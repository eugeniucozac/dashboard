{"ast":null,"code":"import _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ChartPremiumByYear\\\\ChartPremiumByYear.js\";\nimport React, { PureComponent } from 'react';\nimport moment from 'moment';\nimport flatten from 'lodash/flatten';\nimport uniq from 'lodash/uniq'; // app\n\nimport { ChartPremium } from 'modules';\nimport * as utils from 'utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var ChartPremiumByYear = /*#__PURE__*/function (_PureComponent) {\n  _inherits(ChartPremiumByYear, _PureComponent);\n\n  var _super = _createSuper(ChartPremiumByYear);\n\n  function ChartPremiumByYear() {\n    var _this;\n\n    _classCallCheck(this, ChartPremiumByYear);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _this.getData = function (placements) {\n      var data = placements.reduce(function (list, placement) {\n        var insureds = utils.placement.getInsureds(placement);\n        var clients = utils.placement.getClients(placement).join(', ');\n        var date = new Date(placement.inceptionDate);\n        var dateString = date && moment(date).format('DD/MM');\n        var year = utils.placement.getYear(placement);\n        var account = [insureds, clients, dateString].join(' - ');\n        var premiumByCurrency = utils.placement.getPremiumBySettlementCurrency(placement, true, true);\n        var hasPremiums = Boolean(premiumByCurrency);\n        var currentAccountObj = list.find(function (obj) {\n          return obj[account];\n        });\n\n        if (hasPremiums) {\n          Object.keys(premiumByCurrency).forEach(function (currency) {\n            var chartObject = {\n              id: placement.id,\n              insureds: insureds,\n              clients: clients,\n              premium: premiumByCurrency[currency],\n              placement: placement\n            };\n\n            if (currentAccountObj) {\n              if (!currentAccountObj[account][\"\".concat(year, \" (\").concat(currency, \")\")]) {\n                currentAccountObj[account][\"\".concat(year, \" (\").concat(currency, \")\")] = [];\n              }\n\n              currentAccountObj[account][\"\".concat(year, \" (\").concat(currency, \")\")].push(chartObject);\n              return list;\n            }\n\n            list.push(_defineProperty({}, account, _defineProperty({}, \"\".concat(year, \" (\").concat(currency, \")\"), [chartObject])));\n          });\n        }\n\n        return list;\n      }, []);\n      return {\n        data: data,\n        columns: _this.getColumns(data)\n      };\n    };\n\n    _this.getColumns = function (data) {\n      return data.reduce(function (list, entry) {\n        var keys = flatten(Object.keys(entry).map(function (key) {\n          return Object.keys(entry[key]);\n        }));\n        return uniq([].concat(_toConsumableArray(list), _toConsumableArray(keys)));\n      }, []).sort();\n    };\n\n    return _this;\n  }\n\n  _createClass(ChartPremiumByYear, [{\n    key: \"render\",\n    value: function render() {\n      var placements = this.props.placements; // abort\n\n      if (!placements) return null;\n      return /*#__PURE__*/_jsxDEV(ChartPremium, {\n        id: \"byYear\",\n        dataByCurrency: [this.getData(placements)]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 12\n      }, this);\n    }\n  }]);\n\n  return ChartPremiumByYear;\n}(PureComponent);\nexport default ChartPremiumByYear;","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ChartPremiumByYear/ChartPremiumByYear.js"],"names":["React","PureComponent","moment","flatten","uniq","ChartPremium","utils","ChartPremiumByYear","getData","placements","data","reduce","list","placement","insureds","getInsureds","clients","getClients","join","date","Date","inceptionDate","dateString","format","year","getYear","account","premiumByCurrency","getPremiumBySettlementCurrency","hasPremiums","Boolean","currentAccountObj","find","obj","Object","keys","forEach","currency","chartObject","id","premium","push","columns","getColumns","entry","map","key","sort","props"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,QAAqC,OAArC;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,OAAOC,IAAP,MAAiB,aAAjB,C,CAEA;;AACA,SAASC,YAAT,QAA6B,SAA7B;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;;AAEA,WAAaC,kBAAb;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,UACEC,OADF,GACY,UAACC,UAAD,EAAgB;AACxB,UAAMC,IAAI,GAAGD,UAAU,CAACE,MAAX,CAAkB,UAACC,IAAD,EAAOC,SAAP,EAAqB;AAClD,YAAMC,QAAQ,GAAGR,KAAK,CAACO,SAAN,CAAgBE,WAAhB,CAA4BF,SAA5B,CAAjB;AACA,YAAMG,OAAO,GAAGV,KAAK,CAACO,SAAN,CAAgBI,UAAhB,CAA2BJ,SAA3B,EAAsCK,IAAtC,CAA2C,IAA3C,CAAhB;AACA,YAAMC,IAAI,GAAG,IAAIC,IAAJ,CAASP,SAAS,CAACQ,aAAnB,CAAb;AACA,YAAMC,UAAU,GAAGH,IAAI,IAAIjB,MAAM,CAACiB,IAAD,CAAN,CAAaI,MAAb,CAAoB,OAApB,CAA3B;AACA,YAAMC,IAAI,GAAGlB,KAAK,CAACO,SAAN,CAAgBY,OAAhB,CAAwBZ,SAAxB,CAAb;AACA,YAAMa,OAAO,GAAG,CAACZ,QAAD,EAAWE,OAAX,EAAoBM,UAApB,EAAgCJ,IAAhC,CAAqC,KAArC,CAAhB;AACA,YAAMS,iBAAiB,GAAGrB,KAAK,CAACO,SAAN,CAAgBe,8BAAhB,CAA+Cf,SAA/C,EAA0D,IAA1D,EAAgE,IAAhE,CAA1B;AACA,YAAMgB,WAAW,GAAGC,OAAO,CAACH,iBAAD,CAA3B;AACA,YAAMI,iBAAiB,GAAGnB,IAAI,CAACoB,IAAL,CAAU,UAACC,GAAD;AAAA,iBAASA,GAAG,CAACP,OAAD,CAAZ;AAAA,SAAV,CAA1B;;AAEA,YAAIG,WAAJ,EAAiB;AACfK,UAAAA,MAAM,CAACC,IAAP,CAAYR,iBAAZ,EAA+BS,OAA/B,CAAuC,UAACC,QAAD,EAAc;AACnD,gBAAMC,WAAW,GAAG;AAClBC,cAAAA,EAAE,EAAE1B,SAAS,CAAC0B,EADI;AAElBzB,cAAAA,QAAQ,EAAEA,QAFQ;AAGlBE,cAAAA,OAAO,EAAEA,OAHS;AAIlBwB,cAAAA,OAAO,EAAEb,iBAAiB,CAACU,QAAD,CAJR;AAKlBxB,cAAAA,SAAS,EAAEA;AALO,aAApB;;AAQA,gBAAIkB,iBAAJ,EAAuB;AACrB,kBAAI,CAACA,iBAAiB,CAACL,OAAD,CAAjB,WAA8BF,IAA9B,eAAuCa,QAAvC,OAAL,EAA0D;AACxDN,gBAAAA,iBAAiB,CAACL,OAAD,CAAjB,WAA8BF,IAA9B,eAAuCa,QAAvC,UAAsD,EAAtD;AACD;;AAEDN,cAAAA,iBAAiB,CAACL,OAAD,CAAjB,WAA8BF,IAA9B,eAAuCa,QAAvC,QAAoDI,IAApD,CAAyDH,WAAzD;AACA,qBAAO1B,IAAP;AACD;;AAEDA,YAAAA,IAAI,CAAC6B,IAAL,qBACGf,OADH,gCAEQF,IAFR,eAEiBa,QAFjB,QAE+B,CAACC,WAAD,CAF/B;AAKD,WAvBD;AAwBD;;AAED,eAAO1B,IAAP;AACD,OAvCY,EAuCV,EAvCU,CAAb;AAyCA,aAAO;AACLF,QAAAA,IAAI,EAAJA,IADK;AAELgC,QAAAA,OAAO,EAAE,MAAKC,UAAL,CAAgBjC,IAAhB;AAFJ,OAAP;AAID,KA/CH;;AAAA,UAiDEiC,UAjDF,GAiDe,UAACjC,IAAD,EAAU;AACrB,aAAOA,IAAI,CACRC,MADI,CACG,UAACC,IAAD,EAAOgC,KAAP,EAAiB;AACvB,YAAMT,IAAI,GAAGhC,OAAO,CAAC+B,MAAM,CAACC,IAAP,CAAYS,KAAZ,EAAmBC,GAAnB,CAAuB,UAACC,GAAD;AAAA,iBAASZ,MAAM,CAACC,IAAP,CAAYS,KAAK,CAACE,GAAD,CAAjB,CAAT;AAAA,SAAvB,CAAD,CAApB;AACA,eAAO1C,IAAI,8BAAKQ,IAAL,sBAAcuB,IAAd,GAAX;AACD,OAJI,EAIF,EAJE,EAKJY,IALI,EAAP;AAMD,KAxDH;;AAAA;AAAA;;AAAA;AAAA;AAAA,WA0DE,kBAAS;AAAA,UACCtC,UADD,GACgB,KAAKuC,KADrB,CACCvC,UADD,EAGP;;AACA,UAAI,CAACA,UAAL,EAAiB,OAAO,IAAP;AAEjB,0BAAO,QAAC,YAAD;AAAc,QAAA,EAAE,EAAC,QAAjB;AAA0B,QAAA,cAAc,EAAE,CAAC,KAAKD,OAAL,CAAaC,UAAb,CAAD;AAA1C;AAAA;AAAA;AAAA;AAAA,cAAP;AACD;AAjEH;;AAAA;AAAA,EAAwCR,aAAxC;AAoEA,eAAeM,kBAAf","sourcesContent":["import React, { PureComponent } from 'react';\r\nimport moment from 'moment';\r\nimport flatten from 'lodash/flatten';\r\nimport uniq from 'lodash/uniq';\r\n\r\n// app\r\nimport { ChartPremium } from 'modules';\r\nimport * as utils from 'utils';\r\n\r\nexport class ChartPremiumByYear extends PureComponent {\r\n  getData = (placements) => {\r\n    const data = placements.reduce((list, placement) => {\r\n      const insureds = utils.placement.getInsureds(placement);\r\n      const clients = utils.placement.getClients(placement).join(', ');\r\n      const date = new Date(placement.inceptionDate);\r\n      const dateString = date && moment(date).format('DD/MM');\r\n      const year = utils.placement.getYear(placement);\r\n      const account = [insureds, clients, dateString].join(' - ');\r\n      const premiumByCurrency = utils.placement.getPremiumBySettlementCurrency(placement, true, true);\r\n      const hasPremiums = Boolean(premiumByCurrency);\r\n      const currentAccountObj = list.find((obj) => obj[account]);\r\n\r\n      if (hasPremiums) {\r\n        Object.keys(premiumByCurrency).forEach((currency) => {\r\n          const chartObject = {\r\n            id: placement.id,\r\n            insureds: insureds,\r\n            clients: clients,\r\n            premium: premiumByCurrency[currency],\r\n            placement: placement,\r\n          };\r\n\r\n          if (currentAccountObj) {\r\n            if (!currentAccountObj[account][`${year} (${currency})`]) {\r\n              currentAccountObj[account][`${year} (${currency})`] = [];\r\n            }\r\n\r\n            currentAccountObj[account][`${year} (${currency})`].push(chartObject);\r\n            return list;\r\n          }\r\n\r\n          list.push({\r\n            [account]: {\r\n              [`${year} (${currency})`]: [chartObject],\r\n            },\r\n          });\r\n        });\r\n      }\r\n\r\n      return list;\r\n    }, []);\r\n\r\n    return {\r\n      data,\r\n      columns: this.getColumns(data),\r\n    };\r\n  };\r\n\r\n  getColumns = (data) => {\r\n    return data\r\n      .reduce((list, entry) => {\r\n        const keys = flatten(Object.keys(entry).map((key) => Object.keys(entry[key])));\r\n        return uniq([...list, ...keys]);\r\n      }, [])\r\n      .sort();\r\n  };\r\n\r\n  render() {\r\n    const { placements } = this.props;\r\n\r\n    // abort\r\n    if (!placements) return null;\r\n\r\n    return <ChartPremium id=\"byYear\" dataByCurrency={[this.getData(placements)]} />;\r\n  }\r\n}\r\n\r\nexport default ChartPremiumByYear;\r\n"]},"metadata":{},"sourceType":"module"}