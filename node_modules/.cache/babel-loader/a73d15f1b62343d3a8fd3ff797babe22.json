{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ProcessingInstructionsEndorseFaBorder\\\\ProcessingInstructionsEndorseFaBorder.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory, useParams } from 'react-router';\nimport moment from 'moment';\nimport uniqBy from 'lodash/uniqBy';\nimport isEqual from 'lodash/isEqual';\nimport get from 'lodash/get';\nimport * as Yup from 'yup'; // app\n\nimport ProcessingInstructionsEndorseFaBorderView from './ProcessingInstructionsEndorseFaBorder.view';\nimport { showModal, getUsersForRole, selectUser, selectUsersInRoles, getBordereauPolicyTypes, updateProcessingInstruction, submitProcessingInstruction, getIsRiskReferenceDocumentCountLoading, enqueueNotification, selectPiProducingBrokers, selectPiAccountExecutives, getRiskReferenceDocumentsCount } from 'stores';\nimport { PI_STATUS_SUBMITTED_PROCESSING, FRONT_END_CONTACT, OPERATIONS_LEAD, AUTHORISED_SIGNATORY } from 'consts';\nimport * as utils from 'utils';\nimport config from 'config';\nimport * as constants from 'consts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nProcessingInstructionsEndorseFaBorder.propTypes = {\n  instruction: PropTypes.object.isRequired,\n  handlers: PropTypes.shape({\n    back: PropTypes.func.isRequired\n  }).isRequired\n};\nexport default function ProcessingInstructionsEndorseFaBorder(_ref) {\n  _s();\n\n  var _uniqBy,\n      _leadRef$gxbAttribute,\n      _riskReferences$reduc,\n      _riskReferences$reduc2,\n      _instruction$details,\n      _leadRef$gxbAttribute2,\n      _instruction$details2,\n      _leadRef$gxbAttribute3,\n      _documents$riskRefere,\n      _instruction$details7,\n      _instruction$details$,\n      _instruction$details8,\n      _instruction$details$2,\n      _instruction$details9,\n      _instruction$details10,\n      _validateWarrantyList,\n      _validateWarrantyList2,\n      _instruction$details11,\n      _instruction$details12,\n      _this = this;\n\n  var instruction = _ref.instruction,\n      handlers = _ref.handlers,\n      childRef = _ref.childRef;\n  var dispatch = useDispatch();\n  var history = useHistory();\n\n  var _useParams = useParams(),\n      id = _useParams.id,\n      step = _useParams.step,\n      tab = _useParams.tab;\n\n  var user = useSelector(selectUser);\n  var users = useSelector(selectUsersInRoles);\n  var bordereauPolicyTypes = useSelector(function (state) {\n    return get(state, 'processingInstructions.bordereauPolicyTypes');\n  });\n  var producingBrokersFromRoles = useSelector(selectPiProducingBrokers);\n  var accountExecutivesFromRoles = useSelector(selectPiAccountExecutives);\n  var isRiskReferenceDocumentCountLoading = useSelector(getIsRiskReferenceDocumentCountLoading);\n  var documents = useSelector(function (state) {\n    return get(state, 'processingInstructions.documents');\n  }) || {};\n  var businessProcesses = useSelector(function (state) {\n    return get(state, 'referenceData.businessProcesses');\n  });\n  var warrantyTypes = useSelector(function (state) {\n    return get(state, 'referenceData.warrantyTypes');\n  }) || [];\n  var warrantyListOptions = utils.generic.isValidArray(warrantyTypes, true) ? (_uniqBy = uniqBy(warrantyTypes, 'code')) === null || _uniqBy === void 0 ? void 0 : _uniqBy.sort(function (a, b) {\n    return a.code > b.code ? 1 : b.code > a.code ? -1 : 0;\n  }) : [];\n  var isDraft = utils.processingInstructions.status.isDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isSubmittedProcessing = utils.processingInstructions.status.isSubmittedProcessing(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isReopened = utils.processingInstructions.status.isReopened(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\n  var isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\n  var isReadOnly = !isEditable;\n  var isEndorsement = utils.processingInstructions.isEndorsement(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isBordereau = utils.processingInstructions.isBordereau(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isFeeAndAmendment = utils.processingInstructions.isFeeAndAmendment(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var faBorderProcessType = isBordereau || isFeeAndAmendment;\n  var riskReferences = instruction === null || instruction === void 0 ? void 0 : instruction.riskReferences;\n  var leadRef = riskReferences === null || riskReferences === void 0 ? void 0 : riskReferences.find(function (r) {\n    return r.leadPolicy;\n  });\n  var gxbWarrantyDetails = leadRef === null || leadRef === void 0 ? void 0 : (_leadRef$gxbAttribute = leadRef.gxbAttributeDefaultValues) === null || _leadRef$gxbAttribute === void 0 ? void 0 : _leadRef$gxbAttribute.warrantyDetails; // ToDO\n  // const gxbRiskRefFECs = utils.generic.isValidArray(riskReferences, true)\n  //   ? riskReferences\n  //       ?.reduce((acc, curr) => {\n  //         return [...acc, ...(curr?.gxbAttributeDefaultValues?.workFlowFrontEndContacts?.filter((gxbFecs) => gxbFecs?.gxbUseId) ?? [])];\n  //       }, [])\n  //       ?.map((fec) => ({ id: fec?.gxbUseId, name: `${fec?.name} - ${fec?.emailId}` })) || []\n  //   : [];\n\n  var gxbProducingBrokers = utils.generic.isValidArray(riskReferences, true) ? (riskReferences === null || riskReferences === void 0 ? void 0 : (_riskReferences$reduc = riskReferences.reduce(function (acc, curr) {\n    var _curr$gxbAttributeDef, _curr$gxbAttributeDef2, _curr$gxbAttributeDef3;\n\n    return [].concat(_toConsumableArray(acc), _toConsumableArray((_curr$gxbAttributeDef = curr === null || curr === void 0 ? void 0 : (_curr$gxbAttributeDef2 = curr.gxbAttributeDefaultValues) === null || _curr$gxbAttributeDef2 === void 0 ? void 0 : (_curr$gxbAttributeDef3 = _curr$gxbAttributeDef2.producingBrokers) === null || _curr$gxbAttributeDef3 === void 0 ? void 0 : _curr$gxbAttributeDef3.filter(function (gxbPbs) {\n      return gxbPbs === null || gxbPbs === void 0 ? void 0 : gxbPbs.gxbUseId;\n    })) !== null && _curr$gxbAttributeDef !== void 0 ? _curr$gxbAttributeDef : []));\n  }, [])) === null || _riskReferences$reduc === void 0 ? void 0 : _riskReferences$reduc.map(function (pb) {\n    return {\n      id: pb === null || pb === void 0 ? void 0 : pb.gxbUseId,\n      name: pb === null || pb === void 0 ? void 0 : pb.name,\n      emailId: pb === null || pb === void 0 ? void 0 : pb.emailId\n    };\n  })) || [] : [];\n  var gxbAccountExecutives = utils.generic.isValidArray(riskReferences, true) ? (riskReferences === null || riskReferences === void 0 ? void 0 : (_riskReferences$reduc2 = riskReferences.reduce(function (acc, curr) {\n    var _curr$gxbAttributeDef4, _curr$gxbAttributeDef5, _curr$gxbAttributeDef6;\n\n    return [].concat(_toConsumableArray(acc), _toConsumableArray((_curr$gxbAttributeDef4 = curr === null || curr === void 0 ? void 0 : (_curr$gxbAttributeDef5 = curr.gxbAttributeDefaultValues) === null || _curr$gxbAttributeDef5 === void 0 ? void 0 : (_curr$gxbAttributeDef6 = _curr$gxbAttributeDef5.accountExecutives) === null || _curr$gxbAttributeDef6 === void 0 ? void 0 : _curr$gxbAttributeDef6.filter(function (gxbAEs) {\n      return gxbAEs === null || gxbAEs === void 0 ? void 0 : gxbAEs.gxbUseId;\n    })) !== null && _curr$gxbAttributeDef4 !== void 0 ? _curr$gxbAttributeDef4 : []));\n  }, [])) === null || _riskReferences$reduc2 === void 0 ? void 0 : _riskReferences$reduc2.map(function (ae) {\n    return {\n      id: ae === null || ae === void 0 ? void 0 : ae.gxbUseId,\n      name: ae === null || ae === void 0 ? void 0 : ae.name,\n      emailId: ae === null || ae === void 0 ? void 0 : ae.emailId\n    };\n  })) || [] : [];\n  var piHighPriority = (instruction === null || instruction === void 0 ? void 0 : (_instruction$details = instruction.details) === null || _instruction$details === void 0 ? void 0 : _instruction$details.highPriority) || (leadRef === null || leadRef === void 0 ? void 0 : (_leadRef$gxbAttribute2 = leadRef.gxbAttributeDefaultValues) === null || _leadRef$gxbAttribute2 === void 0 ? void 0 : _leadRef$gxbAttribute2.highPriority);\n  var piFrontEndSendDocs = (instruction === null || instruction === void 0 ? void 0 : (_instruction$details2 = instruction.details) === null || _instruction$details2 === void 0 ? void 0 : _instruction$details2.frontEndSendDocs) || (leadRef === null || leadRef === void 0 ? void 0 : (_leadRef$gxbAttribute3 = leadRef.gxbAttributeDefaultValues) === null || _leadRef$gxbAttribute3 === void 0 ? void 0 : _leadRef$gxbAttribute3.frontEndSendDocs);\n  var referenceList = utils.generic.isValidArray(documents === null || documents === void 0 ? void 0 : documents.riskReferences, true) && (documents === null || documents === void 0 ? void 0 : (_documents$riskRefere = documents.riskReferences) === null || _documents$riskRefere === void 0 ? void 0 : _documents$riskRefere.map(function (refData) {\n    return {\n      endorsementId: refData.endorsementId,\n      endorsementNumber: refData.endorsementNumber,\n      riskRefId: refData.riskRefId,\n      xbInstanceId: refData.xbInstanceId,\n      xbPolicyId: refData.xbPolicyId\n    };\n  }));\n  var documentTypeValue = isEndorsement ? constants.PI_ENDORSEMENT_TYPE_DOCUMENT.documentTypeDescription : faBorderProcessType ? constants.PI_FABORDER_TYPE_DOCUMENT.documentTypeDescription : constants.PI_CLOSING_FDO_TYPE_DOCUMENT.documentTypeDescription;\n  var bordereauTypes = [{\n    id: 1,\n    name: 'premium',\n    value: 'premium',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.premium')\n  }, {\n    id: 2,\n    name: 'claims',\n    value: 'claims',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.claims')\n  }, {\n    id: 3,\n    name: 'combined',\n    value: 'combined',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.combined')\n  }];\n  var feeAndAmendmentTypes = [{\n    name: 'fee',\n    value: 'fee',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.fee')\n  }, {\n    name: 'amendment',\n    value: 'amendment',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.amendment')\n  }];\n  var tabs = [{\n    value: 'processing-instruction',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.tabs.pi')\n  }, {\n    value: 'documents',\n    label: \"\".concat(utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.tabs.attachDoc')).concat(isEndorsement ? '*' : '')\n  }];\n  var isValidTab = tabs.map(function (item) {\n    return item.value;\n  }).includes(tab);\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      defaultValues = _useState2[0],\n      setDefaultValues = _useState2[1];\n\n  var _useState3 = useState(isValidTab ? tab : 'processing-instruction'),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedTab = _useState4[0],\n      setSelectedTab = _useState4[1];\n\n  useEffect(function () {\n    dispatch(getUsersForRole([FRONT_END_CONTACT, OPERATIONS_LEAD, AUTHORISED_SIGNATORY]));\n    dispatch(getBordereauPolicyTypes());\n  }, [dispatch]);\n  useEffect(function () {\n    var _childRef$current, _childRef$current$pro;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current = childRef.current) === null || _childRef$current === void 0 ? void 0 : (_childRef$current$pro = _childRef$current.props) === null || _childRef$current$pro === void 0 ? void 0 : _childRef$current$pro.resetFunc;\n\n    var updatedDefaultValues = _objectSpread({}, utils.form.getInitialValues(fields));\n\n    setDefaultValues(updatedDefaultValues);\n\n    if (utils.generic.isFunction(reset)) {\n      reset(updatedDefaultValues, {\n        keepDirty: false\n      });\n    }\n  }, [instruction] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n  useEffect(function () {\n    if (!utils.generic.isValidArray(referenceList, true) || !documentTypeValue) return;\n    dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue));\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var filterUsersByRole = function filterUsersByRole(roleNames) {\n    return riskReferences === null || riskReferences === void 0 ? void 0 : riskReferences.reduce(function (acc, cur) {\n      var groupDepartXbInstanceIds = \"\".concat(cur.departmentId, \"-\").concat(cur.xbInstanceId);\n      return [].concat(_toConsumableArray(acc), _toConsumableArray(users.filter(function (u) {\n        return roleNames.includes(u.userRole);\n      }).filter(function (u) {\n        var _u$departmentId;\n\n        return (_u$departmentId = u.departmentId) === null || _u$departmentId === void 0 ? void 0 : _u$departmentId.split(',').map(function (x) {\n          return x.trim();\n        }).includes(groupDepartXbInstanceIds);\n      }).map(function (u) {\n        return {\n          id: u.userId,\n          name: u.fullName + ' - ' + u.emailId\n        };\n      })));\n    }, []);\n  };\n\n  var frontEndContactsForRoles = uniqBy(filterUsersByRole([FRONT_END_CONTACT, OPERATIONS_LEAD]), 'id'); // const frontEndContacts = utils.generic.isValidArray(gxbRiskRefFECs, true) ? gxbRiskRefFECs : frontEndContactsForRoles; // ToDo\n\n  var frontEndContacts = frontEndContactsForRoles;\n  var producingBrokers = utils.generic.isValidArray(gxbProducingBrokers, true) ? gxbProducingBrokers : producingBrokersFromRoles;\n  var accountExecutives = utils.generic.isValidArray(gxbAccountExecutives, true) ? gxbAccountExecutives : accountExecutivesFromRoles;\n\n  var getBordereauPolicyTypeId = function getBordereauPolicyTypeId() {\n    var _instruction$details3;\n\n    var bordereauPolicyTypeId = (_instruction$details3 = instruction.details) === null || _instruction$details3 === void 0 ? void 0 : _instruction$details3.bordereauPolicyTypeId;\n\n    if (!bordereauPolicyTypeId && utils.generic.isValidArray(bordereauPolicyTypes, true)) {\n      var item = bordereauPolicyTypes.find(function (type) {\n        var _instruction$details4;\n\n        return type.bordereauPolicyTypeID === (instruction === null || instruction === void 0 ? void 0 : (_instruction$details4 = instruction.details) === null || _instruction$details4 === void 0 ? void 0 : _instruction$details4.bordereauPolicyTypeId);\n      });\n      bordereauPolicyTypeId = item === null || item === void 0 ? void 0 : item.bordereauPolicyTypeID;\n    }\n\n    return bordereauPolicyTypeId || '';\n  };\n\n  var getBordereauTypeValue = function getBordereauTypeValue() {\n    var _instruction$details5;\n\n    var defaultId = 1;\n    var defaultType = 'premium';\n    var bordereauTypeId = (instruction === null || instruction === void 0 ? void 0 : (_instruction$details5 = instruction.details) === null || _instruction$details5 === void 0 ? void 0 : _instruction$details5.bordereauTypeId) || defaultId;\n    var obj = bordereauTypes.find(function (type) {\n      return type.id === bordereauTypeId;\n    });\n    return (obj === null || obj === void 0 ? void 0 : obj.value) || defaultType;\n  };\n\n  var validateWarrantyListValue = function validateWarrantyListValue() {\n    if (!get(instruction === null || instruction === void 0 ? void 0 : instruction.details, 'ppwOrPpcValue', null)) {\n      if ((gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.isInvalidData) === 0 && utils.generic.isValidArray(gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.warrantyList, true)) {\n        return {\n          flag: true\n        };\n      } else if (((gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.isInvalidData) === 0 || (gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.isInvalidData) === 1) && !utils.generic.isValidArray(gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.warrantyList, true)) {\n        return {\n          falg: false,\n          displayError: (gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.isInvalidData) === 1\n        };\n      }\n    } else {\n      var _instruction$details6;\n\n      return {\n        flag: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details6 = instruction.details) === null || _instruction$details6 === void 0 ? void 0 : _instruction$details6.ppwOrPpc) || false\n      };\n    }\n\n    return false;\n  };\n\n  var fields = [{\n    name: 'frontEndContactId',\n    type: 'select',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndContact'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details7 = instruction.details) === null || _instruction$details7 === void 0 ? void 0 : _instruction$details7.frontEndContactId) || (user === null || user === void 0 ? void 0 : user.id) || '',\n    options: frontEndContacts,\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    optionKey: 'id',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, isFeeAndAmendment ? {\n    name: 'producingBrokerId',\n    group: 'general',\n    type: 'select',\n    label: utils.string.t('processingInstructions.checklist.fields.producingBroker'),\n    value: (_instruction$details$ = instruction === null || instruction === void 0 ? void 0 : (_instruction$details8 = instruction.details) === null || _instruction$details8 === void 0 ? void 0 : _instruction$details8.producingBrokerId) !== null && _instruction$details$ !== void 0 ? _instruction$details$ : '',\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    options: producingBrokers,\n    optionKey: 'id',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(producingBrokers)\n    }\n  } : {\n    name: 'accountExecutiveId',\n    type: 'select',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.accountExecutive'),\n    value: (_instruction$details$2 = instruction === null || instruction === void 0 ? void 0 : (_instruction$details9 = instruction.details) === null || _instruction$details9 === void 0 ? void 0 : _instruction$details9.accountExecutiveId) !== null && _instruction$details$2 !== void 0 ? _instruction$details$2 : '',\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    options: accountExecutives,\n    optionKey: 'id',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'frontEndSendDocs',\n    type: 'checkbox',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\n    value: piFrontEndSendDocs,\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'highPriority',\n    type: 'checkbox',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\n    value: piHighPriority,\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'notes',\n    type: 'textarea',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.notes.label'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details10 = instruction.details) === null || _instruction$details10 === void 0 ? void 0 : _instruction$details10.notes) || '',\n    muiComponentProps: {\n      multiline: true,\n      minRows: 5,\n      maxRows: 10,\n      disabled: isReadOnly\n    }\n  }].concat(_toConsumableArray(isEndorsement ? [{\n    name: 'ppwOrPpc',\n    type: 'checkbox',\n    value: ((_validateWarrantyList = validateWarrantyListValue()) === null || _validateWarrantyList === void 0 ? void 0 : _validateWarrantyList.flag) || false,\n    displayError: ((_validateWarrantyList2 = validateWarrantyListValue()) === null || _validateWarrantyList2 === void 0 ? void 0 : _validateWarrantyList2.displayError) || false,\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.ppwPpc'),\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }] : []), _toConsumableArray(isEndorsement || isFeeAndAmendment ? [{\n    name: 'isNonPremium',\n    type: 'checkbox',\n    value: (leadRef === null || leadRef === void 0 ? void 0 : leadRef.isNonPremium) === 'Yes',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.nonPremium'),\n    disabled: true\n  }] : []), _toConsumableArray(isFeeAndAmendment ? [{\n    name: 'feeOrAmendment',\n    type: 'radio',\n    title: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.type.label'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details11 = instruction.details) === null || _instruction$details11 === void 0 ? void 0 : _instruction$details11.feeOrAmendment) || 'fee',\n    options: feeAndAmendmentTypes,\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    muiFormGroupProps: {\n      row: true\n    },\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }] : []), _toConsumableArray(isBordereau ? [{\n    name: 'bordereauPolicyTypeId',\n    type: 'select',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.policyType'),\n    value: getBordereauPolicyTypeId(),\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    options: bordereauPolicyTypes,\n    optionKey: 'bordereauPolicyTypeID',\n    optionLabel: 'bordereauPolicyTypeDetails',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    type: 'datepicker',\n    name: 'bordereauPeriod',\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.bordereauPeriod'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details12 = instruction.details) === null || _instruction$details12 === void 0 ? void 0 : _instruction$details12.bordereauPeriod) || null,\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    outputFormat: 'iso',\n    placeholder: 'MM YYYY',\n    muiComponentProps: {\n      fullWidth: true,\n      helperText: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.bordereauPeriod.helperTextBordereauPeriod'),\n      disabled: isReadOnly\n    },\n    muiPickerProps: {\n      views: ['year', 'month'],\n      format: 'MM YYYY',\n      clearable: true\n    }\n  }, {\n    name: 'bordereauTypeId',\n    type: 'radio',\n    title: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.bordereauType.label'),\n    value: getBordereauTypeValue(),\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    options: bordereauTypes,\n    muiFormGroupProps: {\n      row: true\n    },\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }] : []));\n\n  var getSelectedFrontEndContactName = function getSelectedFrontEndContactName(fecId) {\n    var _frontEndContacts$fin, _selectedFecName$spli;\n\n    var selectedFecName = frontEndContacts === null || frontEndContacts === void 0 ? void 0 : (_frontEndContacts$fin = frontEndContacts.find(function (fec) {\n      return fec.id === fecId;\n    })) === null || _frontEndContacts$fin === void 0 ? void 0 : _frontEndContacts$fin.name;\n    return (selectedFecName === null || selectedFecName === void 0 ? void 0 : (_selectedFecName$spli = selectedFecName.split('-')[0]) === null || _selectedFecName$spli === void 0 ? void 0 : _selectedFecName$spli.trim()) || '';\n  };\n\n  var getSelectedFrontEndContactEmail = function getSelectedFrontEndContactEmail(fecId) {\n    var _frontEndContacts$fin2, _fecEmailId$split$;\n\n    var fecEmailId = frontEndContacts === null || frontEndContacts === void 0 ? void 0 : (_frontEndContacts$fin2 = frontEndContacts.find(function (fec) {\n      return fec.id === fecId;\n    })) === null || _frontEndContacts$fin2 === void 0 ? void 0 : _frontEndContacts$fin2.name;\n    return (fecEmailId === null || fecEmailId === void 0 ? void 0 : (_fecEmailId$split$ = fecEmailId.split('-')[1]) === null || _fecEmailId$split$ === void 0 ? void 0 : _fecEmailId$split$.trim()) || '';\n  };\n\n  var getSelectedProducingBrokerName = function getSelectedProducingBrokerName(pbId) {\n    var _producingBrokers$fin;\n\n    var selectedProducingBrokerName = producingBrokers === null || producingBrokers === void 0 ? void 0 : (_producingBrokers$fin = producingBrokers.find(function (pb) {\n      return (pb === null || pb === void 0 ? void 0 : pb.id) === pbId;\n    })) === null || _producingBrokers$fin === void 0 ? void 0 : _producingBrokers$fin.name;\n    return selectedProducingBrokerName;\n  };\n\n  var getSelectedProducingBrokerEmail = function getSelectedProducingBrokerEmail(pbId) {\n    var _producingBrokers$fin2;\n\n    var selectedProducingBrokerName = producingBrokers === null || producingBrokers === void 0 ? void 0 : (_producingBrokers$fin2 = producingBrokers.find(function (pb) {\n      return (pb === null || pb === void 0 ? void 0 : pb.id) === pbId;\n    })) === null || _producingBrokers$fin2 === void 0 ? void 0 : _producingBrokers$fin2.emailId;\n    return selectedProducingBrokerName;\n  };\n\n  var getSelectedAccountExecutiveName = function getSelectedAccountExecutiveName(aeId) {\n    var _accountExecutives$fi;\n\n    var selectedAccountExecutiveName = accountExecutives === null || accountExecutives === void 0 ? void 0 : (_accountExecutives$fi = accountExecutives.find(function (ae) {\n      return (ae === null || ae === void 0 ? void 0 : ae.id) === aeId;\n    })) === null || _accountExecutives$fi === void 0 ? void 0 : _accountExecutives$fi.name;\n    return selectedAccountExecutiveName;\n  };\n\n  var getSelectedAccountExecutiveEmail = function getSelectedAccountExecutiveEmail(aeId) {\n    var _accountExecutives$fi2;\n\n    var selectedAccountExecutiveEmail = accountExecutives === null || accountExecutives === void 0 ? void 0 : (_accountExecutives$fi2 = accountExecutives.find(function (ae) {\n      return (ae === null || ae === void 0 ? void 0 : ae.id) === aeId;\n    })) === null || _accountExecutives$fi2 === void 0 ? void 0 : _accountExecutives$fi2.emailId;\n    return selectedAccountExecutiveEmail;\n  };\n\n  var getUpdatedInstruction = function getUpdatedInstruction(instruction, formValues) {\n    var _defaultWarrantyDetai, _defaultWarrantyDetai2, _defaultWarrantyDetai3, _defaultWarrantyDetai4, _defaultWarrantyDetai5, _defaultWarrantyDetai6, _defaultWarrantyDetai7, _defaultWarrantyDetai8, _defaultWarrantyDetai9, _bordereauTypes$find;\n\n    var defaultWarrantyDetails = utils.generic.isValidArray(gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.warrantyList, true) ? gxbWarrantyDetails === null || gxbWarrantyDetails === void 0 ? void 0 : gxbWarrantyDetails.warrantyList.find(function (a) {\n      return a.isSelected;\n    }) : null;\n\n    if (!defaultWarrantyDetails) {\n      defaultWarrantyDetails = utils.generic.isValidArray(warrantyListOptions, true) ? warrantyListOptions === null || warrantyListOptions === void 0 ? void 0 : warrantyListOptions.find(function (a) {\n        var _a$code;\n\n        return !!(a === null || a === void 0 ? void 0 : (_a$code = a.code) === null || _a$code === void 0 ? void 0 : _a$code.toLowerCase()) === !!formValues['ppwOrPpc'];\n      }) : null;\n    }\n\n    return _objectSpread(_objectSpread({}, instruction), {}, {\n      details: _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, formValues), {}, {\n        instructionId: instruction === null || instruction === void 0 ? void 0 : instruction.id\n      }, isFeeAndAmendment && {\n        producingBrokerName: getSelectedProducingBrokerName(formValues === null || formValues === void 0 ? void 0 : formValues.producingBrokerId),\n        producingBrokerId: formValues === null || formValues === void 0 ? void 0 : formValues.producingBrokerId,\n        producingBrokerEmailId: getSelectedProducingBrokerEmail(formValues === null || formValues === void 0 ? void 0 : formValues.producingBrokerId)\n      }), !isFeeAndAmendment && {\n        accountExecutive: getSelectedAccountExecutiveName(formValues === null || formValues === void 0 ? void 0 : formValues.accountExecutiveId),\n        accountExecutiveId: formValues === null || formValues === void 0 ? void 0 : formValues.accountExecutiveId,\n        accountExecutiveEmailId: getSelectedAccountExecutiveEmail(formValues === null || formValues === void 0 ? void 0 : formValues.accountExecutiveId)\n      }), {}, {\n        frontEndContact: getSelectedFrontEndContactName(formValues === null || formValues === void 0 ? void 0 : formValues.frontEndContactId),\n        frontEndContactId: formValues === null || formValues === void 0 ? void 0 : formValues.frontEndContactId,\n        frontEndContactEmail: getSelectedFrontEndContactEmail(formValues === null || formValues === void 0 ? void 0 : formValues.frontEndContactId),\n        warrantyDescription: formValues['ppwOrPpc'] ? ((_defaultWarrantyDetai = defaultWarrantyDetails) === null || _defaultWarrantyDetai === void 0 ? void 0 : _defaultWarrantyDetai.warrantyName) || ((_defaultWarrantyDetai2 = defaultWarrantyDetails) === null || _defaultWarrantyDetai2 === void 0 ? void 0 : _defaultWarrantyDetai2.warrantyDescription) || 'NA' : 'NA',\n        warrantyTypeId: formValues['ppwOrPpc'] ? ((_defaultWarrantyDetai3 = defaultWarrantyDetails) === null || _defaultWarrantyDetai3 === void 0 ? void 0 : _defaultWarrantyDetai3.warrantyTypeId) || ((_defaultWarrantyDetai4 = defaultWarrantyDetails) === null || _defaultWarrantyDetai4 === void 0 ? void 0 : _defaultWarrantyDetai4.warrantyTypeID) || '' : '',\n        warrantyDate: formValues['ppwOrPpc'] ? ((_defaultWarrantyDetai5 = defaultWarrantyDetails) === null || _defaultWarrantyDetai5 === void 0 ? void 0 : _defaultWarrantyDetai5.warrantyDate) || '' : '',\n        warrantyCode: formValues['ppwOrPpc'] ? ((_defaultWarrantyDetai6 = defaultWarrantyDetails) === null || _defaultWarrantyDetai6 === void 0 ? void 0 : _defaultWarrantyDetai6.warrantyCode) || ((_defaultWarrantyDetai7 = defaultWarrantyDetails) === null || _defaultWarrantyDetai7 === void 0 ? void 0 : _defaultWarrantyDetai7.code) || 'NA' : 'NA',\n        ppwOrPpcValue: formValues['ppwOrPpc'] ? ((_defaultWarrantyDetai8 = defaultWarrantyDetails) === null || _defaultWarrantyDetai8 === void 0 ? void 0 : _defaultWarrantyDetai8.warrantyCode) || ((_defaultWarrantyDetai9 = defaultWarrantyDetails) === null || _defaultWarrantyDetai9 === void 0 ? void 0 : _defaultWarrantyDetai9.code) || 'NA' : 'NA'\n      }, isBordereau && {\n        bordereauPeriod: formValues.bordereauPeriod ? moment(formValues.bordereauPeriod).format('MMMM YYYY') : '',\n        bordereauTypeId: ((_bordereauTypes$find = bordereauTypes.find(function (type) {\n          return type.value === formValues.bordereauTypeId;\n        })) === null || _bordereauTypes$find === void 0 ? void 0 : _bordereauTypes$find.id) || null\n      })\n    });\n  };\n\n  var handleCancel = function handleCancel() {\n    var _childRef$current2, _childRef$current2$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current2 = childRef.current) === null || _childRef$current2 === void 0 ? void 0 : (_childRef$current2$pr = _childRef$current2.props) === null || _childRef$current2$pr === void 0 ? void 0 : _childRef$current2$pr.resetFunc;\n\n    if (utils.generic.isFunction(reset)) {\n      reset(defaultValues, {\n        keepDirty: false\n      });\n    }\n  };\n\n  var checkAllRequiredFiledsSelected = function checkAllRequiredFiledsSelected() {\n    var _childRef$current3, _childRef$current3$pr;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current3 = childRef.current) === null || _childRef$current3 === void 0 ? void 0 : (_childRef$current3$pr = _childRef$current3.props) === null || _childRef$current3$pr === void 0 ? void 0 : _childRef$current3$pr.values) || {};\n    var isFrontEndIdSelected = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.frontEndContactId);\n\n    if (isEndorsement) {\n      var isAccountExecutiveIdSelected = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.accountExecutiveId);\n\n      if (isFrontEndIdSelected && isAccountExecutiveIdSelected) {\n        return true;\n      } else if (!isFrontEndIdSelected && !isAccountExecutiveIdSelected) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdAccountExecutiveIdValue', 'warning'));\n        return false;\n      } else if (!isFrontEndIdSelected) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdValue', 'warning'));\n        return false;\n      } else if (!isAccountExecutiveIdSelected) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noAccountExecutiveIdValue', 'warning'));\n        return false;\n      }\n    } else if (isFeeAndAmendment) {\n      var isProducingBrokerSelected = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.producingBrokerId);\n\n      if (isFrontEndIdSelected && isProducingBrokerSelected) {\n        return true;\n      } else if (!isFrontEndIdSelected && !isProducingBrokerSelected) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdProducingBrokerIdValue', 'warning'));\n        return false;\n      } else if (!isFrontEndIdSelected) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdValue', 'warning'));\n        return false;\n      } else if (!isProducingBrokerSelected) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noProducingBrokerValue', 'warning'));\n        return false;\n      }\n    } else if (isBordereau) {\n      var bordereauTypeId = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.bordereauTypeId);\n      var bordereauPeriod = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.bordereauPeriod);\n      var bordereauPolicyTypeId = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.bordereauPolicyTypeId);\n      var accountExecutiveId = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.accountExecutiveId);\n\n      if (isFrontEndIdSelected && bordereauTypeId && bordereauPeriod && bordereauPolicyTypeId && accountExecutiveId) {\n        return true;\n      } else if (!isFrontEndIdSelected) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdValue', 'warning'));\n        return false;\n      } else if (!accountExecutiveId) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noAccountExecutiveIdValue', 'warning'));\n        return false;\n      } else if (!bordereauTypeId) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noBordereauTypeId', 'warning'));\n        return false;\n      } else if (!bordereauPolicyTypeId) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noBordereauPolicyType', 'warning'));\n        return false;\n      } else if (!bordereauPeriod) {\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noBordereauPeriod', 'warning'));\n        return false;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  var handleSave = function handleSave() {\n    var _childRef$current4, _childRef$current4$pr;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current4 = childRef.current) === null || _childRef$current4 === void 0 ? void 0 : (_childRef$current4$pr = _childRef$current4.props) === null || _childRef$current4$pr === void 0 ? void 0 : _childRef$current4$pr.values) || {};\n    var updatedInstruction = getUpdatedInstruction(instruction, formValues);\n    return dispatch(updateProcessingInstruction(updatedInstruction));\n  };\n\n  var mandatoryDocumentsNotUploaded = function mandatoryDocumentsNotUploaded() {\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        fullWidth: true,\n        title: utils.string.t('processingInstructions.mandatoryDocuments.error'),\n        maxWidth: 'xs',\n        componentProps: {\n          hideCancelButton: true,\n          confirmLabel: utils.string.t('processingInstructions.authorisations.form.confirm'),\n          confirmMessage: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: utils.string.t('processingInstructions.mandatoryDocuments.mandatoryDocumentUploaded')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 29\n          }, _this),\n          buttonColors: {\n            confirm: 'secondary'\n          },\n          submitHandler: function submitHandler() {},\n          handleClose: function handleClose() {}\n        }\n      }\n    }));\n  };\n\n  var handleSubmit = function handleSubmit() {\n    var _childRef$current5, _childRef$current5$pr;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current5 = childRef.current) === null || _childRef$current5 === void 0 ? void 0 : (_childRef$current5$pr = _childRef$current5.props) === null || _childRef$current5$pr === void 0 ? void 0 : _childRef$current5$pr.values) || {};\n    var isPageEdited = !isEqual(defaultValues, formValues);\n\n    if (checkAllRequiredFiledsSelected()) {\n      if (isEndorsement) {\n        dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue)).then(function (response) {\n          if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n            var _response$data;\n\n            if (response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.some(function (a) {\n              return a.documentCount === 0;\n            })) {\n              mandatoryDocumentsNotUploaded();\n            } else {\n              if (isPageEdited) {\n                handleSave().then(function (response) {\n                  if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n                    proceedToSubmission();\n                  }\n                });\n              } else {\n                proceedToSubmission();\n              }\n            }\n          }\n        });\n      } else {\n        if (isPageEdited) {\n          handleSave().then(function (response) {\n            if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n              proceedToSubmission();\n            }\n          });\n        } else {\n          proceedToSubmission();\n        }\n      }\n    }\n  };\n\n  var proceedToSubmission = function proceedToSubmission() {\n    var _childRef$current6, _childRef$current6$pr, _businessProcesses$fi;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current6 = childRef.current) === null || _childRef$current6 === void 0 ? void 0 : (_childRef$current6$pr = _childRef$current6.props) === null || _childRef$current6$pr === void 0 ? void 0 : _childRef$current6$pr.values) || {};\n    var updatedInstruction = getUpdatedInstruction(instruction, formValues);\n    var businessProcess = businessProcesses === null || businessProcesses === void 0 ? void 0 : (_businessProcesses$fi = businessProcesses.find(function (bp) {\n      return bp.businessProcessID === updatedInstruction.businessProcessId;\n    })) === null || _businessProcesses$fi === void 0 ? void 0 : _businessProcesses$fi.businessProcessName;\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        title: 'processingInstructions.authorisations.form.title',\n        fullWidth: true,\n        maxWidth: 'sm',\n        componentProps: {\n          confirmMessage: utils.string.t('processingInstructions.authorisations.form.confirmText'),\n          cancelLabel: utils.string.t('processingInstructions.authorisations.form.cancel'),\n          confirmLabel: utils.string.t('processingInstructions.authorisations.form.confirm'),\n          confirmMessageText: utils.string.t('processingInstructions.authorisations.form.confirmMessage'),\n          note: utils.string.t('processingInstructions.authorisations.form.note'),\n          submitHandler: function submitHandler() {\n            dispatch(submitProcessingInstruction(_objectSpread(_objectSpread({}, updatedInstruction), {}, {\n              businessProcess: businessProcess,\n              statusId: PI_STATUS_SUBMITTED_PROCESSING\n            }))).then(function (res) {\n              if ((res === null || res === void 0 ? void 0 : res.status) === constants.API_RESPONSE_OK) {\n                history.push('/processing-instructions');\n                dispatch(enqueueNotification('processingInstructions.details.submittedSuccessfully', 'success'));\n              }\n            });\n          }\n        }\n      }\n    }));\n  };\n\n  var toggleTab = function toggleTab(tab) {\n    setSelectedTab(tab);\n    history.replace(\"\".concat(config.routes.processingInstructions.steps, \"/\").concat(id).concat(step ? \"/\".concat(step) : '').concat(tab ? \"/\".concat(tab) : ''));\n  }; // abort\n\n\n  if (!defaultValues || !instruction || utils.generic.isInvalidOrEmptyArray(users) || !bordereauPolicyTypes) return null;\n  return /*#__PURE__*/_jsxDEV(ProcessingInstructionsEndorseFaBorderView, {\n    instruction: instruction,\n    leadRef: leadRef,\n    tabs: tabs,\n    selectedTab: selectedTab,\n    fields: fields,\n    defaultValues: defaultValues,\n    isEndorsement: isEndorsement,\n    isBordereau: isBordereau,\n    isFeeAndAmendment: isFeeAndAmendment,\n    isReadOnly: isReadOnly,\n    isSubmittedProcessing: isSubmittedProcessing,\n    isRiskReferenceDocumentCountLoading: isRiskReferenceDocumentCountLoading,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      cancel: handleCancel,\n      save: handleSave,\n      submit: handleSubmit,\n      toggleTab: toggleTab\n    }),\n    ref: childRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 678,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProcessingInstructionsEndorseFaBorder, \"9FO8Cd0blMm57Lu988qEA0x63cc=\", false, function () {\n  return [useDispatch, useHistory, useParams, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ProcessingInstructionsEndorseFaBorder;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProcessingInstructionsEndorseFaBorder\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsEndorseFaBorder/ProcessingInstructionsEndorseFaBorder.js"],"names":["React","useState","useEffect","PropTypes","useDispatch","useSelector","useHistory","useParams","moment","uniqBy","isEqual","get","Yup","ProcessingInstructionsEndorseFaBorderView","showModal","getUsersForRole","selectUser","selectUsersInRoles","getBordereauPolicyTypes","updateProcessingInstruction","submitProcessingInstruction","getIsRiskReferenceDocumentCountLoading","enqueueNotification","selectPiProducingBrokers","selectPiAccountExecutives","getRiskReferenceDocumentsCount","PI_STATUS_SUBMITTED_PROCESSING","FRONT_END_CONTACT","OPERATIONS_LEAD","AUTHORISED_SIGNATORY","utils","config","constants","ProcessingInstructionsEndorseFaBorder","propTypes","instruction","object","isRequired","handlers","shape","back","func","childRef","dispatch","history","id","step","tab","user","users","bordereauPolicyTypes","state","producingBrokersFromRoles","accountExecutivesFromRoles","isRiskReferenceDocumentCountLoading","documents","businessProcesses","warrantyTypes","warrantyListOptions","generic","isValidArray","sort","a","b","code","isDraft","processingInstructions","status","statusId","isRejectedDraft","isSubmittedProcessing","isReopened","userHasWritePermission","app","access","feature","isEditable","isReadOnly","isEndorsement","processTypeId","isBordereau","isFeeAndAmendment","faBorderProcessType","riskReferences","leadRef","find","r","leadPolicy","gxbWarrantyDetails","gxbAttributeDefaultValues","warrantyDetails","gxbProducingBrokers","reduce","acc","curr","producingBrokers","filter","gxbPbs","gxbUseId","map","pb","name","emailId","gxbAccountExecutives","accountExecutives","gxbAEs","ae","piHighPriority","details","highPriority","piFrontEndSendDocs","frontEndSendDocs","referenceList","refData","endorsementId","endorsementNumber","riskRefId","xbInstanceId","xbPolicyId","documentTypeValue","PI_ENDORSEMENT_TYPE_DOCUMENT","documentTypeDescription","PI_FABORDER_TYPE_DOCUMENT","PI_CLOSING_FDO_TYPE_DOCUMENT","bordereauTypes","value","label","string","t","feeAndAmendmentTypes","tabs","isValidTab","item","includes","defaultValues","setDefaultValues","selectedTab","setSelectedTab","reset","current","props","resetFunc","updatedDefaultValues","form","getInitialValues","fields","isFunction","keepDirty","filterUsersByRole","roleNames","cur","groupDepartXbInstanceIds","departmentId","u","userRole","split","x","trim","userId","fullName","frontEndContactsForRoles","frontEndContacts","getBordereauPolicyTypeId","bordereauPolicyTypeId","type","bordereauPolicyTypeID","getBordereauTypeValue","defaultId","defaultType","bordereauTypeId","obj","validateWarrantyListValue","isInvalidData","warrantyList","flag","falg","displayError","ppwOrPpc","frontEndContactId","options","validation","required","optionKey","optionLabel","muiComponentProps","disabled","group","producingBrokerId","isInvalidOrEmptyArray","accountExecutiveId","notes","multiline","minRows","maxRows","isNonPremium","title","feeOrAmendment","muiFormGroupProps","row","bordereauPeriod","outputFormat","placeholder","fullWidth","helperText","muiPickerProps","views","format","clearable","getSelectedFrontEndContactName","fecId","selectedFecName","fec","getSelectedFrontEndContactEmail","fecEmailId","getSelectedProducingBrokerName","pbId","selectedProducingBrokerName","getSelectedProducingBrokerEmail","getSelectedAccountExecutiveName","aeId","selectedAccountExecutiveName","getSelectedAccountExecutiveEmail","selectedAccountExecutiveEmail","getUpdatedInstruction","formValues","defaultWarrantyDetails","isSelected","toLowerCase","instructionId","producingBrokerName","producingBrokerEmailId","accountExecutive","accountExecutiveEmailId","frontEndContact","frontEndContactEmail","warrantyDescription","warrantyName","warrantyTypeId","warrantyTypeID","warrantyDate","warrantyCode","ppwOrPpcValue","handleCancel","checkAllRequiredFiledsSelected","values","isFrontEndIdSelected","Boolean","isAccountExecutiveIdSelected","isProducingBrokerSelected","handleSave","updatedInstruction","mandatoryDocumentsNotUploaded","component","maxWidth","componentProps","hideCancelButton","confirmLabel","confirmMessage","buttonColors","confirm","submitHandler","handleClose","handleSubmit","isPageEdited","then","response","API_RESPONSE_OK","data","some","documentCount","proceedToSubmission","businessProcess","bp","businessProcessID","businessProcessId","businessProcessName","cancelLabel","confirmMessageText","note","res","push","toggleTab","replace","routes","steps","cancel","save","submit"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport moment from 'moment';\r\nimport uniqBy from 'lodash/uniqBy';\r\nimport isEqual from 'lodash/isEqual';\r\nimport get from 'lodash/get';\r\nimport * as Yup from 'yup';\r\n\r\n// app\r\nimport ProcessingInstructionsEndorseFaBorderView from './ProcessingInstructionsEndorseFaBorder.view';\r\nimport {\r\n  showModal,\r\n  getUsersForRole,\r\n  selectUser,\r\n  selectUsersInRoles,\r\n  getBordereauPolicyTypes,\r\n  updateProcessingInstruction,\r\n  submitProcessingInstruction,\r\n  getIsRiskReferenceDocumentCountLoading,\r\n  enqueueNotification,\r\n  selectPiProducingBrokers,\r\n  selectPiAccountExecutives,\r\n  getRiskReferenceDocumentsCount,\r\n} from 'stores';\r\nimport { PI_STATUS_SUBMITTED_PROCESSING, FRONT_END_CONTACT, OPERATIONS_LEAD, AUTHORISED_SIGNATORY } from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport * as constants from 'consts';\r\n\r\nProcessingInstructionsEndorseFaBorder.propTypes = {\r\n  instruction: PropTypes.object.isRequired,\r\n  handlers: PropTypes.shape({\r\n    back: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nexport default function ProcessingInstructionsEndorseFaBorder({ instruction, handlers, childRef }) {\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const { id, step, tab } = useParams();\r\n\r\n  const user = useSelector(selectUser);\r\n  const users = useSelector(selectUsersInRoles);\r\n  const bordereauPolicyTypes = useSelector((state) => get(state, 'processingInstructions.bordereauPolicyTypes'));\r\n  const producingBrokersFromRoles = useSelector(selectPiProducingBrokers);\r\n  const accountExecutivesFromRoles = useSelector(selectPiAccountExecutives);\r\n  const isRiskReferenceDocumentCountLoading = useSelector(getIsRiskReferenceDocumentCountLoading);\r\n  const documents = useSelector((state) => get(state, 'processingInstructions.documents')) || {};\r\n  const businessProcesses = useSelector((state) => get(state, 'referenceData.businessProcesses'));\r\n  const warrantyTypes = useSelector((state) => get(state, 'referenceData.warrantyTypes')) || [];\r\n\r\n  const warrantyListOptions = utils.generic.isValidArray(warrantyTypes, true)\r\n    ? uniqBy(warrantyTypes, 'code')?.sort((a, b) => (a.code > b.code ? 1 : b.code > a.code ? -1 : 0))\r\n    : [];\r\n\r\n  const isDraft = utils.processingInstructions.status.isDraft(instruction?.statusId);\r\n  const isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction?.statusId);\r\n  const isSubmittedProcessing = utils.processingInstructions.status.isSubmittedProcessing(instruction?.statusId);\r\n  const isReopened = utils.processingInstructions.status.isReopened(instruction?.statusId);\r\n  const userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\r\n  const isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\r\n  const isReadOnly = !isEditable;\r\n  const isEndorsement = utils.processingInstructions.isEndorsement(instruction?.processTypeId);\r\n  const isBordereau = utils.processingInstructions.isBordereau(instruction?.processTypeId);\r\n  const isFeeAndAmendment = utils.processingInstructions.isFeeAndAmendment(instruction?.processTypeId);\r\n  const faBorderProcessType = isBordereau || isFeeAndAmendment;\r\n  const riskReferences = instruction?.riskReferences;\r\n  const leadRef = riskReferences?.find((r) => r.leadPolicy);\r\n  const gxbWarrantyDetails = leadRef?.gxbAttributeDefaultValues?.warrantyDetails;\r\n\r\n  // ToDO\r\n  // const gxbRiskRefFECs = utils.generic.isValidArray(riskReferences, true)\r\n  //   ? riskReferences\r\n  //       ?.reduce((acc, curr) => {\r\n  //         return [...acc, ...(curr?.gxbAttributeDefaultValues?.workFlowFrontEndContacts?.filter((gxbFecs) => gxbFecs?.gxbUseId) ?? [])];\r\n  //       }, [])\r\n  //       ?.map((fec) => ({ id: fec?.gxbUseId, name: `${fec?.name} - ${fec?.emailId}` })) || []\r\n  //   : [];\r\n\r\n  const gxbProducingBrokers = utils.generic.isValidArray(riskReferences, true)\r\n    ? riskReferences\r\n        ?.reduce((acc, curr) => {\r\n          return [...acc, ...(curr?.gxbAttributeDefaultValues?.producingBrokers?.filter((gxbPbs) => gxbPbs?.gxbUseId) ?? [])];\r\n        }, [])\r\n        ?.map((pb) => ({ id: pb?.gxbUseId, name: pb?.name, emailId: pb?.emailId })) || []\r\n    : [];\r\n\r\n  const gxbAccountExecutives = utils.generic.isValidArray(riskReferences, true)\r\n    ? riskReferences\r\n        ?.reduce((acc, curr) => {\r\n          return [...acc, ...(curr?.gxbAttributeDefaultValues?.accountExecutives?.filter((gxbAEs) => gxbAEs?.gxbUseId) ?? [])];\r\n        }, [])\r\n        ?.map((ae) => ({ id: ae?.gxbUseId, name: ae?.name, emailId: ae?.emailId })) || []\r\n    : [];\r\n\r\n  const piHighPriority = instruction?.details?.highPriority || leadRef?.gxbAttributeDefaultValues?.highPriority;\r\n  const piFrontEndSendDocs = instruction?.details?.frontEndSendDocs || leadRef?.gxbAttributeDefaultValues?.frontEndSendDocs;\r\n  const referenceList =\r\n    utils.generic.isValidArray(documents?.riskReferences, true) &&\r\n    documents?.riskReferences?.map((refData) => ({\r\n      endorsementId: refData.endorsementId,\r\n      endorsementNumber: refData.endorsementNumber,\r\n      riskRefId: refData.riskRefId,\r\n      xbInstanceId: refData.xbInstanceId,\r\n      xbPolicyId: refData.xbPolicyId,\r\n    }));\r\n  const documentTypeValue = isEndorsement\r\n    ? constants.PI_ENDORSEMENT_TYPE_DOCUMENT.documentTypeDescription\r\n    : faBorderProcessType\r\n    ? constants.PI_FABORDER_TYPE_DOCUMENT.documentTypeDescription\r\n    : constants.PI_CLOSING_FDO_TYPE_DOCUMENT.documentTypeDescription;\r\n\r\n  const bordereauTypes = [\r\n    {\r\n      id: 1,\r\n      name: 'premium',\r\n      value: 'premium',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.premium'),\r\n    },\r\n    {\r\n      id: 2,\r\n      name: 'claims',\r\n      value: 'claims',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.claims'),\r\n    },\r\n    {\r\n      id: 3,\r\n      name: 'combined',\r\n      value: 'combined',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.combined'),\r\n    },\r\n  ];\r\n\r\n  const feeAndAmendmentTypes = [\r\n    {\r\n      name: 'fee',\r\n      value: 'fee',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.fee'),\r\n    },\r\n    {\r\n      name: 'amendment',\r\n      value: 'amendment',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.amendment'),\r\n    },\r\n  ];\r\n  const tabs = [\r\n    { value: 'processing-instruction', label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.tabs.pi') },\r\n    {\r\n      value: 'documents',\r\n      label: `${utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.tabs.attachDoc')}${isEndorsement ? '*' : ''}`,\r\n    },\r\n  ];\r\n  const isValidTab = tabs.map((item) => item.value).includes(tab);\r\n\r\n  const [defaultValues, setDefaultValues] = useState();\r\n  const [selectedTab, setSelectedTab] = useState(isValidTab ? tab : 'processing-instruction');\r\n\r\n  useEffect(() => {\r\n    dispatch(getUsersForRole([FRONT_END_CONTACT, OPERATIONS_LEAD, AUTHORISED_SIGNATORY]));\r\n    dispatch(getBordereauPolicyTypes());\r\n  }, [dispatch]);\r\n\r\n  useEffect(\r\n    () => {\r\n      const reset = childRef?.current?.props?.resetFunc;\r\n      const updatedDefaultValues = {\r\n        ...utils.form.getInitialValues(fields),\r\n      };\r\n\r\n      setDefaultValues(updatedDefaultValues);\r\n\r\n      if (utils.generic.isFunction(reset)) {\r\n        reset(updatedDefaultValues, {\r\n          keepDirty: false,\r\n        });\r\n      }\r\n    },\r\n    [instruction] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!utils.generic.isValidArray(referenceList, true) || !documentTypeValue) return;\r\n    dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue));\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const filterUsersByRole = (roleNames) => {\r\n    return riskReferences?.reduce((acc, cur) => {\r\n      const groupDepartXbInstanceIds = `${cur.departmentId}-${cur.xbInstanceId}`;\r\n      return [\r\n        ...acc,\r\n        ...users\r\n          .filter((u) => roleNames.includes(u.userRole))\r\n          .filter((u) =>\r\n            u.departmentId\r\n              ?.split(',')\r\n              .map((x) => x.trim())\r\n              .includes(groupDepartXbInstanceIds)\r\n          )\r\n          .map((u) => {\r\n            return { id: u.userId, name: u.fullName + ' - ' + u.emailId };\r\n          }),\r\n      ];\r\n    }, []);\r\n  };\r\n\r\n  const frontEndContactsForRoles = uniqBy(filterUsersByRole([FRONT_END_CONTACT, OPERATIONS_LEAD]), 'id');\r\n  // const frontEndContacts = utils.generic.isValidArray(gxbRiskRefFECs, true) ? gxbRiskRefFECs : frontEndContactsForRoles; // ToDo\r\n  const frontEndContacts = frontEndContactsForRoles;\r\n  const producingBrokers = utils.generic.isValidArray(gxbProducingBrokers, true) ? gxbProducingBrokers : producingBrokersFromRoles;\r\n  const accountExecutives = utils.generic.isValidArray(gxbAccountExecutives, true) ? gxbAccountExecutives : accountExecutivesFromRoles;\r\n\r\n  const getBordereauPolicyTypeId = () => {\r\n    let bordereauPolicyTypeId = instruction.details?.bordereauPolicyTypeId;\r\n\r\n    if (!bordereauPolicyTypeId && utils.generic.isValidArray(bordereauPolicyTypes, true)) {\r\n      const item = bordereauPolicyTypes.find((type) => type.bordereauPolicyTypeID === instruction?.details?.bordereauPolicyTypeId);\r\n      bordereauPolicyTypeId = item?.bordereauPolicyTypeID;\r\n    }\r\n\r\n    return bordereauPolicyTypeId || '';\r\n  };\r\n\r\n  const getBordereauTypeValue = () => {\r\n    const defaultId = 1;\r\n    const defaultType = 'premium';\r\n    const bordereauTypeId = instruction?.details?.bordereauTypeId || defaultId;\r\n\r\n    const obj = bordereauTypes.find((type) => type.id === bordereauTypeId);\r\n    return obj?.value || defaultType;\r\n  };\r\n\r\n  const validateWarrantyListValue = () => {\r\n    if (!get(instruction?.details, 'ppwOrPpcValue', null)) {\r\n      if (gxbWarrantyDetails?.isInvalidData === 0 && utils.generic.isValidArray(gxbWarrantyDetails?.warrantyList, true)) {\r\n        return { flag: true };\r\n      } else if (\r\n        (gxbWarrantyDetails?.isInvalidData === 0 || gxbWarrantyDetails?.isInvalidData === 1) &&\r\n        !utils.generic.isValidArray(gxbWarrantyDetails?.warrantyList, true)\r\n      ) {\r\n        return {\r\n          falg: false,\r\n          displayError: gxbWarrantyDetails?.isInvalidData === 1,\r\n        };\r\n      }\r\n    } else {\r\n      return { flag: instruction?.details?.ppwOrPpc || false };\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const fields = [\r\n    {\r\n      name: 'frontEndContactId',\r\n      type: 'select',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndContact'),\r\n      value: instruction?.details?.frontEndContactId || user?.id || '',\r\n      options: frontEndContacts,\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n      optionKey: 'id',\r\n      optionLabel: 'name',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    isFeeAndAmendment\r\n      ? {\r\n          name: 'producingBrokerId',\r\n          group: 'general',\r\n          type: 'select',\r\n          label: utils.string.t('processingInstructions.checklist.fields.producingBroker'),\r\n          value: instruction?.details?.producingBrokerId ?? '',\r\n          validation: Yup.string().required(utils.string.t('validation.required')),\r\n          options: producingBrokers,\r\n          optionKey: 'id',\r\n          optionLabel: 'name',\r\n          muiComponentProps: {\r\n            disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(producingBrokers),\r\n          },\r\n        }\r\n      : {\r\n          name: 'accountExecutiveId',\r\n          type: 'select',\r\n          label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.accountExecutive'),\r\n          value: instruction?.details?.accountExecutiveId ?? '',\r\n          validation: Yup.string().required(utils.string.t('validation.required')),\r\n          options: accountExecutives,\r\n          optionKey: 'id',\r\n          optionLabel: 'name',\r\n          muiComponentProps: {\r\n            disabled: isReadOnly,\r\n          },\r\n        },\r\n    {\r\n      name: 'frontEndSendDocs',\r\n      type: 'checkbox',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\r\n      value: piFrontEndSendDocs,\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'highPriority',\r\n      type: 'checkbox',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\r\n      value: piHighPriority,\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'notes',\r\n      type: 'textarea',\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.notes.label'),\r\n      value: instruction?.details?.notes || '',\r\n      muiComponentProps: {\r\n        multiline: true,\r\n        minRows: 5,\r\n        maxRows: 10,\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    ...(isEndorsement\r\n      ? [\r\n          {\r\n            name: 'ppwOrPpc',\r\n            type: 'checkbox',\r\n            value: validateWarrantyListValue()?.flag || false,\r\n            displayError: validateWarrantyListValue()?.displayError || false,\r\n            label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.ppwPpc'),\r\n            muiComponentProps: {\r\n              disabled: isReadOnly,\r\n            },\r\n          },\r\n        ]\r\n      : []),\r\n    ...(isEndorsement || isFeeAndAmendment\r\n      ? [\r\n          {\r\n            name: 'isNonPremium',\r\n            type: 'checkbox',\r\n            value: leadRef?.isNonPremium === 'Yes',\r\n            label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.nonPremium'),\r\n            disabled: true,\r\n          },\r\n        ]\r\n      : []),\r\n    ...(isFeeAndAmendment\r\n      ? [\r\n          {\r\n            name: 'feeOrAmendment',\r\n            type: 'radio',\r\n            title: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.type.label'),\r\n            value: instruction?.details?.feeOrAmendment || 'fee',\r\n            options: feeAndAmendmentTypes,\r\n            validation: Yup.string().required(utils.string.t('validation.required')),\r\n            muiFormGroupProps: {\r\n              row: true,\r\n            },\r\n            muiComponentProps: {\r\n              disabled: isReadOnly,\r\n            },\r\n          },\r\n        ]\r\n      : []),\r\n    ...(isBordereau\r\n      ? [\r\n          {\r\n            name: 'bordereauPolicyTypeId',\r\n            type: 'select',\r\n            label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.policyType'),\r\n            value: getBordereauPolicyTypeId(),\r\n            validation: Yup.string().required(utils.string.t('validation.required')),\r\n            options: bordereauPolicyTypes,\r\n            optionKey: 'bordereauPolicyTypeID',\r\n            optionLabel: 'bordereauPolicyTypeDetails',\r\n            muiComponentProps: {\r\n              disabled: isReadOnly,\r\n            },\r\n          },\r\n          {\r\n            type: 'datepicker',\r\n            name: 'bordereauPeriod',\r\n            label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.bordereauPeriod'),\r\n            value: instruction?.details?.bordereauPeriod || null,\r\n            validation: Yup.string().required(utils.string.t('validation.required')),\r\n            outputFormat: 'iso',\r\n            placeholder: 'MM YYYY',\r\n            muiComponentProps: {\r\n              fullWidth: true,\r\n              helperText: utils.string.t(\r\n                'processingInstructions.processingInstructionsForEndFaBorder.bordereauPeriod.helperTextBordereauPeriod'\r\n              ),\r\n              disabled: isReadOnly,\r\n            },\r\n            muiPickerProps: {\r\n              views: ['year', 'month'],\r\n              format: 'MM YYYY',\r\n              clearable: true,\r\n            },\r\n          },\r\n          {\r\n            name: 'bordereauTypeId',\r\n            type: 'radio',\r\n            title: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.bordereauType.label'),\r\n            value: getBordereauTypeValue(),\r\n            validation: Yup.string().required(utils.string.t('validation.required')),\r\n            options: bordereauTypes,\r\n            muiFormGroupProps: {\r\n              row: true,\r\n            },\r\n            muiComponentProps: {\r\n              disabled: isReadOnly,\r\n            },\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  const getSelectedFrontEndContactName = (fecId) => {\r\n    const selectedFecName = frontEndContacts?.find((fec) => fec.id === fecId)?.name;\r\n    return selectedFecName?.split('-')[0]?.trim() || '';\r\n  };\r\n\r\n  const getSelectedFrontEndContactEmail = (fecId) => {\r\n    const fecEmailId = frontEndContacts?.find((fec) => fec.id === fecId)?.name;\r\n    return fecEmailId?.split('-')[1]?.trim() || '';\r\n  };\r\n\r\n  const getSelectedProducingBrokerName = (pbId) => {\r\n    const selectedProducingBrokerName = producingBrokers?.find((pb) => pb?.id === pbId)?.name;\r\n    return selectedProducingBrokerName;\r\n  };\r\n\r\n  const getSelectedProducingBrokerEmail = (pbId) => {\r\n    const selectedProducingBrokerName = producingBrokers?.find((pb) => pb?.id === pbId)?.emailId;\r\n    return selectedProducingBrokerName;\r\n  };\r\n\r\n  const getSelectedAccountExecutiveName = (aeId) => {\r\n    const selectedAccountExecutiveName = accountExecutives?.find((ae) => ae?.id === aeId)?.name;\r\n    return selectedAccountExecutiveName;\r\n  };\r\n\r\n  const getSelectedAccountExecutiveEmail = (aeId) => {\r\n    const selectedAccountExecutiveEmail = accountExecutives?.find((ae) => ae?.id === aeId)?.emailId;\r\n    return selectedAccountExecutiveEmail;\r\n  };\r\n\r\n  const getUpdatedInstruction = (instruction, formValues) => {\r\n    let defaultWarrantyDetails = utils.generic.isValidArray(gxbWarrantyDetails?.warrantyList, true)\r\n      ? gxbWarrantyDetails?.warrantyList.find((a) => a.isSelected)\r\n      : null;\r\n    if (!defaultWarrantyDetails) {\r\n      defaultWarrantyDetails = utils.generic.isValidArray(warrantyListOptions, true)\r\n        ? warrantyListOptions?.find((a) => !!a?.code?.toLowerCase() === !!formValues['ppwOrPpc'])\r\n        : null;\r\n    }\r\n    return {\r\n      ...instruction,\r\n      details: {\r\n        ...formValues,\r\n        instructionId: instruction?.id,\r\n        ...(isFeeAndAmendment && {\r\n          producingBrokerName: getSelectedProducingBrokerName(formValues?.producingBrokerId),\r\n          producingBrokerId: formValues?.producingBrokerId,\r\n          producingBrokerEmailId: getSelectedProducingBrokerEmail(formValues?.producingBrokerId),\r\n        }),\r\n        ...(!isFeeAndAmendment && {\r\n          accountExecutive: getSelectedAccountExecutiveName(formValues?.accountExecutiveId),\r\n          accountExecutiveId: formValues?.accountExecutiveId,\r\n          accountExecutiveEmailId: getSelectedAccountExecutiveEmail(formValues?.accountExecutiveId),\r\n        }),\r\n        frontEndContact: getSelectedFrontEndContactName(formValues?.frontEndContactId),\r\n        frontEndContactId: formValues?.frontEndContactId,\r\n        frontEndContactEmail: getSelectedFrontEndContactEmail(formValues?.frontEndContactId),\r\n        warrantyDescription: formValues['ppwOrPpc']\r\n          ? defaultWarrantyDetails?.warrantyName || defaultWarrantyDetails?.warrantyDescription || 'NA'\r\n          : 'NA',\r\n        warrantyTypeId: formValues['ppwOrPpc']\r\n          ? defaultWarrantyDetails?.warrantyTypeId || defaultWarrantyDetails?.warrantyTypeID || ''\r\n          : '',\r\n        warrantyDate: formValues['ppwOrPpc'] ? defaultWarrantyDetails?.warrantyDate || '' : '',\r\n        warrantyCode: formValues['ppwOrPpc'] ? defaultWarrantyDetails?.warrantyCode || defaultWarrantyDetails?.code || 'NA' : 'NA',\r\n        ppwOrPpcValue: formValues['ppwOrPpc'] ? defaultWarrantyDetails?.warrantyCode || defaultWarrantyDetails?.code || 'NA' : 'NA',\r\n\r\n        ...(isBordereau && {\r\n          bordereauPeriod: formValues.bordereauPeriod ? moment(formValues.bordereauPeriod).format('MMMM YYYY') : '',\r\n          bordereauTypeId: bordereauTypes.find((type) => type.value === formValues.bordereauTypeId)?.id || null,\r\n        }),\r\n      },\r\n    };\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    const reset = childRef?.current?.props?.resetFunc;\r\n\r\n    if (utils.generic.isFunction(reset)) {\r\n      reset(defaultValues, { keepDirty: false });\r\n    }\r\n  };\r\n\r\n  const checkAllRequiredFiledsSelected = () => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    const isFrontEndIdSelected = Boolean(formValues?.frontEndContactId);\r\n\r\n    if (isEndorsement) {\r\n      const isAccountExecutiveIdSelected = Boolean(formValues?.accountExecutiveId);\r\n      if (isFrontEndIdSelected && isAccountExecutiveIdSelected) {\r\n        return true;\r\n      } else if (!isFrontEndIdSelected && !isAccountExecutiveIdSelected) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdAccountExecutiveIdValue', 'warning'));\r\n        return false;\r\n      } else if (!isFrontEndIdSelected) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdValue', 'warning'));\r\n        return false;\r\n      } else if (!isAccountExecutiveIdSelected) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noAccountExecutiveIdValue', 'warning'));\r\n        return false;\r\n      }\r\n    } else if (isFeeAndAmendment) {\r\n      const isProducingBrokerSelected = Boolean(formValues?.producingBrokerId);\r\n      if (isFrontEndIdSelected && isProducingBrokerSelected) {\r\n        return true;\r\n      } else if (!isFrontEndIdSelected && !isProducingBrokerSelected) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdProducingBrokerIdValue', 'warning'));\r\n        return false;\r\n      } else if (!isFrontEndIdSelected) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdValue', 'warning'));\r\n        return false;\r\n      } else if (!isProducingBrokerSelected) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noProducingBrokerValue', 'warning'));\r\n        return false;\r\n      }\r\n    } else if (isBordereau) {\r\n      const bordereauTypeId = Boolean(formValues?.bordereauTypeId);\r\n      const bordereauPeriod = Boolean(formValues?.bordereauPeriod);\r\n      const bordereauPolicyTypeId = Boolean(formValues?.bordereauPolicyTypeId);\r\n      const accountExecutiveId = Boolean(formValues?.accountExecutiveId);\r\n      if (isFrontEndIdSelected && bordereauTypeId && bordereauPeriod && bordereauPolicyTypeId && accountExecutiveId) {\r\n        return true;\r\n      } else if (!isFrontEndIdSelected) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noFrontEndContactIdValue', 'warning'));\r\n        return false;\r\n      } else if (!accountExecutiveId) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noAccountExecutiveIdValue', 'warning'));\r\n        return false;\r\n      } else if (!bordereauTypeId) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noBordereauTypeId', 'warning'));\r\n        return false;\r\n      } else if (!bordereauPolicyTypeId) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noBordereauPolicyType', 'warning'));\r\n        return false;\r\n      } else if (!bordereauPeriod) {\r\n        dispatch(enqueueNotification('processingInstructions.addRiskReference.noBordereauPeriod', 'warning'));\r\n        return false;\r\n      }\r\n    } else {\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const handleSave = () => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    const updatedInstruction = getUpdatedInstruction(instruction, formValues);\r\n    return dispatch(updateProcessingInstruction(updatedInstruction));\r\n  };\r\n\r\n  const mandatoryDocumentsNotUploaded = () => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('processingInstructions.mandatoryDocuments.error'),\r\n          maxWidth: 'xs',\r\n          componentProps: {\r\n            hideCancelButton: true,\r\n            confirmLabel: utils.string.t('processingInstructions.authorisations.form.confirm'),\r\n            confirmMessage: <span>{utils.string.t('processingInstructions.mandatoryDocuments.mandatoryDocumentUploaded')}</span>,\r\n            buttonColors: { confirm: 'secondary' },\r\n            submitHandler: () => {},\r\n            handleClose: () => {},\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    const isPageEdited = !isEqual(defaultValues, formValues);\r\n    if (checkAllRequiredFiledsSelected()) {\r\n      if (isEndorsement) {\r\n        dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue)).then((response) => {\r\n          if (response?.status === constants.API_RESPONSE_OK) {\r\n            if (response?.data?.some((a) => a.documentCount === 0)) {\r\n              mandatoryDocumentsNotUploaded();\r\n            } else {\r\n              if (isPageEdited) {\r\n                handleSave().then((response) => {\r\n                  if (response?.status === constants.API_RESPONSE_OK) {\r\n                    proceedToSubmission();\r\n                  }\r\n                });\r\n              } else {\r\n                proceedToSubmission();\r\n              }\r\n            }\r\n          }\r\n        });\r\n      } else {\r\n        if (isPageEdited) {\r\n          handleSave().then((response) => {\r\n            if (response?.status === constants.API_RESPONSE_OK) {\r\n              proceedToSubmission();\r\n            }\r\n          });\r\n        } else {\r\n          proceedToSubmission();\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const proceedToSubmission = () => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    const updatedInstruction = getUpdatedInstruction(instruction, formValues);\r\n    const businessProcess = businessProcesses?.find(\r\n      (bp) => bp.businessProcessID === updatedInstruction.businessProcessId\r\n    )?.businessProcessName;\r\n\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          title: 'processingInstructions.authorisations.form.title',\r\n          fullWidth: true,\r\n          maxWidth: 'sm',\r\n          componentProps: {\r\n            confirmMessage: utils.string.t('processingInstructions.authorisations.form.confirmText'),\r\n            cancelLabel: utils.string.t('processingInstructions.authorisations.form.cancel'),\r\n            confirmLabel: utils.string.t('processingInstructions.authorisations.form.confirm'),\r\n            confirmMessageText: utils.string.t('processingInstructions.authorisations.form.confirmMessage'),\r\n            note: utils.string.t('processingInstructions.authorisations.form.note'),\r\n\r\n            submitHandler: () => {\r\n              dispatch(\r\n                submitProcessingInstruction({\r\n                  ...updatedInstruction,\r\n                  businessProcess,\r\n                  statusId: PI_STATUS_SUBMITTED_PROCESSING,\r\n                })\r\n              ).then((res) => {\r\n                if (res?.status === constants.API_RESPONSE_OK) {\r\n                  history.push('/processing-instructions');\r\n                  dispatch(enqueueNotification('processingInstructions.details.submittedSuccessfully', 'success'));\r\n                }\r\n              });\r\n            },\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const toggleTab = (tab) => {\r\n    setSelectedTab(tab);\r\n    history.replace(`${config.routes.processingInstructions.steps}/${id}${step ? `/${step}` : ''}${tab ? `/${tab}` : ''}`);\r\n  };\r\n\r\n  // abort\r\n  if (!defaultValues || !instruction || utils.generic.isInvalidOrEmptyArray(users) || !bordereauPolicyTypes) return null;\r\n\r\n  return (\r\n    <ProcessingInstructionsEndorseFaBorderView\r\n      instruction={instruction}\r\n      leadRef={leadRef}\r\n      tabs={tabs}\r\n      selectedTab={selectedTab}\r\n      fields={fields}\r\n      defaultValues={defaultValues}\r\n      isEndorsement={isEndorsement}\r\n      isBordereau={isBordereau}\r\n      isFeeAndAmendment={isFeeAndAmendment}\r\n      isReadOnly={isReadOnly}\r\n      isSubmittedProcessing={isSubmittedProcessing}\r\n      isRiskReferenceDocumentCountLoading={isRiskReferenceDocumentCountLoading}\r\n      handlers={{\r\n        ...handlers,\r\n        cancel: handleCancel,\r\n        save: handleSave,\r\n        submit: handleSubmit,\r\n        toggleTab,\r\n      }}\r\n      ref={childRef}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}