{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n// app\nimport { addLoader, authLogout, storeProcessingInstructionDocuments, enqueueNotification, removeLoader } from 'stores';\nimport * as utils from 'utils';\nexport var removeBulkDocumentsOnLeadRefChange = function removeBulkDocumentsOnLeadRefChange(formData) {\n  return function (dispatch, getState) {\n    var state = getState(); // prettier-ignore\n\n    var auth = state.user.auth,\n        endpoint = state.config.vars.endpoint;\n    var documents = formData.documents;\n    var defaultError = {\n      file: 'stores/processingInstructions.actions.removeBulkDocumentsOnLeadRefChange'\n    };\n    dispatch(removeBulkDocumentsOnLeadRefChangeRequest(formData));\n    dispatch(addLoader({\n      key: 'removeBulkDocumentsOnLeadRefChange',\n      message: utils.string.t('fileRemove.removing')\n    }));\n    var validFormData = (documents === null || documents === void 0 ? void 0 : documents.premiumTaxDocument) || (documents === null || documents === void 0 ? void 0 : documents.signedLinesDocument);\n\n    if (!formData || !validFormData) {\n      dispatch(removeBulkDocumentsOnLeadRefChangeFailure(_objectSpread(_objectSpread({}, defaultError), {}, {\n        message: utils.string.t('processingInstructions.missingRemoveFileDataParameters')\n      })));\n      dispatch(enqueueNotification('notification.fileUpload.upload.fail', 'error'));\n      dispatch(removeLoader('removeBulkDocumentsOnLeadRefChange'));\n      return;\n    }\n\n    var deleteDocumentIds = function deleteDocumentIds(docs) {\n      var docIds = '';\n\n      if (docs.premiumTaxDocument) {\n        var _docs$premiumTaxDocum;\n\n        docIds += (_docs$premiumTaxDocum = docs.premiumTaxDocument) === null || _docs$premiumTaxDocum === void 0 ? void 0 : _docs$premiumTaxDocum.documentId;\n\n        if (docs.signedLinesDocument) {\n          var _docs$signedLinesDocu;\n\n          docIds += \",\".concat((_docs$signedLinesDocu = docs.signedLinesDocument) === null || _docs$signedLinesDocu === void 0 ? void 0 : _docs$signedLinesDocu.documentId);\n        }\n      } else if (docs.signedLinesDocument) {\n        var _docs$signedLinesDocu2;\n\n        docIds += (_docs$signedLinesDocu2 = docs.signedLinesDocument) === null || _docs$signedLinesDocu2 === void 0 ? void 0 : _docs$signedLinesDocu2.documentId;\n      }\n\n      return docIds;\n    };\n\n    return utils.api.delete({\n      token: auth.accessToken,\n      endpoint: endpoint.dmsService,\n      path: \"dms/document/\".concat(deleteDocumentIds(documents))\n    }).then(function (response) {\n      return utils.api.handleResponse(response);\n    }).then(function (json) {\n      return utils.api.handleNewData(json);\n    }).then(function (data) {\n      var _documents$premiumTax, _documents$signedLine, _documents$premiumTax3, _documents$signedLine3, _documents$premiumTax4, _documents$signedLine4;\n\n      var updatedDocuments = _objectSpread(_objectSpread(_objectSpread({}, documents), data.data[documents === null || documents === void 0 ? void 0 : (_documents$premiumTax = documents.premiumTaxDocument) === null || _documents$premiumTax === void 0 ? void 0 : _documents$premiumTax.documentId] && {\n        premiumTaxDocument: null\n      }), data.data[documents === null || documents === void 0 ? void 0 : (_documents$signedLine = documents.signedLinesDocument) === null || _documents$signedLine === void 0 ? void 0 : _documents$signedLine.documentId] && {\n        signedLinesDocument: null\n      });\n\n      dispatch(storeProcessingInstructionDocuments(updatedDocuments));\n      dispatch(removeBulkDocumentsOnLeadRefChangeSuccess(data.data));\n\n      if ((documents === null || documents === void 0 ? void 0 : documents.premiumTaxDocument) && (documents === null || documents === void 0 ? void 0 : documents.signedLinesDocument)) {\n        var _documents$premiumTax2, _documents$signedLine2;\n\n        if (data.data[documents === null || documents === void 0 ? void 0 : (_documents$premiumTax2 = documents.premiumTaxDocument) === null || _documents$premiumTax2 === void 0 ? void 0 : _documents$premiumTax2.documentId] || data.data[documents === null || documents === void 0 ? void 0 : (_documents$signedLine2 = documents.signedLinesDocument) === null || _documents$signedLine2 === void 0 ? void 0 : _documents$signedLine2.documentId]) {\n          dispatch(enqueueNotification(data.message, 'success'));\n          return data;\n        }\n      } else if ((documents === null || documents === void 0 ? void 0 : documents.premiumTaxDocument) && data.data[documents === null || documents === void 0 ? void 0 : (_documents$premiumTax3 = documents.premiumTaxDocument) === null || _documents$premiumTax3 === void 0 ? void 0 : _documents$premiumTax3.documentId]) {\n        dispatch(enqueueNotification(data.message, 'success'));\n        return data;\n      } else if ((documents === null || documents === void 0 ? void 0 : documents.signedLinesDocument) && data.data[documents === null || documents === void 0 ? void 0 : (_documents$signedLine3 = documents.signedLinesDocument) === null || _documents$signedLine3 === void 0 ? void 0 : _documents$signedLine3.documentId]) {\n        dispatch(enqueueNotification(data.message, 'success'));\n        return data;\n      }\n\n      if (!data.data[documents === null || documents === void 0 ? void 0 : (_documents$premiumTax4 = documents.premiumTaxDocument) === null || _documents$premiumTax4 === void 0 ? void 0 : _documents$premiumTax4.documentId] || !data.data[documents === null || documents === void 0 ? void 0 : (_documents$signedLine4 = documents.signedLinesDocument) === null || _documents$signedLine4 === void 0 ? void 0 : _documents$signedLine4.documentId]) {\n        dispatch(enqueueNotification('notification.fileRemove.remove.fail', 'error'));\n      }\n    }).catch(function (err) {\n      utils.api.handleUnauthorized(err, dispatch, authLogout);\n      dispatch(removeBulkDocumentsOnLeadRefChangeFailure(err));\n      dispatch(enqueueNotification('notification.fileRemove.remove.fail', 'error'));\n      return err;\n    }).finally(function () {\n      dispatch(removeLoader('removeBulkDocumentsOnLeadRefChange'));\n    });\n  };\n};\nexport var removeBulkDocumentsOnLeadRefChangeRequest = function removeBulkDocumentsOnLeadRefChangeRequest(payload) {\n  return {\n    type: 'PI_REMOVE_BULK_DOCUMENTS_ON_LEAD_REF_CHANGE_REQUEST',\n    payload: payload\n  };\n};\nexport var removeBulkDocumentsOnLeadRefChangeSuccess = function removeBulkDocumentsOnLeadRefChangeSuccess(data) {\n  return {\n    type: 'PI_REMOVE_BULK_DOCUMENTS_ON_LEAD_REF_CHANGE_SUCCESS',\n    payload: {\n      data: data\n    }\n  };\n};\nexport var removeBulkDocumentsOnLeadRefChangeFailure = function removeBulkDocumentsOnLeadRefChangeFailure(error) {\n  return {\n    type: 'PI_REMOVE_BULK_DOCUMENTS_ON_LEAD_REF_CHANGE_FAILURE',\n    payload: error\n  };\n};","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/stores/processingInstructions/processingInstructions.actions.removeBulkDocumentsOnLeadRefChange.js"],"names":["addLoader","authLogout","storeProcessingInstructionDocuments","enqueueNotification","removeLoader","utils","removeBulkDocumentsOnLeadRefChange","formData","dispatch","getState","state","auth","user","endpoint","config","vars","documents","defaultError","file","removeBulkDocumentsOnLeadRefChangeRequest","key","message","string","t","validFormData","premiumTaxDocument","signedLinesDocument","removeBulkDocumentsOnLeadRefChangeFailure","deleteDocumentIds","docs","docIds","documentId","api","delete","token","accessToken","dmsService","path","then","response","handleResponse","json","handleNewData","data","updatedDocuments","removeBulkDocumentsOnLeadRefChangeSuccess","catch","err","handleUnauthorized","finally","payload","type","error"],"mappings":"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","sourcesContent":["// app\r\nimport { addLoader, authLogout, storeProcessingInstructionDocuments, enqueueNotification, removeLoader } from 'stores';\r\nimport * as utils from 'utils';\r\n\r\nexport const removeBulkDocumentsOnLeadRefChange = (formData) => (dispatch, getState) => {\r\n  const state = getState();\r\n\r\n  // prettier-ignore\r\n  const { user: { auth }, config: { vars: { endpoint } },  } = state;\r\n  const { documents } = formData;\r\n\r\n  const defaultError = {\r\n    file: 'stores/processingInstructions.actions.removeBulkDocumentsOnLeadRefChange',\r\n  };\r\n\r\n  dispatch(removeBulkDocumentsOnLeadRefChangeRequest(formData));\r\n  dispatch(addLoader({ key: 'removeBulkDocumentsOnLeadRefChange', message: utils.string.t('fileRemove.removing') }));\r\n\r\n  const validFormData = documents?.premiumTaxDocument || documents?.signedLinesDocument;\r\n\r\n  if (!formData || !validFormData) {\r\n    dispatch(\r\n      removeBulkDocumentsOnLeadRefChangeFailure({\r\n        ...defaultError,\r\n        message: utils.string.t('processingInstructions.missingRemoveFileDataParameters'),\r\n      })\r\n    );\r\n    dispatch(enqueueNotification('notification.fileUpload.upload.fail', 'error'));\r\n    dispatch(removeLoader('removeBulkDocumentsOnLeadRefChange'));\r\n    return;\r\n  }\r\n\r\n  const deleteDocumentIds = (docs) => {\r\n    let docIds = '';\r\n    if (docs.premiumTaxDocument) {\r\n      docIds += docs.premiumTaxDocument?.documentId;\r\n      if (docs.signedLinesDocument) {\r\n        docIds += `,${docs.signedLinesDocument?.documentId}`;\r\n      }\r\n    } else if (docs.signedLinesDocument) {\r\n      docIds += docs.signedLinesDocument?.documentId;\r\n    }\r\n\r\n    return docIds;\r\n  };\r\n\r\n  return utils.api\r\n    .delete({\r\n      token: auth.accessToken,\r\n      endpoint: endpoint.dmsService,\r\n      path: `dms/document/${deleteDocumentIds(documents)}`,\r\n    })\r\n    .then((response) => utils.api.handleResponse(response))\r\n    .then((json) => utils.api.handleNewData(json))\r\n    .then((data) => {\r\n      const updatedDocuments = {\r\n        ...documents,\r\n        ...(data.data[documents?.premiumTaxDocument?.documentId] && { premiumTaxDocument: null }),\r\n        ...(data.data[documents?.signedLinesDocument?.documentId] && { signedLinesDocument: null }),\r\n      };\r\n\r\n      dispatch(storeProcessingInstructionDocuments(updatedDocuments));\r\n      dispatch(removeBulkDocumentsOnLeadRefChangeSuccess(data.data));\r\n\r\n      if (documents?.premiumTaxDocument && documents?.signedLinesDocument) {\r\n        if (data.data[documents?.premiumTaxDocument?.documentId] || data.data[documents?.signedLinesDocument?.documentId]) {\r\n          dispatch(enqueueNotification(data.message, 'success'));\r\n          return data;\r\n        }\r\n      } else if (documents?.premiumTaxDocument && data.data[documents?.premiumTaxDocument?.documentId]) {\r\n        dispatch(enqueueNotification(data.message, 'success'));\r\n        return data;\r\n      } else if (documents?.signedLinesDocument && data.data[documents?.signedLinesDocument?.documentId]) {\r\n        dispatch(enqueueNotification(data.message, 'success'));\r\n        return data;\r\n      }\r\n      if (!data.data[documents?.premiumTaxDocument?.documentId] || !data.data[documents?.signedLinesDocument?.documentId]) {\r\n        dispatch(enqueueNotification('notification.fileRemove.remove.fail', 'error'));\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      utils.api.handleUnauthorized(err, dispatch, authLogout);\r\n      dispatch(removeBulkDocumentsOnLeadRefChangeFailure(err));\r\n      dispatch(enqueueNotification('notification.fileRemove.remove.fail', 'error'));\r\n      return err;\r\n    })\r\n    .finally(() => {\r\n      dispatch(removeLoader('removeBulkDocumentsOnLeadRefChange'));\r\n    });\r\n};\r\n\r\nexport const removeBulkDocumentsOnLeadRefChangeRequest = (payload) => {\r\n  return {\r\n    type: 'PI_REMOVE_BULK_DOCUMENTS_ON_LEAD_REF_CHANGE_REQUEST',\r\n    payload,\r\n  };\r\n};\r\n\r\nexport const removeBulkDocumentsOnLeadRefChangeSuccess = (data) => {\r\n  return {\r\n    type: 'PI_REMOVE_BULK_DOCUMENTS_ON_LEAD_REF_CHANGE_SUCCESS',\r\n    payload: {\r\n      data,\r\n    },\r\n  };\r\n};\r\n\r\nexport const removeBulkDocumentsOnLeadRefChangeFailure = (error) => {\r\n  return {\r\n    type: 'PI_REMOVE_BULK_DOCUMENTS_ON_LEAD_REF_CHANGE_FAILURE',\r\n    payload: error,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}