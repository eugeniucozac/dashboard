{"ast":null,"code":"import _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\pages\\\\Trips\\\\Trips.view.js\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport uniqBy from 'lodash/uniqBy'; // app\n\nimport styles from './Trips.styles';\nimport { AvatarGroup, Layout, Loader, Overflow, Pagination, PopoverMenu, Restricted, Search, SearchResult, SectionHeader, SeparatedList, TableCell, TableHead, Translate } from 'components';\nimport { TripSummary } from 'modules';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport config from 'config'; // mui\n\nimport { makeStyles, Table, TableRow, TableBody } from '@material-ui/core';\nimport FlightTakeoffIcon from '@material-ui/icons/FlightTakeoff';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nTripsView.propTypes = {\n  list: PropTypes.object.isRequired,\n  selected: PropTypes.object.isRequired,\n  sort: PropTypes.shape({\n    by: PropTypes.string.isRequired,\n    type: PropTypes.string.isRequired,\n    direction: PropTypes.string.isRequired\n  }).isRequired,\n  pagination: PropTypes.shape({\n    page: PropTypes.number.isRequired,\n    rowsTotal: PropTypes.number.isRequired,\n    rowsPerPage: PropTypes.number.isRequired\n  }).isRequired,\n  loader: PropTypes.array,\n  handleSearch: PropTypes.func.isRequired,\n  handleSearchReset: PropTypes.func.isRequired,\n  handleChangePage: PropTypes.func.isRequired,\n  handleChangeRowsPerPage: PropTypes.func.isRequired,\n  handleEdit: PropTypes.func.isRequired,\n  handleClickRow: PropTypes.func.isRequired,\n  handleDelete: PropTypes.func.isRequired\n};\nexport function TripsView(_ref) {\n  var _this = this;\n\n  var list = _ref.list,\n      selected = _ref.selected,\n      sort = _ref.sort,\n      pagination = _ref.pagination,\n      loader = _ref.loader,\n      handleChangePage = _ref.handleChangePage,\n      handleChangeRowsPerPage = _ref.handleChangeRowsPerPage,\n      handleSearch = _ref.handleSearch,\n      handleSearchReset = _ref.handleSearchReset,\n      handleEdit = _ref.handleEdit,\n      handleClickRow = _ref.handleClickRow,\n      handleDelete = _ref.handleDelete;\n  var classes = makeStyles(styles, {\n    name: 'Trips'\n  })();\n  var cols = [{\n    id: 'title',\n    label: utils.string.t('app.title')\n  }, {\n    id: 'clients',\n    label: utils.string.t('app.client_plural')\n  }, {\n    id: 'date',\n    label: utils.string.t('app.dateStart')\n  }, {\n    id: 'brokers',\n    label: utils.string.t('app.broker_plural')\n  }, {\n    id: 'actions',\n    empty: true\n  }];\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    testid: \"trips\",\n    children: [/*#__PURE__*/_jsxDEV(Layout, {\n      main: true,\n      children: [/*#__PURE__*/_jsxDEV(SectionHeader, {\n        title: utils.string.t('trips.title'),\n        icon: FlightTakeoffIcon,\n        testid: \"trips\",\n        children: /*#__PURE__*/_jsxDEV(Search, {\n          text: list.query,\n          placeholder: utils.string.t('trips.search'),\n          handlers: {\n            search: handleSearch,\n            reset: handleSearchReset\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SearchResult, {\n        count: list.itemsTotal,\n        query: list.query,\n        handleSearchReset: handleSearchReset\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Overflow, {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            columns: cols,\n            sorting: sort\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n            \"data-testid\": \"trip-list\",\n            children: list.items.map(function (trip) {\n              var hasVisits = utils.generic.isValidArray(trip.visits, true);\n              var dateFrom = utils.trip.getDateFrom(trip && trip.visits);\n              var brokers = hasVisits ? trip.visits.reduce(function (acc, visit) {\n                return utils.generic.isValidArray(visit.users) ? [].concat(_toConsumableArray(acc), _toConsumableArray(visit.users)) : acc;\n              }, []) : [];\n              var clients = hasVisits ? trip.visits.map(function (visit) {\n                return Object.assign({}, visit.client, {\n                  id: \"\".concat(visit.id, \"-\").concat(visit.client.id)\n                });\n              }) : [];\n              return /*#__PURE__*/_jsxDEV(TableRow, {\n                hover: true,\n                className: classnames(classes.row, _defineProperty({}, classes.rowSelected, trip.id === selected.id)),\n                onClick: handleClickRow(trip.id),\n                \"data-testid\": \"trip-row-\".concat(trip.id),\n                children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                  \"data-testid\": \"trip-cell-title-\".concat(trip.id),\n                  className: classes.cellName,\n                  children: trip.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 126,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  \"data-testid\": \"trip-cell-clients-\".concat(trip.id),\n                  children: /*#__PURE__*/_jsxDEV(SeparatedList, {\n                    list: clients\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 131,\n                    columnNumber: 23\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  nowrap: true,\n                  \"data-testid\": \"trip-cell-date-\".concat(trip.id),\n                  children: /*#__PURE__*/_jsxDEV(Translate, {\n                    label: \"format.date\",\n                    options: {\n                      value: {\n                        date: dateFrom,\n                        format: config.ui.format.date.text,\n                        default: '-'\n                      }\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 135,\n                    columnNumber: 23\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  nowrap: true,\n                  \"data-testid\": \"trip-cell-users-\".concat(trip.id),\n                  children: brokers.length > 0 && /*#__PURE__*/_jsxDEV(AvatarGroup, {\n                    users: uniqBy(brokers, 'id'),\n                    max: 5\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 46\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  menu: true,\n                  children: /*#__PURE__*/_jsxDEV(Restricted, {\n                    include: [constants.ROLE_BROKER],\n                    children: /*#__PURE__*/_jsxDEV(PopoverMenu, {\n                      id: \"renewal-list\",\n                      data: {\n                        id: trip.id,\n                        title: trip.title || \"\".concat(utils.string.t('app.trip'), \" ID: \").concat(trip.id)\n                      },\n                      items: [{\n                        id: 'edit',\n                        label: 'app.edit',\n                        callback: handleEdit\n                      }, {\n                        id: 'delete',\n                        label: 'app.delete',\n                        callback: handleDelete\n                      }]\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 147,\n                      columnNumber: 25\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 146,\n                    columnNumber: 23\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 21\n                }, _this)]\n              }, trip.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 19\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n        page: pagination.page,\n        count: pagination.rowsTotal,\n        rowsPerPage: pagination.rowsPerPage,\n        onChangePage: handleChangePage,\n        onChangeRowsPerPage: handleChangeRowsPerPage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Layout, {\n      sidebar: true,\n      padding: false,\n      children: [/*#__PURE__*/_jsxDEV(TripSummary, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Loader, {\n        visible: !utils.generic.isValidArray(loader, true) && selected.loading,\n        panel: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n}\n_c = TripsView;\n\nvar _c;\n\n$RefreshReg$(_c, \"TripsView\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/pages/Trips/Trips.view.js"],"names":["React","PropTypes","classnames","uniqBy","styles","AvatarGroup","Layout","Loader","Overflow","Pagination","PopoverMenu","Restricted","Search","SearchResult","SectionHeader","SeparatedList","TableCell","TableHead","Translate","TripSummary","constants","utils","config","makeStyles","Table","TableRow","TableBody","FlightTakeoffIcon","TripsView","propTypes","list","object","isRequired","selected","sort","shape","by","string","type","direction","pagination","page","number","rowsTotal","rowsPerPage","loader","array","handleSearch","func","handleSearchReset","handleChangePage","handleChangeRowsPerPage","handleEdit","handleClickRow","handleDelete","classes","name","cols","id","label","t","empty","query","search","reset","itemsTotal","items","map","trip","hasVisits","generic","isValidArray","visits","dateFrom","getDateFrom","brokers","reduce","acc","visit","users","clients","Object","assign","client","row","rowSelected","cellName","title","value","date","format","ui","text","default","length","ROLE_BROKER","callback","loading"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classnames from 'classnames';\r\nimport uniqBy from 'lodash/uniqBy';\r\n\r\n// app\r\nimport styles from './Trips.styles';\r\nimport {\r\n  AvatarGroup,\r\n  Layout,\r\n  Loader,\r\n  Overflow,\r\n  Pagination,\r\n  PopoverMenu,\r\n  Restricted,\r\n  Search,\r\n  SearchResult,\r\n  SectionHeader,\r\n  SeparatedList,\r\n  TableCell,\r\n  TableHead,\r\n  Translate,\r\n} from 'components';\r\nimport { TripSummary } from 'modules';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\n// mui\r\nimport { makeStyles, Table, TableRow, TableBody } from '@material-ui/core';\r\nimport FlightTakeoffIcon from '@material-ui/icons/FlightTakeoff';\r\n\r\nTripsView.propTypes = {\r\n  list: PropTypes.object.isRequired,\r\n  selected: PropTypes.object.isRequired,\r\n  sort: PropTypes.shape({\r\n    by: PropTypes.string.isRequired,\r\n    type: PropTypes.string.isRequired,\r\n    direction: PropTypes.string.isRequired,\r\n  }).isRequired,\r\n  pagination: PropTypes.shape({\r\n    page: PropTypes.number.isRequired,\r\n    rowsTotal: PropTypes.number.isRequired,\r\n    rowsPerPage: PropTypes.number.isRequired,\r\n  }).isRequired,\r\n  loader: PropTypes.array,\r\n  handleSearch: PropTypes.func.isRequired,\r\n  handleSearchReset: PropTypes.func.isRequired,\r\n  handleChangePage: PropTypes.func.isRequired,\r\n  handleChangeRowsPerPage: PropTypes.func.isRequired,\r\n  handleEdit: PropTypes.func.isRequired,\r\n  handleClickRow: PropTypes.func.isRequired,\r\n  handleDelete: PropTypes.func.isRequired,\r\n};\r\n\r\nexport function TripsView({\r\n  list,\r\n  selected,\r\n  sort,\r\n  pagination,\r\n  loader,\r\n  handleChangePage,\r\n  handleChangeRowsPerPage,\r\n  handleSearch,\r\n  handleSearchReset,\r\n  handleEdit,\r\n  handleClickRow,\r\n  handleDelete,\r\n}) {\r\n  const classes = makeStyles(styles, { name: 'Trips' })();\r\n\r\n  const cols = [\r\n    { id: 'title', label: utils.string.t('app.title') },\r\n    { id: 'clients', label: utils.string.t('app.client_plural') },\r\n    { id: 'date', label: utils.string.t('app.dateStart') },\r\n    { id: 'brokers', label: utils.string.t('app.broker_plural') },\r\n    { id: 'actions', empty: true },\r\n  ];\r\n\r\n  return (\r\n    <Layout testid=\"trips\">\r\n      <Layout main>\r\n        <SectionHeader title={utils.string.t('trips.title')} icon={FlightTakeoffIcon} testid=\"trips\">\r\n          <Search\r\n            text={list.query}\r\n            placeholder={utils.string.t('trips.search')}\r\n            handlers={{\r\n              search: handleSearch,\r\n              reset: handleSearchReset,\r\n            }}\r\n          />\r\n        </SectionHeader>\r\n\r\n        <SearchResult count={list.itemsTotal} query={list.query} handleSearchReset={handleSearchReset} />\r\n\r\n        <Overflow>\r\n          <Table>\r\n            <TableHead columns={cols} sorting={sort} />\r\n\r\n            <TableBody data-testid=\"trip-list\">\r\n              {list.items.map((trip) => {\r\n                const hasVisits = utils.generic.isValidArray(trip.visits, true);\r\n\r\n                const dateFrom = utils.trip.getDateFrom(trip && trip.visits);\r\n\r\n                const brokers = hasVisits\r\n                  ? trip.visits.reduce((acc, visit) => {\r\n                      return utils.generic.isValidArray(visit.users) ? [...acc, ...visit.users] : acc;\r\n                    }, [])\r\n                  : [];\r\n\r\n                const clients = hasVisits\r\n                  ? trip.visits.map((visit) => {\r\n                      return Object.assign({}, visit.client, { id: `${visit.id}-${visit.client.id}` });\r\n                    })\r\n                  : [];\r\n\r\n                return (\r\n                  <TableRow\r\n                    key={trip.id}\r\n                    hover\r\n                    className={classnames(classes.row, { [classes.rowSelected]: trip.id === selected.id })}\r\n                    onClick={handleClickRow(trip.id)}\r\n                    data-testid={`trip-row-${trip.id}`}\r\n                  >\r\n                    <TableCell data-testid={`trip-cell-title-${trip.id}`} className={classes.cellName}>\r\n                      {trip.title}\r\n                    </TableCell>\r\n\r\n                    <TableCell data-testid={`trip-cell-clients-${trip.id}`}>\r\n                      <SeparatedList list={clients} />\r\n                    </TableCell>\r\n\r\n                    <TableCell nowrap data-testid={`trip-cell-date-${trip.id}`}>\r\n                      <Translate\r\n                        label=\"format.date\"\r\n                        options={{ value: { date: dateFrom, format: config.ui.format.date.text, default: '-' } }}\r\n                      />\r\n                    </TableCell>\r\n\r\n                    <TableCell nowrap data-testid={`trip-cell-users-${trip.id}`}>\r\n                      {brokers.length > 0 && <AvatarGroup users={uniqBy(brokers, 'id')} max={5} />}\r\n                    </TableCell>\r\n\r\n                    <TableCell menu>\r\n                      <Restricted include={[constants.ROLE_BROKER]}>\r\n                        <PopoverMenu\r\n                          id=\"renewal-list\"\r\n                          data={{\r\n                            id: trip.id,\r\n                            title: trip.title || `${utils.string.t('app.trip')} ID: ${trip.id}`,\r\n                          }}\r\n                          items={[\r\n                            {\r\n                              id: 'edit',\r\n                              label: 'app.edit',\r\n                              callback: handleEdit,\r\n                            },\r\n                            {\r\n                              id: 'delete',\r\n                              label: 'app.delete',\r\n                              callback: handleDelete,\r\n                            },\r\n                          ]}\r\n                        />\r\n                      </Restricted>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                );\r\n              })}\r\n            </TableBody>\r\n          </Table>\r\n        </Overflow>\r\n\r\n        <Pagination\r\n          page={pagination.page}\r\n          count={pagination.rowsTotal}\r\n          rowsPerPage={pagination.rowsPerPage}\r\n          onChangePage={handleChangePage}\r\n          onChangeRowsPerPage={handleChangeRowsPerPage}\r\n        />\r\n      </Layout>\r\n\r\n      <Layout sidebar padding={false}>\r\n        <TripSummary />\r\n        <Loader visible={!utils.generic.isValidArray(loader, true) && selected.loading} panel />\r\n      </Layout>\r\n    </Layout>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}