{"ast":null,"code":"import _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\pages\\\\ReportsExtended\\\\ReportsExtended.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useHistory, useParams, useLocation } from 'react-router';\nimport { Helmet } from 'react-helmet';\nimport get from 'lodash/get'; // app\n\nimport { ReportsExtendedView } from './ReportsExtended.view';\nimport * as utils from 'utils';\nimport config from 'config';\nimport * as constants from 'consts';\nimport { usePagination } from 'hooks';\nimport { showModal, getReportListExtended, selectReportListExtended, selectSelectedReportGroupExtended, deleteReportsExtended, selectReportListExtendedPagination, selectReportListExtendedSort, selectUser, selectReportListExtendedLoading, setReportDetailBool } from 'stores';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ReportsExtended() {\n  _s();\n\n  var _location$state;\n\n  var history = useHistory();\n\n  var _useParams = useParams(),\n      groupId = _useParams.groupId;\n\n  var location = useLocation();\n  var dispatch = useDispatch();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      breadcrumbs = _useState2[0],\n      setBreadcrumbs = _useState2[1];\n\n  var brand = useSelector(function (state) {\n    return state.ui.brand;\n  });\n  var reportList = useSelector(selectReportListExtended);\n  var selectedReportGroup = useSelector(selectSelectedReportGroupExtended);\n  var reportListPagination = useSelector(selectReportListExtendedPagination);\n  var reportListSorting = useSelector(selectReportListExtendedSort);\n  var user = useSelector(selectUser);\n  var isReportListLoading = useSelector(selectReportListExtendedLoading);\n  var configVars = useSelector(function (state) {\n    return get(state, 'config.vars');\n  }); // This will be removed after the POC by API team.\n\n  var isDev = utils.app.isLocalOrDev1(configVars); // This will be removed after the POC by API team.\n\n  var hasCreateReportPermission = utils.app.access.feature('reporting.addReport', ['read', 'create', 'update', 'delete'], user);\n  var hasEditReportPermission = utils.app.access.feature('reporting.editReport', ['update'], user);\n  var hasDeleteReportPermission = utils.app.access.feature('reporting.deleteReport', ['delete'], user);\n  var reportGroupTitle = (selectedReportGroup === null || selectedReportGroup === void 0 ? void 0 : selectedReportGroup.name) || (location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.reportGroupTitle);\n  var reportListParam = {};\n  useEffect(function () {\n    dispatch(getReportListExtended(reportListParam, groupId));\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    setBreadcrumbs([{\n      name: 'report-group',\n      label: utils.string.t('reportingExtended.title'),\n      link: \"\".concat(config.routes.reportingExtended.root)\n    }, {\n      name: 'report',\n      label: reportGroupTitle || '',\n      link: \"\".concat(config.routes.reportingExtended.root, \"/\").concat(groupId),\n      active: false\n    }]);\n  }, [reportGroupTitle] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  var setActiveBreadCrumbStep = function setActiveBreadCrumbStep(breadcrumbs) {\n    // abort\n    if (!utils.generic.isValidArray(breadcrumbs, true)) return [];\n    return breadcrumbs === null || breadcrumbs === void 0 ? void 0 : breadcrumbs.map(function (item) {\n      if (item.name === constants.REPORTING_EXTENDED_BREADCRUMB_REPORT && history.location.pathname.includes(\"reporting-extended/\".concat(groupId))) {\n        item.active = true;\n      } else {\n        item.active = history.location.pathname === item.link;\n      }\n\n      return item;\n    });\n  };\n\n  var cols = [{\n    id: 'reportName',\n    label: utils.string.t('reportingExtended.reporting.columns.reportName'),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'description',\n    label: utils.string.t('reportingExtended.reporting.columns.description'),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'createdBy',\n    label: utils.string.t('reportingExtended.reporting.columns.createdBy'),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'createdDate',\n    label: utils.string.t('reportingExtended.reporting.columns.createdDate'),\n    sort: {\n      type: 'date',\n      direction: 'asc'\n    }\n  }].concat(_toConsumableArray(hasEditReportPermission || hasDeleteReportPermission ? [{\n    id: 'actions',\n    menu: true,\n    visible: true\n  }] : []));\n\n  var handleClickRow = function handleClickRow(report) {\n    return function (event) {\n      dispatch(setReportDetailBool(false));\n      var id = report.id,\n          title = report.title;\n\n      if (groupId && id) {\n        history.push(\"\".concat(config.routes.reportingExtended.root, \"/\").concat(groupId, \"/\").concat(id), {\n          reportGroupTitle: reportGroupTitle,\n          reportId: id,\n          reportTitle: title\n        });\n      }\n    };\n  };\n\n  var handleChangePage = function handleChangePage(newPage) {\n    dispatch(getReportListExtended({\n      page: newPage + 1\n    }, groupId));\n  };\n\n  var handleChangeRowsPerPage = function handleChangeRowsPerPage(rowsPerPage) {\n    dispatch(getReportListExtended({\n      size: rowsPerPage\n    }, groupId));\n  };\n\n  var searchSubmit = function searchSubmit(_ref) {\n    var search = _ref.search,\n        filters = _ref.filters;\n    dispatch(getReportListExtended({\n      searchBy: search,\n      filters: filters\n    }, groupId));\n  };\n\n  var onSortColumn = function onSortColumn(by, dir, type) {\n    dispatch(getReportListExtended({\n      sortBy: by,\n      direction: dir,\n      sortType: type\n    }, groupId));\n  };\n\n  var onSuccessfulCreateOrEditOrDeleteReport = function onSuccessfulCreateOrEditOrDeleteReport() {\n    dispatch(getReportListExtended(reportListParam, groupId));\n  };\n\n  var handleCreateEditReport = function handleCreateEditReport(isEditAddReport, report) {\n    dispatch(showModal({\n      component: 'REPORTS_EXTENDED_ADD_EDIT',\n      props: {\n        fullWidth: false,\n        maxWidth: 'sm',\n        title: isEditAddReport ? utils.string.t('reportingExtended.reporting.editReport') : utils.string.t('reportingExtended.reporting.createReport'),\n        componentProps: {\n          report: report,\n          groupId: groupId,\n          isEditAddReport: isEditAddReport,\n          handlers: {\n            onSuccessfulCreateOrEditOrDeleteReport: onSuccessfulCreateOrEditOrDeleteReport\n          }\n        }\n      }\n    }));\n  };\n\n  var handleDeleteReport = function handleDeleteReport(report) {\n    var id = report.id,\n        title = report.title;\n\n    var submitHandler = function submitHandler() {\n      dispatch(deleteReportsExtended(id)).then(function (response) {\n        if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_NO_CONTENT_STATUS) {\n          onSuccessfulCreateOrEditOrDeleteReport();\n        }\n      });\n    };\n\n    dispatch(showModal({\n      component: 'CONFIRM_DELETE',\n      props: {\n        title: \"\".concat(utils.string.t('reportingExtended.reporting.deleteReport')),\n        subtitle: title,\n        fullWidth: true,\n        maxWidth: 'xs',\n        disableAutoFocus: true,\n        componentProps: {\n          submitHandler: submitHandler\n        }\n      }\n    }));\n  }; // This will be removed after the POC by API team.\n\n\n  var openPowerBiInAnotherTab = function openPowerBiInAnotherTab() {\n    return function (event) {\n      window.open('https://app.powerbi.com/reportEmbed?reportId=7a6d4c46-63ad-4809-8ad8-781b42b43039&autoAuth=true&ctid=281280b5-acfc-430d-896a-9b49855a3f17&config=eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly93YWJpLXVrLXNvdXRoLWItcHJpbWFyeS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldC8ifQ%3D%3D', '_blank');\n    };\n  }; // This will be removed after the POC by API team.\n\n\n  var openPowerBiWithinDetailsPage = function openPowerBiWithinDetailsPage() {\n    dispatch(setReportDetailBool(true));\n\n    if (groupId) {\n      history.push(\"\".concat(config.routes.reportingExtended.root, \"/\").concat(groupId, \"/1\"));\n    }\n  };\n\n  var popoverActions = [].concat(_toConsumableArray(hasEditReportPermission ? [{\n    id: 'edit',\n    label: utils.string.t('reportingExtended.reporting.popOverMenuItems.edit'),\n    callback: function callback(_ref2) {\n      var report = _ref2.report;\n      return handleCreateEditReport(true, report);\n    }\n  }] : []), _toConsumableArray(hasDeleteReportPermission ? [{\n    id: 'delete',\n    label: utils.string.t('reportingExtended.reporting.popOverMenuItems.delete'),\n    callback: function callback(_ref3) {\n      var report = _ref3.report;\n      return handleDeleteReport(report);\n    }\n  }] : []));\n  var pagination = usePagination(reportList, reportListPagination, handleChangePage, handleChangeRowsPerPage);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"\".concat(reportGroupTitle, \" - \").concat(utils.app.getAppName(brand))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ReportsExtendedView, {\n      breadcrumbs: setActiveBreadCrumbStep(breadcrumbs),\n      columns: cols,\n      reports: reportList,\n      popoverActions: popoverActions,\n      pagination: pagination.obj,\n      sort: reportListSorting,\n      hasCreateReportPermission: hasCreateReportPermission,\n      reportGroupTitle: reportGroupTitle,\n      isReportListLoading: isReportListLoading,\n      isDev: isDev,\n      handlers: {\n        handleClickRow: handleClickRow,\n        handleCreateEditReport: handleCreateEditReport,\n        handleChangePage: pagination.handlers.handleChangePage,\n        handleChangeRowsPerPage: pagination.handlers.handleChangeRowsPerPage,\n        searchSubmit: searchSubmit,\n        onSortColumn: onSortColumn,\n        openPowerBiInAnotherTab: openPowerBiInAnotherTab,\n        openPowerBiWithinDetailsPage: openPowerBiWithinDetailsPage\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(ReportsExtended, \"ctwC3tnisNyUFGAZN+Boj0Vvu6Q=\", false, function () {\n  return [useHistory, useParams, useLocation, useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, usePagination];\n});\n\n_c = ReportsExtended;\n\nvar _c;\n\n$RefreshReg$(_c, \"ReportsExtended\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/pages/ReportsExtended/ReportsExtended.js"],"names":["React","useState","useEffect","useSelector","useDispatch","useHistory","useParams","useLocation","Helmet","get","ReportsExtendedView","utils","config","constants","usePagination","showModal","getReportListExtended","selectReportListExtended","selectSelectedReportGroupExtended","deleteReportsExtended","selectReportListExtendedPagination","selectReportListExtendedSort","selectUser","selectReportListExtendedLoading","setReportDetailBool","ReportsExtended","history","groupId","location","dispatch","breadcrumbs","setBreadcrumbs","brand","state","ui","reportList","selectedReportGroup","reportListPagination","reportListSorting","user","isReportListLoading","configVars","isDev","app","isLocalOrDev1","hasCreateReportPermission","access","feature","hasEditReportPermission","hasDeleteReportPermission","reportGroupTitle","name","reportListParam","label","string","t","link","routes","reportingExtended","root","active","setActiveBreadCrumbStep","generic","isValidArray","map","item","REPORTING_EXTENDED_BREADCRUMB_REPORT","pathname","includes","cols","id","sort","type","direction","menu","visible","handleClickRow","report","event","title","push","reportId","reportTitle","handleChangePage","newPage","page","handleChangeRowsPerPage","rowsPerPage","size","searchSubmit","search","filters","searchBy","onSortColumn","by","dir","sortBy","sortType","onSuccessfulCreateOrEditOrDeleteReport","handleCreateEditReport","isEditAddReport","component","props","fullWidth","maxWidth","componentProps","handlers","handleDeleteReport","submitHandler","then","response","status","API_RESPONSE_NO_CONTENT_STATUS","subtitle","disableAutoFocus","openPowerBiInAnotherTab","window","open","openPowerBiWithinDetailsPage","popoverActions","callback","pagination","getAppName","obj"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,UAAT,EAAqBC,SAArB,EAAgCC,WAAhC,QAAmD,cAAnD;AACA,SAASC,MAAT,QAAuB,cAAvB;AACA,OAAOC,GAAP,MAAgB,YAAhB,C,CAEA;;AACA,SAASC,mBAAT,QAAoC,wBAApC;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAO,KAAKC,SAAZ,MAA2B,QAA3B;AACA,SAASC,aAAT,QAA8B,OAA9B;AACA,SACEC,SADF,EAEEC,qBAFF,EAGEC,wBAHF,EAIEC,iCAJF,EAKEC,qBALF,EAMEC,kCANF,EAOEC,4BAPF,EAQEC,UARF,EASEC,+BATF,EAUEC,mBAVF,QAWO,QAXP;;;AAaA,eAAe,SAASC,eAAT,GAA2B;AAAA;;AAAA;;AACxC,MAAMC,OAAO,GAAGrB,UAAU,EAA1B;;AADwC,mBAEpBC,SAAS,EAFW;AAAA,MAEhCqB,OAFgC,cAEhCA,OAFgC;;AAGxC,MAAMC,QAAQ,GAAGrB,WAAW,EAA5B;AACA,MAAMsB,QAAQ,GAAGzB,WAAW,EAA5B;;AAJwC,kBAMFH,QAAQ,CAAC,EAAD,CANN;AAAA;AAAA,MAMjC6B,WANiC;AAAA,MAMpBC,cANoB;;AAQxC,MAAMC,KAAK,GAAG7B,WAAW,CAAC,UAAC8B,KAAD;AAAA,WAAWA,KAAK,CAACC,EAAN,CAASF,KAApB;AAAA,GAAD,CAAzB;AACA,MAAMG,UAAU,GAAGhC,WAAW,CAACc,wBAAD,CAA9B;AACA,MAAMmB,mBAAmB,GAAGjC,WAAW,CAACe,iCAAD,CAAvC;AACA,MAAMmB,oBAAoB,GAAGlC,WAAW,CAACiB,kCAAD,CAAxC;AACA,MAAMkB,iBAAiB,GAAGnC,WAAW,CAACkB,4BAAD,CAArC;AACA,MAAMkB,IAAI,GAAGpC,WAAW,CAACmB,UAAD,CAAxB;AACA,MAAMkB,mBAAmB,GAAGrC,WAAW,CAACoB,+BAAD,CAAvC;AACA,MAAMkB,UAAU,GAAGtC,WAAW,CAAC,UAAC8B,KAAD;AAAA,WAAWxB,GAAG,CAACwB,KAAD,EAAQ,aAAR,CAAd;AAAA,GAAD,CAA9B,CAfwC,CAe8B;;AACtE,MAAMS,KAAK,GAAG/B,KAAK,CAACgC,GAAN,CAAUC,aAAV,CAAwBH,UAAxB,CAAd,CAhBwC,CAgBW;;AAEnD,MAAMI,yBAAyB,GAAGlC,KAAK,CAACgC,GAAN,CAAUG,MAAV,CAAiBC,OAAjB,CAAyB,qBAAzB,EAAgD,CAAC,MAAD,EAAS,QAAT,EAAmB,QAAnB,EAA6B,QAA7B,CAAhD,EAAwFR,IAAxF,CAAlC;AACA,MAAMS,uBAAuB,GAAGrC,KAAK,CAACgC,GAAN,CAAUG,MAAV,CAAiBC,OAAjB,CAAyB,sBAAzB,EAAiD,CAAC,QAAD,CAAjD,EAA6DR,IAA7D,CAAhC;AACA,MAAMU,yBAAyB,GAAGtC,KAAK,CAACgC,GAAN,CAAUG,MAAV,CAAiBC,OAAjB,CAAyB,wBAAzB,EAAmD,CAAC,QAAD,CAAnD,EAA+DR,IAA/D,CAAlC;AAEA,MAAMW,gBAAgB,GAAG,CAAAd,mBAAmB,SAAnB,IAAAA,mBAAmB,WAAnB,YAAAA,mBAAmB,CAAEe,IAArB,MAA6BvB,QAA7B,aAA6BA,QAA7B,0CAA6BA,QAAQ,CAAEK,KAAvC,oDAA6B,gBAAiBiB,gBAA9C,CAAzB;AACA,MAAME,eAAe,GAAG,EAAxB;AAEAlD,EAAAA,SAAS,CAAC,YAAM;AACd2B,IAAAA,QAAQ,CAACb,qBAAqB,CAACoC,eAAD,EAAkBzB,OAAlB,CAAtB,CAAR;AACD,GAFQ,EAEN,EAFM,CAAT,CAzBwC,CA2BhC;;AAERzB,EAAAA,SAAS,CACP,YAAM;AACJ6B,IAAAA,cAAc,CAAC,CACb;AACEoB,MAAAA,IAAI,EAAE,cADR;AAEEE,MAAAA,KAAK,EAAE1C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,yBAAf,CAFT;AAGEC,MAAAA,IAAI,YAAK5C,MAAM,CAAC6C,MAAP,CAAcC,iBAAd,CAAgCC,IAArC;AAHN,KADa,EAMb;AACER,MAAAA,IAAI,EAAE,QADR;AAEEE,MAAAA,KAAK,EAAEH,gBAAgB,IAAI,EAF7B;AAGEM,MAAAA,IAAI,YAAK5C,MAAM,CAAC6C,MAAP,CAAcC,iBAAd,CAAgCC,IAArC,cAA6ChC,OAA7C,CAHN;AAIEiC,MAAAA,MAAM,EAAE;AAJV,KANa,CAAD,CAAd;AAaD,GAfM,EAgBP,CAACV,gBAAD,CAhBO,CAgBY;AAhBZ,GAAT;;AAmBA,MAAMW,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAC/B,WAAD,EAAiB;AAC/C;AACA,QAAI,CAACnB,KAAK,CAACmD,OAAN,CAAcC,YAAd,CAA2BjC,WAA3B,EAAwC,IAAxC,CAAL,EAAoD,OAAO,EAAP;AAEpD,WAAOA,WAAP,aAAOA,WAAP,uBAAOA,WAAW,CAAEkC,GAAb,CAAiB,UAACC,IAAD,EAAU;AAChC,UACEA,IAAI,CAACd,IAAL,KAActC,SAAS,CAACqD,oCAAxB,IACAxC,OAAO,CAACE,QAAR,CAAiBuC,QAAjB,CAA0BC,QAA1B,8BAAyDzC,OAAzD,EAFF,EAGE;AACAsC,QAAAA,IAAI,CAACL,MAAL,GAAc,IAAd;AACD,OALD,MAKO;AACLK,QAAAA,IAAI,CAACL,MAAL,GAAclC,OAAO,CAACE,QAAR,CAAiBuC,QAAjB,KAA8BF,IAAI,CAACT,IAAjD;AACD;;AACD,aAAOS,IAAP;AACD,KAVM,CAAP;AAWD,GAfD;;AAiBA,MAAMI,IAAI,IACR;AACEC,IAAAA,EAAE,EAAE,YADN;AAEEjB,IAAAA,KAAK,EAAE1C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,gDAAf,CAFT;AAGEgB,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,SAAS,EAAE;AAA9B;AAHR,GADQ,EAMR;AACEH,IAAAA,EAAE,EAAE,aADN;AAEEjB,IAAAA,KAAK,EAAE1C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,iDAAf,CAFT;AAGEgB,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,SAAS,EAAE;AAA9B;AAHR,GANQ,EAWR;AACEH,IAAAA,EAAE,EAAE,WADN;AAEEjB,IAAAA,KAAK,EAAE1C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,+CAAf,CAFT;AAGEgB,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,SAAS,EAAE;AAA9B;AAHR,GAXQ,EAgBR;AACEH,IAAAA,EAAE,EAAE,aADN;AAEEjB,IAAAA,KAAK,EAAE1C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,iDAAf,CAFT;AAGEgB,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE,MAAR;AAAgBC,MAAAA,SAAS,EAAE;AAA3B;AAHR,GAhBQ,4BAqBJzB,uBAAuB,IAAIC,yBAA3B,GAAuD,CAAC;AAAEqB,IAAAA,EAAE,EAAE,SAAN;AAAiBI,IAAAA,IAAI,EAAE,IAAvB;AAA6BC,IAAAA,OAAO,EAAE;AAAtC,GAAD,CAAvD,GAAwG,EArBpG,EAAV;;AAwBA,MAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,MAAD;AAAA,WAAY,UAACC,KAAD,EAAW;AAC5CjD,MAAAA,QAAQ,CAACL,mBAAmB,CAAC,KAAD,CAApB,CAAR;AAD4C,UAEpC8C,EAFoC,GAEtBO,MAFsB,CAEpCP,EAFoC;AAAA,UAEhCS,KAFgC,GAEtBF,MAFsB,CAEhCE,KAFgC;;AAG5C,UAAIpD,OAAO,IAAI2C,EAAf,EAAmB;AACjB5C,QAAAA,OAAO,CAACsD,IAAR,WAAgBpE,MAAM,CAAC6C,MAAP,CAAcC,iBAAd,CAAgCC,IAAhD,cAAwDhC,OAAxD,cAAmE2C,EAAnE,GAAyE;AACvEpB,UAAAA,gBAAgB,EAAhBA,gBADuE;AAEvE+B,UAAAA,QAAQ,EAAEX,EAF6D;AAGvEY,UAAAA,WAAW,EAAEH;AAH0D,SAAzE;AAKD;AACF,KAVsB;AAAA,GAAvB;;AAYA,MAAMI,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,OAAD,EAAa;AACpCvD,IAAAA,QAAQ,CAACb,qBAAqB,CAAC;AAAEqE,MAAAA,IAAI,EAAED,OAAO,GAAG;AAAlB,KAAD,EAAwBzD,OAAxB,CAAtB,CAAR;AACD,GAFD;;AAIA,MAAM2D,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACC,WAAD,EAAiB;AAC/C1D,IAAAA,QAAQ,CAACb,qBAAqB,CAAC;AAAEwE,MAAAA,IAAI,EAAED;AAAR,KAAD,EAAwB5D,OAAxB,CAAtB,CAAR;AACD,GAFD;;AAIA,MAAM8D,YAAY,GAAG,SAAfA,YAAe,OAAyB;AAAA,QAAtBC,MAAsB,QAAtBA,MAAsB;AAAA,QAAdC,OAAc,QAAdA,OAAc;AAC5C9D,IAAAA,QAAQ,CAACb,qBAAqB,CAAC;AAAE4E,MAAAA,QAAQ,EAAEF,MAAZ;AAAoBC,MAAAA,OAAO,EAAPA;AAApB,KAAD,EAAgChE,OAAhC,CAAtB,CAAR;AACD,GAFD;;AAIA,MAAMkE,YAAY,GAAG,SAAfA,YAAe,CAACC,EAAD,EAAKC,GAAL,EAAUvB,IAAV,EAAmB;AACtC3C,IAAAA,QAAQ,CAACb,qBAAqB,CAAC;AAAEgF,MAAAA,MAAM,EAAEF,EAAV;AAAcrB,MAAAA,SAAS,EAAEsB,GAAzB;AAA8BE,MAAAA,QAAQ,EAAEzB;AAAxC,KAAD,EAAiD7C,OAAjD,CAAtB,CAAR;AACD,GAFD;;AAIA,MAAMuE,sCAAsC,GAAG,SAAzCA,sCAAyC,GAAM;AACnDrE,IAAAA,QAAQ,CAACb,qBAAqB,CAACoC,eAAD,EAAkBzB,OAAlB,CAAtB,CAAR;AACD,GAFD;;AAIA,MAAMwE,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACC,eAAD,EAAkBvB,MAAlB,EAA6B;AAC1DhD,IAAAA,QAAQ,CACNd,SAAS,CAAC;AACRsF,MAAAA,SAAS,EAAE,2BADH;AAERC,MAAAA,KAAK,EAAE;AACLC,QAAAA,SAAS,EAAE,KADN;AAELC,QAAAA,QAAQ,EAAE,IAFL;AAGLzB,QAAAA,KAAK,EAAEqB,eAAe,GAClBzF,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,wCAAf,CADkB,GAElB5C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,0CAAf,CALC;AAMLkD,QAAAA,cAAc,EAAE;AACd5B,UAAAA,MAAM,EAANA,MADc;AAEdlD,UAAAA,OAAO,EAAPA,OAFc;AAGdyE,UAAAA,eAAe,EAAfA,eAHc;AAIdM,UAAAA,QAAQ,EAAE;AACRR,YAAAA,sCAAsC,EAAtCA;AADQ;AAJI;AANX;AAFC,KAAD,CADH,CAAR;AAoBD,GArBD;;AAuBA,MAAMS,kBAAkB,GAAG,SAArBA,kBAAqB,CAAC9B,MAAD,EAAY;AAAA,QAC7BP,EAD6B,GACfO,MADe,CAC7BP,EAD6B;AAAA,QACzBS,KADyB,GACfF,MADe,CACzBE,KADyB;;AAErC,QAAM6B,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAC1B/E,MAAAA,QAAQ,CAACV,qBAAqB,CAACmD,EAAD,CAAtB,CAAR,CAAoCuC,IAApC,CAAyC,UAACC,QAAD,EAAc;AACrD,YAAI,CAAAA,QAAQ,SAAR,IAAAA,QAAQ,WAAR,YAAAA,QAAQ,CAAEC,MAAV,MAAqBlG,SAAS,CAACmG,8BAAnC,EAAmE;AACjEd,UAAAA,sCAAsC;AACvC;AACF,OAJD;AAKD,KAND;;AAQArE,IAAAA,QAAQ,CACNd,SAAS,CAAC;AACRsF,MAAAA,SAAS,EAAE,gBADH;AAERC,MAAAA,KAAK,EAAE;AACLvB,QAAAA,KAAK,YAAKpE,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,0CAAf,CAAL,CADA;AAEL0D,QAAAA,QAAQ,EAAElC,KAFL;AAGLwB,QAAAA,SAAS,EAAE,IAHN;AAILC,QAAAA,QAAQ,EAAE,IAJL;AAKLU,QAAAA,gBAAgB,EAAE,IALb;AAMLT,QAAAA,cAAc,EAAE;AACdG,UAAAA,aAAa,EAAbA;AADc;AANX;AAFC,KAAD,CADH,CAAR;AAeD,GAzBD,CAhJwC,CA2KxC;;;AACA,MAAMO,uBAAuB,GAAG,SAA1BA,uBAA0B;AAAA,WAAM,UAACrC,KAAD,EAAW;AAC/CsC,MAAAA,MAAM,CAACC,IAAP,CACE,mQADF,EAEE,QAFF;AAID,KAL+B;AAAA,GAAhC,CA5KwC,CAmLxC;;;AACA,MAAMC,4BAA4B,GAAG,SAA/BA,4BAA+B,GAAM;AACzCzF,IAAAA,QAAQ,CAACL,mBAAmB,CAAC,IAAD,CAApB,CAAR;;AACA,QAAIG,OAAJ,EAAa;AACXD,MAAAA,OAAO,CAACsD,IAAR,WAAgBpE,MAAM,CAAC6C,MAAP,CAAcC,iBAAd,CAAgCC,IAAhD,cAAwDhC,OAAxD;AACD;AACF,GALD;;AAOA,MAAM4F,cAAc,gCACdvE,uBAAuB,GACvB,CACE;AACEsB,IAAAA,EAAE,EAAE,MADN;AAEEjB,IAAAA,KAAK,EAAE1C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,mDAAf,CAFT;AAGEiE,IAAAA,QAAQ,EAAE;AAAA,UAAG3C,MAAH,SAAGA,MAAH;AAAA,aAAgBsB,sBAAsB,CAAC,IAAD,EAAOtB,MAAP,CAAtC;AAAA;AAHZ,GADF,CADuB,GAQvB,EATc,sBAUd5B,yBAAyB,GACzB,CACE;AACEqB,IAAAA,EAAE,EAAE,QADN;AAEEjB,IAAAA,KAAK,EAAE1C,KAAK,CAAC2C,MAAN,CAAaC,CAAb,CAAe,qDAAf,CAFT;AAGEiE,IAAAA,QAAQ,EAAE;AAAA,UAAG3C,MAAH,SAAGA,MAAH;AAAA,aAAgB8B,kBAAkB,CAAC9B,MAAD,CAAlC;AAAA;AAHZ,GADF,CADyB,GAQzB,EAlBc,EAApB;AAqBA,MAAM4C,UAAU,GAAG3G,aAAa,CAACqB,UAAD,EAAaE,oBAAb,EAAmC8C,gBAAnC,EAAqDG,uBAArD,CAAhC;AAEA,sBACE;AAAA,4BACE,QAAC,MAAD;AAAA,6BACE;AAAA,4BAAWpC,gBAAX,gBAAiCvC,KAAK,CAACgC,GAAN,CAAU+E,UAAV,CAAqB1F,KAArB,CAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF,eAIE,QAAC,mBAAD;AACE,MAAA,WAAW,EAAE6B,uBAAuB,CAAC/B,WAAD,CADtC;AAEE,MAAA,OAAO,EAAEuC,IAFX;AAGE,MAAA,OAAO,EAAElC,UAHX;AAIE,MAAA,cAAc,EAAEoF,cAJlB;AAKE,MAAA,UAAU,EAAEE,UAAU,CAACE,GALzB;AAME,MAAA,IAAI,EAAErF,iBANR;AAOE,MAAA,yBAAyB,EAAEO,yBAP7B;AAQE,MAAA,gBAAgB,EAAEK,gBARpB;AASE,MAAA,mBAAmB,EAAEV,mBATvB;AAUE,MAAA,KAAK,EAAEE,KAVT;AAWE,MAAA,QAAQ,EAAE;AACRkC,QAAAA,cAAc,EAAdA,cADQ;AAERuB,QAAAA,sBAAsB,EAAtBA,sBAFQ;AAGRhB,QAAAA,gBAAgB,EAAEsC,UAAU,CAACf,QAAX,CAAoBvB,gBAH9B;AAIRG,QAAAA,uBAAuB,EAAEmC,UAAU,CAACf,QAAX,CAAoBpB,uBAJrC;AAKRG,QAAAA,YAAY,EAAZA,YALQ;AAMRI,QAAAA,YAAY,EAAZA,YANQ;AAORsB,QAAAA,uBAAuB,EAAvBA,uBAPQ;AAQRG,QAAAA,4BAA4B,EAA5BA;AARQ;AAXZ;AAAA;AAAA;AAAA;AAAA,YAJF;AAAA,kBADF;AA6BD;;GA/OuB7F,e;UACNpB,U,EACIC,S,EACHC,W,EACAH,W,EAIHD,W,EACKA,W,EACSA,W,EACCA,W,EACHA,W,EACbA,W,EACeA,W,EACTA,W,EAiMAW,a;;;KAhNGW,e","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useHistory, useParams, useLocation } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\nimport get from 'lodash/get';\r\n\r\n// app\r\nimport { ReportsExtendedView } from './ReportsExtended.view';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport * as constants from 'consts';\r\nimport { usePagination } from 'hooks';\r\nimport {\r\n  showModal,\r\n  getReportListExtended,\r\n  selectReportListExtended,\r\n  selectSelectedReportGroupExtended,\r\n  deleteReportsExtended,\r\n  selectReportListExtendedPagination,\r\n  selectReportListExtendedSort,\r\n  selectUser,\r\n  selectReportListExtendedLoading,\r\n  setReportDetailBool,\r\n} from 'stores';\r\n\r\nexport default function ReportsExtended() {\r\n  const history = useHistory();\r\n  const { groupId } = useParams();\r\n  const location = useLocation();\r\n  const dispatch = useDispatch();\r\n\r\n  const [breadcrumbs, setBreadcrumbs] = useState([]);\r\n\r\n  const brand = useSelector((state) => state.ui.brand);\r\n  const reportList = useSelector(selectReportListExtended);\r\n  const selectedReportGroup = useSelector(selectSelectedReportGroupExtended);\r\n  const reportListPagination = useSelector(selectReportListExtendedPagination);\r\n  const reportListSorting = useSelector(selectReportListExtendedSort);\r\n  const user = useSelector(selectUser);\r\n  const isReportListLoading = useSelector(selectReportListExtendedLoading);\r\n  const configVars = useSelector((state) => get(state, 'config.vars')); // This will be removed after the POC by API team.\r\n  const isDev = utils.app.isLocalOrDev1(configVars); // This will be removed after the POC by API team.\r\n\r\n  const hasCreateReportPermission = utils.app.access.feature('reporting.addReport', ['read', 'create', 'update', 'delete'], user);\r\n  const hasEditReportPermission = utils.app.access.feature('reporting.editReport', ['update'], user);\r\n  const hasDeleteReportPermission = utils.app.access.feature('reporting.deleteReport', ['delete'], user);\r\n\r\n  const reportGroupTitle = selectedReportGroup?.name || location?.state?.reportGroupTitle;\r\n  const reportListParam = {};\r\n\r\n  useEffect(() => {\r\n    dispatch(getReportListExtended(reportListParam, groupId));\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(\r\n    () => {\r\n      setBreadcrumbs([\r\n        {\r\n          name: 'report-group',\r\n          label: utils.string.t('reportingExtended.title'),\r\n          link: `${config.routes.reportingExtended.root}`,\r\n        },\r\n        {\r\n          name: 'report',\r\n          label: reportGroupTitle || '',\r\n          link: `${config.routes.reportingExtended.root}/${groupId}`,\r\n          active: false,\r\n        },\r\n      ]);\r\n    },\r\n    [reportGroupTitle] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  const setActiveBreadCrumbStep = (breadcrumbs) => {\r\n    // abort\r\n    if (!utils.generic.isValidArray(breadcrumbs, true)) return [];\r\n\r\n    return breadcrumbs?.map((item) => {\r\n      if (\r\n        item.name === constants.REPORTING_EXTENDED_BREADCRUMB_REPORT &&\r\n        history.location.pathname.includes(`reporting-extended/${groupId}`)\r\n      ) {\r\n        item.active = true;\r\n      } else {\r\n        item.active = history.location.pathname === item.link;\r\n      }\r\n      return item;\r\n    });\r\n  };\r\n\r\n  const cols = [\r\n    {\r\n      id: 'reportName',\r\n      label: utils.string.t('reportingExtended.reporting.columns.reportName'),\r\n      sort: { type: 'lexical', direction: 'asc' },\r\n    },\r\n    {\r\n      id: 'description',\r\n      label: utils.string.t('reportingExtended.reporting.columns.description'),\r\n      sort: { type: 'lexical', direction: 'asc' },\r\n    },\r\n    {\r\n      id: 'createdBy',\r\n      label: utils.string.t('reportingExtended.reporting.columns.createdBy'),\r\n      sort: { type: 'lexical', direction: 'asc' },\r\n    },\r\n    {\r\n      id: 'createdDate',\r\n      label: utils.string.t('reportingExtended.reporting.columns.createdDate'),\r\n      sort: { type: 'date', direction: 'asc' },\r\n    },\r\n    ...(hasEditReportPermission || hasDeleteReportPermission ? [{ id: 'actions', menu: true, visible: true }] : []),\r\n  ];\r\n\r\n  const handleClickRow = (report) => (event) => {\r\n    dispatch(setReportDetailBool(false));\r\n    const { id, title } = report;\r\n    if (groupId && id) {\r\n      history.push(`${config.routes.reportingExtended.root}/${groupId}/${id}`, {\r\n        reportGroupTitle,\r\n        reportId: id,\r\n        reportTitle: title,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleChangePage = (newPage) => {\r\n    dispatch(getReportListExtended({ page: newPage + 1 }, groupId));\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (rowsPerPage) => {\r\n    dispatch(getReportListExtended({ size: rowsPerPage }, groupId));\r\n  };\r\n\r\n  const searchSubmit = ({ search, filters }) => {\r\n    dispatch(getReportListExtended({ searchBy: search, filters }, groupId));\r\n  };\r\n\r\n  const onSortColumn = (by, dir, type) => {\r\n    dispatch(getReportListExtended({ sortBy: by, direction: dir, sortType: type }, groupId));\r\n  };\r\n\r\n  const onSuccessfulCreateOrEditOrDeleteReport = () => {\r\n    dispatch(getReportListExtended(reportListParam, groupId));\r\n  };\r\n\r\n  const handleCreateEditReport = (isEditAddReport, report) => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'REPORTS_EXTENDED_ADD_EDIT',\r\n        props: {\r\n          fullWidth: false,\r\n          maxWidth: 'sm',\r\n          title: isEditAddReport\r\n            ? utils.string.t('reportingExtended.reporting.editReport')\r\n            : utils.string.t('reportingExtended.reporting.createReport'),\r\n          componentProps: {\r\n            report,\r\n            groupId,\r\n            isEditAddReport,\r\n            handlers: {\r\n              onSuccessfulCreateOrEditOrDeleteReport,\r\n            },\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleDeleteReport = (report) => {\r\n    const { id, title } = report;\r\n    const submitHandler = () => {\r\n      dispatch(deleteReportsExtended(id)).then((response) => {\r\n        if (response?.status === constants.API_RESPONSE_NO_CONTENT_STATUS) {\r\n          onSuccessfulCreateOrEditOrDeleteReport();\r\n        }\r\n      });\r\n    };\r\n\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM_DELETE',\r\n        props: {\r\n          title: `${utils.string.t('reportingExtended.reporting.deleteReport')}`,\r\n          subtitle: title,\r\n          fullWidth: true,\r\n          maxWidth: 'xs',\r\n          disableAutoFocus: true,\r\n          componentProps: {\r\n            submitHandler,\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  // This will be removed after the POC by API team.\r\n  const openPowerBiInAnotherTab = () => (event) => {\r\n    window.open(\r\n      'https://app.powerbi.com/reportEmbed?reportId=7a6d4c46-63ad-4809-8ad8-781b42b43039&autoAuth=true&ctid=281280b5-acfc-430d-896a-9b49855a3f17&config=eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly93YWJpLXVrLXNvdXRoLWItcHJpbWFyeS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldC8ifQ%3D%3D',\r\n      '_blank'\r\n    );\r\n  };\r\n\r\n  // This will be removed after the POC by API team.\r\n  const openPowerBiWithinDetailsPage = () => {\r\n    dispatch(setReportDetailBool(true));\r\n    if (groupId) {\r\n      history.push(`${config.routes.reportingExtended.root}/${groupId}/1`);\r\n    }\r\n  };\r\n\r\n  const popoverActions = [\r\n    ...(hasEditReportPermission\r\n      ? [\r\n          {\r\n            id: 'edit',\r\n            label: utils.string.t('reportingExtended.reporting.popOverMenuItems.edit'),\r\n            callback: ({ report }) => handleCreateEditReport(true, report),\r\n          },\r\n        ]\r\n      : []),\r\n    ...(hasDeleteReportPermission\r\n      ? [\r\n          {\r\n            id: 'delete',\r\n            label: utils.string.t('reportingExtended.reporting.popOverMenuItems.delete'),\r\n            callback: ({ report }) => handleDeleteReport(report),\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  const pagination = usePagination(reportList, reportListPagination, handleChangePage, handleChangeRowsPerPage);\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{`${reportGroupTitle} - ${utils.app.getAppName(brand)}`}</title>\r\n      </Helmet>\r\n      <ReportsExtendedView\r\n        breadcrumbs={setActiveBreadCrumbStep(breadcrumbs)}\r\n        columns={cols}\r\n        reports={reportList}\r\n        popoverActions={popoverActions}\r\n        pagination={pagination.obj}\r\n        sort={reportListSorting}\r\n        hasCreateReportPermission={hasCreateReportPermission}\r\n        reportGroupTitle={reportGroupTitle}\r\n        isReportListLoading={isReportListLoading}\r\n        isDev={isDev}\r\n        handlers={{\r\n          handleClickRow,\r\n          handleCreateEditReport,\r\n          handleChangePage: pagination.handlers.handleChangePage,\r\n          handleChangeRowsPerPage: pagination.handlers.handleChangeRowsPerPage,\r\n          searchSubmit,\r\n          onSortColumn,\r\n          openPowerBiInAnotherTab,\r\n          openPowerBiWithinDetailsPage,\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}