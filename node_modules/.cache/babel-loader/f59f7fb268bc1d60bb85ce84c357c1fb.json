{"ast":null,"code":"import _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\PasteFromExcel\\\\PasteFromExcel.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport * as Yup from 'yup';\nimport startCase from 'lodash/startCase';\nimport merge from 'lodash/merge'; // app\n\nimport styles from './PasteFromExcel.styles';\nimport { PasteFromExcelView } from './PasteFromExcel.view';\nimport * as utils from 'utils'; // mui\n\nimport { makeStyles } from '@material-ui/core';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nPasteFromExcel.propTypes = {\n  name: PropTypes.string,\n  headers: PropTypes.arrayOf(PropTypes.shape({\n    key: PropTypes.string.isRequired,\n    value: PropTypes.string\n  })).isRequired,\n  steps: PropTypes.number,\n  labels: PropTypes.shape({\n    step1: PropTypes.shape({\n      title: PropTypes.node,\n      hint: PropTypes.string,\n      label: PropTypes.string,\n      required: PropTypes.string,\n      placeholder: PropTypes.string\n    }),\n    step2: PropTypes.shape({\n      title: PropTypes.node,\n      hint: PropTypes.string,\n      label: PropTypes.string,\n      error: PropTypes.string\n    }),\n    step3: PropTypes.shape({\n      title: PropTypes.node,\n      hint: PropTypes.string\n    }),\n    step4: PropTypes.shape({\n      title: PropTypes.node,\n      hint: PropTypes.string\n    })\n  }),\n  handlers: PropTypes.shape({\n    extract: PropTypes.func,\n    match: PropTypes.func,\n    submit: PropTypes.func.isRequired\n  }).isRequired\n};\nPasteFromExcel.defaultProps = {\n  steps: 3,\n  headers: [],\n  handlers: {}\n};\nexport default function PasteFromExcel(_ref) {\n  _s();\n\n  var name = _ref.name,\n      headersMap = _ref.headers,\n      steps = _ref.steps,\n      labels = _ref.labels,\n      handlers = _ref.handlers,\n      children = _ref.children;\n  var classes = makeStyles(styles, {\n    name: 'PasteFromExcel'\n  })();\n\n  var _useState = useState(1),\n      _useState2 = _slicedToArray(_useState, 2),\n      step = _useState2[0],\n      setStep = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      rows = _useState4[0],\n      setRows = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      columns = _useState6[0],\n      setColumns = _useState6[1];\n\n  var _useState7 = useState(headersMap),\n      _useState8 = _slicedToArray(_useState7, 2),\n      headers = _useState8[0],\n      setHeaders = _useState8[1];\n\n  var defaultLabels = {\n    step1: {\n      title: utils.string.html('products.pasteFromExcel.step1.title'),\n      hint: utils.string.t('products.pasteFromExcel.step1.hint'),\n      label: utils.string.t('products.pasteFromExcel.step1.label'),\n      required: utils.string.t('products.pasteFromExcel.step1.required'),\n      placeholder: utils.string.t('products.pasteFromExcel.step1.placeholder')\n    },\n    step2: {\n      title: utils.string.html('products.pasteFromExcel.step2.title'),\n      hint: utils.string.t('products.pasteFromExcel.step2.hint'),\n      label: utils.string.t('products.pasteFromExcel.step2.label'),\n      error: utils.string.t('products.pasteFromExcel.step2.error')\n    },\n    step3: {\n      title: utils.string.html('products.pasteFromExcel.step3.title'),\n      hint: utils.string.t('products.pasteFromExcel.step3.hint')\n    },\n    step4: {\n      title: utils.string.html('products.pasteFromExcel.step4.title'),\n      hint: utils.string.t('products.pasteFromExcel.step4.hint')\n    }\n  };\n  var mergedLabels = merge(defaultLabels, labels);\n\n  var handleExcelExtract = function handleExcelExtract(values) {\n    var cleanString = utils.excel.removeLineBreaksWithinCell(values.excelExtract);\n    var cellsByRow = utils.excel.splitCellsByRow(cleanString);\n    var objectRows = utils.excel.getObjects(cellsByRow);\n    var objectColumns = utils.excel.getColumns(cellsByRow);\n\n    var newHeaders = _toConsumableArray(headers.map(function (h) {\n      return objectColumns.includes(h.key) ? _objectSpread(_objectSpread({}, h), {}, {\n        value: h.value === '' ? h.key : h.value\n      }) : h;\n    }));\n\n    if (utils.generic.isFunction(handlers.extract)) {\n      handlers.extract({\n        headers: newHeaders,\n        rows: objectRows,\n        columns: objectColumns\n      });\n    }\n\n    setStep(2);\n    setHeaders(newHeaders);\n    setColumns(objectColumns);\n    setRows(objectRows);\n  };\n\n  var handleColumnMatching = function handleColumnMatching(form) {\n    var newHeaders = _toConsumableArray(headers.map(function (h) {\n      return _objectSpread(_objectSpread({}, h), {}, {\n        value: form[h.key] === '__placeholder__' ? '' : form[h.key]\n      });\n    }));\n\n    if (utils.generic.isFunction(handlers.match)) {\n      handlers.match({\n        headers: newHeaders\n      });\n    }\n\n    setHeaders(newHeaders);\n    setStep(3);\n  };\n\n  var handleSubmit = function handleSubmit(data) {\n    return function () {\n      if (utils.generic.isFunction(handlers.submit)) {\n        handlers.submit(data);\n      }\n    };\n  };\n\n  var fields = {\n    excelExtract: [{\n      name: 'excelExtract',\n      type: 'text',\n      label: mergedLabels.step1.label,\n      placeholder: mergedLabels.step1.placeholder,\n      value: '',\n      validation: Yup.string().required(mergedLabels.step1.required),\n      muiComponentProps: {\n        autoFocus: true,\n        multiline: true,\n        minRows: 3,\n        maxRows: 12,\n        classes: {\n          root: classes.textarea\n        }\n      }\n    }],\n    columnMatching: [headers.map(function (_ref2) {\n      var key = _ref2.key,\n          value = _ref2.value,\n          label = _ref2.label;\n      return {\n        name: key,\n        type: 'select',\n        gridSize: {\n          xs: 12,\n          sm: 6,\n          md: 4\n        },\n        label: label ? label : startCase(key),\n        value: value || '__placeholder__',\n        options: [{\n          value: '__placeholder__',\n          label: mergedLabels.step2.label,\n          placeholder: true\n        }].concat(_toConsumableArray(columns.map(function (col) {\n          return {\n            value: col,\n            label: startCase(col)\n          };\n        })))\n      };\n    })]\n  };\n  var isReady = utils.generic.isValidArray(rows, true) && utils.generic.isValidArray(columns, true);\n  var rowsFiltered = rows.map(function (row) {\n    return headers.reduce(function (acc, header) {\n      return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, header.key, row[header.value]));\n    }, {});\n  });\n  var columnsFiltered = headers.map(function (h) {\n    return {\n      id: h.key,\n      label: startCase(h.key),\n      compact: true\n    };\n  });\n  return /*#__PURE__*/_jsxDEV(PasteFromExcelView, {\n    step: step,\n    steps: steps,\n    labels: mergedLabels,\n    fields: fields,\n    rows: rowsFiltered,\n    columns: columnsFiltered,\n    imported: isReady,\n    testid: name,\n    handlers: {\n      setStep: setStep,\n      excelExtract: handleExcelExtract,\n      columnMatching: handleColumnMatching,\n      submit: handleSubmit\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PasteFromExcel, \"QS0VD9+F1xeTn7XdPN5QHEfpLis=\");\n\n_c = PasteFromExcel;\n\nvar _c;\n\n$RefreshReg$(_c, \"PasteFromExcel\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/PasteFromExcel/PasteFromExcel.js"],"names":["React","useState","PropTypes","Yup","startCase","merge","styles","PasteFromExcelView","utils","makeStyles","PasteFromExcel","propTypes","name","string","headers","arrayOf","shape","key","isRequired","value","steps","number","labels","step1","title","node","hint","label","required","placeholder","step2","error","step3","step4","handlers","extract","func","match","submit","defaultProps","headersMap","children","classes","step","setStep","rows","setRows","columns","setColumns","setHeaders","defaultLabels","html","t","mergedLabels","handleExcelExtract","values","cleanString","excel","removeLineBreaksWithinCell","excelExtract","cellsByRow","splitCellsByRow","objectRows","getObjects","objectColumns","getColumns","newHeaders","map","h","includes","generic","isFunction","handleColumnMatching","form","handleSubmit","data","fields","type","validation","muiComponentProps","autoFocus","multiline","minRows","maxRows","root","textarea","columnMatching","gridSize","xs","sm","md","options","col","isReady","isValidArray","rowsFiltered","row","reduce","acc","header","columnsFiltered","id","compact"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as Yup from 'yup';\r\nimport startCase from 'lodash/startCase';\r\nimport merge from 'lodash/merge';\r\n\r\n// app\r\nimport styles from './PasteFromExcel.styles';\r\nimport { PasteFromExcelView } from './PasteFromExcel.view';\r\nimport * as utils from 'utils';\r\n\r\n// mui\r\nimport { makeStyles } from '@material-ui/core';\r\n\r\nPasteFromExcel.propTypes = {\r\n  name: PropTypes.string,\r\n  headers: PropTypes.arrayOf(\r\n    PropTypes.shape({\r\n      key: PropTypes.string.isRequired,\r\n      value: PropTypes.string,\r\n    })\r\n  ).isRequired,\r\n  steps: PropTypes.number,\r\n  labels: PropTypes.shape({\r\n    step1: PropTypes.shape({\r\n      title: PropTypes.node,\r\n      hint: PropTypes.string,\r\n      label: PropTypes.string,\r\n      required: PropTypes.string,\r\n      placeholder: PropTypes.string,\r\n    }),\r\n    step2: PropTypes.shape({\r\n      title: PropTypes.node,\r\n      hint: PropTypes.string,\r\n      label: PropTypes.string,\r\n      error: PropTypes.string,\r\n    }),\r\n    step3: PropTypes.shape({\r\n      title: PropTypes.node,\r\n      hint: PropTypes.string,\r\n    }),\r\n    step4: PropTypes.shape({\r\n      title: PropTypes.node,\r\n      hint: PropTypes.string,\r\n    }),\r\n  }),\r\n  handlers: PropTypes.shape({\r\n    extract: PropTypes.func,\r\n    match: PropTypes.func,\r\n    submit: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nPasteFromExcel.defaultProps = {\r\n  steps: 3,\r\n  headers: [],\r\n  handlers: {},\r\n};\r\n\r\nexport default function PasteFromExcel({ name, headers: headersMap, steps, labels, handlers, children }) {\r\n  const classes = makeStyles(styles, { name: 'PasteFromExcel' })();\r\n\r\n  const [step, setStep] = useState(1);\r\n  const [rows, setRows] = useState([]);\r\n  const [columns, setColumns] = useState([]);\r\n  const [headers, setHeaders] = useState(headersMap);\r\n\r\n  const defaultLabels = {\r\n    step1: {\r\n      title: utils.string.html('products.pasteFromExcel.step1.title'),\r\n      hint: utils.string.t('products.pasteFromExcel.step1.hint'),\r\n      label: utils.string.t('products.pasteFromExcel.step1.label'),\r\n      required: utils.string.t('products.pasteFromExcel.step1.required'),\r\n      placeholder: utils.string.t('products.pasteFromExcel.step1.placeholder'),\r\n    },\r\n    step2: {\r\n      title: utils.string.html('products.pasteFromExcel.step2.title'),\r\n      hint: utils.string.t('products.pasteFromExcel.step2.hint'),\r\n      label: utils.string.t('products.pasteFromExcel.step2.label'),\r\n      error: utils.string.t('products.pasteFromExcel.step2.error'),\r\n    },\r\n    step3: {\r\n      title: utils.string.html('products.pasteFromExcel.step3.title'),\r\n      hint: utils.string.t('products.pasteFromExcel.step3.hint'),\r\n    },\r\n    step4: {\r\n      title: utils.string.html('products.pasteFromExcel.step4.title'),\r\n      hint: utils.string.t('products.pasteFromExcel.step4.hint'),\r\n    },\r\n  };\r\n\r\n  const mergedLabels = merge(defaultLabels, labels);\r\n\r\n  const handleExcelExtract = (values) => {\r\n    const cleanString = utils.excel.removeLineBreaksWithinCell(values.excelExtract);\r\n    const cellsByRow = utils.excel.splitCellsByRow(cleanString);\r\n    const objectRows = utils.excel.getObjects(cellsByRow);\r\n    const objectColumns = utils.excel.getColumns(cellsByRow);\r\n    const newHeaders = [\r\n      ...headers.map((h) => {\r\n        return objectColumns.includes(h.key) ? { ...h, value: h.value === '' ? h.key : h.value } : h;\r\n      }),\r\n    ];\r\n\r\n    if (utils.generic.isFunction(handlers.extract)) {\r\n      handlers.extract({ headers: newHeaders, rows: objectRows, columns: objectColumns });\r\n    }\r\n\r\n    setStep(2);\r\n    setHeaders(newHeaders);\r\n    setColumns(objectColumns);\r\n    setRows(objectRows);\r\n  };\r\n\r\n  const handleColumnMatching = (form) => {\r\n    const newHeaders = [...headers.map((h) => ({ ...h, value: form[h.key] === '__placeholder__' ? '' : form[h.key] }))];\r\n\r\n    if (utils.generic.isFunction(handlers.match)) {\r\n      handlers.match({ headers: newHeaders });\r\n    }\r\n\r\n    setHeaders(newHeaders);\r\n    setStep(3);\r\n  };\r\n\r\n  const handleSubmit = (data) => () => {\r\n    if (utils.generic.isFunction(handlers.submit)) {\r\n      handlers.submit(data);\r\n    }\r\n  };\r\n\r\n  const fields = {\r\n    excelExtract: [\r\n      {\r\n        name: 'excelExtract',\r\n        type: 'text',\r\n        label: mergedLabels.step1.label,\r\n        placeholder: mergedLabels.step1.placeholder,\r\n        value: '',\r\n        validation: Yup.string().required(mergedLabels.step1.required),\r\n        muiComponentProps: {\r\n          autoFocus: true,\r\n          multiline: true,\r\n          minRows: 3,\r\n          maxRows: 12,\r\n          classes: {\r\n            root: classes.textarea,\r\n          },\r\n        },\r\n      },\r\n    ],\r\n    columnMatching: [\r\n      headers.map(({ key, value, label }) => {\r\n        return {\r\n          name: key,\r\n          type: 'select',\r\n          gridSize: { xs: 12, sm: 6, md: 4 },\r\n          label: label ? label : startCase(key),\r\n          value: value || '__placeholder__',\r\n          options: [\r\n            {\r\n              value: '__placeholder__',\r\n              label: mergedLabels.step2.label,\r\n              placeholder: true,\r\n            },\r\n            ...columns.map((col) => ({ value: col, label: startCase(col) })),\r\n          ],\r\n        };\r\n      }),\r\n    ],\r\n  };\r\n\r\n  const isReady = utils.generic.isValidArray(rows, true) && utils.generic.isValidArray(columns, true);\r\n\r\n  const rowsFiltered = rows.map((row) => {\r\n    return headers.reduce((acc, header) => {\r\n      return { ...acc, [header.key]: row[header.value] };\r\n    }, {});\r\n  });\r\n\r\n  const columnsFiltered = headers.map((h) => ({ id: h.key, label: startCase(h.key), compact: true }));\r\n\r\n  return (\r\n    <PasteFromExcelView\r\n      step={step}\r\n      steps={steps}\r\n      labels={mergedLabels}\r\n      fields={fields}\r\n      rows={rowsFiltered}\r\n      columns={columnsFiltered}\r\n      imported={isReady}\r\n      testid={name}\r\n      handlers={{\r\n        setStep,\r\n        excelExtract: handleExcelExtract,\r\n        columnMatching: handleColumnMatching,\r\n        submit: handleSubmit,\r\n      }}\r\n      children={children}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}