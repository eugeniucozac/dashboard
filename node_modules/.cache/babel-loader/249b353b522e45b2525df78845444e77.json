{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\forms\\\\AddAssignee\\\\AddAssignee.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport * as Yup from 'yup';\nimport { useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport uniqBy from 'lodash/uniqBy'; // app\n\nimport { AddAssigneeView } from './AddAssignee.view';\nimport { hideModal, selectClaimsAssignedToUsers, getUsersByOrg, postSaveTaskProcessingAssignees, resetClaimsAssignedToUsers, getAssignedToUsersList, selectAssignedToUsers, postAssignToUser } from 'stores';\nimport * as utils from 'utils';\nimport { useFormActions } from 'hooks';\nimport * as constants from 'consts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nAddAssignee.propTypes = {\n  taskDetails: PropTypes.array.isRequired,\n  submitHandler: PropTypes.func.isRequired,\n  isPremiumProcessing: PropTypes.bool\n};\nexport default function AddAssignee(_ref) {\n  _s();\n\n  var _taskDetails$;\n\n  var isPremiumProcessing = _ref.isPremiumProcessing,\n      taskDetails = _ref.taskDetails,\n      submitHandler = _ref.submitHandler;\n  var dispatch = useDispatch();\n  var newTeam = ((_taskDetails$ = taskDetails[0]) === null || _taskDetails$ === void 0 ? void 0 : _taskDetails$.team) || constants.ORGANIZATIONS.mphasis.name;\n  var selectAssignees = useSelector(selectClaimsAssignedToUsers);\n  var allAssignees = selectAssignees === null || selectAssignees === void 0 ? void 0 : selectAssignees.items;\n  var hasOrgChanged = (selectAssignees === null || selectAssignees === void 0 ? void 0 : selectAssignees.orgName) !== newTeam;\n  var assignedToUsersList = useSelector(selectAssignedToUsers);\n  var isAssignedToUserList = utils.generic.isValidArray(assignedToUsersList, true);\n\n  var _useState = useState(allAssignees),\n      _useState2 = _slicedToArray(_useState, 2),\n      assigneeList = _useState2[0],\n      setAssigneeList = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      additionalAssigneeList = _useState4[0],\n      setAdditionalAssigneeList = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      assigneeResetKey = _useState6[0],\n      setAssigneeResetKey = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      resetKey = _useState8[0],\n      setResetKey = _useState8[1];\n\n  var additionalAssigneeOptions = [{\n    id: -1,\n    fullName: '',\n    email: ''\n  }].concat(_toConsumableArray(additionalAssigneeList));\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      ppAssigneUserList = _useState10[0],\n      setPPAssigneUserList = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      isDefaultAssignee = _useState12[0],\n      setIsDefaultAssignee = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      isDefaultAddAssignee = _useState14[0],\n      setIsDefaultAddAssignee = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      isAddAssigneeSelected = _useState16[0],\n      setIsAddAssigneeSelected = _useState16[1];\n\n  var _useState17 = useState({}),\n      _useState18 = _slicedToArray(_useState17, 2),\n      addAssigneeDetails = _useState18[0],\n      setAddAssigneeDetails = _useState18[1];\n\n  var getCurrentAssignee = function getCurrentAssignee() {\n    var _taskDetails$2, _taskDetails$3, _taskDetails$4, _taskDetails$5;\n\n    if (utils.generic.isValidArray(taskDetails, true) && ((_taskDetails$2 = taskDetails[0]) === null || _taskDetails$2 === void 0 ? void 0 : _taskDetails$2.assignee) && ((_taskDetails$3 = taskDetails[0]) === null || _taskDetails$3 === void 0 ? void 0 : _taskDetails$3.assigneeFullName) && !isDefaultAssignee) setIsDefaultAssignee(true);\n    return {\n      id: -1,\n      email: (_taskDetails$4 = taskDetails[0]) === null || _taskDetails$4 === void 0 ? void 0 : _taskDetails$4.assignee,\n      fullName: (_taskDetails$5 = taskDetails[0]) === null || _taskDetails$5 === void 0 ? void 0 : _taskDetails$5.assigneeFullName\n    };\n  };\n\n  var getCurrentAdditionalAssignee = function getCurrentAdditionalAssignee() {\n    var _taskDetails$6, _taskDetails$7;\n\n    if (utils.generic.isValidArray(taskDetails, true) && ((_taskDetails$6 = taskDetails[0]) === null || _taskDetails$6 === void 0 ? void 0 : _taskDetails$6.additionalAssigneeFullName) && ((_taskDetails$7 = taskDetails[0]) === null || _taskDetails$7 === void 0 ? void 0 : _taskDetails$7.additionalAssignee) && !isDefaultAddAssignee) {\n      var _taskDetails$8, _taskDetails$9;\n\n      setIsDefaultAddAssignee(true);\n      return {\n        id: -1,\n        fullName: (_taskDetails$8 = taskDetails[0]) === null || _taskDetails$8 === void 0 ? void 0 : _taskDetails$8.additionalAssigneeFullName,\n        email: (_taskDetails$9 = taskDetails[0]) === null || _taskDetails$9 === void 0 ? void 0 : _taskDetails$9.additionalAssignee\n      };\n    } else if (isAddAssigneeSelected && (addAssigneeDetails === null || addAssigneeDetails === void 0 ? void 0 : addAssigneeDetails.email)) {\n      return {\n        id: addAssigneeDetails === null || addAssigneeDetails === void 0 ? void 0 : addAssigneeDetails.id,\n        email: addAssigneeDetails === null || addAssigneeDetails === void 0 ? void 0 : addAssigneeDetails.email,\n        fullName: addAssigneeDetails === null || addAssigneeDetails === void 0 ? void 0 : addAssigneeDetails.fullName\n      };\n    }\n  };\n\n  var fields = [{\n    name: 'addAssignee',\n    type: 'autocompletemui',\n    optionKey: 'email',\n    optionLabel: 'fullName',\n    options: isPremiumProcessing && utils.generic.isValidArray(ppAssigneUserList, true) ? ppAssigneUserList : assigneeList || [],\n    value: !isPremiumProcessing && !isDefaultAssignee ? getCurrentAssignee() : null,\n    validation: Yup.object().nullable().required(utils.string.t('validation.required')),\n    callback: function callback(event, data) {\n      setIsAddAssigneeSelected(true);\n    }\n  }].concat(_toConsumableArray(!isPremiumProcessing ? [{\n    name: 'addAdditionalAssignee',\n    type: 'autocompletemui',\n    value: !isPremiumProcessing && !isDefaultAddAssignee ? getCurrentAdditionalAssignee() : null,\n    optionKey: 'email',\n    optionLabel: 'fullName',\n    options: additionalAssigneeOptions,\n    callback: function callback(event, data) {\n      setAddAssigneeDetails(data);\n    }\n  }] : []));\n  var actions = [{\n    name: 'cancel',\n    label: utils.string.t('app.cancel'),\n    handler: function handler() {\n      return hideModal();\n    }\n  }, {\n    name: 'submit',\n    label: utils.string.t('app.assign'),\n    handler: function () {\n      var _handler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n        var addAssignee, addAdditionalAssignee, addAssigneesRequest, assignList, response, premiumProcessingSaveAssigneeResponse;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                addAssignee = _ref2.addAssignee, addAdditionalAssignee = _ref2.addAdditionalAssignee;\n\n                if (isPremiumProcessing) {\n                  _context.next = 8;\n                  break;\n                }\n\n                addAssigneesRequest = taskDetails.map(function (eachTask) {\n                  return {\n                    additionalAssignee: addAdditionalAssignee === null || addAdditionalAssignee === void 0 ? void 0 : addAdditionalAssignee.email,\n                    assignTo: addAssignee === null || addAssignee === void 0 ? void 0 : addAssignee.email,\n                    processId: eachTask.processId,\n                    taskId: eachTask.taskId\n                  };\n                });\n                _context.next = 5;\n                return dispatch(postSaveTaskProcessingAssignees(addAssigneesRequest));\n\n              case 5:\n                if (submitHandler) {\n                  submitHandler({\n                    addAssignee: addAssignee,\n                    addAdditionalAssignee: addAdditionalAssignee\n                  });\n                }\n\n                _context.next = 14;\n                break;\n\n              case 8:\n                if (!taskDetails) {\n                  _context.next = 14;\n                  break;\n                }\n\n                assignList = utils.generic.isValidArray(ppAssigneUserList, true) && ppAssigneUserList.filter(function (a) {\n                  return a.emailId === (addAssignee === null || addAssignee === void 0 ? void 0 : addAssignee.emailId) && a.fullName === (addAssignee === null || addAssignee === void 0 ? void 0 : addAssignee.fullName);\n                });\n                _context.next = 12;\n                return dispatch(postAssignToUser({\n                  userDetails: assignList,\n                  rowDetails: taskDetails\n                }));\n\n              case 12:\n                response = _context.sent;\n\n                if (response && (response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n                  premiumProcessingSaveAssigneeResponse = response;\n\n                  if (submitHandler) {\n                    submitHandler({\n                      addAssignee: addAssignee,\n                      addAdditionalAssignee: addAdditionalAssignee,\n                      premiumProcessingSaveAssigneeResponse: premiumProcessingSaveAssigneeResponse\n                    });\n                  }\n                }\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function handler(_x) {\n        return _handler.apply(this, arguments);\n      }\n\n      return handler;\n    }()\n  }];\n  var defaultValues = utils.form.getInitialValues(fields);\n  var validationSchema = utils.form.getValidationSchema(fields);\n\n  var _useForm = useForm(_objectSpread({\n    defaultValues: defaultValues\n  }, validationSchema && {\n    resolver: yupResolver(validationSchema)\n  })),\n      control = _useForm.control,\n      errors = _useForm.errors,\n      watch = _useForm.watch,\n      handleSubmit = _useForm.handleSubmit;\n\n  var assigneeField = watch('addAssignee');\n  var additionalAssigneeField = watch('addAdditionalAssignee');\n\n  var _useFormActions = useFormActions(actions),\n      cancel = _useFormActions.cancel,\n      submit = _useFormActions.submit;\n\n  var cancelModal = function cancelModal() {\n    dispatch(hideModal());\n  };\n\n  var createEligibleList = function createEligibleList(allList, existingAssignees) {\n    var result = utils.generic.isValidArray(existingAssignees, true) ? allList.filter(function (_ref3) {\n      var email = _ref3.email;\n      return existingAssignees.indexOf(email.toLowerCase()) === -1;\n    }) : allList;\n    return result;\n  };\n\n  useEffect(function () {\n    if (isPremiumProcessing) {\n      if (!isAssignedToUserList) {\n        dispatch(getAssignedToUsersList());\n      }\n    } else {\n      dispatch(resetClaimsAssignedToUsers());\n\n      if (hasOrgChanged) {\n        dispatch(getUsersByOrg(newTeam, taskDetails, 'addAssignee'));\n      }\n\n      setAssigneeResetKey(new Date().getTime());\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (isAssignedToUserList) {\n      if (utils.generic.isValidArray(taskDetails, true)) {\n        var usersList = assignedToUsersList.filter(function (item) {\n          var _taskDetails$10, _taskDetails$11;\n\n          return item.xbInstanceId === ((_taskDetails$10 = taskDetails[0]) === null || _taskDetails$10 === void 0 ? void 0 : _taskDetails$10.xbInstanceId) && item.departmentId === ((_taskDetails$11 = taskDetails[0]) === null || _taskDetails$11 === void 0 ? void 0 : _taskDetails$11.departmentID);\n        });\n        setPPAssigneUserList(uniqBy(usersList, 'userId'));\n      }\n    }\n  }, [taskDetails, isAssignedToUserList]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (!isPremiumProcessing) {\n      var existingAssignees = utils.generic.isValidArray(taskDetails, true) && taskDetails.map(function (eachTask) {\n        var _eachTask$assignee;\n\n        return eachTask === null || eachTask === void 0 ? void 0 : (_eachTask$assignee = eachTask.assignee) === null || _eachTask$assignee === void 0 ? void 0 : _eachTask$assignee.toLowerCase();\n      });\n\n      if (utils.generic.isValidArray(allAssignees, true)) {\n        setAssigneeList(allAssignees);\n      }\n\n      if (assigneeField === null || assigneeField === void 0 ? void 0 : assigneeField.email) {\n        var _assigneeField$email;\n\n        setAdditionalAssigneeList(createEligibleList(allAssignees, [].concat(_toConsumableArray(existingAssignees), [assigneeField === null || assigneeField === void 0 ? void 0 : (_assigneeField$email = assigneeField.email) === null || _assigneeField$email === void 0 ? void 0 : _assigneeField$email.toLowerCase()])));\n      }\n\n      setResetKey(new Date().getTime());\n    }\n  }, [allAssignees, assigneeField]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var checkAssignBtnStatus = function checkAssignBtnStatus() {\n    if (isPremiumProcessing && !(assigneeField === null || assigneeField === void 0 ? void 0 : assigneeField.emailId)) {\n      return true;\n    } else if (!isPremiumProcessing) {\n      var _taskDetails$12, _taskDetails$13, _taskDetails$14, _taskDetails$15;\n\n      if ((!additionalAssigneeField || !additionalAssigneeField.email) && (assigneeField === null || assigneeField === void 0 ? void 0 : assigneeField.email) === ((_taskDetails$12 = taskDetails[0]) === null || _taskDetails$12 === void 0 ? void 0 : _taskDetails$12.assignee)) {\n        return true;\n      } else if (!assigneeField && additionalAssigneeField && !(additionalAssigneeField === null || additionalAssigneeField === void 0 ? void 0 : additionalAssigneeField.email) || !assigneeField && (additionalAssigneeField === null || additionalAssigneeField === void 0 ? void 0 : additionalAssigneeField.email) === ((_taskDetails$13 = taskDetails[0]) === null || _taskDetails$13 === void 0 ? void 0 : _taskDetails$13.additionalAssignee)) {\n        return true;\n      } else if ((assigneeField === null || assigneeField === void 0 ? void 0 : assigneeField.email) === ((_taskDetails$14 = taskDetails[0]) === null || _taskDetails$14 === void 0 ? void 0 : _taskDetails$14.assignee) && (additionalAssigneeField === null || additionalAssigneeField === void 0 ? void 0 : additionalAssigneeField.email) === ((_taskDetails$15 = taskDetails[0]) === null || _taskDetails$15 === void 0 ? void 0 : _taskDetails$15.additionalAssignee)) {\n        return true;\n      } else if ((assigneeField === null || assigneeField === void 0 ? void 0 : assigneeField.email) === (additionalAssigneeField === null || additionalAssigneeField === void 0 ? void 0 : additionalAssigneeField.email)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  return /*#__PURE__*/_jsxDEV(AddAssigneeView, {\n    fields: fields,\n    assignBtnStatus: checkAssignBtnStatus(),\n    control: control,\n    errors: errors,\n    assigneeResetKey: assigneeResetKey,\n    resetKey: resetKey,\n    isPremiumProcessing: isPremiumProcessing,\n    actions: {\n      submit: submit,\n      cancel: cancel\n    },\n    handlers: {\n      submit: handleSubmit,\n      cancel: cancelModal\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AddAssignee, \"XXs+PY4rzN85jBKiS8VON1Z1ixA=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useForm, useFormActions];\n});\n\n_c = AddAssignee;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddAssignee\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/forms/AddAssignee/AddAssignee.js"],"names":["React","useState","useEffect","PropTypes","useDispatch","useSelector","Yup","useForm","yupResolver","uniqBy","AddAssigneeView","hideModal","selectClaimsAssignedToUsers","getUsersByOrg","postSaveTaskProcessingAssignees","resetClaimsAssignedToUsers","getAssignedToUsersList","selectAssignedToUsers","postAssignToUser","utils","useFormActions","constants","AddAssignee","propTypes","taskDetails","array","isRequired","submitHandler","func","isPremiumProcessing","bool","dispatch","newTeam","team","ORGANIZATIONS","mphasis","name","selectAssignees","allAssignees","items","hasOrgChanged","orgName","assignedToUsersList","isAssignedToUserList","generic","isValidArray","assigneeList","setAssigneeList","additionalAssigneeList","setAdditionalAssigneeList","assigneeResetKey","setAssigneeResetKey","resetKey","setResetKey","additionalAssigneeOptions","id","fullName","email","ppAssigneUserList","setPPAssigneUserList","isDefaultAssignee","setIsDefaultAssignee","isDefaultAddAssignee","setIsDefaultAddAssignee","isAddAssigneeSelected","setIsAddAssigneeSelected","addAssigneeDetails","setAddAssigneeDetails","getCurrentAssignee","assignee","assigneeFullName","getCurrentAdditionalAssignee","additionalAssigneeFullName","additionalAssignee","fields","type","optionKey","optionLabel","options","value","validation","object","nullable","required","string","t","callback","event","data","actions","label","handler","addAssignee","addAdditionalAssignee","addAssigneesRequest","map","eachTask","assignTo","processId","taskId","assignList","filter","a","emailId","userDetails","rowDetails","response","status","API_RESPONSE_OK","premiumProcessingSaveAssigneeResponse","defaultValues","form","getInitialValues","validationSchema","getValidationSchema","resolver","control","errors","watch","handleSubmit","assigneeField","additionalAssigneeField","cancel","submit","cancelModal","createEligibleList","allList","existingAssignees","result","indexOf","toLowerCase","Date","getTime","usersList","item","xbInstanceId","departmentId","departmentID","checkAssignBtnStatus"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport * as Yup from 'yup';\r\nimport { useForm } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport uniqBy from 'lodash/uniqBy';\r\n\r\n// app\r\nimport { AddAssigneeView } from './AddAssignee.view';\r\nimport {\r\n  hideModal,\r\n  selectClaimsAssignedToUsers,\r\n  getUsersByOrg,\r\n  postSaveTaskProcessingAssignees,\r\n  resetClaimsAssignedToUsers,\r\n  getAssignedToUsersList,\r\n  selectAssignedToUsers,\r\n  postAssignToUser,\r\n} from 'stores';\r\nimport * as utils from 'utils';\r\nimport { useFormActions } from 'hooks';\r\nimport * as constants from 'consts';\r\n\r\nAddAssignee.propTypes = {\r\n  taskDetails: PropTypes.array.isRequired,\r\n  submitHandler: PropTypes.func.isRequired,\r\n  isPremiumProcessing: PropTypes.bool,\r\n};\r\n\r\nexport default function AddAssignee({ isPremiumProcessing, taskDetails, submitHandler }) {\r\n  const dispatch = useDispatch();\r\n  const newTeam = taskDetails[0]?.team || constants.ORGANIZATIONS.mphasis.name;\r\n  const selectAssignees = useSelector(selectClaimsAssignedToUsers);\r\n\r\n  const allAssignees = selectAssignees?.items;\r\n  const hasOrgChanged = selectAssignees?.orgName !== newTeam;\r\n  const assignedToUsersList = useSelector(selectAssignedToUsers);\r\n  const isAssignedToUserList = utils.generic.isValidArray(assignedToUsersList, true);\r\n  const [assigneeList, setAssigneeList] = useState(allAssignees);\r\n  const [additionalAssigneeList, setAdditionalAssigneeList] = useState([]);\r\n  const [assigneeResetKey, setAssigneeResetKey] = useState();\r\n  const [resetKey, setResetKey] = useState();\r\n  const additionalAssigneeOptions = [{ id: -1, fullName: '', email: '' }, ...additionalAssigneeList];\r\n  const [ppAssigneUserList, setPPAssigneUserList] = useState([]);\r\n\r\n  const [isDefaultAssignee, setIsDefaultAssignee] = useState(false);\r\n  const [isDefaultAddAssignee, setIsDefaultAddAssignee] = useState(false);\r\n  const [isAddAssigneeSelected, setIsAddAssigneeSelected] = useState(false);\r\n  const [addAssigneeDetails, setAddAssigneeDetails] = useState({});\r\n\r\n  const getCurrentAssignee = () => {\r\n    if (utils.generic.isValidArray(taskDetails, true) && taskDetails[0]?.assignee \r\n      && taskDetails[0]?.assigneeFullName && !isDefaultAssignee)\r\n      setIsDefaultAssignee(true);\r\n      return {id: -1, email: taskDetails[0]?.assignee, fullName: taskDetails[0]?.assigneeFullName};\r\n  }\r\n\r\n  const getCurrentAdditionalAssignee = () => {\r\n    if (utils.generic.isValidArray(taskDetails, true) && taskDetails[0]?.additionalAssigneeFullName &&\r\n      taskDetails[0]?.additionalAssignee && !isDefaultAddAssignee) {\r\n      setIsDefaultAddAssignee(true);\r\n      return {id: -1, fullName: taskDetails[0]?.additionalAssigneeFullName, email: taskDetails[0]?.additionalAssignee};\r\n    }\r\n    else if (isAddAssigneeSelected && addAssigneeDetails?.email) {\r\n      return {id: addAssigneeDetails?.id, email: addAssigneeDetails?.email, fullName: addAssigneeDetails?.fullName};\r\n    }\r\n  }\r\n\r\n  const fields = [\r\n    {\r\n      name: 'addAssignee',\r\n      type: 'autocompletemui',\r\n      optionKey: 'email',\r\n      optionLabel: 'fullName',\r\n      options: isPremiumProcessing && utils.generic.isValidArray(ppAssigneUserList, true) ? ppAssigneUserList : assigneeList || [],\r\n      value: !isPremiumProcessing && !isDefaultAssignee ? getCurrentAssignee() : null,\r\n      validation: Yup.object().nullable().required(utils.string.t('validation.required')),\r\n      callback: (event, data) => {\r\n        setIsAddAssigneeSelected(true);\r\n      }\r\n    },\r\n    ...(!isPremiumProcessing\r\n      ? [\r\n          {\r\n            name: 'addAdditionalAssignee',\r\n            type: 'autocompletemui',\r\n            value: !isPremiumProcessing && !isDefaultAddAssignee ? getCurrentAdditionalAssignee() : null,\r\n            optionKey: 'email',\r\n            optionLabel: 'fullName',\r\n            options: additionalAssigneeOptions,\r\n            callback: (event, data) => {\r\n              setAddAssigneeDetails(data);\r\n            }\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  const actions = [\r\n    {\r\n      name: 'cancel',\r\n      label: utils.string.t('app.cancel'),\r\n      handler: () => hideModal(),\r\n    },\r\n    {\r\n      name: 'submit',\r\n      label: utils.string.t('app.assign'),\r\n      handler: async ({ addAssignee, addAdditionalAssignee }) => {\r\n        if (!isPremiumProcessing) {\r\n          const addAssigneesRequest = taskDetails.map((eachTask) => {\r\n            return {\r\n              additionalAssignee: addAdditionalAssignee?.email,\r\n              assignTo: addAssignee?.email,\r\n              processId: eachTask.processId,\r\n              taskId: eachTask.taskId,\r\n            };\r\n          });\r\n          await dispatch(postSaveTaskProcessingAssignees(addAssigneesRequest));\r\n          if (submitHandler) {\r\n            submitHandler({ addAssignee, addAdditionalAssignee });\r\n          }\r\n        } else {\r\n          if (taskDetails) {\r\n            let assignList =\r\n              utils.generic.isValidArray(ppAssigneUserList, true) &&\r\n              ppAssigneUserList.filter((a) => a.emailId === addAssignee?.emailId && a.fullName === addAssignee?.fullName);\r\n            const response = await dispatch(postAssignToUser({ userDetails: assignList, rowDetails: taskDetails }));\r\n            if (response && response?.status === constants.API_RESPONSE_OK) {\r\n              const premiumProcessingSaveAssigneeResponse = response;\r\n              if (submitHandler) {\r\n                submitHandler({ addAssignee, addAdditionalAssignee, premiumProcessingSaveAssigneeResponse });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n    },\r\n  ];\r\n\r\n  const defaultValues = utils.form.getInitialValues(fields);\r\n  const validationSchema = utils.form.getValidationSchema(fields);\r\n\r\n  const { control, errors, watch, handleSubmit } = useForm({\r\n    defaultValues,\r\n    ...(validationSchema && { resolver: yupResolver(validationSchema) }),\r\n  });\r\n\r\n  const assigneeField = watch('addAssignee');\r\n  const additionalAssigneeField = watch('addAdditionalAssignee');\r\n\r\n  const { cancel, submit } = useFormActions(actions);\r\n\r\n  const cancelModal = () => {\r\n     dispatch(hideModal());\r\n  };\r\n\r\n  const createEligibleList = (allList, existingAssignees) => {\r\n    const result = utils.generic.isValidArray(existingAssignees, true)\r\n      ? allList.filter(({ email }) => existingAssignees.indexOf(email.toLowerCase()) === -1)\r\n      : allList;\r\n    return result;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isPremiumProcessing) {\r\n      if (!isAssignedToUserList) {\r\n        dispatch(getAssignedToUsersList());\r\n      }\r\n    } else {\r\n      dispatch(resetClaimsAssignedToUsers());\r\n      if (hasOrgChanged) {\r\n        dispatch(getUsersByOrg(newTeam, taskDetails, 'addAssignee'));\r\n      }\r\n      setAssigneeResetKey(new Date().getTime());\r\n    }\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (isAssignedToUserList) {\r\n      if (utils.generic.isValidArray(taskDetails, true)) {\r\n        const usersList = assignedToUsersList.filter(\r\n          (item) => item.xbInstanceId === taskDetails[0]?.xbInstanceId && item.departmentId === taskDetails[0]?.departmentID\r\n        );\r\n        setPPAssigneUserList(uniqBy(usersList, 'userId'));\r\n      }\r\n    }\r\n  }, [taskDetails, isAssignedToUserList]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (!isPremiumProcessing) {\r\n      const existingAssignees =\r\n        utils.generic.isValidArray(taskDetails, true) && taskDetails.map((eachTask) => eachTask?.assignee?.toLowerCase());\r\n      if (utils.generic.isValidArray(allAssignees, true)) {\r\n        setAssigneeList(allAssignees);\r\n      }\r\n      if (assigneeField?.email) {\r\n        setAdditionalAssigneeList(createEligibleList(allAssignees, [...existingAssignees, assigneeField?.email?.toLowerCase()]));\r\n      }\r\n      setResetKey(new Date().getTime());\r\n    }\r\n  }, [allAssignees, assigneeField]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const checkAssignBtnStatus = () => {\r\n    if (isPremiumProcessing && !assigneeField?.emailId) {\r\n      return true;\r\n    }\r\n    else if (!isPremiumProcessing) {\r\n      if ((!additionalAssigneeField || !additionalAssigneeField.email) && (assigneeField?.email === taskDetails[0]?.assignee)) {\r\n        return true;\r\n      }\r\n      else if ((!assigneeField && additionalAssigneeField && !additionalAssigneeField?.email) || \r\n            (!assigneeField && additionalAssigneeField?.email === taskDetails[0]?.additionalAssignee)) {\r\n        return true;\r\n      }\r\n      else if ((assigneeField?.email === taskDetails[0]?.assignee) && \r\n            (additionalAssigneeField?.email === taskDetails[0]?.additionalAssignee)) {\r\n        return true;\r\n      }\r\n      else if (assigneeField?.email === additionalAssigneeField?.email) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  return (\r\n    <AddAssigneeView\r\n      fields={fields}\r\n      assignBtnStatus={checkAssignBtnStatus()}\r\n      control={control}\r\n      errors={errors}\r\n      assigneeResetKey={assigneeResetKey}\r\n      resetKey={resetKey}\r\n      isPremiumProcessing={isPremiumProcessing}\r\n      actions={{\r\n        submit,\r\n        cancel,\r\n      }}\r\n      handlers={{\r\n        submit: handleSubmit,\r\n        cancel: cancelModal,\r\n      }}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}