{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\PremiumProcessingCaseRfiResolve\\\\PremiumProcessingCaseRfiResolve.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport * as Yup from 'yup'; // app\n\nimport PremiumProcessingCaseRfiResolveView from './PremiumProcessingCaseRfiResolve.view';\nimport { getRfiResolutionCodes, getCaseRFIDetails, selectRfiResolutionCodes, selectAssignedToUsers, getAssignedToUsersList, premiumProcessingResolveRFI, selectorDmsViewFiles, selectRefDataQueryCodes, getViewTableDocuments, selectCaseDetails } from 'stores';\nimport { useConfirmNavigation } from 'hooks';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nPremiumProcessingCaseRfiResolve.propTypes = {\n  rfiDetails: PropTypes.object.isRequired,\n  isEditable: PropTypes.bool.isRequired,\n  isPageDirty: PropTypes.bool.isRequired,\n  isResolved: PropTypes.bool,\n  isWorklist: PropTypes.bool.isRequired,\n  handlers: PropTypes.shape({\n    setIsPageDirty: PropTypes.func.isRequired\n  })\n};\nexport default function PremiumProcessingCaseRfiResolve(_ref) {\n  _s();\n\n  var _rfiDetails$caseId;\n\n  var rfiDetails = _ref.rfiDetails,\n      isPageDirty = _ref.isPageDirty,\n      isEditable = _ref.isEditable,\n      isResolved = _ref.isResolved,\n      isWorklist = _ref.isWorklist,\n      handlers = _ref.handlers;\n  var dispatch = useDispatch();\n  var queryCodes = useSelector(selectRefDataQueryCodes);\n  var queryCodesRfi = queryCodes.find(function (queryCode) {\n    return (queryCode === null || queryCode === void 0 ? void 0 : queryCode.queryCodeDetails) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryCode);\n  });\n\n  var _useConfirmNavigation = useConfirmNavigation({\n    title: utils.string.t('navigation.form.titleClear'),\n    subtitle: utils.string.t('navigation.form.subtitle')\n  }),\n      confirmNavigation = _useConfirmNavigation.confirmNavigation;\n\n  var caseRFIBureau = (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.rfiType) === constants.BUREAU_RFITYPE;\n  var caseDetails = useSelector(selectCaseDetails);\n  var tabDetails = (caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskView) === constants.WORKBASKET || (caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskView) === constants.ALL_CASES;\n  var selectAssignees = useSelector(selectAssignedToUsers);\n  var resolutionCodes = useSelector(selectRfiResolutionCodes);\n  var dmsViewFiles = useSelector(selectorDmsViewFiles);\n  var resolutionTypeInternals = utils.generic.isValidArray(resolutionCodes, true) ? resolutionCodes.filter(function (resolutionCodes) {\n    return resolutionCodes.rfiTypeID === constants.RFI_TYPE_FOR_QUERY_CODE;\n  }) : [];\n\n  var _useState = useState(constants.DMS_VIEW_TAB_VIEW),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedDmsTab = _useState2[0],\n      setSelectedDmsTab = _useState2[1];\n\n  var isAssignedToUserList = utils.generic.isValidArray(selectAssignees, true); // commenting until the dev who did this completes the story\n  // const assignedToUsers = selectAssignees?.map((item) => (item ? { ...item, email: item.email.toLowerCase() } : null));\n\n  var fetchDmsDocuments = function fetchDmsDocuments(id) {\n    if (id) {\n      dispatch(getViewTableDocuments({\n        referenceId: id,\n        sectionType: constants.DMS_CONTEXT_RFI\n      }));\n    }\n  };\n\n  useEffect(function () {\n    if (utils.generic.isInvalidOrEmptyArray(resolutionCodes)) {\n      dispatch(getRfiResolutionCodes());\n    }\n\n    if (!isAssignedToUserList) {\n      dispatch(getAssignedToUsersList());\n    } // fetch RFI documents\n\n\n    fetchDmsDocuments(rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId);\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    fetchDmsDocuments(rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId);\n  }, [rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var resetForm = function resetForm(resetFn) {\n    if (utils.generic.isFunction(resetFn)) {\n      resetFn(utils.form.getInitialValues(fields), {\n        keepDirty: false\n      });\n    }\n  };\n\n  var handleCancel = function handleCancel(resetFn) {\n    if (isPageDirty) {\n      confirmNavigation(function () {\n        return resetForm(resetFn);\n      });\n    } else {\n      resetForm(resetFn);\n    }\n  };\n\n  var selectDmsTab = function selectDmsTab(tabName) {\n    setSelectedDmsTab(tabName);\n  };\n\n  var fields = [{\n    name: 'resolutionCode',\n    type: 'autocompletemui',\n    value: !isEditable && resolutionCodes ? resolutionCodes.find(function (option) {\n      return (option === null || option === void 0 ? void 0 : option.resolutionCd) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.resolutionCode);\n    }) || null : null,\n    options: resolutionTypeInternals,\n    optionKey: 'resolutionCodeID',\n    optionLabel: 'resolutionCodeDescription',\n    label: utils.string.t('premiumProcessing.rfi.resolutionCode'),\n    validation: !caseRFIBureau ? Yup.object().nullable().required(utils.string.t('validation.required')) : '',\n    muiComponentProps: {\n      disabled: !isEditable || tabDetails\n    }\n  }, {\n    name: 'typeYourResponse',\n    type: 'textarea',\n    value: !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.resolutionComments) || '' : '',\n    validation: Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')).required(utils.string.t('validation.required')),\n    label: isEditable ? utils.string.t('premiumProcessing.rfi.resolutionNotes') : utils.string.t('premiumProcessing.rfi.typeYourResponse'),\n    fullWidth: true,\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      disabled: !isEditable || tabDetails\n    }\n  }].concat(_toConsumableArray(rfiDetails.rfiType === constants.BUREAU_RFITYPE ? [{\n    name: 'bureauQueryDescription',\n    type: 'textarea',\n    label: utils.string.t('premiumProcessing.rfi.bureauQuery'),\n    value: rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.bureauQuery,\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      disabled: true\n    },\n    validation: Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max'))\n  }] : []));\n  var actions = [{\n    name: 'cancel',\n    label: utils.string.t('app.cancel'),\n    handler: function handler(reset) {\n      return handleCancel(reset);\n    }\n  }, {\n    name: 'submit',\n    label: utils.string.t('premiumProcessing.rfi.resolveRfi'),\n    handler: function handler(reset) {\n      return function (values) {\n        if (values) {\n          var _values$resolutionCod;\n\n          handlers.setIsPageDirty(false);\n          dispatch(premiumProcessingResolveRFI({\n            queryId: rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId,\n            taskId: rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.taskId,\n            resolutionCode: values === null || values === void 0 ? void 0 : (_values$resolutionCod = values.resolutionCode) === null || _values$resolutionCod === void 0 ? void 0 : _values$resolutionCod.resolutionCd,\n            resolutionComments: values === null || values === void 0 ? void 0 : values.typeYourResponse,\n            documentId: []\n          })).then(function (response) {\n            // success POST\n            if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n              reset();\n              dispatch(getCaseRFIDetails({\n                taskId: rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.taskId\n              }));\n            }\n          });\n        }\n      };\n    }\n  }];\n  var dms = {\n    context: constants.DMS_CONTEXT_CASE,\n    referenceId: rfiDetails === null || rfiDetails === void 0 ? void 0 : (_rfiDetails$caseId = rfiDetails.caseId) === null || _rfiDetails$caseId === void 0 ? void 0 : _rfiDetails$caseId.toString() // confirm with API which ID should be used for reference\n\n  };\n  var tabs = [{\n    value: constants.DMS_VIEW_TAB_VIEW,\n    label: utils.string.t('dms.wrapper.tabs.viewDocuments')\n  }]; // abort\n\n  if (!rfiDetails.taskId || !isResolved && utils.generic.isInvalidOrEmptyArray(resolutionCodes)) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsxDEV(PremiumProcessingCaseRfiResolveView, {\n    fields: fields,\n    actions: actions,\n    rfiDetails: rfiDetails,\n    dms: dms,\n    dmsTabs: tabs,\n    documents: dmsViewFiles,\n    selectedDmsTab: selectedDmsTab,\n    isEditable: isEditable,\n    isPageDirty: isPageDirty,\n    queryCodesRfi: queryCodesRfi,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      selectDmsTab: selectDmsTab\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 208,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PremiumProcessingCaseRfiResolve, \"2FKogPBSGXRy4tTPmzAr5XfP8Eo=\", false, function () {\n  return [useDispatch, useSelector, useConfirmNavigation, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PremiumProcessingCaseRfiResolve;\n\nvar _c;\n\n$RefreshReg$(_c, \"PremiumProcessingCaseRfiResolve\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/PremiumProcessingCaseRfiResolve/PremiumProcessingCaseRfiResolve.js"],"names":["React","useEffect","useState","useDispatch","useSelector","PropTypes","Yup","PremiumProcessingCaseRfiResolveView","getRfiResolutionCodes","getCaseRFIDetails","selectRfiResolutionCodes","selectAssignedToUsers","getAssignedToUsersList","premiumProcessingResolveRFI","selectorDmsViewFiles","selectRefDataQueryCodes","getViewTableDocuments","selectCaseDetails","useConfirmNavigation","constants","utils","PremiumProcessingCaseRfiResolve","propTypes","rfiDetails","object","isRequired","isEditable","bool","isPageDirty","isResolved","isWorklist","handlers","shape","setIsPageDirty","func","dispatch","queryCodes","queryCodesRfi","find","queryCode","queryCodeDetails","title","string","t","subtitle","confirmNavigation","caseRFIBureau","rfiType","BUREAU_RFITYPE","caseDetails","tabDetails","taskView","WORKBASKET","ALL_CASES","selectAssignees","resolutionCodes","dmsViewFiles","resolutionTypeInternals","generic","isValidArray","filter","rfiTypeID","RFI_TYPE_FOR_QUERY_CODE","DMS_VIEW_TAB_VIEW","selectedDmsTab","setSelectedDmsTab","isAssignedToUserList","fetchDmsDocuments","id","referenceId","sectionType","DMS_CONTEXT_RFI","isInvalidOrEmptyArray","queryId","resetForm","resetFn","isFunction","form","getInitialValues","fields","keepDirty","handleCancel","selectDmsTab","tabName","name","type","value","option","resolutionCd","resolutionCode","options","optionKey","optionLabel","label","validation","nullable","required","muiComponentProps","disabled","resolutionComments","min","max","fullWidth","inputProps","maxLength","multiline","rows","rowsMax","bureauQuery","actions","handler","reset","values","taskId","typeYourResponse","documentId","then","response","status","API_RESPONSE_OK","dms","context","DMS_CONTEXT_CASE","caseId","toString","tabs"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport * as Yup from 'yup';\r\n\r\n// app\r\n\r\nimport PremiumProcessingCaseRfiResolveView from './PremiumProcessingCaseRfiResolve.view';\r\nimport {\r\n  getRfiResolutionCodes,\r\n  getCaseRFIDetails,\r\n  selectRfiResolutionCodes,\r\n  selectAssignedToUsers,\r\n  getAssignedToUsersList,\r\n  premiumProcessingResolveRFI,\r\n  selectorDmsViewFiles,\r\n  selectRefDataQueryCodes,\r\n  getViewTableDocuments,\r\n  selectCaseDetails,\r\n} from 'stores';\r\nimport { useConfirmNavigation } from 'hooks';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\n\r\nPremiumProcessingCaseRfiResolve.propTypes = {\r\n  rfiDetails: PropTypes.object.isRequired,\r\n  isEditable: PropTypes.bool.isRequired,\r\n  isPageDirty: PropTypes.bool.isRequired,\r\n  isResolved: PropTypes.bool,\r\n  isWorklist: PropTypes.bool.isRequired,\r\n  handlers: PropTypes.shape({\r\n    setIsPageDirty: PropTypes.func.isRequired,\r\n  }),\r\n};\r\nexport default function PremiumProcessingCaseRfiResolve({ rfiDetails, isPageDirty, isEditable, isResolved, isWorklist, handlers }) {\r\n  const dispatch = useDispatch();\r\n  const queryCodes = useSelector(selectRefDataQueryCodes);\r\n  const queryCodesRfi = queryCodes.find((queryCode) => queryCode?.queryCodeDetails === rfiDetails?.queryCode);\r\n  const { confirmNavigation } = useConfirmNavigation({\r\n    title: utils.string.t('navigation.form.titleClear'),\r\n    subtitle: utils.string.t('navigation.form.subtitle'),\r\n  });\r\n  const caseRFIBureau = rfiDetails?.rfiType === constants.BUREAU_RFITYPE;\r\n  const caseDetails = useSelector(selectCaseDetails);\r\n  const tabDetails = caseDetails?.taskView === constants.WORKBASKET || caseDetails?.taskView === constants.ALL_CASES;\r\n  const selectAssignees = useSelector(selectAssignedToUsers);\r\n  const resolutionCodes = useSelector(selectRfiResolutionCodes);\r\n  const dmsViewFiles = useSelector(selectorDmsViewFiles);\r\n  const resolutionTypeInternals = utils.generic.isValidArray(resolutionCodes, true)\r\n    ? resolutionCodes.filter((resolutionCodes) => resolutionCodes.rfiTypeID === constants.RFI_TYPE_FOR_QUERY_CODE)\r\n    : [];\r\n  const [selectedDmsTab, setSelectedDmsTab] = useState(constants.DMS_VIEW_TAB_VIEW);\r\n\r\n  const isAssignedToUserList = utils.generic.isValidArray(selectAssignees, true);\r\n  // commenting until the dev who did this completes the story\r\n  // const assignedToUsers = selectAssignees?.map((item) => (item ? { ...item, email: item.email.toLowerCase() } : null));\r\n\r\n  const fetchDmsDocuments = (id) => {\r\n    if (id) {\r\n      dispatch(getViewTableDocuments({ referenceId: id, sectionType: constants.DMS_CONTEXT_RFI }));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (utils.generic.isInvalidOrEmptyArray(resolutionCodes)) {\r\n      dispatch(getRfiResolutionCodes());\r\n    }\r\n\r\n    if (!isAssignedToUserList) {\r\n      dispatch(getAssignedToUsersList());\r\n    }\r\n\r\n    // fetch RFI documents\r\n    fetchDmsDocuments(rfiDetails?.queryId);\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    fetchDmsDocuments(rfiDetails?.queryId);\r\n  }, [rfiDetails?.queryId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const resetForm = (resetFn) => {\r\n    if (utils.generic.isFunction(resetFn)) {\r\n      resetFn(utils.form.getInitialValues(fields), { keepDirty: false });\r\n    }\r\n  };\r\n\r\n  const handleCancel = (resetFn) => {\r\n    if (isPageDirty) {\r\n      confirmNavigation(() => resetForm(resetFn));\r\n    } else {\r\n      resetForm(resetFn);\r\n    }\r\n  };\r\n\r\n  const selectDmsTab = (tabName) => {\r\n    setSelectedDmsTab(tabName);\r\n  };\r\n  const fields = [\r\n    {\r\n      name: 'resolutionCode',\r\n      type: 'autocompletemui',\r\n      value:\r\n        !isEditable && resolutionCodes\r\n          ? resolutionCodes.find((option) => option?.resolutionCd === rfiDetails?.resolutionCode) || null\r\n          : null,\r\n      options: resolutionTypeInternals,\r\n      optionKey: 'resolutionCodeID',\r\n      optionLabel: 'resolutionCodeDescription',\r\n      label: utils.string.t('premiumProcessing.rfi.resolutionCode'),\r\n      validation: !caseRFIBureau ? Yup.object().nullable().required(utils.string.t('validation.required')) : '',\r\n      muiComponentProps: {\r\n        disabled: !isEditable || tabDetails,\r\n      },\r\n    },\r\n    {\r\n      name: 'typeYourResponse',\r\n      type: 'textarea',\r\n      value: !isEditable ? rfiDetails?.resolutionComments || '' : '',\r\n      validation: Yup.string()\r\n        .min(5, utils.string.t('validation.string.min'))\r\n        .max(4000, utils.string.t('validation.string.max'))\r\n        .required(utils.string.t('validation.required')),\r\n      label: isEditable\r\n        ? utils.string.t('premiumProcessing.rfi.resolutionNotes')\r\n        : utils.string.t('premiumProcessing.rfi.typeYourResponse'),\r\n      fullWidth: true,\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 4000,\r\n        },\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 10,\r\n        disabled: !isEditable || tabDetails,\r\n      },\r\n    },\r\n    ...(rfiDetails.rfiType === constants.BUREAU_RFITYPE\r\n      ? [\r\n          {\r\n            name: 'bureauQueryDescription',\r\n            type: 'textarea',\r\n            label: utils.string.t('premiumProcessing.rfi.bureauQuery'),\r\n            value: rfiDetails?.bureauQuery,\r\n            muiComponentProps: {\r\n              inputProps: { maxLength: 4000 },\r\n              multiline: true,\r\n              rows: 5,\r\n              rowsMax: 10,\r\n              disabled: true,\r\n            },\r\n            validation: Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')),\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  const actions = [\r\n    {\r\n      name: 'cancel',\r\n      label: utils.string.t('app.cancel'),\r\n      handler: (reset) => handleCancel(reset),\r\n    },\r\n    {\r\n      name: 'submit',\r\n      label: utils.string.t('premiumProcessing.rfi.resolveRfi'),\r\n\r\n      handler: (reset) => (values) => {\r\n        if (values) {\r\n          handlers.setIsPageDirty(false);\r\n          dispatch(\r\n            premiumProcessingResolveRFI({\r\n              queryId: rfiDetails?.queryId,\r\n              taskId: rfiDetails?.taskId,\r\n              resolutionCode: values?.resolutionCode?.resolutionCd,\r\n              resolutionComments: values?.typeYourResponse,\r\n              documentId: [],\r\n            })\r\n          ).then((response) => {\r\n            // success POST\r\n            if (response?.status === constants.API_RESPONSE_OK) {\r\n              reset();\r\n              dispatch(getCaseRFIDetails({ taskId: rfiDetails?.taskId }));\r\n            }\r\n          });\r\n        }\r\n      },\r\n    },\r\n  ];\r\n\r\n  const dms = {\r\n    context: constants.DMS_CONTEXT_CASE,\r\n    referenceId: rfiDetails?.caseId?.toString(), // confirm with API which ID should be used for reference\r\n  };\r\n\r\n  const tabs = [\r\n    {\r\n      value: constants.DMS_VIEW_TAB_VIEW,\r\n      label: utils.string.t('dms.wrapper.tabs.viewDocuments'),\r\n    },\r\n  ];\r\n\r\n  // abort\r\n  if (!rfiDetails.taskId || (!isResolved && utils.generic.isInvalidOrEmptyArray(resolutionCodes))) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <PremiumProcessingCaseRfiResolveView\r\n      fields={fields}\r\n      actions={actions}\r\n      rfiDetails={rfiDetails}\r\n      dms={dms}\r\n      dmsTabs={tabs}\r\n      documents={dmsViewFiles}\r\n      selectedDmsTab={selectedDmsTab}\r\n      isEditable={isEditable}\r\n      isPageDirty={isPageDirty}\r\n      queryCodesRfi={queryCodesRfi}\r\n      handlers={{ ...handlers, selectDmsTab }}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}