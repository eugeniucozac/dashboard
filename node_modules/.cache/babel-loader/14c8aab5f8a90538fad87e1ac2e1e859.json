{"ast":null,"code":"import _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ProcessingInstructionsDetails\\\\ProcessingInstructionsDetails.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport moment from 'moment';\nimport get from 'lodash/get'; // app\n\nimport ProcessingInstructionsDetailsView from './ProcessingInstructionsDetails.view';\nimport { selectUser, showModal, updateProcessingInstruction, removePremiumTaxSignedLinesDocument, storeRetainedBrokerageAmountForPdf, storeTotalAmountForPdf, addLoader, storeProcessingInstructionDocuments, viewDocumentsDownload } from 'stores';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport config from 'config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nProcessingInstructionsDetails.propTypes = {\n  instruction: PropTypes.object.isRequired,\n  handlers: PropTypes.shape({\n    back: PropTypes.func.isRequired,\n    next: PropTypes.func.isRequired\n  }).isRequired\n};\nexport default function ProcessingInstructionsDetails(_ref) {\n  _s();\n\n  var _instruction$details, _instruction$details2, _utils$processingInst, _utils$processingInst2, _utils$processingInst3, _utils$processingInst4, _utils$processingInst5, _utils$processingInst6, _utils$processingInst7, _utils$processingInst8, _utils$processingInst9, _utils$processingInst10, _utils$processingInst11, _utils$processingInst12, _utils$processingInst13, _utils$processingInst14, _utils$processingInst15, _utils$processingInst16, _utils$processingInst17, _utils$processingInst18, _utils$processingInst19, _utils$processingInst20, _utils$processingInst21, _utils$processingInst22, _utils$processingInst23, _utils$processingInst24, _utils$processingInst25, _utils$processingInst26, _utils$processingInst27, _utils$processingInst28, _utils$processingInst29, _utils$processingInst30, _utils$processingInst31, _utils$processingInst32, _utils$processingInst33, _utils$processingInst34, _instruction$details3, _instruction$riskRefe, _childRef$current, _childRef$current$pro;\n\n  var instruction = _ref.instruction,\n      handlers = _ref.handlers,\n      childRef = _ref.childRef;\n  var dispatch = useDispatch();\n  var user = useSelector(selectUser);\n  var documents = useSelector(function (state) {\n    return get(state, 'processingInstructions.documents');\n  }) || {};\n  var refDataCurrencies = useSelector(function (state) {\n    return get(state, 'referenceData.currencyCodes');\n  }) || [];\n  var isDraft = utils.processingInstructions.status.isDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isReopened = utils.processingInstructions.status.isReopened(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\n  var userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\n  var isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\n  var isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\n  var isReadOnly = !isEditable;\n  var paymentBasisOptions = [{\n    id: '1',\n    code: 'cash',\n    name: 'Cash'\n  }, {\n    id: '2',\n    code: 'quaterly',\n    name: 'Quaterly'\n  }, {\n    id: '3',\n    code: 'otherDeferred',\n    name: 'Other Deferred'\n  }];\n  var ppwOrPpcOptions = [{\n    id: '1',\n    code: 'ppw',\n    name: 'PPW',\n    value: 1\n  }, {\n    id: '2',\n    code: 'ppc',\n    name: 'PPC',\n    value: 2\n  }, {\n    id: '3',\n    code: 'na',\n    name: 'N/A',\n    value: 3\n  }];\n  var toggleOptions = [{\n    label: utils.string.t('app.yes'),\n    value: 1\n  }, {\n    label: utils.string.t('app.no'),\n    value: 0\n  }, {\n    label: utils.string.t('app.na'),\n    value: -1\n  }];\n\n  var getToggleValue = function getToggleValue(value) {\n    return toggleOptions.map(function (o) {\n      return o.value;\n    }).includes(value) ? value : null;\n  };\n\n  var fields = [{\n    name: 'highPriority',\n    type: 'checkbox',\n    value: instruction === null || instruction === void 0 ? void 0 : (_instruction$details = instruction.details) === null || _instruction$details === void 0 ? void 0 : _instruction$details.highPriority,\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'frontEndSendDocs',\n    type: 'checkbox',\n    value: instruction === null || instruction === void 0 ? void 0 : (_instruction$details2 = instruction.details) === null || _instruction$details2 === void 0 ? void 0 : _instruction$details2.frontEndSendDocs,\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'premiumTaxCalculationSheetAttachedNumber',\n    type: 'toggle',\n    value: getToggleValue((_utils$processingInst = utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')) === null || _utils$processingInst === void 0 ? void 0 : _utils$processingInst.numberValue),\n    options: toggleOptions,\n    buttonGroupProps: {\n      exclusive: true,\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'premiumTaxCalculationSheetAttachedCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst2 = utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')) === null || _utils$processingInst2 === void 0 ? void 0 : _utils$processingInst2.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'signedLinesCalculationSheetAttachedNumber',\n    type: 'toggle',\n    value: getToggleValue((_utils$processingInst3 = utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')) === null || _utils$processingInst3 === void 0 ? void 0 : _utils$processingInst3.numberValue),\n    options: toggleOptions,\n    buttonGroupProps: {\n      exclusive: true,\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'signedLinesCalculationSheetAttachedCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst4 = utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')) === null || _utils$processingInst4 === void 0 ? void 0 : _utils$processingInst4.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'grossPremiumAmountNumber',\n    type: 'number',\n    value: ((_utils$processingInst5 = utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')) === null || _utils$processingInst5 === void 0 ? void 0 : _utils$processingInst5.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'grossPremiumAmountCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst6 = utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')) === null || _utils$processingInst6 === void 0 ? void 0 : _utils$processingInst6.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'slipOrderNumber',\n    type: 'number',\n    value: ((_utils$processingInst7 = utils.processingInstructions.getFinancialField(instruction, 'slipOrder')) === null || _utils$processingInst7 === void 0 ? void 0 : _utils$processingInst7.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'slipOrderCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst8 = utils.processingInstructions.getFinancialField(instruction, 'slipOrder')) === null || _utils$processingInst8 === void 0 ? void 0 : _utils$processingInst8.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'totalBrokerageNumber',\n    type: 'number',\n    value: ((_utils$processingInst9 = utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')) === null || _utils$processingInst9 === void 0 ? void 0 : _utils$processingInst9.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'totalBrokerageCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst10 = utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')) === null || _utils$processingInst10 === void 0 ? void 0 : _utils$processingInst10.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'clientDiscountNumber',\n    type: 'number',\n    value: ((_utils$processingInst11 = utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')) === null || _utils$processingInst11 === void 0 ? void 0 : _utils$processingInst11.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'clientDiscountCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst12 = utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')) === null || _utils$processingInst12 === void 0 ? void 0 : _utils$processingInst12.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'thirdPartyNumber',\n    type: 'number',\n    value: ((_utils$processingInst13 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst13 === void 0 ? void 0 : _utils$processingInst13.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'thirdPartyString',\n    type: 'text',\n    value: ((_utils$processingInst14 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst14 === void 0 ? void 0 : _utils$processingInst14.stringValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'thirdPartyCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst15 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst15 === void 0 ? void 0 : _utils$processingInst15.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'pfinternalNumber',\n    type: 'number',\n    value: ((_utils$processingInst16 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst16 === void 0 ? void 0 : _utils$processingInst16.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'pfinternalString',\n    type: 'text',\n    value: ((_utils$processingInst17 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst17 === void 0 ? void 0 : _utils$processingInst17.stringValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'pfinternalCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst18 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst18 === void 0 ? void 0 : _utils$processingInst18.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'retainedBrokerageNumber',\n    type: 'number',\n    value: ((_utils$processingInst19 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')) === null || _utils$processingInst19 === void 0 ? void 0 : _utils$processingInst19.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'retainedBrokerageCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst20 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')) === null || _utils$processingInst20 === void 0 ? void 0 : _utils$processingInst20.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'retainedBrokerageCurrencyCodeString',\n    value: ((_utils$processingInst21 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')) === null || _utils$processingInst21 === void 0 ? void 0 : _utils$processingInst21.stringValue) || constants.CURRENCY_USD,\n    optionsKey: 'premiumCurrency',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'retainedBrokerageCurrencyCodeCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst22 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')) === null || _utils$processingInst22 === void 0 ? void 0 : _utils$processingInst22.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'feesNumber',\n    type: 'number',\n    value: ((_utils$processingInst23 = utils.processingInstructions.getFinancialField(instruction, 'fees')) === null || _utils$processingInst23 === void 0 ? void 0 : _utils$processingInst23.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'feesCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst24 = utils.processingInstructions.getFinancialField(instruction, 'fees')) === null || _utils$processingInst24 === void 0 ? void 0 : _utils$processingInst24.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'otherDeductionsNumber',\n    type: 'number',\n    value: ((_utils$processingInst25 = utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')) === null || _utils$processingInst25 === void 0 ? void 0 : _utils$processingInst25.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'otherDeductionsCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst26 = utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')) === null || _utils$processingInst26 === void 0 ? void 0 : _utils$processingInst26.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'settlementCurrencyCodeIdNumber',\n    type: 'select',\n    value: ((_utils$processingInst27 = utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')) === null || _utils$processingInst27 === void 0 ? void 0 : _utils$processingInst27.numberValue) || '',\n    options: refDataCurrencies,\n    optionKey: 'currencyCodeID',\n    optionLabel: 'currencyCd',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'settlementCurrencyCodeIdCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst28 = utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')) === null || _utils$processingInst28 === void 0 ? void 0 : _utils$processingInst28.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'paymentBasisNumber',\n    type: 'select',\n    value: ((_utils$processingInst29 = utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')) === null || _utils$processingInst29 === void 0 ? void 0 : _utils$processingInst29.numberValue) || '',\n    options: paymentBasisOptions,\n    optionKey: 'id',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'paymentBasisCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst30 = utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')) === null || _utils$processingInst30 === void 0 ? void 0 : _utils$processingInst30.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'ppwOrPpcNumber',\n    type: 'select',\n    value: ((_utils$processingInst31 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst31 === void 0 ? void 0 : _utils$processingInst31.numberValue) || '',\n    options: ppwOrPpcOptions,\n    optionKey: 'value',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'ppwOrPpcDate',\n    type: 'datepicker',\n    value: ((_utils$processingInst32 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst32 === void 0 ? void 0 : _utils$processingInst32.dateValue) ? moment((_utils$processingInst33 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst33 === void 0 ? void 0 : _utils$processingInst33.dateValue) : null,\n    outputFormat: 'iso',\n    placeholder: utils.string.t('app.selectDate'),\n    muiComponentProps: {\n      disabled: isReadOnly\n    },\n    muiPickerProps: {\n      format: config.ui.format.date.text,\n      clearable: true\n    }\n  }, {\n    name: 'ppwOrPpcCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst34 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst34 === void 0 ? void 0 : _utils$processingInst34.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'notes',\n    label: utils.string.t('processingInstructions.details.notes'),\n    type: 'textarea',\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details3 = instruction.details) === null || _instruction$details3 === void 0 ? void 0 : _instruction$details3.notes) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      minRows: 4,\n      maxRows: 8,\n      disabled: isReadOnly\n    }\n  }];\n  var selectedRiskRef = instruction === null || instruction === void 0 ? void 0 : (_instruction$riskRefe = instruction.riskReferences) === null || _instruction$riskRefe === void 0 ? void 0 : _instruction$riskRefe.find(function (r) {\n    return r.leadPolicy;\n  });\n  var retainedBrokerageCurrencyCodeField = utils.form.getFieldProps(fields, 'retainedBrokerageCurrencyCodeString');\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      defaultValues = _useState2[0],\n      setDefaultValues = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      retainedBrokerageAmount = _useState4[0],\n      setRetainedBrokerageAmount = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      convertedBrokerage = _useState6[0],\n      setConvertedBrokerage = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      totalAmount = _useState8[0],\n      setTotalAmount = _useState8[1];\n\n  var formValues = childRef === null || childRef === void 0 ? void 0 : (_childRef$current = childRef.current) === null || _childRef$current === void 0 ? void 0 : (_childRef$current$pro = _childRef$current.props) === null || _childRef$current$pro === void 0 ? void 0 : _childRef$current$pro.values;\n  var retainedBrokerageCurrencyCode = (formValues === null || formValues === void 0 ? void 0 : formValues.retainedBrokerageCurrencyCodeString) || (retainedBrokerageCurrencyCodeField === null || retainedBrokerageCurrencyCodeField === void 0 ? void 0 : retainedBrokerageCurrencyCodeField.defaultValue) || (retainedBrokerageCurrencyCodeField === null || retainedBrokerageCurrencyCodeField === void 0 ? void 0 : retainedBrokerageCurrencyCodeField.value);\n\n  var getRetainedBrokerageAmount = function getRetainedBrokerageAmount(_ref2) {\n    var grossPremiumAmount = _ref2.grossPremiumAmount,\n        slipOrder = _ref2.slipOrder,\n        retainedBrokerage = _ref2.retainedBrokerage,\n        retainedBrokerageCurrencyCode = _ref2.retainedBrokerageCurrencyCode,\n        retainedBrokerageAmount = _ref2.retainedBrokerageAmount;\n    var amount = utils.processingInstructions.getRetainedBrokerageValue(grossPremiumAmount, slipOrder, retainedBrokerage);\n    var brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(retainedBrokerageCurrencyCode, retainedBrokerageAmount);\n    setRetainedBrokerageAmount(amount);\n    setConvertedBrokerage(brokerage);\n    dispatch(storeRetainedBrokerageAmountForPdf({\n      retBrokerageAmt: amount,\n      convertedBrokerageAmt: brokerage\n    }));\n  };\n\n  var getTotalAmount = function getTotalAmount(_ref3) {\n    var clientDiscount = _ref3.clientDiscount,\n        thirdPartyCommissionSharing = _ref3.thirdPartyCommissionSharing,\n        pfinternalCommissionSharing = _ref3.pfinternalCommissionSharing,\n        retainedBrokerage = _ref3.retainedBrokerage;\n\n    if (clientDiscount && thirdPartyCommissionSharing && pfinternalCommissionSharing && retainedBrokerage) {\n      var sumValuesArray = [clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage];\n      setTotalAmount(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal));\n      dispatch(storeTotalAmountForPdf(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal)));\n    } else {\n      setTotalAmount('');\n    }\n  };\n\n  var handleSave = function handleSave() {\n    var _childRef$current2, _childRef$current2$pr;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current2 = childRef.current) === null || _childRef$current2 === void 0 ? void 0 : (_childRef$current2$pr = _childRef$current2.props) === null || _childRef$current2$pr === void 0 ? void 0 : _childRef$current2$pr.values) || {};\n    var financialChecklistBlank = [{\n      name: 'signedLinesCalculationSheetAttached',\n      types: ['Number']\n    }, {\n      name: 'premiumTaxCalculationSheetAttached',\n      types: ['Number']\n    }, {\n      name: 'grossPremiumAmount',\n      types: ['Number']\n    }, {\n      name: 'slipOrder',\n      types: ['Number']\n    }, {\n      name: 'totalBrokerage',\n      types: ['Number']\n    }, {\n      name: 'fees',\n      types: ['Number']\n    }, {\n      name: 'otherDeductions',\n      types: ['Number']\n    }, {\n      name: 'settlementCurrencyCodeId',\n      types: ['Number']\n    }, {\n      name: 'paymentBasis',\n      types: ['Number']\n    }, {\n      name: 'ppwOrPpc',\n      types: ['Number', 'Date']\n    }, {\n      name: 'clientDiscount',\n      types: ['Number']\n    }, {\n      name: 'thirdParty',\n      types: ['Number', 'String']\n    }, {\n      name: 'pfinternal',\n      types: ['Number', 'String']\n    }, {\n      name: 'retainedBrokerage',\n      types: ['Number']\n    }, {\n      name: 'retainedBrokerageCurrencyCode',\n      types: ['String']\n    }];\n\n    var updatedInstruction = _objectSpread(_objectSpread({}, instruction), {}, {\n      details: _objectSpread(_objectSpread({}, instruction.details), {}, {\n        highPriority: formValues.highPriority,\n        frontEndSendDocs: formValues.frontEndSendDocs,\n        notes: formValues.notes,\n        retainedBrokerageCurrencyCode: retainedBrokerageCurrencyCode\n      }),\n      financialChecklist: financialChecklistBlank.map(function (_ref4) {\n        var name = _ref4.name,\n            types = _ref4.types;\n        return types.reduce(function (acc, type) {\n          var _objectSpread2;\n\n          var valueKey = \"\".concat(name).concat(type);\n          var isThirdPartyString = valueKey === 'thirdPartyString';\n          var thirdPartyNumberValue = formValues['thirdPartyNumber'];\n          var thirdPartyStringValue = Boolean(thirdPartyNumberValue) ? formValues[valueKey] : '';\n          var isPfInternalString = valueKey === 'pfinternalString';\n          var pfInternalNumberValue = formValues['pfinternalNumber'];\n          var pfInternalStringValue = Boolean(pfInternalNumberValue) ? formValues[valueKey] : '';\n          var value = isThirdPartyString ? thirdPartyStringValue : isPfInternalString ? pfInternalStringValue : formValues[valueKey];\n          var isDate = type === 'Date';\n          var isValidDate = isDate && moment(value).isValid();\n          return _objectSpread(_objectSpread({}, acc), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, \"\".concat(type.toLowerCase(), \"Value\"), isDate ? isValidDate ? moment(value).format('YYYY-MM-DD') : '' : value), _defineProperty(_objectSpread2, \"approvedByAuthorisedSignatory\", formValues[\"\".concat(name, \"Checkbox\")]), _objectSpread2));\n        }, {\n          name: name\n        });\n      })\n    });\n\n    dispatch(updateProcessingInstruction(updatedInstruction, formValues));\n  };\n\n  var handleCancel = function handleCancel() {\n    var _childRef$current3, _childRef$current3$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current3 = childRef.current) === null || _childRef$current3 === void 0 ? void 0 : (_childRef$current3$pr = _childRef$current3.props) === null || _childRef$current3$pr === void 0 ? void 0 : _childRef$current3$pr.resetFunc;\n\n    if (utils.generic.isFunction(reset)) {\n      reset(defaultValues, {\n        keepDirty: false\n      });\n    }\n  };\n\n  useEffect(function () {\n    var _childRef$current4, _childRef$current4$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current4 = childRef.current) === null || _childRef$current4 === void 0 ? void 0 : (_childRef$current4$pr = _childRef$current4.props) === null || _childRef$current4$pr === void 0 ? void 0 : _childRef$current4$pr.resetFunc;\n\n    var updatedDefaultValues = _objectSpread({}, utils.form.getInitialValues(fields));\n\n    setDefaultValues(updatedDefaultValues);\n\n    if (utils.generic.isFunction(reset)) {\n      reset(updatedDefaultValues, {\n        keepDirty: false\n      });\n    }\n  }, [instruction] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  var handleUploadedDocument = function handleUploadedDocument(data, documentTypeKey) {\n    var _data$data;\n\n    var newFiles = data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.documentDto;\n    if (!utils.generic.isValidArray(newFiles)) return;\n    var newGxbDocs = newFiles.map(function (file) {\n      return _objectSpread(_objectSpread({}, file), {}, {\n        folderUuid: file === null || file === void 0 ? void 0 : file.folderUid,\n        name: file === null || file === void 0 ? void 0 : file.documentName,\n        path: file === null || file === void 0 ? void 0 : file.documentPath,\n        source: file === null || file === void 0 ? void 0 : file.documentSource,\n        typeId: file === null || file === void 0 ? void 0 : file.documentTypeId,\n        uuid: file === null || file === void 0 ? void 0 : file.documentUid\n      });\n    });\n\n    var updatedDocuments = _objectSpread(_objectSpread(_objectSpread({}, documents), documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.type.piPremiumCalculation && {\n      premiumTaxDocument: newGxbDocs[0]\n    }), documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.type.piMarketSigned && {\n      signedLinesDocument: newGxbDocs[0]\n    });\n\n    dispatch(storeProcessingInstructionDocuments(updatedDocuments));\n  };\n\n  var uploadPremiumTaxSignedLinesModal = function uploadPremiumTaxSignedLinesModal(documentTypeKey) {\n    return function (files) {\n      dispatch(addLoader('DmsUploadFiles'));\n      dispatch(showModal({\n        component: 'DMS_UPLOAD_FILES',\n        props: {\n          fullWidth: true,\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\n          maxWidth: 'xl',\n          componentProps: {\n            files: files,\n            context: constants.DMS_CONTEXT_PROCESSING_INSTRUCTION,\n            referenceId: Number(instruction === null || instruction === void 0 ? void 0 : instruction.id),\n            sourceId: Number(selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : selectedRiskRef.xbInstanceId),\n            documentTypeKey: documentTypeKey,\n            postDmsDocumentsSuccess: function postDmsDocumentsSuccess(data) {\n              return handleUploadedDocument(data, documentTypeKey);\n            },\n            confirmLabel: utils.string.t('app.ok'),\n            cancelLabel: utils.string.t('app.goBack'),\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\n            buttonColors: {\n              confirm: 'secondary',\n              cancel: 'primary'\n            }\n          }\n        }\n      }));\n    };\n  };\n\n  var confirmRemoveDocumentModal = function confirmRemoveDocumentModal(file, removeDocumentType) {\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        fullWidth: true,\n        title: utils.string.t('processingInstructions.checklist.warning.title'),\n        maxWidth: 'xs',\n        componentProps: {\n          confirmLabel: utils.string.t('app.yes'),\n          cancelLabel: utils.string.t('app.no'),\n          confirmMessage: utils.string.t('processingInstructions.removeDocumentWarning'),\n          buttonColors: {\n            confirm: 'secondary',\n            cancel: 'primary'\n          },\n          submitHandler: function submitHandler() {\n            dispatch(removePremiumTaxSignedLinesDocument({\n              docIds: file === null || file === void 0 ? void 0 : file.documentId,\n              removeDocumentType: removeDocumentType,\n              documents: documents\n            }));\n          },\n          cancelHandler: function cancelHandler() {},\n          handleClose: function handleClose() {}\n        }\n      }\n    }));\n  };\n\n  var handleLinkDownload = function handleLinkDownload(file) {\n    dispatch(viewDocumentsDownload({\n      documentId: file === null || file === void 0 ? void 0 : file.documentId,\n      documentName: file === null || file === void 0 ? void 0 : file.name\n    }));\n  }; // abort if data is not ready/available\n\n\n  if (!defaultValues || !instruction) return null;\n  return /*#__PURE__*/_jsxDEV(ProcessingInstructionsDetailsView, {\n    instructionId: instruction === null || instruction === void 0 ? void 0 : instruction.id,\n    documents: documents,\n    fields: fields,\n    defaultValues: defaultValues,\n    retainedBrokerageAmount: retainedBrokerageAmount,\n    convertedBrokerage: convertedBrokerage,\n    premiumCurrency: retainedBrokerageCurrencyCode,\n    sumTotal: totalAmount,\n    riskRefId: selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : selectedRiskRef.riskRefId,\n    isEditable: isEditable,\n    isReadOnly: isReadOnly,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      save: handleSave,\n      cancel: handleCancel,\n      getRetainedBrokerageAmount: getRetainedBrokerageAmount,\n      getTotalAmount: getTotalAmount,\n      uploadPremiumTaxSignedLinesModal: uploadPremiumTaxSignedLinesModal,\n      confirmRemoveDocumentModal: confirmRemoveDocumentModal,\n      download: handleLinkDownload\n    }),\n    ref: childRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 595,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProcessingInstructionsDetails, \"P/8Rj0nbszR2Gbdjhj9FoRvjROQ=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector];\n});\n\n_c = ProcessingInstructionsDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProcessingInstructionsDetails\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsDetails/ProcessingInstructionsDetails.js"],"names":["React","useState","useEffect","PropTypes","useDispatch","useSelector","moment","get","ProcessingInstructionsDetailsView","selectUser","showModal","updateProcessingInstruction","removePremiumTaxSignedLinesDocument","storeRetainedBrokerageAmountForPdf","storeTotalAmountForPdf","addLoader","storeProcessingInstructionDocuments","viewDocumentsDownload","constants","utils","config","ProcessingInstructionsDetails","propTypes","instruction","object","isRequired","handlers","shape","back","func","next","childRef","dispatch","user","documents","state","refDataCurrencies","isDraft","processingInstructions","status","statusId","isRejectedDraft","isSubmittedAuthorisedSignatory","isReopened","userHasWritePermission","app","access","feature","userHasApproverAccess","isCheckboxesEditable","isEditable","isReadOnly","paymentBasisOptions","id","code","name","ppwOrPpcOptions","value","toggleOptions","label","string","t","getToggleValue","map","o","includes","fields","type","details","highPriority","muiComponentProps","disabled","frontEndSendDocs","getFinancialField","numberValue","options","buttonGroupProps","exclusive","approvedByAuthorisedSignatory","autoComplete","stringValue","CURRENCY_USD","optionsKey","optionKey","optionLabel","dateValue","outputFormat","placeholder","muiPickerProps","format","ui","date","text","clearable","notes","inputProps","maxLength","multiline","minRows","maxRows","selectedRiskRef","riskReferences","find","r","leadPolicy","retainedBrokerageCurrencyCodeField","form","getFieldProps","defaultValues","setDefaultValues","retainedBrokerageAmount","setRetainedBrokerageAmount","convertedBrokerage","setConvertedBrokerage","totalAmount","setTotalAmount","formValues","current","props","values","retainedBrokerageCurrencyCode","retainedBrokerageCurrencyCodeString","defaultValue","getRetainedBrokerageAmount","grossPremiumAmount","slipOrder","retainedBrokerage","amount","getRetainedBrokerageValue","brokerage","getRetainedBrokerageConvertedValue","retBrokerageAmt","convertedBrokerageAmt","getTotalAmount","clientDiscount","thirdPartyCommissionSharing","pfinternalCommissionSharing","sumValuesArray","generic","getSumOfArray","percent","decimal","handleSave","financialChecklistBlank","types","updatedInstruction","financialChecklist","reduce","acc","valueKey","isThirdPartyString","thirdPartyNumberValue","thirdPartyStringValue","Boolean","isPfInternalString","pfInternalNumberValue","pfInternalStringValue","isDate","isValidDate","isValid","toLowerCase","handleCancel","reset","resetFunc","isFunction","keepDirty","updatedDefaultValues","getInitialValues","handleUploadedDocument","data","documentTypeKey","newFiles","documentDto","isValidArray","newGxbDocs","file","folderUuid","folderUid","documentName","path","documentPath","source","documentSource","typeId","documentTypeId","uuid","documentUid","updatedDocuments","DMS_DOCUMENT_TYPE_SECTION_KEYS","piPremiumCalculation","premiumTaxDocument","piMarketSigned","signedLinesDocument","uploadPremiumTaxSignedLinesModal","files","component","fullWidth","title","maxWidth","componentProps","context","DMS_CONTEXT_PROCESSING_INSTRUCTION","referenceId","Number","sourceId","xbInstanceId","postDmsDocumentsSuccess","confirmLabel","cancelLabel","confirmMessage","buttonColors","confirm","cancel","confirmRemoveDocumentModal","removeDocumentType","submitHandler","docIds","documentId","cancelHandler","handleClose","handleLinkDownload","riskRefId","save","download"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport moment from 'moment';\r\nimport get from 'lodash/get';\r\n\r\n// app\r\nimport ProcessingInstructionsDetailsView from './ProcessingInstructionsDetails.view';\r\nimport {\r\n  selectUser,\r\n  showModal,\r\n  updateProcessingInstruction,\r\n  removePremiumTaxSignedLinesDocument,\r\n  storeRetainedBrokerageAmountForPdf,\r\n  storeTotalAmountForPdf,\r\n  addLoader,\r\n  storeProcessingInstructionDocuments,\r\n  viewDocumentsDownload,\r\n} from 'stores';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\nProcessingInstructionsDetails.propTypes = {\r\n  instruction: PropTypes.object.isRequired,\r\n  handlers: PropTypes.shape({\r\n    back: PropTypes.func.isRequired,\r\n    next: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nexport default function ProcessingInstructionsDetails({ instruction, handlers, childRef }) {\r\n  const dispatch = useDispatch();\r\n\r\n  const user = useSelector(selectUser);\r\n  const documents = useSelector((state) => get(state, 'processingInstructions.documents')) || {};\r\n  const refDataCurrencies = useSelector((state) => get(state, 'referenceData.currencyCodes')) || [];\r\n  const isDraft = utils.processingInstructions.status.isDraft(instruction?.statusId);\r\n  const isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction?.statusId);\r\n  const isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction?.statusId);\r\n  const isReopened = utils.processingInstructions.status.isReopened(instruction?.statusId);\r\n  const userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\r\n  const userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\r\n  const isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\r\n\r\n  const isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\r\n  const isReadOnly = !isEditable;\r\n\r\n  const paymentBasisOptions = [\r\n    { id: '1', code: 'cash', name: 'Cash' },\r\n    { id: '2', code: 'quaterly', name: 'Quaterly' },\r\n    { id: '3', code: 'otherDeferred', name: 'Other Deferred' },\r\n  ];\r\n\r\n  const ppwOrPpcOptions = [\r\n    { id: '1', code: 'ppw', name: 'PPW', value: 1 },\r\n    { id: '2', code: 'ppc', name: 'PPC', value: 2 },\r\n    { id: '3', code: 'na', name: 'N/A', value: 3 },\r\n  ];\r\n\r\n  const toggleOptions = [\r\n    { label: utils.string.t('app.yes'), value: 1 },\r\n    { label: utils.string.t('app.no'), value: 0 },\r\n    { label: utils.string.t('app.na'), value: -1 },\r\n  ];\r\n\r\n  const getToggleValue = (value) => {\r\n    return toggleOptions.map((o) => o.value).includes(value) ? value : null;\r\n  };\r\n\r\n  const fields = [\r\n    {\r\n      name: 'highPriority',\r\n      type: 'checkbox',\r\n      value: instruction?.details?.highPriority,\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'frontEndSendDocs',\r\n      type: 'checkbox',\r\n      value: instruction?.details?.frontEndSendDocs,\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'premiumTaxCalculationSheetAttachedNumber',\r\n      type: 'toggle',\r\n      value: getToggleValue(utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')?.numberValue),\r\n      options: toggleOptions,\r\n      buttonGroupProps: {\r\n        exclusive: true,\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'premiumTaxCalculationSheetAttachedCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')\r\n        ?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'signedLinesCalculationSheetAttachedNumber',\r\n      type: 'toggle',\r\n      value: getToggleValue(\r\n        utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')?.numberValue\r\n      ),\r\n      options: toggleOptions,\r\n      buttonGroupProps: {\r\n        exclusive: true,\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'signedLinesCalculationSheetAttachedCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')\r\n        ?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'grossPremiumAmountNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'grossPremiumAmountCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'slipOrderNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'slipOrder')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'slipOrderCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'slipOrder')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'totalBrokerageNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'totalBrokerageCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'clientDiscountNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'clientDiscountCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'thirdPartyNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'thirdPartyString',\r\n      type: 'text',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.stringValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'thirdPartyCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'pfinternalNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'pfinternalString',\r\n      type: 'text',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.stringValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'pfinternalCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'retainedBrokerageNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCurrencyCodeString',\r\n      value:\r\n        utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')?.stringValue || constants.CURRENCY_USD,\r\n      optionsKey: 'premiumCurrency',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCurrencyCodeCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'feesNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'fees')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'feesCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'fees')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'otherDeductionsNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'otherDeductionsCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'settlementCurrencyCodeIdNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')?.numberValue || '',\r\n      options: refDataCurrencies,\r\n      optionKey: 'currencyCodeID',\r\n      optionLabel: 'currencyCd',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'settlementCurrencyCodeIdCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'paymentBasisNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')?.numberValue || '',\r\n      options: paymentBasisOptions,\r\n      optionKey: 'id',\r\n      optionLabel: 'name',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'paymentBasisCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'ppwOrPpcNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.numberValue || '',\r\n      options: ppwOrPpcOptions,\r\n      optionKey: 'value',\r\n      optionLabel: 'name',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'ppwOrPpcDate',\r\n      type: 'datepicker',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.dateValue\r\n        ? moment(utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.dateValue)\r\n        : null,\r\n      outputFormat: 'iso',\r\n      placeholder: utils.string.t('app.selectDate'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n      muiPickerProps: {\r\n        format: config.ui.format.date.text,\r\n        clearable: true,\r\n      },\r\n    },\r\n    {\r\n      name: 'ppwOrPpcCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'notes',\r\n      label: utils.string.t('processingInstructions.details.notes'),\r\n      type: 'textarea',\r\n      value: instruction?.details?.notes || '',\r\n      muiComponentProps: {\r\n        inputProps: { maxLength: 4000 },\r\n        multiline: true,\r\n        minRows: 4,\r\n        maxRows: 8,\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n  ];\r\n\r\n  const selectedRiskRef = instruction?.riskReferences?.find((r) => r.leadPolicy);\r\n  const retainedBrokerageCurrencyCodeField = utils.form.getFieldProps(fields, 'retainedBrokerageCurrencyCodeString');\r\n\r\n  const [defaultValues, setDefaultValues] = useState();\r\n  const [retainedBrokerageAmount, setRetainedBrokerageAmount] = useState('');\r\n  const [convertedBrokerage, setConvertedBrokerage] = useState();\r\n  const [totalAmount, setTotalAmount] = useState('');\r\n\r\n  const formValues = childRef?.current?.props?.values;\r\n  const retainedBrokerageCurrencyCode =\r\n    formValues?.retainedBrokerageCurrencyCodeString ||\r\n    retainedBrokerageCurrencyCodeField?.defaultValue ||\r\n    retainedBrokerageCurrencyCodeField?.value;\r\n\r\n  const getRetainedBrokerageAmount = ({\r\n    grossPremiumAmount,\r\n    slipOrder,\r\n    retainedBrokerage,\r\n    retainedBrokerageCurrencyCode,\r\n    retainedBrokerageAmount,\r\n  }) => {\r\n    const amount = utils.processingInstructions.getRetainedBrokerageValue(grossPremiumAmount, slipOrder, retainedBrokerage);\r\n    const brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(\r\n      retainedBrokerageCurrencyCode,\r\n      retainedBrokerageAmount\r\n    );\r\n\r\n    setRetainedBrokerageAmount(amount);\r\n    setConvertedBrokerage(brokerage);\r\n    dispatch(\r\n      storeRetainedBrokerageAmountForPdf({\r\n        retBrokerageAmt: amount,\r\n        convertedBrokerageAmt: brokerage,\r\n      })\r\n    );\r\n  };\r\n\r\n  const getTotalAmount = ({ clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage }) => {\r\n    if (clientDiscount && thirdPartyCommissionSharing && pfinternalCommissionSharing && retainedBrokerage) {\r\n      const sumValuesArray = [clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage];\r\n\r\n      setTotalAmount(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal));\r\n      dispatch(storeTotalAmountForPdf(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal)));\r\n    } else {\r\n      setTotalAmount('');\r\n    }\r\n  };\r\n\r\n  const handleSave = () => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n\r\n    const financialChecklistBlank = [\r\n      { name: 'signedLinesCalculationSheetAttached', types: ['Number'] },\r\n      { name: 'premiumTaxCalculationSheetAttached', types: ['Number'] },\r\n      { name: 'grossPremiumAmount', types: ['Number'] },\r\n      { name: 'slipOrder', types: ['Number'] },\r\n      { name: 'totalBrokerage', types: ['Number'] },\r\n      { name: 'fees', types: ['Number'] },\r\n      { name: 'otherDeductions', types: ['Number'] },\r\n      { name: 'settlementCurrencyCodeId', types: ['Number'] },\r\n      { name: 'paymentBasis', types: ['Number'] },\r\n      { name: 'ppwOrPpc', types: ['Number', 'Date'] },\r\n      { name: 'clientDiscount', types: ['Number'] },\r\n      { name: 'thirdParty', types: ['Number', 'String'] },\r\n      { name: 'pfinternal', types: ['Number', 'String'] },\r\n      { name: 'retainedBrokerage', types: ['Number'] },\r\n      { name: 'retainedBrokerageCurrencyCode', types: ['String'] },\r\n    ];\r\n\r\n    const updatedInstruction = {\r\n      ...instruction,\r\n      details: {\r\n        ...instruction.details,\r\n        highPriority: formValues.highPriority,\r\n        frontEndSendDocs: formValues.frontEndSendDocs,\r\n        notes: formValues.notes,\r\n        retainedBrokerageCurrencyCode,\r\n      },\r\n      financialChecklist: financialChecklistBlank.map(({ name, types }) => {\r\n        return types.reduce(\r\n          (acc, type) => {\r\n            const valueKey = `${name}${type}`;\r\n\r\n            const isThirdPartyString = valueKey === 'thirdPartyString';\r\n            const thirdPartyNumberValue = formValues['thirdPartyNumber'];\r\n            const thirdPartyStringValue = Boolean(thirdPartyNumberValue) ? formValues[valueKey] : '';\r\n\r\n            const isPfInternalString = valueKey === 'pfinternalString';\r\n            const pfInternalNumberValue = formValues['pfinternalNumber'];\r\n            const pfInternalStringValue = Boolean(pfInternalNumberValue) ? formValues[valueKey] : '';\r\n\r\n            const value = isThirdPartyString ? thirdPartyStringValue : isPfInternalString ? pfInternalStringValue : formValues[valueKey];\r\n            const isDate = type === 'Date';\r\n            const isValidDate = isDate && moment(value).isValid();\r\n\r\n            return {\r\n              ...acc,\r\n              [`${type.toLowerCase()}Value`]: isDate ? (isValidDate ? moment(value).format('YYYY-MM-DD') : '') : value,\r\n              approvedByAuthorisedSignatory: formValues[`${name}Checkbox`],\r\n            };\r\n          },\r\n          { name }\r\n        );\r\n      }),\r\n    };\r\n\r\n    dispatch(updateProcessingInstruction(updatedInstruction, formValues));\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    const reset = childRef?.current?.props?.resetFunc;\r\n\r\n    if (utils.generic.isFunction(reset)) {\r\n      reset(defaultValues, { keepDirty: false });\r\n    }\r\n  };\r\n\r\n  useEffect(\r\n    () => {\r\n      const reset = childRef?.current?.props?.resetFunc;\r\n      const updatedDefaultValues = {\r\n        ...utils.form.getInitialValues(fields),\r\n      };\r\n\r\n      setDefaultValues(updatedDefaultValues);\r\n\r\n      if (utils.generic.isFunction(reset)) {\r\n        reset(updatedDefaultValues, {\r\n          keepDirty: false,\r\n        });\r\n      }\r\n    },\r\n    [instruction] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  const handleUploadedDocument = (data, documentTypeKey) => {\r\n    const newFiles = data?.data?.documentDto;\r\n    if (!utils.generic.isValidArray(newFiles)) return;\r\n    const newGxbDocs = newFiles.map((file) => {\r\n      return {\r\n        ...file,\r\n        folderUuid: file?.folderUid,\r\n        name: file?.documentName,\r\n        path: file?.documentPath,\r\n        source: file?.documentSource,\r\n        typeId: file?.documentTypeId,\r\n        uuid: file?.documentUid,\r\n      };\r\n    });\r\n\r\n    const updatedDocuments = {\r\n      ...documents,\r\n      ...(documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.type.piPremiumCalculation && {\r\n        premiumTaxDocument: newGxbDocs[0],\r\n      }),\r\n      ...(documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.type.piMarketSigned && {\r\n        signedLinesDocument: newGxbDocs[0],\r\n      }),\r\n    };\r\n    dispatch(storeProcessingInstructionDocuments(updatedDocuments));\r\n  };\r\n\r\n  const uploadPremiumTaxSignedLinesModal = (documentTypeKey) => (files) => {\r\n\r\n    dispatch(addLoader('DmsUploadFiles'));\r\n\r\n    dispatch(\r\n      showModal({\r\n        component: 'DMS_UPLOAD_FILES',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\r\n          maxWidth: 'xl',\r\n          componentProps: {\r\n            files,\r\n            context: constants.DMS_CONTEXT_PROCESSING_INSTRUCTION,\r\n            referenceId: Number(instruction?.id),\r\n            sourceId: Number(selectedRiskRef?.xbInstanceId),\r\n            documentTypeKey,\r\n            postDmsDocumentsSuccess: (data) => handleUploadedDocument(data, documentTypeKey),\r\n            confirmLabel: utils.string.t('app.ok'),\r\n            cancelLabel: utils.string.t('app.goBack'),\r\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const confirmRemoveDocumentModal = (file, removeDocumentType) => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('processingInstructions.checklist.warning.title'),\r\n          maxWidth: 'xs',\r\n          componentProps: {\r\n            confirmLabel: utils.string.t('app.yes'),\r\n            cancelLabel: utils.string.t('app.no'),\r\n            confirmMessage: utils.string.t('processingInstructions.removeDocumentWarning'),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n            submitHandler: () => {\r\n              dispatch(removePremiumTaxSignedLinesDocument({ docIds: file?.documentId, removeDocumentType, documents }));\r\n            },\r\n            cancelHandler: () => { },\r\n            handleClose: () => { },\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleLinkDownload = (file) => {\r\n    dispatch(viewDocumentsDownload({ documentId: file?.documentId, documentName: file?.name }));\r\n  };\r\n\r\n  // abort if data is not ready/available\r\n  if (!defaultValues || !instruction) return null;\r\n\r\n  return (\r\n    <ProcessingInstructionsDetailsView\r\n      instructionId={instruction?.id}\r\n      documents={documents}\r\n      fields={fields}\r\n      defaultValues={defaultValues}\r\n      retainedBrokerageAmount={retainedBrokerageAmount}\r\n      convertedBrokerage={convertedBrokerage}\r\n      premiumCurrency={retainedBrokerageCurrencyCode}\r\n      sumTotal={totalAmount}\r\n      riskRefId={selectedRiskRef?.riskRefId}\r\n      isEditable={isEditable}\r\n      isReadOnly={isReadOnly}\r\n      handlers={{\r\n        ...handlers,\r\n        save: handleSave,\r\n        cancel: handleCancel,\r\n        getRetainedBrokerageAmount,\r\n        getTotalAmount,\r\n        uploadPremiumTaxSignedLinesModal,\r\n        confirmRemoveDocumentModal,\r\n        download: handleLinkDownload,\r\n      }}\r\n      ref={childRef}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}