{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\PremiumProcessingCaseRFI\\\\PremiumProcessingCaseRFI.js\",\n    _s = $RefreshSig$();\n\nimport { React, useState, useRef, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory, useParams } from 'react-router';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport get from 'lodash/get'; // app\n\nimport styles from './PremiumProcessingCaseRFI.styles';\nimport PremiumProcessingCaseRFIView from './PremiumProcessingCaseRFI.view';\nimport { getCaseRfiSubTabData, selectcaseRfiSubTabs, selectUser, selectCaseRfiDetails, hideModal, getCaseRFIDetails, selectUserEmail, selectUsersInRoles, getUsersForRole, selectRfiHistory, getViewTableDocuments, selectUserRole } from 'stores';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport config from 'config'; // mui\n\nimport { makeStyles } from '@material-ui/core';\nimport FiberManualRecordIcon from '@material-ui/icons/FiberManualRecord';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nPremiumProcessingCaseRFI.propTypes = {\n  taskId: PropTypes.string.isRequired,\n  caseId: PropTypes.string.isRequired,\n  caseDetailsObject: PropTypes.object.isRequired,\n  isPageDirty: PropTypes.bool.isRequired,\n  handlers: PropTypes.shape({\n    setIsPageDirty: PropTypes.func.isRequired,\n    confirmNavigation: PropTypes.func.isRequired\n  })\n};\n\nfunction PremiumProcessingCaseRFI(_ref) {\n  _s();\n\n  var _params$subtab,\n      _this = this;\n\n  var taskId = _ref.taskId,\n      caseId = _ref.caseId,\n      caseDetailsObject = _ref.caseDetailsObject,\n      isPageDirty = _ref.isPageDirty,\n      handlers = _ref.handlers;\n  var classes = makeStyles(styles, {\n    name: 'PremiumProcessingCaseRFI'\n  })();\n  var dispatch = useDispatch();\n  var params = useParams();\n  var history = useHistory();\n  var isNewRfiUsersFetched = useRef(false);\n  var rfiSubTabs = useSelector(selectcaseRfiSubTabs);\n  var caseRfiDetails = useSelector(selectCaseRfiDetails);\n  var userEmail = useSelector(selectUserEmail);\n  var newRfiUsers = useSelector(selectUsersInRoles);\n  var user = useSelector(selectUser);\n  var caseRfiHistory = useSelector(selectRfiHistory);\n  var currentUser = useSelector(selectUserRole);\n  var rfiCaseId = caseRfiDetails === null || caseRfiDetails === void 0 ? void 0 : caseRfiDetails.caseId;\n  var isWorklist = (caseDetailsObject === null || caseDetailsObject === void 0 ? void 0 : caseDetailsObject.taskView) === constants.WORKLIST;\n  var hasRfiTabPermission = utils.app.access.feature('premiumProcessing.RFITab', ['read'], user);\n  var newRfiTab = {\n    value: constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\n    label: utils.string.t('premiumProcessing.rfi.newRfi')\n  };\n  var isHistoryCases = (caseDetailsObject === null || caseDetailsObject === void 0 ? void 0 : caseDetailsObject.taskView) === constants.ALL_CASES;\n  var isFrontEndContact = utils.generic.isValidArray(currentUser, true) && currentUser.some(function (item) {\n    return [constants.FRONT_END_CONTACT.toLowerCase()].includes(item.name.toLowerCase());\n  });\n  var isSeniorManager = utils.generic.isValidArray(currentUser, true) && currentUser.some(function (item) {\n    return [constants.SENIOR_MANAGER.toLowerCase()].includes(item.name.toLowerCase());\n  });\n  var isOperationsLead = utils.generic.isValidArray(currentUser, true) && currentUser.some(function (item) {\n    return [constants.OPERATIONS_LEAD.toLowerCase()].includes(item.name.toLowerCase());\n  });\n  var notificationObj = useSelector(function (state) {\n    return get(state, 'notifications.notificationList');\n  });\n  var paramsRfiTab = params === null || params === void 0 ? void 0 : (_params$subtab = params.subtab) === null || _params$subtab === void 0 ? void 0 : _params$subtab.toString();\n  var isValidTab = rfiSubTabs.map(function (tab) {\n    return tab.taskId;\n  }).includes(paramsRfiTab);\n\n  var _useState = useState({\n    id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\n    status: ''\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedTab = _useState2[0],\n      setSelectedTab = _useState2[1];\n\n  var subTabs = rfiSubTabs === null || rfiSubTabs === void 0 ? void 0 : rfiSubTabs.map(function (tab) {\n    var _classnames;\n\n    return {\n      value: tab.taskId,\n      label: utils.string.t('premiumProcessing.rfi.tabName', {\n        type: tab.rfiType,\n        id: tab.queryId\n      }),\n      subLabel: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(FiberManualRecordIcon, {\n          className: classnames((_classnames = {}, _defineProperty(_classnames, classes.status, true), _defineProperty(_classnames, classes.open, tab.status === constants.RFI_STATUS.OPEN), _defineProperty(_classnames, classes.responseReceived, tab.status === constants.RFI_STATUS.RESPONSE_RECEIVED), _defineProperty(_classnames, classes.resolved, tab.status === constants.RFI_STATUS.RESOLVED), _classnames))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, _this), tab.status]\n      }, void 0, true)\n    };\n  });\n  useEffect(function () {\n    if (caseId || rfiCaseId) {\n      var caseIdData = caseId || rfiCaseId;\n      dispatch(getCaseRfiSubTabData(caseIdData));\n    }\n  }, [dispatch, caseId, rfiCaseId, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    var _rfiSubTabs$find;\n\n    var selectedTabStatus = utils.generic.isValidArray(rfiSubTabs) ? ((_rfiSubTabs$find = rfiSubTabs.find(function (tab) {\n      var _tab$taskId;\n\n      return ((_tab$taskId = tab.taskId) === null || _tab$taskId === void 0 ? void 0 : _tab$taskId.toString()) === (paramsRfiTab === null || paramsRfiTab === void 0 ? void 0 : paramsRfiTab.toString());\n    })) === null || _rfiSubTabs$find === void 0 ? void 0 : _rfiSubTabs$find.status) || '' : '';\n    setSelectedTab({\n      id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\n      status: selectedTabStatus\n    });\n  }, [rfiSubTabs]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (paramsRfiTab && paramsRfiTab !== constants.PREMIUM_PROCESSING_TAB_NEW_RFI) {\n      dispatch(getCaseRFIDetails({\n        taskId: paramsRfiTab\n      })).then(function (res) {\n        if (res === null || res === void 0 ? void 0 : res.taskId) {\n          setSelectedTab({\n            id: res.taskId,\n            status: res.status\n          });\n        }\n      });\n    }\n  }, [paramsRfiTab, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (!isNewRfiUsersFetched.current) {\n      dispatch(getUsersForRole([constants.FRONT_END_CONTACT, constants.OPERATIONS_LEAD])).then(function (res) {\n        if (utils.generic.isValidArray(res, true)) {\n          isNewRfiUsersFetched.current = true;\n        }\n      });\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var switchTab = function switchTab(newTab) {\n    setSelectedTab({\n      id: newTab,\n      status: ''\n    });\n    handlers.setIsPageDirty(false);\n\n    if (newTab === constants.PREMIUM_PROCESSING_TAB_NEW_RFI) {\n      rfiDocumentAttached();\n    }\n\n    history.replace(\"\".concat(config.routes.premiumProcessing.case, \"/\").concat(taskId, \"/\").concat(constants.PREMIUM_PROCESSING_TAB_RFI, \"/\").concat(newTab));\n    dispatch(hideModal('CONFIRM'));\n    return;\n  };\n\n  var rfiDocumentAttached = function rfiDocumentAttached() {\n    var paramsData = {\n      referenceId: caseDetailsObject === null || caseDetailsObject === void 0 ? void 0 : caseDetailsObject.caseId,\n      sectionType: constants.DMS_CONTEXT_CASE,\n      instructionId: caseDetailsObject === null || caseDetailsObject === void 0 ? void 0 : caseDetailsObject.instructionId,\n      policyRef: caseDetailsObject === null || caseDetailsObject === void 0 ? void 0 : caseDetailsObject.policyRef\n    };\n    dispatch(getViewTableDocuments(paramsData));\n  };\n\n  var stayOnTab = function stayOnTab() {\n    dispatch(hideModal('CONFIRM'));\n    return;\n  };\n\n  var selectTab = function selectTab(tabName) {\n    if (tabName === (selectedTab === null || selectedTab === void 0 ? void 0 : selectedTab.id)) return;\n\n    if (isPageDirty) {\n      handlers.confirmNavigation(function () {\n        return switchTab(tabName);\n      }, stayOnTab);\n      return;\n    } else {\n      switchTab(tabName);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(PremiumProcessingCaseRFIView, {\n    hasRfiTabPermission: hasRfiTabPermission,\n    caseDetails: caseDetailsObject,\n    rfiDetails: caseRfiDetails,\n    newRfiUsers: newRfiUsers,\n    subTabs: isHistoryCases || isFrontEndContact || isSeniorManager || isOperationsLead ? _toConsumableArray(subTabs) : [newRfiTab].concat(_toConsumableArray(subTabs)),\n    selectedSubTab: selectedTab,\n    isCreatedByLoginUser: caseRfiDetails.createdByEmail === userEmail,\n    isPageDirty: isPageDirty,\n    isWorklist: isWorklist,\n    isHistoryCases: isHistoryCases,\n    isFrontEndContact: isFrontEndContact,\n    isSeniorManager: isSeniorManager,\n    isOperationsLead: isOperationsLead,\n    notificationObj: notificationObj,\n    loggedInUserEmail: userEmail,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      selectTab: selectTab,\n      switchTab: switchTab,\n      stayOnTab: stayOnTab\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PremiumProcessingCaseRFI, \"LnAoPzSnmUHzlpilAiG/Yj+KqcM=\", false, function () {\n  return [useDispatch, useParams, useHistory, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PremiumProcessingCaseRFI;\nexport default PremiumProcessingCaseRFI;\n\nvar _c;\n\n$RefreshReg$(_c, \"PremiumProcessingCaseRFI\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/PremiumProcessingCaseRFI/PremiumProcessingCaseRFI.js"],"names":["React","useState","useRef","useEffect","useDispatch","useSelector","useHistory","useParams","PropTypes","classnames","get","styles","PremiumProcessingCaseRFIView","getCaseRfiSubTabData","selectcaseRfiSubTabs","selectUser","selectCaseRfiDetails","hideModal","getCaseRFIDetails","selectUserEmail","selectUsersInRoles","getUsersForRole","selectRfiHistory","getViewTableDocuments","selectUserRole","constants","utils","config","makeStyles","FiberManualRecordIcon","PremiumProcessingCaseRFI","propTypes","taskId","string","isRequired","caseId","caseDetailsObject","object","isPageDirty","bool","handlers","shape","setIsPageDirty","func","confirmNavigation","classes","name","dispatch","params","history","isNewRfiUsersFetched","rfiSubTabs","caseRfiDetails","userEmail","newRfiUsers","user","caseRfiHistory","currentUser","rfiCaseId","isWorklist","taskView","WORKLIST","hasRfiTabPermission","app","access","feature","newRfiTab","value","PREMIUM_PROCESSING_TAB_NEW_RFI","label","t","isHistoryCases","ALL_CASES","isFrontEndContact","generic","isValidArray","some","item","FRONT_END_CONTACT","toLowerCase","includes","isSeniorManager","SENIOR_MANAGER","isOperationsLead","OPERATIONS_LEAD","notificationObj","state","paramsRfiTab","subtab","toString","isValidTab","map","tab","id","status","selectedTab","setSelectedTab","subTabs","type","rfiType","queryId","subLabel","open","RFI_STATUS","OPEN","responseReceived","RESPONSE_RECEIVED","resolved","RESOLVED","caseIdData","selectedTabStatus","find","then","res","current","switchTab","newTab","rfiDocumentAttached","replace","routes","premiumProcessing","case","PREMIUM_PROCESSING_TAB_RFI","paramsData","referenceId","sectionType","DMS_CONTEXT_CASE","instructionId","policyRef","stayOnTab","selectTab","tabName","createdByEmail"],"mappings":"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","sourcesContent":["import { React, useState, useRef, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport PropTypes from 'prop-types';\r\nimport classnames from 'classnames';\r\nimport get from 'lodash/get';\r\n\r\n// app\r\nimport styles from './PremiumProcessingCaseRFI.styles';\r\nimport PremiumProcessingCaseRFIView from './PremiumProcessingCaseRFI.view';\r\nimport {\r\n  getCaseRfiSubTabData,\r\n  selectcaseRfiSubTabs,\r\n  selectUser,\r\n  selectCaseRfiDetails,\r\n  hideModal,\r\n  getCaseRFIDetails,\r\n  selectUserEmail,\r\n  selectUsersInRoles,\r\n  getUsersForRole,\r\n  selectRfiHistory,\r\n  getViewTableDocuments,\r\n  selectUserRole\r\n} from 'stores';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\n// mui\r\nimport { makeStyles } from '@material-ui/core';\r\nimport FiberManualRecordIcon from '@material-ui/icons/FiberManualRecord';\r\n\r\nPremiumProcessingCaseRFI.propTypes = {\r\n  taskId: PropTypes.string.isRequired,\r\n  caseId: PropTypes.string.isRequired,\r\n  caseDetailsObject: PropTypes.object.isRequired,\r\n  isPageDirty: PropTypes.bool.isRequired,\r\n  handlers: PropTypes.shape({\r\n    setIsPageDirty: PropTypes.func.isRequired,\r\n    confirmNavigation: PropTypes.func.isRequired,\r\n  }),\r\n};\r\nfunction PremiumProcessingCaseRFI({ taskId, caseId, caseDetailsObject, isPageDirty, handlers }) {\r\n  const classes = makeStyles(styles, { name: 'PremiumProcessingCaseRFI' })();\r\n\r\n  const dispatch = useDispatch();\r\n  const params = useParams();\r\n  const history = useHistory();\r\n\r\n  const isNewRfiUsersFetched = useRef(false);\r\n  const rfiSubTabs = useSelector(selectcaseRfiSubTabs);\r\n  const caseRfiDetails = useSelector(selectCaseRfiDetails);\r\n  const userEmail = useSelector(selectUserEmail);\r\n  const newRfiUsers = useSelector(selectUsersInRoles);\r\n  const user = useSelector(selectUser);\r\n  const caseRfiHistory = useSelector(selectRfiHistory);\r\n  const currentUser = useSelector(selectUserRole);\r\n  const rfiCaseId = caseRfiDetails?.caseId;\r\n  const isWorklist = caseDetailsObject?.taskView === constants.WORKLIST;\r\n  const hasRfiTabPermission = utils.app.access.feature('premiumProcessing.RFITab', ['read'], user);\r\n  const newRfiTab = {\r\n    value: constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\r\n    label: utils.string.t('premiumProcessing.rfi.newRfi'),\r\n  };\r\n  const isHistoryCases = caseDetailsObject?.taskView === constants.ALL_CASES;\r\n  const isFrontEndContact =\r\n  utils.generic.isValidArray(currentUser, true) &&\r\n  currentUser.some((item) => [constants.FRONT_END_CONTACT.toLowerCase()].includes(item.name.toLowerCase()));\r\n  const isSeniorManager =\r\n  utils.generic.isValidArray(currentUser, true) &&\r\n  currentUser.some((item) => [constants.SENIOR_MANAGER.toLowerCase()].includes(item.name.toLowerCase()));\r\n  const isOperationsLead =\r\n  utils.generic.isValidArray(currentUser, true) &&\r\n  currentUser.some((item) => [constants.OPERATIONS_LEAD.toLowerCase()].includes(item.name.toLowerCase()));\r\n  const notificationObj = useSelector((state) => get(state, 'notifications.notificationList'));\r\n  const paramsRfiTab = params?.subtab?.toString();\r\n  const isValidTab = rfiSubTabs.map((tab) => tab.taskId).includes(paramsRfiTab);\r\n  const [selectedTab, setSelectedTab] = useState({ id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI, status: '' });\r\n  const subTabs = rfiSubTabs?.map((tab) => {\r\n    return {\r\n      value: tab.taskId,\r\n      label: utils.string.t('premiumProcessing.rfi.tabName', { type: tab.rfiType, id: tab.queryId }),\r\n      subLabel: (\r\n        <>\r\n          <FiberManualRecordIcon\r\n            className={classnames({\r\n              [classes.status]: true,\r\n              [classes.open]: tab.status === constants.RFI_STATUS.OPEN,\r\n              [classes.responseReceived]: tab.status === constants.RFI_STATUS.RESPONSE_RECEIVED,\r\n              [classes.resolved]: tab.status === constants.RFI_STATUS.RESOLVED,\r\n            })}\r\n          />\r\n          {tab.status}\r\n        </>\r\n      ),\r\n    };\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (caseId || rfiCaseId) {\r\n      const caseIdData = caseId || rfiCaseId;\r\n      dispatch(getCaseRfiSubTabData(caseIdData));\r\n    }\r\n  }, [dispatch, caseId, rfiCaseId, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    const selectedTabStatus = utils.generic.isValidArray(rfiSubTabs)\r\n      ? rfiSubTabs.find((tab) => tab.taskId?.toString() === paramsRfiTab?.toString())?.status || ''\r\n      : '';\r\n\r\n    setSelectedTab({ id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI, status: selectedTabStatus });\r\n  }, [rfiSubTabs]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (paramsRfiTab && paramsRfiTab !== constants.PREMIUM_PROCESSING_TAB_NEW_RFI) {\r\n      dispatch(getCaseRFIDetails({ taskId: paramsRfiTab })).then((res) => {\r\n        if (res?.taskId) {\r\n          setSelectedTab({ id: res.taskId, status: res.status });\r\n        }\r\n      });\r\n    }\r\n  }, [paramsRfiTab, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (!isNewRfiUsersFetched.current) {\r\n      dispatch(getUsersForRole([constants.FRONT_END_CONTACT, constants.OPERATIONS_LEAD])).then((res) => {\r\n        if (utils.generic.isValidArray(res, true)) {\r\n          isNewRfiUsersFetched.current = true;\r\n        }\r\n      });\r\n    }\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const switchTab = (newTab) => {\r\n    setSelectedTab({ id: newTab, status: '' });\r\n    handlers.setIsPageDirty(false);\r\n    if (newTab === constants.PREMIUM_PROCESSING_TAB_NEW_RFI) {\r\n      rfiDocumentAttached();\r\n    }\r\n    history.replace(`${config.routes.premiumProcessing.case}/${taskId}/${constants.PREMIUM_PROCESSING_TAB_RFI}/${newTab}`);\r\n    dispatch(hideModal('CONFIRM'));\r\n    return;\r\n  };\r\n\r\n  const rfiDocumentAttached = () => {\r\n    const paramsData = {\r\n      referenceId: caseDetailsObject?.caseId,\r\n      sectionType: constants.DMS_CONTEXT_CASE,\r\n      instructionId: caseDetailsObject?.instructionId,\r\n      policyRef: caseDetailsObject?.policyRef,\r\n    };\r\n    dispatch(getViewTableDocuments(paramsData));\r\n  };\r\n\r\n  const stayOnTab = () => {\r\n    dispatch(hideModal('CONFIRM'));\r\n    return;\r\n  };\r\n\r\n  const selectTab = (tabName) => {\r\n    if (tabName === selectedTab?.id) return;\r\n    if (isPageDirty) {\r\n      handlers.confirmNavigation(() => switchTab(tabName), stayOnTab);\r\n      return;\r\n    } else {\r\n      switchTab(tabName);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <PremiumProcessingCaseRFIView\r\n      hasRfiTabPermission={hasRfiTabPermission}\r\n      caseDetails={caseDetailsObject}\r\n      rfiDetails={caseRfiDetails}\r\n      newRfiUsers={newRfiUsers}\r\n      subTabs={isHistoryCases || isFrontEndContact || isSeniorManager || isOperationsLead ? [...subTabs] : [newRfiTab, ...subTabs]}\r\n      selectedSubTab={selectedTab}\r\n      isCreatedByLoginUser={caseRfiDetails.createdByEmail === userEmail}\r\n      isPageDirty={isPageDirty}\r\n      isWorklist={isWorklist}\r\n      isHistoryCases={isHistoryCases}\r\n      isFrontEndContact={isFrontEndContact}\r\n      isSeniorManager={isSeniorManager}\r\n      isOperationsLead={isOperationsLead}\r\n      notificationObj={notificationObj}\r\n      loggedInUserEmail={userEmail}\r\n      handlers={{ ...handlers, selectTab, switchTab, stayOnTab }}\r\n    />\r\n  );\r\n}\r\nexport default PremiumProcessingCaseRFI;\r\n"]},"metadata":{},"sourceType":"module"}