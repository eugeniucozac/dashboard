{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\PremiumProcessingCaseRFIForm\\\\PremiumProcessingCaseRFIForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport * as Yup from 'yup';\nimport sortBy from 'lodash/sortBy';\nimport uniqBy from 'lodash/uniqBy'; // app\n\nimport PremiumProcessingCaseRFIFormView from './PremiumProcessingCaseRFIForm.view';\nimport { getRfiResponseDate, getViewTableDocuments, postSubmitNewRfi, premiumProcessingBureauRFIDetails, selectRefDataResolutionCode, selectCaseIsCheckSigning, selectUserDetails, selectUserGroup, selectorDmsViewFiles, selectRefDataQueryCodes, getDocumentUploaded } from 'stores';\nimport { useConfirmNavigation } from 'hooks';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport config from 'config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nPremiumProcessingCaseRFIForm.propTypes = {\n  caseDetails: PropTypes.object.isRequired,\n  rfiDetails: PropTypes.object,\n  newRfiUsers: PropTypes.array.isRequired,\n  isEditable: PropTypes.bool.isRequired,\n  isPageDirty: PropTypes.bool.isRequired,\n  isWorklist: PropTypes.bool.isRequired,\n  handlers: PropTypes.shape({\n    stayOnTab: PropTypes.func.isRequired,\n    switchTab: PropTypes.func.isRequired,\n    setIsPageDirty: PropTypes.func.isRequired\n  })\n};\nexport default function PremiumProcessingCaseRFIForm(_ref) {\n  _s();\n\n  var _caseDetails$caseStag, _userGroup$, _caseDetails$bureauRf4;\n\n  var _ref$caseDetails = _ref.caseDetails,\n      caseDetails = _ref$caseDetails === void 0 ? {} : _ref$caseDetails,\n      rfiDetails = _ref.rfiDetails,\n      newRfiUsers = _ref.newRfiUsers,\n      isPageDirty = _ref.isPageDirty,\n      isEditable = _ref.isEditable,\n      handlers = _ref.handlers,\n      isWorklist = _ref.isWorklist;\n  var history = useHistory();\n  var dispatch = useDispatch();\n\n  var _useConfirmNavigation = useConfirmNavigation({\n    title: utils.string.t('navigation.form.titleClear'),\n    subtitle: utils.string.t('navigation.form.subtitle')\n  }),\n      confirmNavigation = _useConfirmNavigation.confirmNavigation;\n\n  var isCheckSigning = useSelector(selectCaseIsCheckSigning);\n  var queryCodes = useSelector(selectRefDataQueryCodes);\n  var resolutionCodes = useSelector(selectRefDataResolutionCode);\n  var currentUser = useSelector(selectUserDetails);\n  var userGroup = useSelector(selectUserGroup);\n  var dmsViewFiles = useSelector(selectorDmsViewFiles);\n\n  var _useSelector = useSelector(getDocumentUploaded),\n      documentDto = _useSelector.documentDto;\n\n  var tabDetails = (caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskView) === constants.WORKBASKET || (caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskView) === constants.ALL_CASES;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      responseDate = _useState2[0],\n      setResponseDate = _useState2[1];\n\n  var _useState3 = useState(constants.DMS_VIEW_TAB_VIEW),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedDmsTab = _useState4[0],\n      setSelectedDmsTab = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      selectedDmsFiles = _useState6[0],\n      setSelectedDmsFiles = _useState6[1];\n\n  var isRejectPendingActionStage = caseDetails === null || caseDetails === void 0 ? void 0 : (_caseDetails$caseStag = caseDetails.caseStageDetails) === null || _caseDetails$caseStag === void 0 ? void 0 : _caseDetails$caseStag.some(function (cs) {\n    return [constants.BPM_STAGE_REJECTED_PENDING_ACTION].includes(cs.bpmStageCode) && cs.active;\n  });\n  var queryCodesRfi = utils.generic.isValidArray(queryCodes, true) ? queryCodes.filter(function (queryCode) {\n    return queryCode.rfiTypeID === constants.RFI_TYPE_FOR_QUERY_CODE;\n  }) : [];\n  var caseTeamData = caseDetails.caseTeamData,\n      fecId = caseDetails.fecId,\n      caseId = caseDetails.caseId,\n      instructionId = caseDetails.instructionId,\n      policyRef = caseDetails.policyRef;\n  var queryCodesBureauRfi = utils.generic.isValidArray(queryCodes, true) ? queryCodes.filter(function (queryCode) {\n    return queryCode.rfiTypeID === constants.RFI_TYPE_FOR_BUREAU_QUERY_CODE;\n  }) : [];\n  var resolutionCodesRfi = utils.generic.isValidArray(resolutionCodes, true) ? resolutionCodes.filter(function (resolutionCodes) {\n    return resolutionCodes.rfiTypeID === constants.RFI_TYPE_FOR_BUREAU_RESOLUTION_CODE;\n  }) : [];\n  var caseDepartXbInstanceId = \"\".concat(caseTeamData === null || caseTeamData === void 0 ? void 0 : caseTeamData.departmentId, \"-\").concat(caseTeamData === null || caseTeamData === void 0 ? void 0 : caseTeamData.xbInstanceId); // re-order the list of users\n  // move the FEC who created the RFI to the top of the list\n  // filter only keep users who match the task departmentID and xbIstanceID\n\n  var users = sortBy(newRfiUsers, function (user) {\n    return (user === null || user === void 0 ? void 0 : user.userId) !== fecId;\n  });\n  var usersFiltered = users === null || users === void 0 ? void 0 : users.filter(function (user) {\n    var _user$departmentId;\n\n    return user && (user === null || user === void 0 ? void 0 : (_user$departmentId = user.departmentId) === null || _user$departmentId === void 0 ? void 0 : _user$departmentId.split(', ').includes(caseDepartXbInstanceId));\n  });\n  useEffect(function () {\n    if (caseId) {\n      // if RFI is being created, we fetch all case documents\n      // if RFI is already created, we only fetch the documents linked to the RFI\n      var params = isEditable ? {\n        referenceId: caseId,\n        sectionType: constants.DMS_CONTEXT_CASE,\n        instructionId: instructionId,\n        policyRef: policyRef\n      } : {\n        referenceId: rfiDetails.queryId,\n        sectionType: constants.DMS_CONTEXT_RFI\n      };\n      dispatch(getViewTableDocuments(params));\n    }\n  }, [caseId]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (isCheckSigning) {\n      dispatch(premiumProcessingBureauRFIDetails(caseId));\n    }\n  }, [caseId, isCheckSigning]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    setSelectedDmsFiles(uniqBy([].concat(_toConsumableArray(selectedDmsFiles), _toConsumableArray(documentDto)), 'documentId'));\n  }, [documentDto]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var resetForm = function resetForm(resetFn) {\n    if (utils.generic.isFunction(resetFn)) {\n      resetFn(utils.form.getInitialValues(fields), {\n        keepDirty: false\n      });\n      setResponseDate('');\n    }\n  };\n\n  var handleCancel = function handleCancel(resetFn) {\n    if (isPageDirty) {\n      confirmNavigation(function () {\n        return resetForm(resetFn);\n      });\n    } else {\n      resetForm(resetFn);\n    }\n  };\n\n  var getResponseDate = function getResponseDate(option) {\n    dispatch(getRfiResponseDate({\n      sla: option === null || option === void 0 ? void 0 : option.sla\n    })).then(function (response) {\n      var _response$data;\n\n      var responseDate = (response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.dueDate) ? response.data.dueDate : '';\n      setResponseDate(responseDate);\n    });\n  };\n\n  var selectDmsTab = function selectDmsTab(tabName) {\n    setSelectedDmsTab(tabName);\n  };\n\n  var onSelectDmsFile = function onSelectDmsFile(files) {\n    setSelectedDmsFiles(uniqBy([].concat(_toConsumableArray(selectedDmsFiles), _toConsumableArray(files)), 'documentId'));\n  };\n\n  var currentUserEmail = currentUser.email;\n  var currentUserGroup = userGroup === null || userGroup === void 0 ? void 0 : (_userGroup$ = userGroup[0]) === null || _userGroup$ === void 0 ? void 0 : _userGroup$.code;\n  var actions = [{\n    name: 'cancel',\n    label: utils.string.t('app.cancel'),\n    handler: function handler(reset) {\n      return handleCancel(reset);\n    }\n  }, {\n    name: 'submit',\n    label: isCheckSigning ? utils.string.t('premiumProcessing.resolveRfi.resolveRfi') : utils.string.t('premiumProcessing.rfi.sendRFI'),\n    handler: function handler(reset) {\n      return function (values) {\n        var _values$sendTo, _values$sendTo2, _values$queryCode, _values$queryCode2, _values$sendTo3, _values$sendTo4, _values$sendTo5, _values$sendTo6, _caseDetails$bureauRf, _caseDetails$bureauRf2, _values$queryCodeBure, _values$resolutionCod, _caseDetails$bureauRf3;\n\n        handlers.setIsPageDirty(false);\n\n        var internalRFI = _objectSpread(_objectSpread({\n          caseIncidentId: caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.caseId,\n          parentTaskId: caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskId,\n          parentProcessId: caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.processId,\n          assignedTo: values === null || values === void 0 ? void 0 : (_values$sendTo = values.sendTo) === null || _values$sendTo === void 0 ? void 0 : _values$sendTo.emailId,\n          assignedToTeam: values === null || values === void 0 ? void 0 : (_values$sendTo2 = values.sendTo) === null || _values$sendTo2 === void 0 ? void 0 : _values$sendTo2.groupName,\n          queryDescription: values === null || values === void 0 ? void 0 : values.queryDescription,\n          queryCodeDescription: values === null || values === void 0 ? void 0 : (_values$queryCode = values.queryCode) === null || _values$queryCode === void 0 ? void 0 : _values$queryCode.queryCodeDescription\n        }, responseDate ? {\n          dueDate: moment(responseDate).format('DD-MM-YYYY')\n        } : null), {}, {\n          queryCode: values === null || values === void 0 ? void 0 : (_values$queryCode2 = values.queryCode) === null || _values$queryCode2 === void 0 ? void 0 : _values$queryCode2.queryCodeDetails,\n          taskCategory: values === null || values === void 0 ? void 0 : values.rfiType,\n          documentId: selectedDmsFiles === null || selectedDmsFiles === void 0 ? void 0 : selectedDmsFiles.map(function (doc) {\n            return doc.documentId;\n          })\n        });\n\n        var bureauRFI = {\n          action: values === null || values === void 0 ? void 0 : values.chooseAction,\n          assignedTo: (values === null || values === void 0 ? void 0 : (_values$sendTo3 = values.sendTo) === null || _values$sendTo3 === void 0 ? void 0 : _values$sendTo3.emailId) ? values === null || values === void 0 ? void 0 : (_values$sendTo4 = values.sendTo) === null || _values$sendTo4 === void 0 ? void 0 : _values$sendTo4.emailId : currentUserEmail,\n          assignedToTeam: (values === null || values === void 0 ? void 0 : (_values$sendTo5 = values.sendTo) === null || _values$sendTo5 === void 0 ? void 0 : _values$sendTo5.groupName) ? values === null || values === void 0 ? void 0 : (_values$sendTo6 = values.sendTo) === null || _values$sendTo6 === void 0 ? void 0 : _values$sendTo6.groupName : currentUserGroup,\n          bureauNames: caseDetails === null || caseDetails === void 0 ? void 0 : (_caseDetails$bureauRf = caseDetails.bureauRfiDetails) === null || _caseDetails$bureauRf === void 0 ? void 0 : _caseDetails$bureauRf.bureauName,\n          bureauQuery: values === null || values === void 0 ? void 0 : values.bureauQueryDescription,\n          caseIncidentId: caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.caseId,\n          dueDate: moment(caseDetails === null || caseDetails === void 0 ? void 0 : (_caseDetails$bureauRf2 = caseDetails.bureauRfiDetails) === null || _caseDetails$bureauRf2 === void 0 ? void 0 : _caseDetails$bureauRf2.expectedResponseDate).format('DD-MM-YYYY'),\n          parentTaskId: caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskId,\n          parentProcessId: caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.processId,\n          queryDescription: (values === null || values === void 0 ? void 0 : values.resolutionNotes) ? values === null || values === void 0 ? void 0 : values.resolutionNotes : values === null || values === void 0 ? void 0 : values.resolutionNotesFEC,\n          queryCode: values === null || values === void 0 ? void 0 : (_values$queryCodeBure = values.queryCodeBureau) === null || _values$queryCodeBure === void 0 ? void 0 : _values$queryCodeBure.queryCodeDetails,\n          resolutionCode: values === null || values === void 0 ? void 0 : (_values$resolutionCod = values.resolutionCode) === null || _values$resolutionCod === void 0 ? void 0 : _values$resolutionCod.resolutionCd,\n          workPackageRef: caseDetails === null || caseDetails === void 0 ? void 0 : (_caseDetails$bureauRf3 = caseDetails.bureauRfiDetails) === null || _caseDetails$bureauRf3 === void 0 ? void 0 : _caseDetails$bureauRf3.workPackageReference,\n          taskCategory: 'ExternalRFI',\n          documentId: selectedDmsFiles === null || selectedDmsFiles === void 0 ? void 0 : selectedDmsFiles.map(function (doc) {\n            return doc.documentId;\n          })\n        };\n        var payload = isCheckSigning ? bureauRFI : internalRFI;\n        dispatch(postSubmitNewRfi(payload)).then(function (response) {\n          var _response$data2;\n\n          // success POST\n          if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK && (response === null || response === void 0 ? void 0 : (_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.id)) {\n            reset(isCheckSigning ? {\n              chooseAction: values.chooseAction\n            } : undefined);\n            history.push(config.routes.premiumProcessing.root);\n          }\n        });\n      };\n    }\n  }];\n  var sendToOptions = (usersFiltered === null || usersFiltered === void 0 ? void 0 : usersFiltered.map(function (user) {\n    return _objectSpread(_objectSpread({}, user), {}, {\n      userNameEmail: \"\".concat(user.fullName, \" - \").concat(user.emailId)\n    });\n  })) || [];\n  var isRadioButtonValue = rfiDetails.rfiType === constants.BUREAU_RFITYPE && rfiDetails.status === constants.RFI_STATUS.OPEN;\n  var fields = [{\n    name: 'rfiType',\n    type: 'radio',\n    title: utils.string.t('premiumProcessing.rfi.rfiType'),\n    value: isCheckSigning ? 'bureau' : !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.rfiType) === 'Internal' ? 'InternalRFI' : 'bureau' : 'InternalRFI',\n    options: [{\n      name: 'internal',\n      value: 'InternalRFI',\n      label: utils.string.t('premiumProcessing.rfi.internal')\n    }, {\n      name: 'bureau',\n      value: 'bureau',\n      label: utils.string.t('premiumProcessing.rfi.bureau')\n    }],\n    muiFormGroupProps: {\n      row: true\n    },\n    muiComponentProps: {\n      disabled: true\n    }\n  }, {\n    name: 'sendTo',\n    type: 'autocompletemui',\n    value: !isEditable ? sendToOptions.find(function (option) {\n      return (option === null || option === void 0 ? void 0 : option.emailId) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.sendTo);\n    }) || null : null,\n    options: sendToOptions,\n    muiComponentProps: {\n      disabled: !isEditable || !isWorklist\n    },\n    optionKey: 'userId',\n    optionLabel: 'userNameEmail',\n    label: utils.string.t('premiumProcessing.rfi.sendTo')\n  }, {\n    name: 'queryCode',\n    type: 'autocompletemui',\n    value: !isEditable ? queryCodesRfi.find(function (option) {\n      return (option === null || option === void 0 ? void 0 : option.queryCodeDetails) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryCode);\n    }) || null : null,\n    options: queryCodesRfi || [],\n    optionKey: 'queryCodeID',\n    optionLabel: 'queryCodeDescription',\n    label: utils.string.t('premiumProcessing.rfi.queryCode'),\n    muiComponentProps: {\n      disabled: !isEditable || !isWorklist\n    }\n  }, {\n    name: 'queryCodeBureau',\n    type: 'autocompletemui',\n    value: !isEditable ? queryCodesBureauRfi.find(function (option) {\n      return (option === null || option === void 0 ? void 0 : option.queryCodeDetails) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryCode);\n    }) || null : null,\n    options: queryCodesBureauRfi || [],\n    optionKey: 'queryCodeID',\n    optionLabel: 'queryCodeDescription',\n    label: utils.string.t('premiumProcessing.rfi.queryCode'),\n    muiComponentProps: {\n      disabled: !isWorklist || !isEditable || isRejectPendingActionStage\n    }\n  }, {\n    name: 'responseDate',\n    type: 'text',\n    value: isCheckSigning ? caseDetails === null || caseDetails === void 0 ? void 0 : (_caseDetails$bureauRf4 = caseDetails.bureauRfiDetails) === null || _caseDetails$bureauRf4 === void 0 ? void 0 : _caseDetails$bureauRf4.expectedResponseDate : !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.timeToDueDate) || responseDate : responseDate,\n    label: utils.string.t('premiumProcessing.rfi.expectedResponseDate'),\n    muiComponentProps: {\n      disabled: !isEditable || !isWorklist,\n      InputProps: {\n        readOnly: true,\n        disabled: true\n      }\n    }\n  }, {\n    name: 'chooseAction',\n    type: 'radio',\n    title: utils.string.t('premiumProcessing.rfi.chooseAction'),\n    value: isRadioButtonValue && !isEditable ? 'Send to FEC' : 'Resolve',\n    options: [{\n      name: 'resolve',\n      value: 'Resolve',\n      label: utils.string.t('premiumProcessing.rfi.resolve'),\n      disabled: !isWorklist || !isEditable || isRejectPendingActionStage\n    }, {\n      name: 'sendtoFEC',\n      value: 'Send to FEC',\n      label: utils.string.t('premiumProcessing.rfi.sendToFec'),\n      disabled: !isWorklist || !isEditable || isRejectPendingActionStage\n    }],\n    muiFormGroupProps: {\n      row: true\n    }\n  }, {\n    name: 'bureauQueryDescription',\n    type: 'textarea',\n    label: utils.string.t('premiumProcessing.rfi.bureauQuery'),\n    placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\n    value: !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.bureauQuery) || '' : '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 5000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      disabled: !isWorklist || !isEditable || isRejectPendingActionStage\n    },\n    validation: isCheckSigning ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')).required(utils.string.t('validation.required')) : ''\n  }, {\n    name: 'resolutionNotes',\n    type: 'textarea',\n    label: utils.string.t('premiumProcessing.notes.notes'),\n    placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\n    value: !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.notes) || '' : '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      disabled: !isWorklist || !isEditable || isRejectPendingActionStage\n    },\n    validation: isCheckSigning ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')) : ''\n  }, {\n    name: 'resolutionNotesFEC',\n    type: 'textarea',\n    label: utils.string.t('premiumProcessing.rfi.queryLabelForCheckSigning'),\n    placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\n    value: !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.notes) || '' : '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      disabled: !isWorklist || !isEditable\n    },\n    validation: isCheckSigning ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')) : ''\n  }, {\n    name: 'bureauQuery',\n    type: 'textarea',\n    label: utils.string.t('premiumProcessing.rfi.queryLabelForCheckSigning'),\n    placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\n    value: '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      disabled: !isEditable\n    },\n    validation: isCheckSigning ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')) : ''\n  }, {\n    name: 'resolutionCode',\n    type: 'autocompletemui',\n    value: !isEditable ? resolutionCodesRfi.find(function (option) {\n      return (option === null || option === void 0 ? void 0 : option.resolutionCd) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.resolutionCode);\n    }) || null : null,\n    options: resolutionCodesRfi || [],\n    optionKey: 'resolutionCodeID',\n    optionLabel: 'resolutionCodeDescription',\n    label: utils.string.t('premiumProcessing.rfi.resolutionCode'),\n    muiComponentProps: {\n      disabled: !isWorklist || !isEditable || isRejectPendingActionStage\n    }\n  }, {\n    name: 'queryDescription',\n    type: 'textarea',\n    label: utils.string.t('premiumProcessing.rfi.queryLabel'),\n    placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\n    value: !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.notes) || '' : '',\n    muiComponentProps: {\n      disabled: !isEditable || !isWorklist,\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10\n    },\n    validation: !isCheckSigning ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')).required(utils.string.t('validation.required')) : ''\n  }];\n  var dms = {\n    context: constants.DMS_CONTEXT_CASE,\n    referenceId: caseId === null || caseId === void 0 ? void 0 : caseId.toString(),\n    // confirm with API which ID should be used for reference\n    sourceId: caseTeamData === null || caseTeamData === void 0 ? void 0 : caseTeamData.xbInstanceId\n  };\n  var tabs = [{\n    value: constants.DMS_VIEW_TAB_VIEW,\n    label: utils.string.t('dms.wrapper.tabs.viewDocuments'),\n    disabled: !isWorklist\n  }]; // abort\n\n  if (utils.generic.isInvalidOrEmptyArray(sendToOptions)) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsxDEV(PremiumProcessingCaseRFIFormView, {\n    isWorklist: isWorklist,\n    tabDetails: tabDetails,\n    fields: fields,\n    actions: actions,\n    caseDetails: caseDetails,\n    dms: dms,\n    dmsTabs: tabs,\n    documents: dmsViewFiles,\n    selectedDmsTab: selectedDmsTab,\n    isCheckSigning: isCheckSigning,\n    isEditable: isEditable,\n    isPageDirty: isPageDirty,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      getResponseDate: getResponseDate,\n      selectDmsTab: selectDmsTab,\n      onSelectDmsFile: onSelectDmsFile\n    })\n  }, !isEditable ? rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.taskId : 'new', false, {\n    fileName: _jsxFileName,\n    lineNumber: 450,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PremiumProcessingCaseRFIForm, \"p+mN15JH8804C/EMiVRXHQ+tDIY=\", false, function () {\n  return [useHistory, useDispatch, useConfirmNavigation, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PremiumProcessingCaseRFIForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"PremiumProcessingCaseRFIForm\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/PremiumProcessingCaseRFIForm/PremiumProcessingCaseRFIForm.js"],"names":["React","useEffect","useState","useDispatch","useSelector","useHistory","PropTypes","moment","Yup","sortBy","uniqBy","PremiumProcessingCaseRFIFormView","getRfiResponseDate","getViewTableDocuments","postSubmitNewRfi","premiumProcessingBureauRFIDetails","selectRefDataResolutionCode","selectCaseIsCheckSigning","selectUserDetails","selectUserGroup","selectorDmsViewFiles","selectRefDataQueryCodes","getDocumentUploaded","useConfirmNavigation","constants","utils","config","PremiumProcessingCaseRFIForm","propTypes","caseDetails","object","isRequired","rfiDetails","newRfiUsers","array","isEditable","bool","isPageDirty","isWorklist","handlers","shape","stayOnTab","func","switchTab","setIsPageDirty","history","dispatch","title","string","t","subtitle","confirmNavigation","isCheckSigning","queryCodes","resolutionCodes","currentUser","userGroup","dmsViewFiles","documentDto","tabDetails","taskView","WORKBASKET","ALL_CASES","responseDate","setResponseDate","DMS_VIEW_TAB_VIEW","selectedDmsTab","setSelectedDmsTab","selectedDmsFiles","setSelectedDmsFiles","isRejectPendingActionStage","caseStageDetails","some","cs","BPM_STAGE_REJECTED_PENDING_ACTION","includes","bpmStageCode","active","queryCodesRfi","generic","isValidArray","filter","queryCode","rfiTypeID","RFI_TYPE_FOR_QUERY_CODE","caseTeamData","fecId","caseId","instructionId","policyRef","queryCodesBureauRfi","RFI_TYPE_FOR_BUREAU_QUERY_CODE","resolutionCodesRfi","RFI_TYPE_FOR_BUREAU_RESOLUTION_CODE","caseDepartXbInstanceId","departmentId","xbInstanceId","users","user","userId","usersFiltered","split","params","referenceId","sectionType","DMS_CONTEXT_CASE","queryId","DMS_CONTEXT_RFI","resetForm","resetFn","isFunction","form","getInitialValues","fields","keepDirty","handleCancel","getResponseDate","option","sla","then","response","data","dueDate","selectDmsTab","tabName","onSelectDmsFile","files","currentUserEmail","email","currentUserGroup","code","actions","name","label","handler","reset","values","internalRFI","caseIncidentId","parentTaskId","taskId","parentProcessId","processId","assignedTo","sendTo","emailId","assignedToTeam","groupName","queryDescription","queryCodeDescription","format","queryCodeDetails","taskCategory","rfiType","documentId","map","doc","bureauRFI","action","chooseAction","bureauNames","bureauRfiDetails","bureauName","bureauQuery","bureauQueryDescription","expectedResponseDate","resolutionNotes","resolutionNotesFEC","queryCodeBureau","resolutionCode","resolutionCd","workPackageRef","workPackageReference","payload","status","API_RESPONSE_OK","id","undefined","push","routes","premiumProcessing","root","sendToOptions","userNameEmail","fullName","isRadioButtonValue","BUREAU_RFITYPE","RFI_STATUS","OPEN","type","value","options","muiFormGroupProps","row","muiComponentProps","disabled","find","optionKey","optionLabel","timeToDueDate","InputProps","readOnly","placeholder","inputProps","maxLength","multiline","rows","rowsMax","validation","min","max","required","notes","dms","context","toString","sourceId","tabs","isInvalidOrEmptyArray"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory } from 'react-router';\r\nimport PropTypes from 'prop-types';\r\nimport moment from 'moment';\r\nimport * as Yup from 'yup';\r\nimport sortBy from 'lodash/sortBy';\r\nimport uniqBy from 'lodash/uniqBy';\r\n\r\n// app\r\nimport PremiumProcessingCaseRFIFormView from './PremiumProcessingCaseRFIForm.view';\r\nimport {\r\n  getRfiResponseDate,\r\n  getViewTableDocuments,\r\n  postSubmitNewRfi,\r\n  premiumProcessingBureauRFIDetails,\r\n  selectRefDataResolutionCode,\r\n  selectCaseIsCheckSigning,\r\n  selectUserDetails,\r\n  selectUserGroup,\r\n  selectorDmsViewFiles,\r\n  selectRefDataQueryCodes,\r\n  getDocumentUploaded,\r\n} from 'stores';\r\nimport { useConfirmNavigation } from 'hooks';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\nPremiumProcessingCaseRFIForm.propTypes = {\r\n  caseDetails: PropTypes.object.isRequired,\r\n  rfiDetails: PropTypes.object,\r\n  newRfiUsers: PropTypes.array.isRequired,\r\n  isEditable: PropTypes.bool.isRequired,\r\n  isPageDirty: PropTypes.bool.isRequired,\r\n  isWorklist: PropTypes.bool.isRequired,\r\n  handlers: PropTypes.shape({\r\n    stayOnTab: PropTypes.func.isRequired,\r\n    switchTab: PropTypes.func.isRequired,\r\n    setIsPageDirty: PropTypes.func.isRequired,\r\n  }),\r\n};\r\n\r\nexport default function PremiumProcessingCaseRFIForm({\r\n  caseDetails = {},\r\n  rfiDetails,\r\n  newRfiUsers,\r\n  isPageDirty,\r\n  isEditable,\r\n  handlers,\r\n  isWorklist,\r\n}) {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n\r\n  const { confirmNavigation } = useConfirmNavigation({\r\n    title: utils.string.t('navigation.form.titleClear'),\r\n    subtitle: utils.string.t('navigation.form.subtitle'),\r\n  });\r\n\r\n  const isCheckSigning = useSelector(selectCaseIsCheckSigning);\r\n  const queryCodes = useSelector(selectRefDataQueryCodes);\r\n  const resolutionCodes = useSelector(selectRefDataResolutionCode);\r\n  const currentUser = useSelector(selectUserDetails);\r\n  const userGroup = useSelector(selectUserGroup);\r\n  const dmsViewFiles = useSelector(selectorDmsViewFiles);\r\n  const { documentDto } = useSelector(getDocumentUploaded);\r\n\r\n  const tabDetails = caseDetails?.taskView === constants.WORKBASKET || caseDetails?.taskView === constants.ALL_CASES;\r\n\r\n  const [responseDate, setResponseDate] = useState('');\r\n  const [selectedDmsTab, setSelectedDmsTab] = useState(constants.DMS_VIEW_TAB_VIEW);\r\n  const [selectedDmsFiles, setSelectedDmsFiles] = useState([]);\r\n\r\n  const isRejectPendingActionStage = caseDetails?.caseStageDetails?.some(\r\n    (cs) => [constants.BPM_STAGE_REJECTED_PENDING_ACTION].includes(cs.bpmStageCode) && cs.active\r\n  );\r\n  const queryCodesRfi = utils.generic.isValidArray(queryCodes, true)\r\n    ? queryCodes.filter((queryCode) => queryCode.rfiTypeID === constants.RFI_TYPE_FOR_QUERY_CODE)\r\n    : [];\r\n\r\n  const { caseTeamData, fecId, caseId, instructionId, policyRef } = caseDetails;\r\n  const queryCodesBureauRfi = utils.generic.isValidArray(queryCodes, true)\r\n    ? queryCodes.filter((queryCode) => queryCode.rfiTypeID === constants.RFI_TYPE_FOR_BUREAU_QUERY_CODE)\r\n    : [];\r\n\r\n  const resolutionCodesRfi = utils.generic.isValidArray(resolutionCodes, true)\r\n    ? resolutionCodes.filter((resolutionCodes) => resolutionCodes.rfiTypeID === constants.RFI_TYPE_FOR_BUREAU_RESOLUTION_CODE)\r\n    : [];\r\n\r\n  const caseDepartXbInstanceId = `${caseTeamData?.departmentId}-${caseTeamData?.xbInstanceId}`;\r\n\r\n  // re-order the list of users\r\n  // move the FEC who created the RFI to the top of the list\r\n  // filter only keep users who match the task departmentID and xbIstanceID\r\n  const users = sortBy(newRfiUsers, (user) => user?.userId !== fecId);\r\n  const usersFiltered = users?.filter((user) => {\r\n    return user && user?.departmentId?.split(', ').includes(caseDepartXbInstanceId);\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (caseId) {\r\n      // if RFI is being created, we fetch all case documents\r\n      // if RFI is already created, we only fetch the documents linked to the RFI\r\n      const params = isEditable\r\n        ? {\r\n            referenceId: caseId,\r\n            sectionType: constants.DMS_CONTEXT_CASE,\r\n            instructionId: instructionId,\r\n            policyRef: policyRef,\r\n          }\r\n        : { referenceId: rfiDetails.queryId, sectionType: constants.DMS_CONTEXT_RFI };\r\n      dispatch(getViewTableDocuments(params));\r\n    }\r\n  }, [caseId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (isCheckSigning) {\r\n      dispatch(premiumProcessingBureauRFIDetails(caseId));\r\n    }\r\n  }, [caseId, isCheckSigning]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    setSelectedDmsFiles(uniqBy([...selectedDmsFiles, ...documentDto], 'documentId'));\r\n  }, [documentDto]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const resetForm = (resetFn) => {\r\n    if (utils.generic.isFunction(resetFn)) {\r\n      resetFn(utils.form.getInitialValues(fields), { keepDirty: false });\r\n      setResponseDate('');\r\n    }\r\n  };\r\n\r\n  const handleCancel = (resetFn) => {\r\n    if (isPageDirty) {\r\n      confirmNavigation(() => resetForm(resetFn));\r\n    } else {\r\n      resetForm(resetFn);\r\n    }\r\n  };\r\n\r\n  const getResponseDate = (option) => {\r\n    dispatch(getRfiResponseDate({ sla: option?.sla })).then((response) => {\r\n      const responseDate = response?.data?.dueDate ? response.data.dueDate : '';\r\n      setResponseDate(responseDate);\r\n    });\r\n  };\r\n\r\n  const selectDmsTab = (tabName) => {\r\n    setSelectedDmsTab(tabName);\r\n  };\r\n\r\n  const onSelectDmsFile = (files) => {\r\n    setSelectedDmsFiles(uniqBy([...selectedDmsFiles, ...files], 'documentId'));\r\n  };\r\n  const currentUserEmail = currentUser.email;\r\n  const currentUserGroup = userGroup?.[0]?.code;\r\n\r\n  const actions = [\r\n    {\r\n      name: 'cancel',\r\n      label: utils.string.t('app.cancel'),\r\n      handler: (reset) => handleCancel(reset),\r\n    },\r\n    {\r\n      name: 'submit',\r\n      label: isCheckSigning ? utils.string.t('premiumProcessing.resolveRfi.resolveRfi') : utils.string.t('premiumProcessing.rfi.sendRFI'),\r\n      handler: (reset) => (values) => {\r\n        handlers.setIsPageDirty(false);\r\n\r\n        const internalRFI = {\r\n          caseIncidentId: caseDetails?.caseId,\r\n          parentTaskId: caseDetails?.taskId,\r\n          parentProcessId: caseDetails?.processId,\r\n          assignedTo: values?.sendTo?.emailId,\r\n          assignedToTeam: values?.sendTo?.groupName,\r\n          queryDescription: values?.queryDescription,\r\n          queryCodeDescription: values?.queryCode?.queryCodeDescription,\r\n          ...(responseDate ? { dueDate: moment(responseDate).format('DD-MM-YYYY') } : null),\r\n          queryCode: values?.queryCode?.queryCodeDetails,\r\n          taskCategory: values?.rfiType,\r\n          documentId: selectedDmsFiles?.map((doc) => doc.documentId),\r\n        };\r\n\r\n        const bureauRFI = {\r\n          action: values?.chooseAction,\r\n          assignedTo: values?.sendTo?.emailId ? values?.sendTo?.emailId : currentUserEmail,\r\n          assignedToTeam: values?.sendTo?.groupName ? values?.sendTo?.groupName : currentUserGroup,\r\n          bureauNames: caseDetails?.bureauRfiDetails?.bureauName,\r\n          bureauQuery: values?.bureauQueryDescription,\r\n          caseIncidentId: caseDetails?.caseId,\r\n          dueDate: moment(caseDetails?.bureauRfiDetails?.expectedResponseDate).format('DD-MM-YYYY'),\r\n          parentTaskId: caseDetails?.taskId,\r\n          parentProcessId: caseDetails?.processId,\r\n          queryDescription: values?.resolutionNotes ? values?.resolutionNotes : values?.resolutionNotesFEC,\r\n          queryCode: values?.queryCodeBureau?.queryCodeDetails,\r\n          resolutionCode: values?.resolutionCode?.resolutionCd,\r\n          workPackageRef: caseDetails?.bureauRfiDetails?.workPackageReference,\r\n          taskCategory: 'ExternalRFI',\r\n          documentId: selectedDmsFiles?.map((doc) => doc.documentId),\r\n        };\r\n\r\n        const payload = isCheckSigning ? bureauRFI : internalRFI;\r\n\r\n        dispatch(postSubmitNewRfi(payload)).then((response) => {\r\n          // success POST\r\n          if (response?.status === constants.API_RESPONSE_OK && response?.data?.id) {\r\n            reset(isCheckSigning ? { chooseAction: values.chooseAction } : undefined);\r\n            history.push(config.routes.premiumProcessing.root);\r\n          }\r\n        });\r\n      },\r\n    },\r\n  ];\r\n\r\n  const sendToOptions =\r\n    usersFiltered?.map((user) => {\r\n      return { ...user, userNameEmail: `${user.fullName} - ${user.emailId}` };\r\n    }) || [];\r\n\r\n  const isRadioButtonValue = rfiDetails.rfiType === constants.BUREAU_RFITYPE && rfiDetails.status === constants.RFI_STATUS.OPEN;\r\n\r\n  const fields = [\r\n    {\r\n      name: 'rfiType',\r\n      type: 'radio',\r\n      title: utils.string.t('premiumProcessing.rfi.rfiType'),\r\n      value: isCheckSigning ? 'bureau' : !isEditable ? (rfiDetails?.rfiType === 'Internal' ? 'InternalRFI' : 'bureau') : 'InternalRFI',\r\n      options: [\r\n        {\r\n          name: 'internal',\r\n          value: 'InternalRFI',\r\n          label: utils.string.t('premiumProcessing.rfi.internal'),\r\n        },\r\n        {\r\n          name: 'bureau',\r\n          value: 'bureau',\r\n          label: utils.string.t('premiumProcessing.rfi.bureau'),\r\n        },\r\n      ],\r\n      muiFormGroupProps: {\r\n        row: true,\r\n      },\r\n      muiComponentProps: {\r\n        disabled: true,\r\n      },\r\n    },\r\n    {\r\n      name: 'sendTo',\r\n      type: 'autocompletemui',\r\n      value: !isEditable ? sendToOptions.find((option) => option?.emailId === rfiDetails?.sendTo) || null : null,\r\n      options: sendToOptions,\r\n      muiComponentProps: {\r\n        disabled: !isEditable || !isWorklist,\r\n      },\r\n      optionKey: 'userId',\r\n      optionLabel: 'userNameEmail',\r\n      label: utils.string.t('premiumProcessing.rfi.sendTo'),\r\n    },\r\n    {\r\n      name: 'queryCode',\r\n      type: 'autocompletemui',\r\n      value: !isEditable ? queryCodesRfi.find((option) => option?.queryCodeDetails === rfiDetails?.queryCode) || null : null,\r\n      options: queryCodesRfi || [],\r\n      optionKey: 'queryCodeID',\r\n      optionLabel: 'queryCodeDescription',\r\n      label: utils.string.t('premiumProcessing.rfi.queryCode'),\r\n      muiComponentProps: {\r\n        disabled: !isEditable || !isWorklist,\r\n      },\r\n    },\r\n    {\r\n      name: 'queryCodeBureau',\r\n      type: 'autocompletemui',\r\n      value: !isEditable ? queryCodesBureauRfi.find((option) => option?.queryCodeDetails === rfiDetails?.queryCode) || null : null,\r\n      options: queryCodesBureauRfi || [],\r\n      optionKey: 'queryCodeID',\r\n      optionLabel: 'queryCodeDescription',\r\n      label: utils.string.t('premiumProcessing.rfi.queryCode'),\r\n      muiComponentProps: {\r\n        disabled: !isWorklist || !isEditable || isRejectPendingActionStage,\r\n      },\r\n    },\r\n    {\r\n      name: 'responseDate',\r\n      type: 'text',\r\n      value: isCheckSigning\r\n        ? caseDetails?.bureauRfiDetails?.expectedResponseDate\r\n        : !isEditable\r\n        ? rfiDetails?.timeToDueDate || responseDate\r\n        : responseDate,\r\n      label: utils.string.t('premiumProcessing.rfi.expectedResponseDate'),\r\n      muiComponentProps: {\r\n        disabled: !isEditable || !isWorklist,\r\n        InputProps: {\r\n          readOnly: true,\r\n          disabled: true,\r\n        },\r\n      },\r\n    },\r\n\r\n    {\r\n      name: 'chooseAction',\r\n      type: 'radio',\r\n      title: utils.string.t('premiumProcessing.rfi.chooseAction'),\r\n      value: isRadioButtonValue && !isEditable ? 'Send to FEC' : 'Resolve',\r\n      options: [\r\n        {\r\n          name: 'resolve',\r\n          value: 'Resolve',\r\n          label: utils.string.t('premiumProcessing.rfi.resolve'),\r\n          disabled: !isWorklist || !isEditable || isRejectPendingActionStage,\r\n        },\r\n        {\r\n          name: 'sendtoFEC',\r\n          value: 'Send to FEC',\r\n          label: utils.string.t('premiumProcessing.rfi.sendToFec'),\r\n          disabled: !isWorklist || !isEditable || isRejectPendingActionStage,\r\n        },\r\n      ],\r\n      muiFormGroupProps: {\r\n        row: true,\r\n      },\r\n    },\r\n    {\r\n      name: 'bureauQueryDescription',\r\n      type: 'textarea',\r\n      label: utils.string.t('premiumProcessing.rfi.bureauQuery'),\r\n      placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\r\n      value: !isEditable ? rfiDetails?.bureauQuery || '' : '',\r\n      muiComponentProps: {\r\n        inputProps: { maxLength: 5000 },\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 10,\r\n        disabled: !isWorklist || !isEditable || isRejectPendingActionStage,\r\n      },\r\n      validation: isCheckSigning\r\n        ? Yup.string()\r\n            .min(5, utils.string.t('validation.string.min'))\r\n            .max(4000, utils.string.t('validation.string.max'))\r\n            .required(utils.string.t('validation.required'))\r\n        : '',\r\n    },\r\n    {\r\n      name: 'resolutionNotes',\r\n      type: 'textarea',\r\n      label: utils.string.t('premiumProcessing.notes.notes'),\r\n      placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\r\n      value: !isEditable ? rfiDetails?.notes || '' : '',\r\n      muiComponentProps: {\r\n        inputProps: { maxLength: 4000 },\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 10,\r\n        disabled: !isWorklist || !isEditable || isRejectPendingActionStage,\r\n      },\r\n      validation: isCheckSigning\r\n        ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max'))\r\n        : '',\r\n    },\r\n    {\r\n      name: 'resolutionNotesFEC',\r\n      type: 'textarea',\r\n      label: utils.string.t('premiumProcessing.rfi.queryLabelForCheckSigning'),\r\n      placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\r\n      value: !isEditable ? rfiDetails?.notes || '' : '',\r\n      muiComponentProps: {\r\n        inputProps: { maxLength: 4000 },\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 10,\r\n        disabled: !isWorklist || !isEditable,\r\n      },\r\n      validation: isCheckSigning\r\n        ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max'))\r\n        : '',\r\n    },\r\n    {\r\n      name: 'bureauQuery',\r\n      type: 'textarea',\r\n      label: utils.string.t('premiumProcessing.rfi.queryLabelForCheckSigning'),\r\n      placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\r\n      value: '',\r\n      muiComponentProps: {\r\n        inputProps: { maxLength: 4000 },\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 10,\r\n        disabled: !isEditable,\r\n      },\r\n      validation: isCheckSigning\r\n        ? Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max'))\r\n        : '',\r\n    },\r\n    {\r\n      name: 'resolutionCode',\r\n      type: 'autocompletemui',\r\n      value: !isEditable ? resolutionCodesRfi.find((option) => option?.resolutionCd === rfiDetails?.resolutionCode) || null : null,\r\n      options: resolutionCodesRfi || [],\r\n      optionKey: 'resolutionCodeID',\r\n      optionLabel: 'resolutionCodeDescription',\r\n      label: utils.string.t('premiumProcessing.rfi.resolutionCode'),\r\n      muiComponentProps: {\r\n        disabled: !isWorklist || !isEditable || isRejectPendingActionStage,\r\n      },\r\n    },\r\n    {\r\n      name: 'queryDescription',\r\n      type: 'textarea',\r\n      label: utils.string.t('premiumProcessing.rfi.queryLabel'),\r\n      placeholder: utils.string.t('premiumProcessing.rfi.queryPlaceholder'),\r\n      value: !isEditable ? rfiDetails?.notes || '' : '',\r\n      muiComponentProps: {\r\n        disabled: !isEditable || !isWorklist,\r\n        inputProps: { maxLength: 4000 },\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 10,\r\n      },\r\n      validation: !isCheckSigning\r\n        ? Yup.string()\r\n            .min(5, utils.string.t('validation.string.min'))\r\n            .max(4000, utils.string.t('validation.string.max'))\r\n            .required(utils.string.t('validation.required'))\r\n        : '',\r\n    },\r\n  ];\r\n\r\n  const dms = {\r\n    context: constants.DMS_CONTEXT_CASE,\r\n    referenceId: caseId?.toString(), // confirm with API which ID should be used for reference\r\n    sourceId: caseTeamData?.xbInstanceId,\r\n  };\r\n\r\n  const tabs = [\r\n    {\r\n      value: constants.DMS_VIEW_TAB_VIEW,\r\n      label: utils.string.t('dms.wrapper.tabs.viewDocuments'),\r\n      disabled: !isWorklist,\r\n    },\r\n  ];\r\n\r\n  // abort\r\n  if (utils.generic.isInvalidOrEmptyArray(sendToOptions)) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <PremiumProcessingCaseRFIFormView\r\n      isWorklist={isWorklist}\r\n      tabDetails={tabDetails}\r\n      key={!isEditable ? rfiDetails?.taskId : 'new'}\r\n      fields={fields}\r\n      actions={actions}\r\n      caseDetails={caseDetails}\r\n      dms={dms}\r\n      dmsTabs={tabs}\r\n      documents={dmsViewFiles}\r\n      selectedDmsTab={selectedDmsTab}\r\n      isCheckSigning={isCheckSigning}\r\n      isEditable={isEditable}\r\n      isPageDirty={isPageDirty}\r\n      handlers={{ ...handlers, getResponseDate, selectDmsTab, onSelectDmsFile }}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}