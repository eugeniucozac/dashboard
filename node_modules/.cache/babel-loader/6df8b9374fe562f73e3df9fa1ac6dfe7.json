{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\components\\\\FormSelect\\\\FormSelect.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport { Controller } from 'react-hook-form';\nimport { merge } from 'lodash'; // app\n\nimport styles from './FormSelect.styles';\nimport { ErrorMessage } from 'components';\nimport * as utils from 'utils'; // mui\n\nimport { makeStyles, Box, FormControl, MenuItem, OutlinedInput, Select, InputLabel } from '@material-ui/core';\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\nimport AddIcon from '@material-ui/icons/Add';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nFormSelect.propTypes = {\n  name: PropTypes.string.isRequired,\n  margin: PropTypes.oneOf(['normal', 'none', 'dense']),\n  options: PropTypes.arrayOf(PropTypes.object).isRequired,\n  optionKey: PropTypes.string.isRequired,\n  optionLabel: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  disabled: PropTypes.bool,\n  hint: PropTypes.string,\n  error: PropTypes.object,\n  size: PropTypes.oneOf(['xs', 'sm', 'md']),\n  muiComponentProps: PropTypes.object,\n  handleUpdate: PropTypes.func,\n  nestedClasses: PropTypes.shape({\n    root: PropTypes.string,\n    icon: PropTypes.string\n  }),\n  testid: PropTypes.string\n};\nFormSelect.defaultProps = {\n  optionKey: 'value',\n  optionLabel: 'label',\n  margin: 'normal',\n  muiComponentProps: {},\n  nestedClasses: {},\n  testid: 'form-select'\n};\nexport function FormSelect(_ref) {\n  _s();\n\n  var _selectSizeClasses,\n      _this = this;\n\n  var disabled = _ref.disabled,\n      name = _ref.name,\n      margin = _ref.margin,\n      value = _ref.value,\n      _ref$options = _ref.options,\n      options = _ref$options === void 0 ? [] : _ref$options,\n      optionKey = _ref.optionKey,\n      optionLabel = _ref.optionLabel,\n      label = _ref.label,\n      hint = _ref.hint,\n      error = _ref.error,\n      size = _ref.size,\n      nestedClasses = _ref.nestedClasses,\n      muiComponentProps = _ref.muiComponentProps,\n      testid = _ref.testid,\n      control = _ref.control,\n      defaultValue = _ref.defaultValue,\n      handleUpdate = _ref.handleUpdate;\n  var classes = makeStyles(styles, {\n    name: 'FormSelect'\n  })();\n  var allValues = control && control.getValues() || {};\n  var fieldValue = allValues[name] || '';\n  var isMulti = muiComponentProps.multiple;\n  var isPlaceholder = control ? isMulti ? fieldValue.includes('__placeholder__') : fieldValue === '__placeholder__' : isMulti ? value.includes('__placeholder__') : value === '__placeholder__';\n\n  var _useState = useState(isPlaceholder),\n      _useState2 = _slicedToArray(_useState, 2),\n      placeholder = _useState2[0],\n      setPlaceholder = _useState2[1];\n\n  useEffect(function () {\n    setPlaceholder(isPlaceholder);\n  }, [isPlaceholder]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var selectClasses = _defineProperty({}, classes.placeholder, Boolean(placeholder));\n\n  var selectSizeClasses = (_selectSizeClasses = {}, _defineProperty(_selectSizeClasses, classes.selectMd, size === 'md'), _defineProperty(_selectSizeClasses, classes.selectSm, size === 'sm'), _defineProperty(_selectSizeClasses, classes.selectXs, size === 'xs'), _selectSizeClasses);\n\n  var iconSizeClasses = _defineProperty({}, classes.iconXs, size === 'xs');\n\n  var renderMenuItem = function renderMenuItem(option, key, label) {\n    var _menuClasses;\n\n    if (!option || !key || !label) return;\n\n    var isCreate = function isCreate(_ref2) {\n      var value = _ref2.value;\n      return value === '__create__';\n    };\n\n    var menuClasses = (_menuClasses = {}, _defineProperty(_menuClasses, classes.placeholder, option.placeholder || option.blank), _defineProperty(_menuClasses, classes.createLabel, isCreate(option)), _defineProperty(_menuClasses, classes.disabled, option.disabled), _menuClasses); // TODO added on 31/07/2020: in multi mode, menuItem breaks if anything other than text is rendered (Box, div...)\n\n    return /*#__PURE__*/_jsxDEV(MenuItem, {\n      value: option[key],\n      disabled: option.disabled,\n      className: classnames(menuClasses),\n      children: isMulti ? option[label] : /*#__PURE__*/_jsxDEV(Box, {\n        display: \"flex\",\n        alignItems: \"center\",\n        children: [isCreate(option) && /*#__PURE__*/_jsxDEV(AddIcon, {\n          className: classes.createIcon\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 34\n        }, _this), /*#__PURE__*/_jsxDEV(Box, {\n          className: classes.selectedLabel,\n          children: option[label]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, _this)\n    }, \"\".concat(option[key], \"-\").concat(option[label]), false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, _this);\n  };\n\n  var parseChangeValues = function parseChangeValues(event) {\n    var _ref3 = event && event.target || {},\n        name = _ref3.name,\n        value = _ref3.value;\n\n    var valueIsPlaceholder;\n    var valueIncludesPlaceholder;\n    var returnedValue = value;\n\n    if (isMulti) {\n      valueIsPlaceholder = utils.generic.isValidArray(value) && value.length === 1 && value.includes('__placeholder__');\n      valueIncludesPlaceholder = utils.generic.isValidArray(value) && value.length >= 2 && value.includes('__placeholder__'); // we're stripping away the __placeholder__ value if there is multiple values selected\n      // if ONLY __placeholder__ is selected, we leave it untouched so that it shows as the placeholder\n      // if we only have valid values, we leave them untouched as well, ex:\n      //                               [] --> []\n      //              ['__placeholder__'] --> ['__placeholder__']\n      // ['__placeholder__', 'yes', 'no'] --> ['yes', 'no']\n      //                    ['yes', 'no'] --> ['yes', 'no']\n\n      returnedValue = valueIncludesPlaceholder ? value.filter(function (v) {\n        return v !== '__placeholder__';\n      }) : value;\n    } else {\n      valueIsPlaceholder = value === '__placeholder__';\n    }\n\n    setPlaceholder(valueIsPlaceholder);\n\n    if (utils.generic.isFunction(handleUpdate)) {\n      handleUpdate(name, returnedValue);\n    }\n\n    return returnedValue;\n  };\n\n  var handleChangeRHF = function handleChangeRHF(event) {\n    return parseChangeValues(event);\n  };\n\n  var handleChangeMUI = function handleChangeMUI(event) {\n    return parseChangeValues(event);\n  };\n\n  var fullwidth = typeof muiComponentProps.fullWidth !== 'undefined' ? muiComponentProps.fullWidth : true;\n\n  var props = _objectSpread(_objectSpread({\n    displayEmpty: true,\n    disabled: disabled,\n    id: name,\n    name: name,\n    input: /*#__PURE__*/_jsxDEV(OutlinedInput, {\n      labelWidth: 0,\n      name: name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 12\n    }, this),\n    variant: 'outlined',\n    error: Boolean(error),\n    IconComponent: KeyboardArrowDownIcon,\n    fullWidth: fullwidth\n  }, muiComponentProps), {}, {\n    className: classnames(classes.select, selectClasses, nestedClasses.root),\n    classes: {\n      icon: classnames(iconSizeClasses),\n      select: classnames(selectSizeClasses)\n    },\n    'data-testid': testid\n  });\n\n  return /*#__PURE__*/_jsxDEV(FormControl, {\n    margin: margin,\n    fullWidth: fullwidth,\n    className: classes.root,\n    children: [label && /*#__PURE__*/_jsxDEV(InputLabel, {\n      disabled: !!muiComponentProps.disabled,\n      error: Boolean(error),\n      shrink: true,\n      variant: \"outlined\",\n      htmlFor: name,\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }, this), control ? /*#__PURE__*/_jsxDEV(Controller, {\n      name: name,\n      control: control,\n      defaultValue: defaultValue,\n      value: value,\n      render: function render(_ref4) {\n        var _onChange = _ref4.onChange,\n            value = _ref4.value;\n        return /*#__PURE__*/_jsxDEV(Select, _objectSpread(_objectSpread({}, props), {}, {\n          onChange: function onChange(e) {\n            handleChangeRHF(e);\n\n            _onChange(e);\n          },\n          value: value,\n          inputProps: _objectSpread(_objectSpread({}, muiComponentProps.inputProps), {}, {\n            'data-form-type': 'select'\n          }),\n          children: options.map(function (option) {\n            return renderMenuItem(option, optionKey, optionLabel);\n          })\n        }), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 15\n        }, _this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Select, _objectSpread(_objectSpread({\n      value: value || ''\n    }, props), {}, {\n      onChange: handleChangeMUI,\n      inputProps: _objectSpread({}, merge({}, muiComponentProps === null || muiComponentProps === void 0 ? void 0 : muiComponentProps.inputProps, {\n        'data-form-type': 'select'\n      })),\n      children: options.map(function (option) {\n        return renderMenuItem(option, optionKey, optionLabel);\n      })\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ErrorMessage, {\n      error: error,\n      hint: hint\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 5\n  }, this);\n}\n\n_s(FormSelect, \"KtRk1hunAL3ut/SI/rChhL/FmOE=\");\n\n_c = FormSelect;\nFormSelect.displayName = \"FormSelect\";\nFormSelect.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [],\n  \"displayName\": \"FormSelect\",\n  \"props\": {\n    \"options\": {\n      \"defaultValue\": {\n        \"value\": \"[]\",\n        \"computed\": false\n      },\n      \"type\": {\n        \"name\": \"arrayOf\",\n        \"value\": {\n          \"name\": \"object\"\n        }\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"optionKey\": {\n      \"defaultValue\": {\n        \"value\": \"'value'\",\n        \"computed\": false\n      },\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"optionLabel\": {\n      \"defaultValue\": {\n        \"value\": \"'label'\",\n        \"computed\": false\n      },\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"margin\": {\n      \"defaultValue\": {\n        \"value\": \"'normal'\",\n        \"computed\": false\n      },\n      \"type\": {\n        \"name\": \"enum\",\n        \"value\": [{\n          \"value\": \"'normal'\",\n          \"computed\": false\n        }, {\n          \"value\": \"'none'\",\n          \"computed\": false\n        }, {\n          \"value\": \"'dense'\",\n          \"computed\": false\n        }]\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"muiComponentProps\": {\n      \"defaultValue\": {\n        \"value\": \"{}\",\n        \"computed\": false\n      },\n      \"type\": {\n        \"name\": \"object\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"nestedClasses\": {\n      \"defaultValue\": {\n        \"value\": \"{}\",\n        \"computed\": false\n      },\n      \"type\": {\n        \"name\": \"shape\",\n        \"value\": {\n          \"root\": {\n            \"name\": \"string\",\n            \"required\": false\n          },\n          \"icon\": {\n            \"name\": \"string\",\n            \"required\": false\n          }\n        }\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"testid\": {\n      \"defaultValue\": {\n        \"value\": \"'form-select'\",\n        \"computed\": false\n      },\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"name\": {\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"label\": {\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"disabled\": {\n      \"type\": {\n        \"name\": \"bool\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"hint\": {\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"error\": {\n      \"type\": {\n        \"name\": \"object\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"size\": {\n      \"type\": {\n        \"name\": \"enum\",\n        \"value\": [{\n          \"value\": \"'xs'\",\n          \"computed\": false\n        }, {\n          \"value\": \"'sm'\",\n          \"computed\": false\n        }, {\n          \"value\": \"'md'\",\n          \"computed\": false\n        }]\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"handleUpdate\": {\n      \"type\": {\n        \"name\": \"func\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    }\n  }\n};\nexport default FormSelect;\n\nif (typeof STORYBOOK_REACT_CLASSES !== \"undefined\") {\n  STORYBOOK_REACT_CLASSES[\"src\\\\components\\\\FormSelect\\\\FormSelect.js\"] = {\n    name: \"FormSelect\",\n    docgenInfo: FormSelect.__docgenInfo,\n    path: \"src\\\\components\\\\FormSelect\\\\FormSelect.js\"\n  };\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"FormSelect\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/components/FormSelect/FormSelect.js"],"names":["React","useEffect","useState","PropTypes","classnames","Controller","merge","styles","ErrorMessage","utils","makeStyles","Box","FormControl","MenuItem","OutlinedInput","Select","InputLabel","KeyboardArrowDownIcon","AddIcon","FormSelect","propTypes","name","string","isRequired","margin","oneOf","options","arrayOf","object","optionKey","optionLabel","label","disabled","bool","hint","error","size","muiComponentProps","handleUpdate","func","nestedClasses","shape","root","icon","testid","defaultProps","value","control","defaultValue","classes","allValues","getValues","fieldValue","isMulti","multiple","isPlaceholder","includes","placeholder","setPlaceholder","selectClasses","Boolean","selectSizeClasses","selectMd","selectSm","selectXs","iconSizeClasses","iconXs","renderMenuItem","option","key","isCreate","menuClasses","blank","createLabel","createIcon","selectedLabel","parseChangeValues","event","target","valueIsPlaceholder","valueIncludesPlaceholder","returnedValue","generic","isValidArray","length","filter","v","isFunction","handleChangeRHF","handleChangeMUI","fullwidth","fullWidth","props","displayEmpty","id","input","variant","IconComponent","className","select","onChange","e","inputProps","map"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classnames from 'classnames';\r\nimport { Controller } from 'react-hook-form';\r\nimport { merge } from 'lodash';\r\n\r\n// app\r\nimport styles from './FormSelect.styles';\r\nimport { ErrorMessage } from 'components';\r\nimport * as utils from 'utils';\r\n\r\n// mui\r\nimport { makeStyles, Box, FormControl, MenuItem, OutlinedInput, Select, InputLabel } from '@material-ui/core';\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport AddIcon from '@material-ui/icons/Add';\r\n\r\nFormSelect.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  margin: PropTypes.oneOf(['normal', 'none', 'dense']),\r\n  options: PropTypes.arrayOf(PropTypes.object).isRequired,\r\n  optionKey: PropTypes.string.isRequired,\r\n  optionLabel: PropTypes.string.isRequired,\r\n  label: PropTypes.string,\r\n  disabled: PropTypes.bool,\r\n  hint: PropTypes.string,\r\n  error: PropTypes.object,\r\n  size: PropTypes.oneOf(['xs', 'sm', 'md']),\r\n  muiComponentProps: PropTypes.object,\r\n  handleUpdate: PropTypes.func,\r\n  nestedClasses: PropTypes.shape({\r\n    root: PropTypes.string,\r\n    icon: PropTypes.string,\r\n  }),\r\n  testid: PropTypes.string,\r\n};\r\n\r\nFormSelect.defaultProps = {\r\n  optionKey: 'value',\r\n  optionLabel: 'label',\r\n  margin: 'normal',\r\n  muiComponentProps: {},\r\n  nestedClasses: {},\r\n  testid: 'form-select',\r\n};\r\n\r\nexport function FormSelect({\r\n  disabled,\r\n  name,\r\n  margin,\r\n  value,\r\n  options = [],\r\n  optionKey,\r\n  optionLabel,\r\n  label,\r\n  hint,\r\n  error,\r\n  size,\r\n  nestedClasses,\r\n  muiComponentProps,\r\n  testid,\r\n  control,\r\n  defaultValue,\r\n  handleUpdate,\r\n}) {\r\n  const classes = makeStyles(styles, { name: 'FormSelect' })();\r\n\r\n  const allValues = (control && control.getValues()) || {};\r\n  const fieldValue = allValues[name] || '';\r\n  const isMulti = muiComponentProps.multiple;\r\n  const isPlaceholder = control\r\n    ? isMulti\r\n      ? fieldValue.includes('__placeholder__')\r\n      : fieldValue === '__placeholder__'\r\n    : isMulti\r\n    ? value.includes('__placeholder__')\r\n    : value === '__placeholder__';\r\n\r\n  const [placeholder, setPlaceholder] = useState(isPlaceholder);\r\n\r\n  useEffect(() => {\r\n    setPlaceholder(isPlaceholder);\r\n  }, [isPlaceholder]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const selectClasses = {\r\n    [classes.placeholder]: Boolean(placeholder),\r\n  };\r\n\r\n  const selectSizeClasses = {\r\n    [classes.selectMd]: size === 'md',\r\n    [classes.selectSm]: size === 'sm',\r\n    [classes.selectXs]: size === 'xs',\r\n  };\r\n\r\n  const iconSizeClasses = {\r\n    [classes.iconXs]: size === 'xs',\r\n  };\r\n\r\n  const renderMenuItem = (option, key, label) => {\r\n    if (!option || !key || !label) return;\r\n\r\n    const isCreate = ({ value }) => value === '__create__';\r\n    const menuClasses = {\r\n      [classes.placeholder]: option.placeholder || option.blank,\r\n      [classes.createLabel]: isCreate(option),\r\n      [classes.disabled]: option.disabled,\r\n    };\r\n\r\n    // TODO added on 31/07/2020: in multi mode, menuItem breaks if anything other than text is rendered (Box, div...)\r\n    return (\r\n      <MenuItem key={`${option[key]}-${option[label]}`} value={option[key]} disabled={option.disabled} className={classnames(menuClasses)}>\r\n        {isMulti ? (\r\n          option[label]\r\n        ) : (\r\n          <Box display=\"flex\" alignItems=\"center\">\r\n            {isCreate(option) && <AddIcon className={classes.createIcon} />}\r\n            <Box className={classes.selectedLabel}>{option[label]}</Box>\r\n          </Box>\r\n        )}\r\n      </MenuItem>\r\n    );\r\n  };\r\n\r\n  const parseChangeValues = (event) => {\r\n    const { name, value } = (event && event.target) || {};\r\n    let valueIsPlaceholder;\r\n    let valueIncludesPlaceholder;\r\n    let returnedValue = value;\r\n\r\n    if (isMulti) {\r\n      valueIsPlaceholder = utils.generic.isValidArray(value) && value.length === 1 && value.includes('__placeholder__');\r\n      valueIncludesPlaceholder = utils.generic.isValidArray(value) && value.length >= 2 && value.includes('__placeholder__');\r\n\r\n      // we're stripping away the __placeholder__ value if there is multiple values selected\r\n      // if ONLY __placeholder__ is selected, we leave it untouched so that it shows as the placeholder\r\n      // if we only have valid values, we leave them untouched as well, ex:\r\n      //                               [] --> []\r\n      //              ['__placeholder__'] --> ['__placeholder__']\r\n      // ['__placeholder__', 'yes', 'no'] --> ['yes', 'no']\r\n      //                    ['yes', 'no'] --> ['yes', 'no']\r\n      returnedValue = valueIncludesPlaceholder ? value.filter((v) => v !== '__placeholder__') : value;\r\n    } else {\r\n      valueIsPlaceholder = value === '__placeholder__';\r\n    }\r\n\r\n    setPlaceholder(valueIsPlaceholder);\r\n\r\n    if (utils.generic.isFunction(handleUpdate)) {\r\n      handleUpdate(name, returnedValue);\r\n    }\r\n\r\n    return returnedValue;\r\n  };\r\n\r\n  const handleChangeRHF = (event) => {\r\n    return parseChangeValues(event);\r\n  };\r\n\r\n  const handleChangeMUI = (event) => {\r\n    return parseChangeValues(event);\r\n  };\r\n\r\n  const fullwidth = typeof muiComponentProps.fullWidth !== 'undefined' ? muiComponentProps.fullWidth : true;\r\n\r\n  const props = {\r\n    displayEmpty: true,\r\n    disabled,\r\n    id: name,\r\n    name,\r\n    input: <OutlinedInput labelWidth={0} name={name} />,\r\n    variant: 'outlined',\r\n    error: Boolean(error),\r\n    IconComponent: KeyboardArrowDownIcon,\r\n    fullWidth: fullwidth,\r\n    ...muiComponentProps,\r\n    className: classnames(classes.select, selectClasses, nestedClasses.root),\r\n    classes: {\r\n      icon: classnames(iconSizeClasses),\r\n      select: classnames(selectSizeClasses),\r\n    },\r\n    'data-testid': testid,\r\n  };\r\n\r\n  return (\r\n    <FormControl margin={margin} fullWidth={fullwidth} className={classes.root}>\r\n      {label && (\r\n        <InputLabel disabled={!!muiComponentProps.disabled} error={Boolean(error)} shrink variant=\"outlined\" htmlFor={name}>\r\n          {label}\r\n        </InputLabel>\r\n      )}\r\n      {control ? (\r\n        <Controller\r\n          name={name}\r\n          control={control}\r\n          defaultValue={defaultValue}\r\n          value={value}\r\n          render={({ onChange, value }) => {\r\n            return (\r\n              <Select\r\n                {...props}\r\n                onChange={(e) => {\r\n                  handleChangeRHF(e);\r\n                  onChange(e);\r\n                }}\r\n                value={value}\r\n                inputProps={{\r\n                  ...muiComponentProps.inputProps,\r\n                  'data-form-type': 'select',\r\n                }}\r\n              >\r\n                {options.map((option) => renderMenuItem(option, optionKey, optionLabel))}\r\n              </Select>\r\n            );\r\n          }}\r\n        />\r\n      ) : (\r\n        <Select\r\n          value={value || ''}\r\n          {...props}\r\n          onChange={handleChangeMUI}\r\n          inputProps={{ ...merge({}, muiComponentProps?.inputProps, { 'data-form-type': 'select' }) }}\r\n        >\r\n          {options.map((option) => renderMenuItem(option, optionKey, optionLabel))}\r\n        </Select>\r\n      )}\r\n      <ErrorMessage error={error} hint={hint} />\r\n    </FormControl>\r\n  );\r\n}\r\n\r\nexport default FormSelect;\r\n"]},"metadata":{},"sourceType":"module"}