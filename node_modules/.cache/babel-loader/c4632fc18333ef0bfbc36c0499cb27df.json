{"ast":null,"code":"import _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ProcessingInstructionsDetails\\\\ProcessingInstructionsDetails.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport moment from 'moment';\nimport get from 'lodash/get'; // app\n\nimport ProcessingInstructionsDetailsView from './ProcessingInstructionsDetails.view';\nimport { selectUser, showModal, updateProcessingInstruction, removePremiumTaxSignedLinesDocument, storeRetainedBrokerageAmountForPdf, storeTotalAmountForPdf, addLoader, storeProcessingInstructionDocuments, viewDocumentsDownload, enqueueNotification, selectRefDataThirdPartyList } from 'stores';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport config from 'config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nProcessingInstructionsDetails.propTypes = {\n  instruction: PropTypes.object.isRequired,\n  handlers: PropTypes.shape({\n    back: PropTypes.func.isRequired,\n    next: PropTypes.func.isRequired\n  }).isRequired,\n  childRef: PropTypes.object.isRequired\n};\nexport default function ProcessingInstructionsDetails(_ref) {\n  _s();\n\n  var _instruction$details, _instruction$details2, _utils$processingInst, _utils$processingInst2, _utils$processingInst3, _utils$processingInst4, _utils$processingInst5, _utils$processingInst6, _utils$processingInst7, _utils$processingInst8, _utils$processingInst9, _utils$processingInst10, _utils$processingInst11, _utils$processingInst12, _utils$processingInst13, _utils$processingInst14, _utils$processingInst15, _utils$processingInst16, _utils$processingInst17, _utils$processingInst18, _utils$processingInst19, _utils$processingInst20, _utils$processingInst21, _utils$processingInst22, _utils$processingInst23, _utils$processingInst24, _utils$processingInst25, _utils$processingInst26, _utils$processingInst27, _utils$processingInst28, _utils$processingInst29, _utils$processingInst30, _utils$processingInst31, _utils$processingInst32, _utils$processingInst33, _utils$processingInst34, _instruction$details3, _instruction$riskRefe, _childRef$current, _childRef$current$pro;\n\n  var instruction = _ref.instruction,\n      handlers = _ref.handlers,\n      childRef = _ref.childRef;\n  var dispatch = useDispatch();\n  var user = useSelector(selectUser);\n  var documents = useSelector(function (state) {\n    return get(state, 'processingInstructions.documents');\n  }) || {};\n  var refDataCurrencies = useSelector(function (state) {\n    return get(state, 'referenceData.currencyCodes');\n  }) || [];\n  var optionsDepartments = useSelector(function (state) {\n    return state.processingInstructions.departmentList;\n  }) || [];\n  var optionsThirdParty = useSelector(selectRefDataThirdPartyList) || [];\n  var isDraft = utils.processingInstructions.status.isDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isReopened = utils.processingInstructions.status.isReopened(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\n  var userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\n  var isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\n  var isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\n  var isReadOnly = !isEditable;\n  var paymentBasisOptions = [{\n    id: '1',\n    code: 'cash',\n    name: 'Cash'\n  }, {\n    id: '2',\n    code: 'quaterly',\n    name: 'Quaterly'\n  }, {\n    id: '3',\n    code: 'otherDeferred',\n    name: 'Other Deferred'\n  }];\n  var ppwOrPpcOptions = [{\n    id: '1',\n    code: 'ppw',\n    name: 'PPW',\n    value: 1\n  }, {\n    id: '2',\n    code: 'ppc',\n    name: 'PPC',\n    value: 2\n  }, {\n    id: '3',\n    code: 'na',\n    name: 'N/A',\n    value: 3\n  }];\n  var toggleOptions = [{\n    label: utils.string.t('app.yes'),\n    value: 1\n  }, {\n    label: utils.string.t('app.no'),\n    value: 0\n  }, {\n    label: utils.string.t('app.na'),\n    value: -1\n  }];\n\n  var getToggleValue = function getToggleValue(value) {\n    return toggleOptions.map(function (o) {\n      return o.value;\n    }).includes(value) ? value : null;\n  };\n\n  var fields = [{\n    name: 'highPriority',\n    type: 'checkbox',\n    value: instruction === null || instruction === void 0 ? void 0 : (_instruction$details = instruction.details) === null || _instruction$details === void 0 ? void 0 : _instruction$details.highPriority,\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'frontEndSendDocs',\n    type: 'checkbox',\n    value: instruction === null || instruction === void 0 ? void 0 : (_instruction$details2 = instruction.details) === null || _instruction$details2 === void 0 ? void 0 : _instruction$details2.frontEndSendDocs,\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'premiumTaxCalculationSheetAttachedNumber',\n    type: 'toggle',\n    value: getToggleValue((_utils$processingInst = utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')) === null || _utils$processingInst === void 0 ? void 0 : _utils$processingInst.numberValue),\n    options: toggleOptions,\n    buttonGroupProps: {\n      exclusive: true,\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'premiumTaxCalculationSheetAttachedCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst2 = utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')) === null || _utils$processingInst2 === void 0 ? void 0 : _utils$processingInst2.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'signedLinesCalculationSheetAttachedNumber',\n    type: 'toggle',\n    value: getToggleValue((_utils$processingInst3 = utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')) === null || _utils$processingInst3 === void 0 ? void 0 : _utils$processingInst3.numberValue),\n    options: toggleOptions,\n    buttonGroupProps: {\n      exclusive: true,\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'signedLinesCalculationSheetAttachedCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst4 = utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')) === null || _utils$processingInst4 === void 0 ? void 0 : _utils$processingInst4.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'grossPremiumAmountNumber',\n    type: 'number',\n    value: ((_utils$processingInst5 = utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')) === null || _utils$processingInst5 === void 0 ? void 0 : _utils$processingInst5.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'grossPremiumAmountCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst6 = utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')) === null || _utils$processingInst6 === void 0 ? void 0 : _utils$processingInst6.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'slipOrderNumber',\n    type: 'number',\n    value: ((_utils$processingInst7 = utils.processingInstructions.getFinancialField(instruction, 'slipOrder')) === null || _utils$processingInst7 === void 0 ? void 0 : _utils$processingInst7.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'slipOrderCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst8 = utils.processingInstructions.getFinancialField(instruction, 'slipOrder')) === null || _utils$processingInst8 === void 0 ? void 0 : _utils$processingInst8.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'totalBrokerageNumber',\n    type: 'number',\n    value: ((_utils$processingInst9 = utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')) === null || _utils$processingInst9 === void 0 ? void 0 : _utils$processingInst9.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'totalBrokerageCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst10 = utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')) === null || _utils$processingInst10 === void 0 ? void 0 : _utils$processingInst10.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'clientDiscountNumber',\n    type: 'number',\n    value: ((_utils$processingInst11 = utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')) === null || _utils$processingInst11 === void 0 ? void 0 : _utils$processingInst11.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'clientDiscountCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst12 = utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')) === null || _utils$processingInst12 === void 0 ? void 0 : _utils$processingInst12.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'thirdPartyNumber',\n    type: 'number',\n    value: ((_utils$processingInst13 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst13 === void 0 ? void 0 : _utils$processingInst13.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'thirdPartyString',\n    type: 'select',\n    value: ((_utils$processingInst14 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst14 === void 0 ? void 0 : _utils$processingInst14.stringValue) || '',\n    options: (optionsThirdParty === null || optionsThirdParty === void 0 ? void 0 : optionsThirdParty.map(function (option) {\n      return {\n        value: option === null || option === void 0 ? void 0 : option.id,\n        label: option === null || option === void 0 ? void 0 : option.partnerName\n      };\n    })) || [],\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'thirdPartyCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst15 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst15 === void 0 ? void 0 : _utils$processingInst15.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'pfinternalNumber',\n    type: 'number',\n    value: ((_utils$processingInst16 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst16 === void 0 ? void 0 : _utils$processingInst16.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'pfinternalString',\n    type: 'select',\n    value: ((_utils$processingInst17 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst17 === void 0 ? void 0 : _utils$processingInst17.stringValue) || '',\n    options: optionsDepartments,\n    optionKey: 'id',\n    optionLabel: 'deptName',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'pfinternalCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst18 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst18 === void 0 ? void 0 : _utils$processingInst18.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'retainedBrokerageNumber',\n    type: 'number',\n    value: ((_utils$processingInst19 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')) === null || _utils$processingInst19 === void 0 ? void 0 : _utils$processingInst19.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'retainedBrokerageCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst20 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')) === null || _utils$processingInst20 === void 0 ? void 0 : _utils$processingInst20.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'retainedBrokerageCurrencyCodeString',\n    value: ((_utils$processingInst21 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')) === null || _utils$processingInst21 === void 0 ? void 0 : _utils$processingInst21.stringValue) || constants.CURRENCY_USD,\n    optionsKey: 'premiumCurrency',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'retainedBrokerageCurrencyCodeCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst22 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')) === null || _utils$processingInst22 === void 0 ? void 0 : _utils$processingInst22.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'feesNumber',\n    type: 'number',\n    value: ((_utils$processingInst23 = utils.processingInstructions.getFinancialField(instruction, 'fees')) === null || _utils$processingInst23 === void 0 ? void 0 : _utils$processingInst23.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'feesCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst24 = utils.processingInstructions.getFinancialField(instruction, 'fees')) === null || _utils$processingInst24 === void 0 ? void 0 : _utils$processingInst24.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'otherDeductionsNumber',\n    type: 'number',\n    value: ((_utils$processingInst25 = utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')) === null || _utils$processingInst25 === void 0 ? void 0 : _utils$processingInst25.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'otherDeductionsCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst26 = utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')) === null || _utils$processingInst26 === void 0 ? void 0 : _utils$processingInst26.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'settlementCurrencyCodeIdNumber',\n    type: 'select',\n    value: ((_utils$processingInst27 = utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')) === null || _utils$processingInst27 === void 0 ? void 0 : _utils$processingInst27.numberValue) || '',\n    options: refDataCurrencies,\n    optionKey: 'currencyCodeID',\n    optionLabel: 'currencyCd',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'settlementCurrencyCodeIdCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst28 = utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')) === null || _utils$processingInst28 === void 0 ? void 0 : _utils$processingInst28.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'paymentBasisNumber',\n    type: 'select',\n    value: ((_utils$processingInst29 = utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')) === null || _utils$processingInst29 === void 0 ? void 0 : _utils$processingInst29.numberValue) || '',\n    options: paymentBasisOptions,\n    optionKey: 'id',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'paymentBasisCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst30 = utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')) === null || _utils$processingInst30 === void 0 ? void 0 : _utils$processingInst30.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'ppwOrPpcNumber',\n    type: 'select',\n    value: ((_utils$processingInst31 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst31 === void 0 ? void 0 : _utils$processingInst31.numberValue) || '',\n    options: ppwOrPpcOptions,\n    optionKey: 'value',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly\n    }\n  }, {\n    name: 'ppwOrPpcDate',\n    type: 'datepicker',\n    value: ((_utils$processingInst32 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst32 === void 0 ? void 0 : _utils$processingInst32.dateValue) ? moment((_utils$processingInst33 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst33 === void 0 ? void 0 : _utils$processingInst33.dateValue) : null,\n    outputFormat: 'iso',\n    placeholder: utils.string.t('app.selectDate'),\n    muiComponentProps: {\n      disabled: isReadOnly\n    },\n    muiPickerProps: {\n      format: config.ui.format.date.text,\n      clearable: true\n    }\n  }, {\n    name: 'ppwOrPpcCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst34 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst34 === void 0 ? void 0 : _utils$processingInst34.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable\n  }, {\n    name: 'notes',\n    label: utils.string.t('processingInstructions.details.notes'),\n    type: 'textarea',\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details3 = instruction.details) === null || _instruction$details3 === void 0 ? void 0 : _instruction$details3.notes) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      minRows: 4,\n      maxRows: 8,\n      disabled: isReadOnly\n    }\n  }];\n  var selectedRiskRef = instruction === null || instruction === void 0 ? void 0 : (_instruction$riskRefe = instruction.riskReferences) === null || _instruction$riskRefe === void 0 ? void 0 : _instruction$riskRefe.find(function (r) {\n    return r.leadPolicy;\n  });\n  var retainedBrokerageCurrencyCodeField = utils.form.getFieldProps(fields, 'retainedBrokerageCurrencyCodeString');\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      defaultValues = _useState2[0],\n      setDefaultValues = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      retainedBrokerageAmount = _useState4[0],\n      setRetainedBrokerageAmount = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      convertedBrokerage = _useState6[0],\n      setConvertedBrokerage = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      totalAmount = _useState8[0],\n      setTotalAmount = _useState8[1];\n\n  var _useState9 = useState({\n    premiumTaxDocument: false,\n    signedLinesDocument: false\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      documentNotUploadedError = _useState10[0],\n      setDocumentNotUploadedError = _useState10[1];\n\n  var formValues = childRef === null || childRef === void 0 ? void 0 : (_childRef$current = childRef.current) === null || _childRef$current === void 0 ? void 0 : (_childRef$current$pro = _childRef$current.props) === null || _childRef$current$pro === void 0 ? void 0 : _childRef$current$pro.values;\n  var retainedBrokerageCurrencyCode = (formValues === null || formValues === void 0 ? void 0 : formValues.retainedBrokerageCurrencyCodeString) || (retainedBrokerageCurrencyCodeField === null || retainedBrokerageCurrencyCodeField === void 0 ? void 0 : retainedBrokerageCurrencyCodeField.defaultValue) || (retainedBrokerageCurrencyCodeField === null || retainedBrokerageCurrencyCodeField === void 0 ? void 0 : retainedBrokerageCurrencyCodeField.value);\n\n  var getRetainedBrokerageAmount = function getRetainedBrokerageAmount(_ref2) {\n    var grossPremiumAmount = _ref2.grossPremiumAmount,\n        slipOrder = _ref2.slipOrder,\n        retainedBrokerage = _ref2.retainedBrokerage,\n        retainedBrokerageCurrencyCode = _ref2.retainedBrokerageCurrencyCode,\n        retainedBrokerageAmount = _ref2.retainedBrokerageAmount;\n    var amount = utils.processingInstructions.getRetainedBrokerageValue(grossPremiumAmount, slipOrder, retainedBrokerage);\n    var brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(retainedBrokerageCurrencyCode, retainedBrokerageAmount);\n    setRetainedBrokerageAmount(amount);\n    setConvertedBrokerage(brokerage);\n    dispatch(storeRetainedBrokerageAmountForPdf({\n      retBrokerageAmt: amount,\n      convertedBrokerageAmt: brokerage\n    }));\n  };\n\n  var getTotalAmount = function getTotalAmount(_ref3) {\n    var clientDiscount = _ref3.clientDiscount,\n        thirdPartyCommissionSharing = _ref3.thirdPartyCommissionSharing,\n        pfinternalCommissionSharing = _ref3.pfinternalCommissionSharing,\n        retainedBrokerage = _ref3.retainedBrokerage;\n\n    if (clientDiscount && thirdPartyCommissionSharing && pfinternalCommissionSharing && retainedBrokerage) {\n      var sumValuesArray = [clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage];\n      setTotalAmount(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal));\n      dispatch(storeTotalAmountForPdf(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal)));\n    } else {\n      setTotalAmount('');\n    }\n  };\n\n  var handleNext = function handleNext() {\n    var _childRef$current2, _childRef$current2$pr;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current2 = childRef.current) === null || _childRef$current2 === void 0 ? void 0 : (_childRef$current2$pr = _childRef$current2.props) === null || _childRef$current2$pr === void 0 ? void 0 : _childRef$current2$pr.values) || {};\n\n    if (formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument || formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument) {\n      dispatch(enqueueNotification(utils.string.t('processingInstructions.details.noDocumentUploaded', {\n        documentType: formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument && formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument && utils.string.t('processingInstructions.details.premiumTaxCalculationSheetAttachedAndSignedLinesCalculationAttached') || formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument && utils.string.t('processingInstructions.details.premiumTaxCalculationSheetAttached') || formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument && utils.string.t('processingInstructions.details.signedLinesCalculationAttached')\n      }), 'warning'));\n      setDocumentNotUploadedError({\n        premiumTaxDocument: formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocumen,\n        signedLinesDocument: formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument\n      });\n      return;\n    }\n\n    setDocumentNotUploadedError({\n      premiumTaxDocument: false,\n      signedLinesDocument: false\n    });\n    handlers.next();\n  };\n\n  var handleSave = function handleSave(type) {\n    var _childRef$current3, _childRef$current3$pr;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current3 = childRef.current) === null || _childRef$current3 === void 0 ? void 0 : (_childRef$current3$pr = _childRef$current3.props) === null || _childRef$current3$pr === void 0 ? void 0 : _childRef$current3$pr.values) || {};\n    var financialChecklistBlank = [{\n      name: 'signedLinesCalculationSheetAttached',\n      types: ['Number']\n    }, {\n      name: 'premiumTaxCalculationSheetAttached',\n      types: ['Number']\n    }, {\n      name: 'grossPremiumAmount',\n      types: ['Number']\n    }, {\n      name: 'slipOrder',\n      types: ['Number']\n    }, {\n      name: 'totalBrokerage',\n      types: ['Number']\n    }, {\n      name: 'fees',\n      types: ['Number']\n    }, {\n      name: 'otherDeductions',\n      types: ['Number']\n    }, {\n      name: 'settlementCurrencyCodeId',\n      types: ['Number']\n    }, {\n      name: 'paymentBasis',\n      types: ['Number']\n    }, {\n      name: 'ppwOrPpc',\n      types: ['Number', 'Date']\n    }, {\n      name: 'clientDiscount',\n      types: ['Number']\n    }, {\n      name: 'thirdParty',\n      types: ['Number', 'String']\n    }, {\n      name: 'pfinternal',\n      types: ['Number', 'String']\n    }, {\n      name: 'retainedBrokerage',\n      types: ['Number']\n    }, {\n      name: 'retainedBrokerageCurrencyCode',\n      types: ['String']\n    }];\n\n    var updatedInstruction = _objectSpread(_objectSpread({}, instruction), {}, {\n      details: _objectSpread(_objectSpread({}, instruction.details), {}, {\n        highPriority: formValues.highPriority,\n        frontEndSendDocs: formValues.frontEndSendDocs,\n        notes: formValues.notes,\n        retainedBrokerageCurrencyCode: retainedBrokerageCurrencyCode\n      }),\n      financialChecklist: financialChecklistBlank.map(function (_ref4) {\n        var name = _ref4.name,\n            types = _ref4.types;\n        return types.reduce(function (acc, type) {\n          var _objectSpread2;\n\n          var valueKey = \"\".concat(name).concat(type);\n          var isThirdPartyString = valueKey === 'thirdPartyString';\n          var thirdPartyNumberValue = formValues['thirdPartyNumber'];\n          var thirdPartyStringValue = Boolean(thirdPartyNumberValue) ? formValues[valueKey] : '';\n          var isPfInternalString = valueKey === 'pfinternalString';\n          var pfInternalNumberValue = formValues['pfinternalNumber'];\n          var pfInternalStringValue = Boolean(pfInternalNumberValue) ? formValues[valueKey] : '';\n          var value = isThirdPartyString ? thirdPartyStringValue : isPfInternalString ? pfInternalStringValue : formValues[valueKey];\n          var isDate = type === 'Date';\n          var isValidDate = isDate && moment(value).isValid();\n          return _objectSpread(_objectSpread({}, acc), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, \"\".concat(type.toLowerCase(), \"Value\"), isDate ? isValidDate ? moment(value).format('YYYY-MM-DD') : '' : value), _defineProperty(_objectSpread2, \"approvedByAuthorisedSignatory\", formValues[\"\".concat(name, \"Checkbox\")]), _objectSpread2));\n        }, {\n          name: name\n        });\n      })\n    });\n\n    dispatch(updateProcessingInstruction(updatedInstruction, formValues)).then(function (response) {\n      if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n        if (type === 'saveNext') {\n          handlers.next();\n        }\n      }\n    });\n  };\n\n  var handleCancel = function handleCancel() {\n    var _childRef$current4, _childRef$current4$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current4 = childRef.current) === null || _childRef$current4 === void 0 ? void 0 : (_childRef$current4$pr = _childRef$current4.props) === null || _childRef$current4$pr === void 0 ? void 0 : _childRef$current4$pr.resetFunc;\n\n    if (utils.generic.isFunction(reset)) {\n      reset(defaultValues, {\n        keepDirty: false\n      });\n    }\n\n    setDocumentNotUploadedError({\n      premiumTaxDocument: false,\n      signedLinesDocument: false\n    });\n  };\n\n  useEffect(function () {\n    var _childRef$current5, _childRef$current5$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current5 = childRef.current) === null || _childRef$current5 === void 0 ? void 0 : (_childRef$current5$pr = _childRef$current5.props) === null || _childRef$current5$pr === void 0 ? void 0 : _childRef$current5$pr.resetFunc;\n\n    var updatedDefaultValues = _objectSpread({}, utils.form.getInitialValues(fields));\n\n    setDefaultValues(updatedDefaultValues);\n\n    if (utils.generic.isFunction(reset)) {\n      reset(updatedDefaultValues, {\n        keepDirty: false\n      });\n    }\n  }, [instruction] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  var handleUploadedDocument = function handleUploadedDocument(data, documentTypeKey) {\n    var _data$data;\n\n    var newFiles = data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.documentDto;\n    if (!utils.generic.isValidArray(newFiles)) return;\n    var newGxbDocs = newFiles.map(function (file) {\n      return _objectSpread(_objectSpread({}, file), {}, {\n        folderUuid: file === null || file === void 0 ? void 0 : file.folderUid,\n        name: file === null || file === void 0 ? void 0 : file.documentName,\n        path: file === null || file === void 0 ? void 0 : file.documentPath,\n        source: file === null || file === void 0 ? void 0 : file.documentSource,\n        typeId: file === null || file === void 0 ? void 0 : file.documentTypeId,\n        uuid: file === null || file === void 0 ? void 0 : file.documentUid\n      });\n    });\n\n    var updatedDocuments = _objectSpread(_objectSpread(_objectSpread({}, documents), documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piPremiumCalculation && {\n      premiumTaxDocument: newGxbDocs[0]\n    }), documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piMarketSigned && {\n      signedLinesDocument: newGxbDocs[0]\n    });\n\n    dispatch(storeProcessingInstructionDocuments(updatedDocuments));\n  };\n\n  var uploadPremiumTaxSignedLinesModal = function uploadPremiumTaxSignedLinesModal(documentTypeKey) {\n    return function (files) {\n      dispatch(addLoader('DmsUploadFiles'));\n      dispatch(showModal({\n        component: 'DMS_UPLOAD_FILES',\n        props: {\n          fullWidth: true,\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\n          maxWidth: 'xl',\n          componentProps: {\n            files: files,\n            context: constants.DMS_CONTEXT_PROCESSING_INSTRUCTION,\n            referenceId: Number(instruction === null || instruction === void 0 ? void 0 : instruction.id),\n            sourceId: Number(selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : selectedRiskRef.xbInstanceId),\n            documentTypeKey: documentTypeKey,\n            postDmsDocumentsSuccess: function postDmsDocumentsSuccess(data) {\n              return handleUploadedDocument(data, documentTypeKey);\n            },\n            confirmLabel: utils.string.t('app.ok'),\n            cancelLabel: utils.string.t('app.goBack'),\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\n            buttonColors: {\n              confirm: 'secondary',\n              cancel: 'primary'\n            }\n          }\n        }\n      }));\n    };\n  };\n\n  var confirmRemoveDocumentModal = function confirmRemoveDocumentModal(file, removeDocumentType) {\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        fullWidth: true,\n        title: utils.string.t('processingInstructions.checklist.warning.title'),\n        maxWidth: 'xs',\n        componentProps: {\n          confirmLabel: utils.string.t('app.yes'),\n          cancelLabel: utils.string.t('app.no'),\n          confirmMessage: utils.string.t('processingInstructions.removeDocumentWarning'),\n          buttonColors: {\n            confirm: 'secondary',\n            cancel: 'primary'\n          },\n          submitHandler: function submitHandler() {\n            dispatch(removePremiumTaxSignedLinesDocument({\n              docIds: file === null || file === void 0 ? void 0 : file.documentId,\n              removeDocumentType: removeDocumentType,\n              documents: documents\n            }));\n          },\n          cancelHandler: function cancelHandler() {},\n          handleClose: function handleClose() {}\n        }\n      }\n    }));\n  };\n\n  var handleLinkDownload = function handleLinkDownload(file) {\n    dispatch(viewDocumentsDownload({\n      documentId: file === null || file === void 0 ? void 0 : file.documentId,\n      documentName: file === null || file === void 0 ? void 0 : file.name\n    }));\n  }; // abort if data is not ready/available\n\n\n  if (!defaultValues || !instruction) return null;\n  return /*#__PURE__*/_jsxDEV(ProcessingInstructionsDetailsView, {\n    instructionId: instruction === null || instruction === void 0 ? void 0 : instruction.id,\n    documents: documents,\n    fields: fields,\n    defaultValues: defaultValues,\n    retainedBrokerageAmount: retainedBrokerageAmount,\n    convertedBrokerage: convertedBrokerage,\n    premiumCurrency: retainedBrokerageCurrencyCode,\n    sumTotal: totalAmount,\n    riskRefId: selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : selectedRiskRef.riskRefId,\n    isEditable: isEditable,\n    isReadOnly: isReadOnly,\n    documentNotUploadedError: documentNotUploadedError,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      next: handleNext,\n      save: handleSave,\n      cancel: handleCancel,\n      getRetainedBrokerageAmount: getRetainedBrokerageAmount,\n      getTotalAmount: getTotalAmount,\n      uploadPremiumTaxSignedLinesModal: uploadPremiumTaxSignedLinesModal,\n      confirmRemoveDocumentModal: confirmRemoveDocumentModal,\n      download: handleLinkDownload\n    }),\n    ref: childRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 652,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProcessingInstructionsDetails, \"v+1PmpAYSPA7xZMqdPof3bbjqrM=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ProcessingInstructionsDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProcessingInstructionsDetails\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsDetails/ProcessingInstructionsDetails.js"],"names":["React","useState","useEffect","PropTypes","useDispatch","useSelector","moment","get","ProcessingInstructionsDetailsView","selectUser","showModal","updateProcessingInstruction","removePremiumTaxSignedLinesDocument","storeRetainedBrokerageAmountForPdf","storeTotalAmountForPdf","addLoader","storeProcessingInstructionDocuments","viewDocumentsDownload","enqueueNotification","selectRefDataThirdPartyList","constants","utils","config","ProcessingInstructionsDetails","propTypes","instruction","object","isRequired","handlers","shape","back","func","next","childRef","dispatch","user","documents","state","refDataCurrencies","optionsDepartments","processingInstructions","departmentList","optionsThirdParty","isDraft","status","statusId","isRejectedDraft","isSubmittedAuthorisedSignatory","isReopened","userHasWritePermission","app","access","feature","userHasApproverAccess","isCheckboxesEditable","isEditable","isReadOnly","paymentBasisOptions","id","code","name","ppwOrPpcOptions","value","toggleOptions","label","string","t","getToggleValue","map","o","includes","fields","type","details","highPriority","muiComponentProps","disabled","frontEndSendDocs","getFinancialField","numberValue","options","buttonGroupProps","exclusive","approvedByAuthorisedSignatory","autoComplete","stringValue","option","partnerName","optionKey","optionLabel","CURRENCY_USD","optionsKey","dateValue","outputFormat","placeholder","muiPickerProps","format","ui","date","text","clearable","notes","inputProps","maxLength","multiline","minRows","maxRows","selectedRiskRef","riskReferences","find","r","leadPolicy","retainedBrokerageCurrencyCodeField","form","getFieldProps","defaultValues","setDefaultValues","retainedBrokerageAmount","setRetainedBrokerageAmount","convertedBrokerage","setConvertedBrokerage","totalAmount","setTotalAmount","premiumTaxDocument","signedLinesDocument","documentNotUploadedError","setDocumentNotUploadedError","formValues","current","props","values","retainedBrokerageCurrencyCode","retainedBrokerageCurrencyCodeString","defaultValue","getRetainedBrokerageAmount","grossPremiumAmount","slipOrder","retainedBrokerage","amount","getRetainedBrokerageValue","brokerage","getRetainedBrokerageConvertedValue","retBrokerageAmt","convertedBrokerageAmt","getTotalAmount","clientDiscount","thirdPartyCommissionSharing","pfinternalCommissionSharing","sumValuesArray","generic","getSumOfArray","percent","decimal","handleNext","premiumTaxCalculationSheetAttachedNumber","signedLinesCalculationSheetAttachedNumber","documentType","premiumTaxDocumen","handleSave","financialChecklistBlank","types","updatedInstruction","financialChecklist","reduce","acc","valueKey","isThirdPartyString","thirdPartyNumberValue","thirdPartyStringValue","Boolean","isPfInternalString","pfInternalNumberValue","pfInternalStringValue","isDate","isValidDate","isValid","toLowerCase","then","response","API_RESPONSE_OK","handleCancel","reset","resetFunc","isFunction","keepDirty","updatedDefaultValues","getInitialValues","handleUploadedDocument","data","documentTypeKey","newFiles","documentDto","isValidArray","newGxbDocs","file","folderUuid","folderUid","documentName","path","documentPath","source","documentSource","typeId","documentTypeId","uuid","documentUid","updatedDocuments","DMS_DOCUMENT_TYPE_SECTION_KEYS","piPremiumCalculation","piMarketSigned","uploadPremiumTaxSignedLinesModal","files","component","fullWidth","title","maxWidth","componentProps","context","DMS_CONTEXT_PROCESSING_INSTRUCTION","referenceId","Number","sourceId","xbInstanceId","postDmsDocumentsSuccess","confirmLabel","cancelLabel","confirmMessage","buttonColors","confirm","cancel","confirmRemoveDocumentModal","removeDocumentType","submitHandler","docIds","documentId","cancelHandler","handleClose","handleLinkDownload","riskRefId","save","download"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport moment from 'moment';\r\nimport get from 'lodash/get';\r\n\r\n// app\r\nimport ProcessingInstructionsDetailsView from './ProcessingInstructionsDetails.view';\r\nimport {\r\n  selectUser,\r\n  showModal,\r\n  updateProcessingInstruction,\r\n  removePremiumTaxSignedLinesDocument,\r\n  storeRetainedBrokerageAmountForPdf,\r\n  storeTotalAmountForPdf,\r\n  addLoader,\r\n  storeProcessingInstructionDocuments,\r\n  viewDocumentsDownload,\r\n  enqueueNotification,\r\n  selectRefDataThirdPartyList,\r\n} from 'stores';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\nProcessingInstructionsDetails.propTypes = {\r\n  instruction: PropTypes.object.isRequired,\r\n  handlers: PropTypes.shape({\r\n    back: PropTypes.func.isRequired,\r\n    next: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n  childRef: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default function ProcessingInstructionsDetails({ instruction, handlers, childRef }) {\r\n  const dispatch = useDispatch();\r\n\r\n  const user = useSelector(selectUser);\r\n  const documents = useSelector((state) => get(state, 'processingInstructions.documents')) || {};\r\n  const refDataCurrencies = useSelector((state) => get(state, 'referenceData.currencyCodes')) || [];\r\n  const optionsDepartments = useSelector((state) => state.processingInstructions.departmentList) || [];\r\n  const optionsThirdParty = useSelector(selectRefDataThirdPartyList) || [];\r\n  const isDraft = utils.processingInstructions.status.isDraft(instruction?.statusId);\r\n  const isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction?.statusId);\r\n  const isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction?.statusId);\r\n  const isReopened = utils.processingInstructions.status.isReopened(instruction?.statusId);\r\n  const userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\r\n  const userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\r\n  const isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\r\n\r\n  const isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\r\n  const isReadOnly = !isEditable;\r\n\r\n  const paymentBasisOptions = [\r\n    { id: '1', code: 'cash', name: 'Cash' },\r\n    { id: '2', code: 'quaterly', name: 'Quaterly' },\r\n    { id: '3', code: 'otherDeferred', name: 'Other Deferred' },\r\n  ];\r\n\r\n  const ppwOrPpcOptions = [\r\n    { id: '1', code: 'ppw', name: 'PPW', value: 1 },\r\n    { id: '2', code: 'ppc', name: 'PPC', value: 2 },\r\n    { id: '3', code: 'na', name: 'N/A', value: 3 },\r\n  ];\r\n\r\n  const toggleOptions = [\r\n    { label: utils.string.t('app.yes'), value: 1 },\r\n    { label: utils.string.t('app.no'), value: 0 },\r\n    { label: utils.string.t('app.na'), value: -1 },\r\n  ];\r\n\r\n  const getToggleValue = (value) => {\r\n    return toggleOptions.map((o) => o.value).includes(value) ? value : null;\r\n  };\r\n\r\n  const fields = [\r\n    {\r\n      name: 'highPriority',\r\n      type: 'checkbox',\r\n      value: instruction?.details?.highPriority,\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'frontEndSendDocs',\r\n      type: 'checkbox',\r\n      value: instruction?.details?.frontEndSendDocs,\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'premiumTaxCalculationSheetAttachedNumber',\r\n      type: 'toggle',\r\n      value: getToggleValue(utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')?.numberValue),\r\n      options: toggleOptions,\r\n      buttonGroupProps: {\r\n        exclusive: true,\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'premiumTaxCalculationSheetAttachedCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')\r\n        ?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'signedLinesCalculationSheetAttachedNumber',\r\n      type: 'toggle',\r\n      value: getToggleValue(\r\n        utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')?.numberValue\r\n      ),\r\n      options: toggleOptions,\r\n      buttonGroupProps: {\r\n        exclusive: true,\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'signedLinesCalculationSheetAttachedCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')\r\n        ?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'grossPremiumAmountNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'grossPremiumAmountCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'slipOrderNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'slipOrder')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'slipOrderCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'slipOrder')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'totalBrokerageNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'totalBrokerageCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'clientDiscountNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'clientDiscountCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'thirdPartyNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'thirdPartyString',\r\n      type: 'select', \r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.stringValue || '',\r\n      options: optionsThirdParty?.map((option) => ({\r\n          value: option?.id,\r\n          label: option?.partnerName,\r\n      })) || [],\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'thirdPartyCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'pfinternalNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'pfinternalString',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.stringValue || '',\r\n      options: optionsDepartments,\r\n      optionKey: 'id',\r\n      optionLabel: 'deptName',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'pfinternalCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'retainedBrokerageNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCurrencyCodeString',\r\n      value:\r\n        utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')?.stringValue || constants.CURRENCY_USD,\r\n      optionsKey: 'premiumCurrency',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCurrencyCodeCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'feesNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'fees')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'feesCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'fees')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'otherDeductionsNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'otherDeductionsCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'settlementCurrencyCodeIdNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')?.numberValue || '',\r\n      options: refDataCurrencies,\r\n      optionKey: 'currencyCodeID',\r\n      optionLabel: 'currencyCd',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'settlementCurrencyCodeIdCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'paymentBasisNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')?.numberValue || '',\r\n      options: paymentBasisOptions,\r\n      optionKey: 'id',\r\n      optionLabel: 'name',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'paymentBasisCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'ppwOrPpcNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.numberValue || '',\r\n      options: ppwOrPpcOptions,\r\n      optionKey: 'value',\r\n      optionLabel: 'name',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n    {\r\n      name: 'ppwOrPpcDate',\r\n      type: 'datepicker',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.dateValue\r\n        ? moment(utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.dateValue)\r\n        : null,\r\n      outputFormat: 'iso',\r\n      placeholder: utils.string.t('app.selectDate'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly,\r\n      },\r\n      muiPickerProps: {\r\n        format: config.ui.format.date.text,\r\n        clearable: true,\r\n      },\r\n    },\r\n    {\r\n      name: 'ppwOrPpcCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable,\r\n    },\r\n    {\r\n      name: 'notes',\r\n      label: utils.string.t('processingInstructions.details.notes'),\r\n      type: 'textarea',\r\n      value: instruction?.details?.notes || '',\r\n      muiComponentProps: {\r\n        inputProps: { maxLength: 4000 },\r\n        multiline: true,\r\n        minRows: 4,\r\n        maxRows: 8,\r\n        disabled: isReadOnly,\r\n      },\r\n    },\r\n  ];\r\n\r\n  const selectedRiskRef = instruction?.riskReferences?.find((r) => r.leadPolicy);\r\n  const retainedBrokerageCurrencyCodeField = utils.form.getFieldProps(fields, 'retainedBrokerageCurrencyCodeString');\r\n\r\n  const [defaultValues, setDefaultValues] = useState();\r\n  const [retainedBrokerageAmount, setRetainedBrokerageAmount] = useState('');\r\n  const [convertedBrokerage, setConvertedBrokerage] = useState();\r\n  const [totalAmount, setTotalAmount] = useState('');\r\n  const [documentNotUploadedError, setDocumentNotUploadedError] = useState({ premiumTaxDocument: false, signedLinesDocument: false });\r\n\r\n  const formValues = childRef?.current?.props?.values;\r\n  const retainedBrokerageCurrencyCode =\r\n    formValues?.retainedBrokerageCurrencyCodeString ||\r\n    retainedBrokerageCurrencyCodeField?.defaultValue ||\r\n    retainedBrokerageCurrencyCodeField?.value;\r\n\r\n  const getRetainedBrokerageAmount = ({\r\n    grossPremiumAmount,\r\n    slipOrder,\r\n    retainedBrokerage,\r\n    retainedBrokerageCurrencyCode,\r\n    retainedBrokerageAmount,\r\n  }) => {\r\n    const amount = utils.processingInstructions.getRetainedBrokerageValue(grossPremiumAmount, slipOrder, retainedBrokerage);\r\n    const brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(\r\n      retainedBrokerageCurrencyCode,\r\n      retainedBrokerageAmount\r\n    );\r\n\r\n    setRetainedBrokerageAmount(amount);\r\n    setConvertedBrokerage(brokerage);\r\n    dispatch(\r\n      storeRetainedBrokerageAmountForPdf({\r\n        retBrokerageAmt: amount,\r\n        convertedBrokerageAmt: brokerage,\r\n      })\r\n    );\r\n  };\r\n\r\n  const getTotalAmount = ({ clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage }) => {\r\n    if (clientDiscount && thirdPartyCommissionSharing && pfinternalCommissionSharing && retainedBrokerage) {\r\n      const sumValuesArray = [clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage];\r\n\r\n      setTotalAmount(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal));\r\n      dispatch(storeTotalAmountForPdf(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal)));\r\n    } else {\r\n      setTotalAmount('');\r\n    }\r\n  };\r\n\r\n  const handleNext = () => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    if (\r\n      (formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument) ||\r\n      (formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument)\r\n    ) {\r\n      dispatch(\r\n        enqueueNotification(\r\n          utils.string.t('processingInstructions.details.noDocumentUploaded', {\r\n            documentType:\r\n              (formValues.premiumTaxCalculationSheetAttachedNumber === 1 &&\r\n                !documents.premiumTaxDocument &&\r\n                formValues.signedLinesCalculationSheetAttachedNumber === 1 &&\r\n                !documents.signedLinesDocument &&\r\n                utils.string.t('processingInstructions.details.premiumTaxCalculationSheetAttachedAndSignedLinesCalculationAttached')) ||\r\n              (formValues.premiumTaxCalculationSheetAttachedNumber === 1 &&\r\n                !documents.premiumTaxDocument &&\r\n                utils.string.t('processingInstructions.details.premiumTaxCalculationSheetAttached')) ||\r\n              (formValues.signedLinesCalculationSheetAttachedNumber === 1 &&\r\n                !documents.signedLinesDocument &&\r\n                utils.string.t('processingInstructions.details.signedLinesCalculationAttached')),\r\n          }),\r\n          'warning'\r\n        )\r\n      );\r\n      setDocumentNotUploadedError({\r\n        premiumTaxDocument: formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocumen,\r\n        signedLinesDocument: formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument,\r\n      });\r\n      return;\r\n    }\r\n    setDocumentNotUploadedError({\r\n      premiumTaxDocument: false,\r\n      signedLinesDocument: false,\r\n    });\r\n    handlers.next();\r\n  };\r\n\r\n  const handleSave = (type) => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    const financialChecklistBlank = [\r\n      { name: 'signedLinesCalculationSheetAttached', types: ['Number'] },\r\n      { name: 'premiumTaxCalculationSheetAttached', types: ['Number'] },\r\n      { name: 'grossPremiumAmount', types: ['Number'] },\r\n      { name: 'slipOrder', types: ['Number'] },\r\n      { name: 'totalBrokerage', types: ['Number'] },\r\n      { name: 'fees', types: ['Number'] },\r\n      { name: 'otherDeductions', types: ['Number'] },\r\n      { name: 'settlementCurrencyCodeId', types: ['Number'] },\r\n      { name: 'paymentBasis', types: ['Number'] },\r\n      { name: 'ppwOrPpc', types: ['Number', 'Date'] },\r\n      { name: 'clientDiscount', types: ['Number'] },\r\n      { name: 'thirdParty', types: ['Number', 'String'] },\r\n      { name: 'pfinternal', types: ['Number', 'String'] },\r\n      { name: 'retainedBrokerage', types: ['Number'] },\r\n      { name: 'retainedBrokerageCurrencyCode', types: ['String'] },\r\n    ];\r\n\r\n    const updatedInstruction = {\r\n      ...instruction,\r\n      details: {\r\n        ...instruction.details,\r\n        highPriority: formValues.highPriority,\r\n        frontEndSendDocs: formValues.frontEndSendDocs,\r\n        notes: formValues.notes,\r\n        retainedBrokerageCurrencyCode,\r\n      },\r\n      financialChecklist: financialChecklistBlank.map(({ name, types }) => {\r\n        return types.reduce(\r\n          (acc, type) => {\r\n            const valueKey = `${name}${type}`;\r\n\r\n            const isThirdPartyString = valueKey === 'thirdPartyString';\r\n            const thirdPartyNumberValue = formValues['thirdPartyNumber'];\r\n            const thirdPartyStringValue = Boolean(thirdPartyNumberValue) ? formValues[valueKey] : '';\r\n\r\n            const isPfInternalString = valueKey === 'pfinternalString';\r\n            const pfInternalNumberValue = formValues['pfinternalNumber'];\r\n            const pfInternalStringValue = Boolean(pfInternalNumberValue) ? formValues[valueKey] : '';\r\n\r\n            const value = isThirdPartyString ? thirdPartyStringValue : isPfInternalString ? pfInternalStringValue : formValues[valueKey];\r\n            const isDate = type === 'Date';\r\n            const isValidDate = isDate && moment(value).isValid();\r\n\r\n            return {\r\n              ...acc,\r\n              [`${type.toLowerCase()}Value`]: isDate ? (isValidDate ? moment(value).format('YYYY-MM-DD') : '') : value,\r\n              approvedByAuthorisedSignatory: formValues[`${name}Checkbox`],\r\n            };\r\n          },\r\n          { name }\r\n        );\r\n      }),\r\n    };\r\n\r\n    dispatch(updateProcessingInstruction(updatedInstruction, formValues)).then((response) => {\r\n      if (response?.status === constants.API_RESPONSE_OK) {\r\n        if (type === 'saveNext') {\r\n          handlers.next();\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    const reset = childRef?.current?.props?.resetFunc;\r\n\r\n    if (utils.generic.isFunction(reset)) {\r\n      reset(defaultValues, { keepDirty: false });\r\n    }\r\n    setDocumentNotUploadedError({\r\n      premiumTaxDocument: false,\r\n      signedLinesDocument: false,\r\n    });\r\n  };\r\n\r\n  useEffect(\r\n    () => {\r\n      const reset = childRef?.current?.props?.resetFunc;\r\n      const updatedDefaultValues = {\r\n        ...utils.form.getInitialValues(fields),\r\n      };\r\n\r\n      setDefaultValues(updatedDefaultValues);\r\n\r\n      if (utils.generic.isFunction(reset)) {\r\n        reset(updatedDefaultValues, {\r\n          keepDirty: false,\r\n        });\r\n      }\r\n    },\r\n    [instruction] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  const handleUploadedDocument = (data, documentTypeKey) => {\r\n    const newFiles = data?.data?.documentDto;\r\n    if (!utils.generic.isValidArray(newFiles)) return;\r\n    const newGxbDocs = newFiles.map((file) => {\r\n      return {\r\n        ...file,\r\n        folderUuid: file?.folderUid,\r\n        name: file?.documentName,\r\n        path: file?.documentPath,\r\n        source: file?.documentSource,\r\n        typeId: file?.documentTypeId,\r\n        uuid: file?.documentUid,\r\n      };\r\n    });\r\n\r\n    const updatedDocuments = {\r\n      ...documents,\r\n      ...(documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piPremiumCalculation && {\r\n        premiumTaxDocument: newGxbDocs[0],\r\n      }),\r\n      ...(documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piMarketSigned && {\r\n        signedLinesDocument: newGxbDocs[0],\r\n      }),\r\n    };\r\n    dispatch(storeProcessingInstructionDocuments(updatedDocuments));\r\n  };\r\n\r\n  const uploadPremiumTaxSignedLinesModal = (documentTypeKey) => (files) => {\r\n    dispatch(addLoader('DmsUploadFiles'));\r\n\r\n    dispatch(\r\n      showModal({\r\n        component: 'DMS_UPLOAD_FILES',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\r\n          maxWidth: 'xl',\r\n          componentProps: {\r\n            files,\r\n            context: constants.DMS_CONTEXT_PROCESSING_INSTRUCTION,\r\n            referenceId: Number(instruction?.id),\r\n            sourceId: Number(selectedRiskRef?.xbInstanceId),\r\n            documentTypeKey,\r\n            postDmsDocumentsSuccess: (data) => handleUploadedDocument(data, documentTypeKey),\r\n            confirmLabel: utils.string.t('app.ok'),\r\n            cancelLabel: utils.string.t('app.goBack'),\r\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const confirmRemoveDocumentModal = (file, removeDocumentType) => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('processingInstructions.checklist.warning.title'),\r\n          maxWidth: 'xs',\r\n          componentProps: {\r\n            confirmLabel: utils.string.t('app.yes'),\r\n            cancelLabel: utils.string.t('app.no'),\r\n            confirmMessage: utils.string.t('processingInstructions.removeDocumentWarning'),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n            submitHandler: () => {\r\n              dispatch(removePremiumTaxSignedLinesDocument({ docIds: file?.documentId, removeDocumentType, documents }));\r\n            },\r\n            cancelHandler: () => {},\r\n            handleClose: () => {},\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleLinkDownload = (file) => {\r\n    dispatch(viewDocumentsDownload({ documentId: file?.documentId, documentName: file?.name }));\r\n  };\r\n\r\n  // abort if data is not ready/available\r\n  if (!defaultValues || !instruction) return null;\r\n\r\n  return (\r\n    <ProcessingInstructionsDetailsView\r\n      instructionId={instruction?.id}\r\n      documents={documents}\r\n      fields={fields}\r\n      defaultValues={defaultValues}\r\n      retainedBrokerageAmount={retainedBrokerageAmount}\r\n      convertedBrokerage={convertedBrokerage}\r\n      premiumCurrency={retainedBrokerageCurrencyCode}\r\n      sumTotal={totalAmount}\r\n      riskRefId={selectedRiskRef?.riskRefId}\r\n      isEditable={isEditable}\r\n      isReadOnly={isReadOnly}\r\n      documentNotUploadedError={documentNotUploadedError}\r\n      handlers={{\r\n        ...handlers,\r\n        next: handleNext,\r\n        save: handleSave,\r\n        cancel: handleCancel,\r\n        getRetainedBrokerageAmount,\r\n        getTotalAmount,\r\n        uploadPremiumTaxSignedLinesModal,\r\n        confirmRemoveDocumentModal,\r\n        download: handleLinkDownload,\r\n      }}\r\n      ref={childRef}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}