{"ast":null,"code":"import _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ProcessingInstructionsChecklist\\\\ProcessingInstructionsChecklist.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useHistory, useParams } from 'react-router';\nimport get from 'lodash/get';\nimport * as Yup from 'yup'; // app\n\nimport ProcessingInstructionsChecklistView from './ProcessingInstructionsChecklist.view';\nimport { processingInstructionsSchema } from 'schemas';\nimport { enqueueNotification, checkListUpdate, selectUser, selectPiProducingBrokers, selectPiAccountExecutives, selectPiFacilityTypes, updateReferenceDocumentCountLoading, getRiskReferenceDocumentsCount, getRiskReferencesDocumentsCountList, getIsRiskReferenceDocumentCountLoading } from 'stores';\nimport * as utils from 'utils';\nimport config from 'config';\nimport * as constants from 'consts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nProcessingInstructionsChecklist.propTypes = {\n  instruction: PropTypes.object.isRequired,\n  handlers: PropTypes.shape({\n    back: PropTypes.func.isRequired,\n    next: PropTypes.func.isRequired\n  }).isRequired\n};\nexport default function ProcessingInstructionsChecklist(_ref) {\n  _s();\n\n  var _instruction$riskRefe, _leadRef$gxbAttribute, _leadRef$gxbAttribute2, _leadRef$gxbAttribute3, _leadRef$gxbAttribute4, _leadRef$gxbAttribute5, _leadRef$gxbAttribute6, _riskReferences$reduc, _riskReferences$reduc2, _riskReferences$reduc3, _riskReferences$reduc4, _instruction$details3, _instruction$details4, _instruction$details5, _instruction$details6, _instruction$details7, _instruction$details8;\n\n  var instruction = _ref.instruction,\n      handlers = _ref.handlers,\n      childRef = _ref.childRef;\n  var dispatch = useDispatch();\n  var history = useHistory();\n\n  var _useParams = useParams(),\n      id = _useParams.id,\n      step = _useParams.step,\n      tab = _useParams.tab;\n\n  var riskReferencesDocumentsCountList = useSelector(getRiskReferencesDocumentsCountList);\n  var isRiskReferenceDocumentCountLoading = useSelector(getIsRiskReferenceDocumentCountLoading);\n  var documents = useSelector(function (state) {\n    return get(state, 'processingInstructions.documents');\n  }) || {};\n  var producingBrokersFromRoles = useSelector(selectPiProducingBrokers);\n  var accountExecutivesFromRoles = useSelector(selectPiAccountExecutives);\n  var facilityTypes = useSelector(selectPiFacilityTypes);\n  var user = useSelector(selectUser);\n  var columns = [{\n    id: 'detail',\n    label: utils.string.t('processingInstructions.checklist.cols.detail')\n  }, {\n    id: 'frontEndContact',\n    label: utils.string.t('processingInstructions.checklist.cols.frontEndContact'),\n    align: 'center'\n  }, {\n    id: 'authorisedSignatory',\n    label: utils.string.t('processingInstructions.checklist.cols.authorisedSignatory'),\n    align: 'center'\n  }];\n  var checklistTabs = [{\n    value: constants.GENERAL,\n    label: utils.string.t('processingInstructions.checklist.tabs.general.title')\n  }, {\n    value: constants.PRE_PLACING,\n    label: utils.string.t('processingInstructions.checklist.tabs.prePlacing.title')\n  }, {\n    value: constants.MRC,\n    label: utils.string.t('processingInstructions.checklist.tabs.mrc.title')\n  }, {\n    value: constants.OTHER_DETAILS,\n    label: utils.string.t('processingInstructions.checklist.tabs.otherDetails.title')\n  }, {\n    value: constants.RISK_REFERENCES,\n    label: utils.string.t('processingInstructions.checklist.tabs.riskRefs.title')\n  }];\n\n  var _useState = useState(checklistTabs),\n      _useState2 = _slicedToArray(_useState, 2),\n      tabs = _useState2[0],\n      setTabs = _useState2[1];\n\n  var isValidTab = tabs.map(function (item) {\n    return item.value;\n  }).includes(tab);\n\n  var _useState3 = useState(isValidTab ? tab : 'general'),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedTab = _useState4[0],\n      setSelectedTab = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      defaultValues = _useState6[0],\n      setDefaultValues = _useState6[1];\n\n  var _useState7 = useState({}),\n      _useState8 = _slicedToArray(_useState7, 2),\n      schemaData = _useState8[0],\n      setSchemaData = _useState8[1];\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      resetKey = _useState10[0],\n      setResetKey = _useState10[1];\n\n  var _useState11 = useState(processingInstructionsSchema),\n      _useState12 = _slicedToArray(_useState11, 2),\n      piSchema = _useState12[0],\n      setPiSchema = _useState12[1];\n\n  var leadRef = instruction === null || instruction === void 0 ? void 0 : (_instruction$riskRefe = instruction.riskReferences) === null || _instruction$riskRefe === void 0 ? void 0 : _instruction$riskRefe.find(function (r) {\n    return r.leadPolicy;\n  });\n  var leadRefProducingBrokerFirstGXBValue = leadRef === null || leadRef === void 0 ? void 0 : (_leadRef$gxbAttribute = leadRef.gxbAttributeDefaultValues) === null || _leadRef$gxbAttribute === void 0 ? void 0 : (_leadRef$gxbAttribute2 = _leadRef$gxbAttribute.producingBrokers) === null || _leadRef$gxbAttribute2 === void 0 ? void 0 : (_leadRef$gxbAttribute3 = _leadRef$gxbAttribute2.map(function (pb) {\n    return {\n      name: pb === null || pb === void 0 ? void 0 : pb.name\n    };\n  })) === null || _leadRef$gxbAttribute3 === void 0 ? void 0 : _leadRef$gxbAttribute3[0];\n  var leadRefAccountExecutiveFirstGXBValue = leadRef === null || leadRef === void 0 ? void 0 : (_leadRef$gxbAttribute4 = leadRef.gxbAttributeDefaultValues) === null || _leadRef$gxbAttribute4 === void 0 ? void 0 : (_leadRef$gxbAttribute5 = _leadRef$gxbAttribute4.accountExecutives) === null || _leadRef$gxbAttribute5 === void 0 ? void 0 : (_leadRef$gxbAttribute6 = _leadRef$gxbAttribute5.map(function (ae) {\n    return {\n      name: ae === null || ae === void 0 ? void 0 : ae.name\n    };\n  })) === null || _leadRef$gxbAttribute6 === void 0 ? void 0 : _leadRef$gxbAttribute6[0];\n  var isFdo = utils.processingInstructions.isFdo(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isDraft = utils.processingInstructions.status.isDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isReopened = utils.processingInstructions.status.isReopened(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\n  var userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\n  var isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\n  var isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\n  var isReadOnly = !isEditable;\n  var isEndorsement = utils.processingInstructions.isEndorsement(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isFeeAndAmendment = utils.processingInstructions.isFeeAndAmendment(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isBordereau = utils.processingInstructions.isBordereau(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var faBorderProcessType = isBordereau || isFeeAndAmendment;\n  var riskReferences = instruction === null || instruction === void 0 ? void 0 : instruction.riskReferences;\n  var gxbProducingBrokers = utils.generic.isValidArray(riskReferences, true) ? (riskReferences === null || riskReferences === void 0 ? void 0 : (_riskReferences$reduc = riskReferences.reduce(function (acc, curr) {\n    var _curr$gxbAttributeDef;\n\n    return [].concat(_toConsumableArray(acc), _toConsumableArray(curr === null || curr === void 0 ? void 0 : (_curr$gxbAttributeDef = curr.gxbAttributeDefaultValues) === null || _curr$gxbAttributeDef === void 0 ? void 0 : _curr$gxbAttributeDef.producingBrokers));\n  }, [])) === null || _riskReferences$reduc === void 0 ? void 0 : (_riskReferences$reduc2 = _riskReferences$reduc.filter(function (value, index, self) {\n    return index === (self === null || self === void 0 ? void 0 : self.findIndex(function (t) {\n      return (t === null || t === void 0 ? void 0 : t.name) === (value === null || value === void 0 ? void 0 : value.name);\n    }));\n  }) // Add 'id' also for removing duplicate records from array once API sending 'id' info\n  ) === null || _riskReferences$reduc2 === void 0 ? void 0 : _riskReferences$reduc2.map(function (pb, idx) {\n    return {\n      id: idx,\n      name: pb === null || pb === void 0 ? void 0 : pb.name,\n      emailId: pb === null || pb === void 0 ? void 0 : pb.emailId\n    };\n  })) || [] // Will Remove 'idx' once API send gxbUserId\n  : [];\n  var gxbAccountExecutives = utils.generic.isValidArray(riskReferences, true) ? (riskReferences === null || riskReferences === void 0 ? void 0 : (_riskReferences$reduc3 = riskReferences.reduce(function (acc, curr) {\n    var _curr$gxbAttributeDef2;\n\n    return [].concat(_toConsumableArray(acc), _toConsumableArray(curr === null || curr === void 0 ? void 0 : (_curr$gxbAttributeDef2 = curr.gxbAttributeDefaultValues) === null || _curr$gxbAttributeDef2 === void 0 ? void 0 : _curr$gxbAttributeDef2.accountExecutives));\n  }, [])) === null || _riskReferences$reduc3 === void 0 ? void 0 : (_riskReferences$reduc4 = _riskReferences$reduc3.filter(function (value, index, self) {\n    return index === (self === null || self === void 0 ? void 0 : self.findIndex(function (t) {\n      return (t === null || t === void 0 ? void 0 : t.name) === (value === null || value === void 0 ? void 0 : value.name);\n    }));\n  }) // Add 'id' also for removing duplicate records from array once API sending 'id' info\n  ) === null || _riskReferences$reduc4 === void 0 ? void 0 : _riskReferences$reduc4.map(function (ae, idx) {\n    return {\n      id: idx,\n      name: ae === null || ae === void 0 ? void 0 : ae.name,\n      emailId: ae === null || ae === void 0 ? void 0 : ae.emailId\n    };\n  })) || [] // Will Remove 'idx' once API send gxbUserId\n  : [];\n  var producingBrokers = utils.generic.isValidArray(gxbProducingBrokers, true) ? gxbProducingBrokers : producingBrokersFromRoles;\n  var accountExecutives = utils.generic.isValidArray(gxbAccountExecutives, true) ? gxbAccountExecutives : accountExecutivesFromRoles;\n\n  var getFacilityTypeId = function getFacilityTypeId() {\n    var _instruction$details;\n\n    var facilityTypeId = instruction === null || instruction === void 0 ? void 0 : (_instruction$details = instruction.details) === null || _instruction$details === void 0 ? void 0 : _instruction$details.facilityTypeId;\n\n    if (!facilityTypeId && utils.generic.isValidArray(facilityTypes, true)) {\n      var item = facilityTypes.find(function (type) {\n        var _instruction$details2;\n\n        return type.facilityTypeID === (instruction === null || instruction === void 0 ? void 0 : (_instruction$details2 = instruction.details) === null || _instruction$details2 === void 0 ? void 0 : _instruction$details2.facilityTypeId);\n      });\n      facilityTypeId = item === null || item === void 0 ? void 0 : item.facilityTypeID;\n    }\n\n    return facilityTypeId || '';\n  };\n\n  var getRiskReferenceDocumentCount = function getRiskReferenceDocumentCount() {\n    if (utils.generic.isValidArray(documents === null || documents === void 0 ? void 0 : documents.riskReferences, true)) {\n      var _documents$riskRefere;\n\n      dispatch(updateReferenceDocumentCountLoading(true));\n      var referenceList = documents === null || documents === void 0 ? void 0 : (_documents$riskRefere = documents.riskReferences) === null || _documents$riskRefere === void 0 ? void 0 : _documents$riskRefere.map(function (refData) {\n        return {\n          endorsementId: refData.endorsementId,\n          endorsementNumber: refData.endorsementNumber,\n          riskRefId: refData.riskRefId,\n          xbInstanceId: refData.xbInstanceId,\n          xbPolicyId: refData.xbPolicyId\n        };\n      });\n      var documentTypeValue = isEndorsement ? constants.PI_ENDORSEMENT_TYPE_DOCUMENT.documentTypeDescription : faBorderProcessType ? constants.PI_FABORDER_TYPE_DOCUMENT.documentTypeDescription : constants.PI_CLOSING_FDO_TYPE_DOCUMENT.documentTypeDescription;\n      dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue));\n    }\n  };\n\n  useEffect(function () {\n    getRiskReferenceDocumentCount();\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var getSelectedProducingBrokerName = function getSelectedProducingBrokerName(pbId) {\n    var _producingBrokers$fin;\n\n    var selectedProducingBrokerName = producingBrokers === null || producingBrokers === void 0 ? void 0 : (_producingBrokers$fin = producingBrokers.find(function (pb) {\n      return (pb === null || pb === void 0 ? void 0 : pb.name) === pbId;\n    })) === null || _producingBrokers$fin === void 0 ? void 0 : _producingBrokers$fin.name; // Will replace pb?.name with pb?.id once api send id information\n\n    return selectedProducingBrokerName;\n  }; // TODO\n  // const getSelectedProducingBrokerEmail = (pbId) => {\n  //   const selectedProducingBrokerEmail = producingBrokers?.find((pb) => pb?.id === pbId)?.emailId;\n  //   return selectedProducingBrokerEmail;\n  // };\n\n\n  var getSelectedAccountExecutiveName = function getSelectedAccountExecutiveName(aeId) {\n    var _accountExecutives$fi;\n\n    var selectedAccountExecutiveName = accountExecutives === null || accountExecutives === void 0 ? void 0 : (_accountExecutives$fi = accountExecutives.find(function (ae) {\n      return (ae === null || ae === void 0 ? void 0 : ae.name) === aeId;\n    })) === null || _accountExecutives$fi === void 0 ? void 0 : _accountExecutives$fi.name; // Will replace ae?.name with ae?.id once api send id information\n\n    return selectedAccountExecutiveName;\n  }; // TODO\n  // const getSelectedAccountExecutiveEmail = (aeId) => {\n  //   const selectedAccountExecutiveEmail = accountExecutives?.find((ae) => ae?.id === aeId)?.emailId;\n  //   return selectedAccountExecutiveEmail;\n  // };\n\n\n  var fields = [{\n    name: 'invoicingClient',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.invoicingClient'),\n    value: (leadRef === null || leadRef === void 0 ? void 0 : leadRef.clientName) || '',\n    muiComponentProps: {\n      InputProps: {\n        readOnly: true,\n        disabled: true\n      }\n    }\n  }, {\n    name: 'contactName',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.contactName'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details3 = instruction.details) === null || _instruction$details3 === void 0 ? void 0 : _instruction$details3.contactName) || '',\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'clientEmail',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.clientEmail'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details4 = instruction.details) === null || _instruction$details4 === void 0 ? void 0 : _instruction$details4.clientEmail) || '',\n    validation: Yup.string().email(utils.string.t('validation.email')).required(utils.string.t('validation.required')),\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'eocInvoiceContactName',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceContactName'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details5 = instruction.details) === null || _instruction$details5 === void 0 ? void 0 : _instruction$details5.eocInvoiceContactName) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'eocInvoiceMail',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceMail'),\n    validation: Yup.string().email(utils.string.t('validation.email')),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details6 = instruction.details) === null || _instruction$details6 === void 0 ? void 0 : _instruction$details6.eocInvoiceMail) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'producingBroker',\n    group: 'general',\n    type: 'select',\n    label: utils.string.t('processingInstructions.checklist.fields.producingBroker'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details7 = instruction.details) === null || _instruction$details7 === void 0 ? void 0 : _instruction$details7.producingBrokerName) || (leadRefProducingBrokerFirstGXBValue === null || leadRefProducingBrokerFirstGXBValue === void 0 ? void 0 : leadRefProducingBrokerFirstGXBValue.name) || '',\n    options: producingBrokers,\n    optionKey: 'name',\n    // Will update it with 'id' once api send id details\n    optionLabel: 'name',\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    muiComponentProps: {\n      disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(producingBrokers)\n    }\n  }, {\n    name: 'accountExecutive',\n    group: 'general',\n    type: 'select',\n    label: utils.string.t('processingInstructions.checklist.fields.accountExecutive'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details8 = instruction.details) === null || _instruction$details8 === void 0 ? void 0 : _instruction$details8.accountExecutive) || (leadRefAccountExecutiveFirstGXBValue === null || leadRefAccountExecutiveFirstGXBValue === void 0 ? void 0 : leadRefAccountExecutiveFirstGXBValue.name) || '',\n    options: accountExecutives,\n    optionKey: 'name',\n    // Will update it with 'id' once api send id details\n    optionLabel: 'name',\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    muiComponentProps: {\n      disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(accountExecutives)\n    }\n  }].concat(_toConsumableArray(isFdo ? [{\n    name: 'businessType',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.businessType'),\n    value: (leadRef === null || leadRef === void 0 ? void 0 : leadRef.businessType) || '',\n    muiComponentProps: {\n      InputProps: {\n        readOnly: true,\n        disabled: true\n      }\n    }\n  }, {\n    name: 'facilityType',\n    group: 'general',\n    type: 'select',\n    label: utils.string.t('processingInstructions.checklist.fields.facilityType'),\n    value: getFacilityTypeId(),\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    options: facilityTypes,\n    optionKey: 'facilityTypeID',\n    optionLabel: 'facilityTypeDetails',\n    disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(facilityTypes)\n  }] : []));\n  useEffect(function () {\n    var _childRef$current, _childRef$current$pro;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current = childRef.current) === null || _childRef$current === void 0 ? void 0 : (_childRef$current$pro = _childRef$current.props) === null || _childRef$current$pro === void 0 ? void 0 : _childRef$current$pro.resetFunc;\n    var schema = utils.schemas.parsePiChecklist(piSchema, instruction);\n\n    var updatedDefaultValues = _objectSpread({\n      checklist: utils.form.getNestedInitialValues(schema === null || schema === void 0 ? void 0 : schema.rows, 'columnName')\n    }, utils.form.getInitialValues(fields));\n\n    setSchemaData(schema);\n    setDefaultValues(updatedDefaultValues);\n\n    if (utils.generic.isFunction(reset)) {\n      reset(updatedDefaultValues, {\n        keepDirty: false\n      });\n    }\n  }, [instruction] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  var validateChecklistDates = function validateChecklistDates(valuesChecklist) {\n    var _valuesChecklist$quot, _valuesChecklist$quot2, _valuesChecklist$duty, _valuesChecklist$duty2, _valuesChecklist$evid, _valuesChecklist$evid2;\n\n    if ((valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$quot = valuesChecklist.quotesPutUp) === null || _valuesChecklist$quot === void 0 ? void 0 : _valuesChecklist$quot.accountHandler) === 'YES' && (valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$quot2 = valuesChecklist.quotesPutUp) === null || _valuesChecklist$quot2 === void 0 ? void 0 : _valuesChecklist$quot2.signedDate) === null) {\n      return false;\n    }\n\n    if ((valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$duty = valuesChecklist.dutyOfDisclosure) === null || _valuesChecklist$duty === void 0 ? void 0 : _valuesChecklist$duty.accountHandler) === 'YES' && (valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$duty2 = valuesChecklist.dutyOfDisclosure) === null || _valuesChecklist$duty2 === void 0 ? void 0 : _valuesChecklist$duty2.signedDate) === null) {\n      return false;\n    }\n\n    if ((valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$evid = valuesChecklist.evidence) === null || _valuesChecklist$evid === void 0 ? void 0 : _valuesChecklist$evid.accountHandler) === 'YES' && (valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$evid2 = valuesChecklist.evidence) === null || _valuesChecklist$evid2 === void 0 ? void 0 : _valuesChecklist$evid2.signedDate) === null) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var validateYesNoNaToggle = function validateYesNoNaToggle(valuesChecklist) {\n    return Object.values(valuesChecklist).every(function (c) {\n      return ['YES', 'NO', 'NA'].includes(c.accountHandler);\n    });\n  };\n\n  var validateChecklistTabs = function validateChecklistTabs(valuesChecklist) {\n    return validateYesNoNaToggle(valuesChecklist) && validateChecklistDates(valuesChecklist);\n  };\n\n  var validateAllChecklistSelected = function validateAllChecklistSelected(valuesChecklist) {\n    return validateYesNoNaToggle(valuesChecklist);\n  };\n\n  var validateMandateChecklistDates = function validateMandateChecklistDates(checklistRow) {\n    if ((checklistRow === null || checklistRow === void 0 ? void 0 : checklistRow.accountHandler) === 'YES' && (checklistRow === null || checklistRow === void 0 ? void 0 : checklistRow.signedDate) === null) {\n      return true;\n    }\n\n    return false;\n  };\n\n  var saveChecklist = function saveChecklist(_ref2) {\n    var _childRef$current$pro2;\n\n    var isNext = _ref2.isNext,\n        isSave = _ref2.isSave,\n        isSaveNext = _ref2.isSaveNext;\n    var formValues = (_childRef$current$pro2 = childRef.current.props) === null || _childRef$current$pro2 === void 0 ? void 0 : _childRef$current$pro2.values;\n\n    var updatedInstruction = _objectSpread(_objectSpread({}, instruction), {}, {\n      details: _objectSpread(_objectSpread(_objectSpread({}, instruction.details), (formValues === null || formValues === void 0 ? void 0 : formValues.accountExecutive) && {\n        accountExecutive: getSelectedAccountExecutiveName(formValues === null || formValues === void 0 ? void 0 : formValues.accountExecutive) // TODO\n        // accountExecutiveId: formValues?.accountExecutive,\n        // accountExecutiveEmailId: getSelectedAccountExecutiveEmail(formValues?.accountExecutive),\n\n      }), (formValues === null || formValues === void 0 ? void 0 : formValues.producingBroker) && {\n        producingBrokerName: getSelectedProducingBrokerName(formValues === null || formValues === void 0 ? void 0 : formValues.producingBroker) // TODO\n        // producingBrokerId: formValues?.producingBroker,\n        // producingBrokerEmailId: getSelectedProducingBrokerEmail(formValues?.producingBroker),\n\n      })\n    });\n\n    if (isSaveNext || isSave) {\n      dispatch(checkListUpdate(formValues, updatedInstruction)).then(function (data) {\n        if (isSaveNext) {\n          if ((data === null || data === void 0 ? void 0 : data.status) === constants.API_RESPONSE_OK) {\n            handlers.next();\n          } else {\n            dispatch(enqueueNotification('app.somethingWentWrong', 'warning'));\n          }\n        }\n      });\n    } else if (isNext) {\n      handlers.next();\n    }\n  };\n\n  var handleSave = function handleSave(type) {\n    saveChecklist(type);\n  };\n\n  var handleNext = function handleNext(generalTabErrors, type) {\n    var _childRef$current$pro3, _Object$entries, _Object$entries2, _Object$entries3, _Object$entries4;\n\n    var formValues = (_childRef$current$pro3 = childRef.current.props) === null || _childRef$current$pro3 === void 0 ? void 0 : _childRef$current$pro3.values;\n    var isChecklistDatesSelected = validateChecklistDates(formValues === null || formValues === void 0 ? void 0 : formValues.checklist);\n    var updatedContent = (_Object$entries = Object.entries(piSchema === null || piSchema === void 0 ? void 0 : piSchema.content)) === null || _Object$entries === void 0 ? void 0 : _Object$entries.reduce(function (acc, _ref3) {\n      var _ref4 = _slicedToArray(_ref3, 2),\n          key = _ref4[0],\n          value = _ref4[1];\n\n      var newValue = value === null || value === void 0 ? void 0 : value.map(function (contentValue) {\n        var _formValues$checklist;\n\n        contentValue.cells[0].isError = !Boolean(formValues === null || formValues === void 0 ? void 0 : (_formValues$checklist = formValues.checklist[contentValue === null || contentValue === void 0 ? void 0 : contentValue.rowKey]) === null || _formValues$checklist === void 0 ? void 0 : _formValues$checklist.accountHandler) || ['quotesPutUp', 'dutyOfDisclosure', 'evidence'].includes(contentValue === null || contentValue === void 0 ? void 0 : contentValue.rowKey) && validateMandateChecklistDates(formValues === null || formValues === void 0 ? void 0 : formValues.checklist[contentValue === null || contentValue === void 0 ? void 0 : contentValue.rowKey]);\n        return contentValue;\n      });\n      return _objectSpread(_objectSpread({}, acc), _defineProperty({}, key, newValue));\n    }, {});\n\n    var updatePiSchema = _objectSpread(_objectSpread({}, piSchema), {}, {\n      content: updatedContent\n    });\n\n    setPiSchema(updatePiSchema);\n    var schema = utils.schemas.parsePiChecklist(updatePiSchema, instruction);\n    setSchemaData(schema);\n    var prePlacingChcklist = (_Object$entries2 = Object.entries(formValues === null || formValues === void 0 ? void 0 : formValues.checklist)) === null || _Object$entries2 === void 0 ? void 0 : _Object$entries2.reduce(function (acc, _ref5) {\n      var _ref6 = _slicedToArray(_ref5, 2),\n          key = _ref6[0],\n          value = _ref6[1];\n\n      return _objectSpread(_objectSpread({}, acc), ['quotesPutUp', 'dutyOfDisclosure', 'demandsNeeds', 'slipsSigned', 'evidence', 'atlas', 'bars'].includes(key) && _defineProperty({}, key, value));\n    }, {});\n    var mrcChcklist = (_Object$entries3 = Object.entries(formValues === null || formValues === void 0 ? void 0 : formValues.checklist)) === null || _Object$entries3 === void 0 ? void 0 : _Object$entries3.reduce(function (acc, _ref8) {\n      var _ref9 = _slicedToArray(_ref8, 2),\n          key = _ref9[0],\n          value = _ref9[1];\n\n      return _objectSpread(_objectSpread({}, acc), ['allWrittenLines', 'allUnderwriter', 'informationClearlyStated', 'allMarketsApproved', 'paymentTerms', 'subscriptionAgreement', 'riskCodes'].includes(key) && _defineProperty({}, key, value));\n    }, {});\n    var otherDetailsChcklist = (_Object$entries4 = Object.entries(formValues === null || formValues === void 0 ? void 0 : formValues.checklist)) === null || _Object$entries4 === void 0 ? void 0 : _Object$entries4.reduce(function (acc, _ref11) {\n      var _ref12 = _slicedToArray(_ref11, 2),\n          key = _ref12[0],\n          value = _ref12[1];\n\n      return _objectSpread(_objectSpread({}, acc), ['marketSheet', 'confirmSanctioned', 'thirdParty', 'contractCertainty'].includes(key) && _defineProperty({}, key, value));\n    }, {});\n    var isChecklistCompleted = validateAllChecklistSelected(formValues === null || formValues === void 0 ? void 0 : formValues.checklist);\n    var isPrePlacingChecklistCompleted = validateChecklistTabs(prePlacingChcklist);\n    var isMrcChecklistCompleted = validateChecklistTabs(mrcChcklist);\n    var isOtherDetailsChecklistCompleted = validateChecklistTabs(otherDetailsChcklist);\n    var isAllRiskRefsHavingAtLeastADoc = !(utils.generic.isValidArray(riskReferencesDocumentsCountList, true) && (riskReferencesDocumentsCountList === null || riskReferencesDocumentsCountList === void 0 ? void 0 : riskReferencesDocumentsCountList.some(function (a) {\n      return Number(a === null || a === void 0 ? void 0 : a.documentCount) === 0;\n    })));\n    var updatedTabs = tabs === null || tabs === void 0 ? void 0 : tabs.map(function (tab) {\n      switch (tab.value) {\n        case constants.GENERAL:\n          return _objectSpread(_objectSpread({}, tab), {}, {\n            errors: generalTabErrors\n          });\n\n        case constants.PRE_PLACING:\n          return _objectSpread(_objectSpread({}, tab), {}, {\n            errors: Number(!isPrePlacingChecklistCompleted)\n          });\n\n        case constants.MRC:\n          return _objectSpread(_objectSpread({}, tab), {}, {\n            errors: Number(!isMrcChecklistCompleted)\n          });\n\n        case constants.OTHER_DETAILS:\n          return _objectSpread(_objectSpread({}, tab), {}, {\n            errors: Number(!isOtherDetailsChecklistCompleted)\n          });\n\n        case constants.RISK_REFERENCES:\n          return _objectSpread(_objectSpread({}, tab), {}, {\n            errors: Number(!isAllRiskRefsHavingAtLeastADoc)\n          });\n\n        default:\n          return {};\n      }\n    });\n    setTabs(updatedTabs);\n    var isAllMandatoryFieldsCompleted = !Boolean(generalTabErrors) && isChecklistCompleted;\n\n    if (isAllRiskRefsHavingAtLeastADoc && isAllMandatoryFieldsCompleted && isChecklistDatesSelected) {\n      saveChecklist(type);\n    } else if (!isAllMandatoryFieldsCompleted && !isAllRiskRefsHavingAtLeastADoc && !isChecklistDatesSelected) {\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFieldsDatesDocs', 'warning'));\n    } else if (!isAllRiskRefsHavingAtLeastADoc && !isChecklistDatesSelected) {\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredDatesDocs', 'warning'));\n    } else if (!isAllMandatoryFieldsCompleted && !isChecklistDatesSelected) {\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFieldsDates', 'warning'));\n    } else if (!isAllMandatoryFieldsCompleted && !isAllRiskRefsHavingAtLeastADoc) {\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFieldsDocs', 'warning'));\n    } else if (!isAllMandatoryFieldsCompleted) {\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFields', 'warning'));\n    } else if (!isAllRiskRefsHavingAtLeastADoc) {\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredDocs', 'warning'));\n    } else if (!isChecklistDatesSelected) {\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredDates', 'warning'));\n    }\n  };\n\n  var handleCancel = function handleCancel() {\n    var _childRef$current2, _childRef$current2$pr, _Object$entries5;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current2 = childRef.current) === null || _childRef$current2 === void 0 ? void 0 : (_childRef$current2$pr = _childRef$current2.props) === null || _childRef$current2$pr === void 0 ? void 0 : _childRef$current2$pr.resetFunc;\n    setResetKey(new Date().getTime());\n    setTabs(checklistTabs);\n    var updatedContent = (_Object$entries5 = Object.entries(piSchema === null || piSchema === void 0 ? void 0 : piSchema.content)) === null || _Object$entries5 === void 0 ? void 0 : _Object$entries5.reduce(function (acc, _ref14) {\n      var _ref15 = _slicedToArray(_ref14, 2),\n          key = _ref15[0],\n          value = _ref15[1];\n\n      var newValue = value === null || value === void 0 ? void 0 : value.map(function (contentValue) {\n        contentValue.cells[0].isError = false;\n        return contentValue;\n      });\n      return _objectSpread(_objectSpread({}, acc), _defineProperty({}, key, newValue));\n    }, {});\n\n    var updatePiSchema = _objectSpread(_objectSpread({}, piSchema), {}, {\n      content: updatedContent\n    });\n\n    setPiSchema(updatePiSchema);\n    var schema = utils.schemas.parsePiChecklist(updatePiSchema, instruction);\n    setSchemaData(schema);\n\n    if (utils.generic.isFunction(reset)) {\n      reset(defaultValues, {\n        keepDirty: false\n      });\n    }\n  };\n\n  var toggleTab = function toggleTab(tab) {\n    setSelectedTab(tab);\n    history.replace(\"\".concat(config.routes.processingInstructions.steps, \"/\").concat(id).concat(step ? \"/\".concat(step) : '').concat(tab ? \"/\".concat(tab) : ''));\n  }; // abort if data is not ready/available\n\n\n  if (!defaultValues || !instruction) return null;\n  return /*#__PURE__*/_jsxDEV(ProcessingInstructionsChecklistView, {\n    instruction: instruction,\n    leadRef: leadRef,\n    defaultValues: defaultValues,\n    columns: columns,\n    tabs: tabs,\n    selectedTab: selectedTab,\n    fields: fields,\n    schemaData: schemaData,\n    isRiskReferenceDocumentCountLoading: isRiskReferenceDocumentCountLoading,\n    isFdo: isFdo,\n    isReadOnly: isReadOnly,\n    isEditable: isEditable,\n    isCheckboxesEditable: isCheckboxesEditable,\n    resetKey: resetKey,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      cancel: handleCancel,\n      save: handleSave,\n      next: handleNext,\n      toggleTab: toggleTab,\n      setTabs: setTabs\n    }),\n    ref: childRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 552,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProcessingInstructionsChecklist, \"pNJ+zP3WZhhMLKThRgqMvfoccjo=\", false, function () {\n  return [useDispatch, useHistory, useParams, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ProcessingInstructionsChecklist;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProcessingInstructionsChecklist\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsChecklist/ProcessingInstructionsChecklist.js"],"names":["React","useEffect","useState","PropTypes","useSelector","useDispatch","useHistory","useParams","get","Yup","ProcessingInstructionsChecklistView","processingInstructionsSchema","enqueueNotification","checkListUpdate","selectUser","selectPiProducingBrokers","selectPiAccountExecutives","selectPiFacilityTypes","updateReferenceDocumentCountLoading","getRiskReferenceDocumentsCount","getRiskReferencesDocumentsCountList","getIsRiskReferenceDocumentCountLoading","utils","config","constants","ProcessingInstructionsChecklist","propTypes","instruction","object","isRequired","handlers","shape","back","func","next","childRef","dispatch","history","id","step","tab","riskReferencesDocumentsCountList","isRiskReferenceDocumentCountLoading","documents","state","producingBrokersFromRoles","accountExecutivesFromRoles","facilityTypes","user","columns","label","string","t","align","checklistTabs","value","GENERAL","PRE_PLACING","MRC","OTHER_DETAILS","RISK_REFERENCES","tabs","setTabs","isValidTab","map","item","includes","selectedTab","setSelectedTab","defaultValues","setDefaultValues","schemaData","setSchemaData","resetKey","setResetKey","piSchema","setPiSchema","leadRef","riskReferences","find","r","leadPolicy","leadRefProducingBrokerFirstGXBValue","gxbAttributeDefaultValues","producingBrokers","pb","name","leadRefAccountExecutiveFirstGXBValue","accountExecutives","ae","isFdo","processingInstructions","processTypeId","isDraft","status","statusId","isRejectedDraft","isSubmittedAuthorisedSignatory","isReopened","userHasWritePermission","app","access","feature","userHasApproverAccess","isCheckboxesEditable","isEditable","isReadOnly","isEndorsement","isFeeAndAmendment","isBordereau","faBorderProcessType","gxbProducingBrokers","generic","isValidArray","reduce","acc","curr","filter","index","self","findIndex","idx","emailId","gxbAccountExecutives","getFacilityTypeId","facilityTypeId","details","type","facilityTypeID","getRiskReferenceDocumentCount","referenceList","refData","endorsementId","endorsementNumber","riskRefId","xbInstanceId","xbPolicyId","documentTypeValue","PI_ENDORSEMENT_TYPE_DOCUMENT","documentTypeDescription","PI_FABORDER_TYPE_DOCUMENT","PI_CLOSING_FDO_TYPE_DOCUMENT","getSelectedProducingBrokerName","pbId","selectedProducingBrokerName","getSelectedAccountExecutiveName","aeId","selectedAccountExecutiveName","fields","group","clientName","muiComponentProps","InputProps","readOnly","disabled","contactName","validation","required","inputProps","maxLength","clientEmail","email","eocInvoiceContactName","eocInvoiceMail","producingBrokerName","options","optionKey","optionLabel","isInvalidOrEmptyArray","accountExecutive","businessType","reset","current","props","resetFunc","schema","schemas","parsePiChecklist","updatedDefaultValues","checklist","form","getNestedInitialValues","rows","getInitialValues","isFunction","keepDirty","validateChecklistDates","valuesChecklist","quotesPutUp","accountHandler","signedDate","dutyOfDisclosure","evidence","validateYesNoNaToggle","Object","values","every","c","validateChecklistTabs","validateAllChecklistSelected","validateMandateChecklistDates","checklistRow","saveChecklist","isNext","isSave","isSaveNext","formValues","updatedInstruction","producingBroker","then","data","API_RESPONSE_OK","handleSave","handleNext","generalTabErrors","isChecklistDatesSelected","updatedContent","entries","content","key","newValue","contentValue","cells","isError","Boolean","rowKey","updatePiSchema","prePlacingChcklist","mrcChcklist","otherDetailsChcklist","isChecklistCompleted","isPrePlacingChecklistCompleted","isMrcChecklistCompleted","isOtherDetailsChecklistCompleted","isAllRiskRefsHavingAtLeastADoc","some","a","Number","documentCount","updatedTabs","errors","isAllMandatoryFieldsCompleted","handleCancel","Date","getTime","toggleTab","replace","routes","steps","cancel","save"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport get from 'lodash/get';\r\nimport * as Yup from 'yup';\r\n\r\n// app\r\nimport ProcessingInstructionsChecklistView from './ProcessingInstructionsChecklist.view';\r\nimport { processingInstructionsSchema } from 'schemas';\r\nimport {\r\n  enqueueNotification,\r\n  checkListUpdate,\r\n  selectUser,\r\n  selectPiProducingBrokers,\r\n  selectPiAccountExecutives,\r\n  selectPiFacilityTypes,\r\n  updateReferenceDocumentCountLoading,\r\n  getRiskReferenceDocumentsCount,\r\n  getRiskReferencesDocumentsCountList,\r\n  getIsRiskReferenceDocumentCountLoading,\r\n} from 'stores';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport * as constants from 'consts';\r\n\r\nProcessingInstructionsChecklist.propTypes = {\r\n  instruction: PropTypes.object.isRequired,\r\n  handlers: PropTypes.shape({\r\n    back: PropTypes.func.isRequired,\r\n    next: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nexport default function ProcessingInstructionsChecklist({ instruction, handlers, childRef }) {\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const { id, step, tab } = useParams();\r\n  const riskReferencesDocumentsCountList = useSelector(getRiskReferencesDocumentsCountList);\r\n  const isRiskReferenceDocumentCountLoading = useSelector(getIsRiskReferenceDocumentCountLoading);\r\n  const documents = useSelector((state) => get(state, 'processingInstructions.documents')) || {};\r\n  const producingBrokersFromRoles = useSelector(selectPiProducingBrokers);\r\n  const accountExecutivesFromRoles = useSelector(selectPiAccountExecutives);\r\n  const facilityTypes = useSelector(selectPiFacilityTypes);\r\n  const user = useSelector(selectUser);\r\n\r\n  const columns = [\r\n    { id: 'detail', label: utils.string.t('processingInstructions.checklist.cols.detail') },\r\n    { id: 'frontEndContact', label: utils.string.t('processingInstructions.checklist.cols.frontEndContact'), align: 'center' },\r\n    { id: 'authorisedSignatory', label: utils.string.t('processingInstructions.checklist.cols.authorisedSignatory'), align: 'center' },\r\n  ];\r\n\r\n  const checklistTabs = [\r\n    { value: constants.GENERAL, label: utils.string.t('processingInstructions.checklist.tabs.general.title') },\r\n    { value: constants.PRE_PLACING, label: utils.string.t('processingInstructions.checklist.tabs.prePlacing.title') },\r\n    { value: constants.MRC, label: utils.string.t('processingInstructions.checklist.tabs.mrc.title') },\r\n    { value: constants.OTHER_DETAILS, label: utils.string.t('processingInstructions.checklist.tabs.otherDetails.title') },\r\n    { value: constants.RISK_REFERENCES, label: utils.string.t('processingInstructions.checklist.tabs.riskRefs.title') },\r\n  ];\r\n\r\n  const [tabs, setTabs] = useState(checklistTabs);\r\n\r\n  const isValidTab = tabs.map((item) => item.value).includes(tab);\r\n\r\n  const [selectedTab, setSelectedTab] = useState(isValidTab ? tab : 'general');\r\n  const [defaultValues, setDefaultValues] = useState();\r\n  const [schemaData, setSchemaData] = useState({});\r\n  const [resetKey, setResetKey] = useState();\r\n  const [piSchema, setPiSchema] = useState(processingInstructionsSchema);\r\n\r\n  const leadRef = instruction?.riskReferences?.find((r) => r.leadPolicy);\r\n  const leadRefProducingBrokerFirstGXBValue = leadRef?.gxbAttributeDefaultValues?.producingBrokers?.map((pb) => ({\r\n    name: pb?.name,\r\n  }))?.[0];\r\n  const leadRefAccountExecutiveFirstGXBValue = leadRef?.gxbAttributeDefaultValues?.accountExecutives?.map((ae) => ({\r\n    name: ae?.name,\r\n  }))?.[0];\r\n  const isFdo = utils.processingInstructions.isFdo(instruction?.processTypeId);\r\n  const isDraft = utils.processingInstructions.status.isDraft(instruction?.statusId);\r\n  const isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction?.statusId);\r\n  const isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction?.statusId);\r\n  const isReopened = utils.processingInstructions.status.isReopened(instruction?.statusId);\r\n  const userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\r\n  const userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\r\n  const isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\r\n  const isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\r\n  const isReadOnly = !isEditable;\r\n\r\n  const isEndorsement = utils.processingInstructions.isEndorsement(instruction?.processTypeId);\r\n  const isFeeAndAmendment = utils.processingInstructions.isFeeAndAmendment(instruction?.processTypeId);\r\n  const isBordereau = utils.processingInstructions.isBordereau(instruction?.processTypeId);\r\n  const faBorderProcessType = isBordereau || isFeeAndAmendment;\r\n  const riskReferences = instruction?.riskReferences;\r\n  const gxbProducingBrokers = utils.generic.isValidArray(riskReferences, true)\r\n    ? riskReferences\r\n        ?.reduce((acc, curr) => {\r\n          return [...acc, ...curr?.gxbAttributeDefaultValues?.producingBrokers];\r\n        }, [])\r\n        ?.filter((value, index, self) => index === self?.findIndex((t) => t?.name === value?.name)) // Add 'id' also for removing duplicate records from array once API sending 'id' info\r\n        ?.map((pb, idx) => ({ id: idx, name: pb?.name, emailId: pb?.emailId })) || [] // Will Remove 'idx' once API send gxbUserId\r\n    : [];\r\n\r\n  const gxbAccountExecutives = utils.generic.isValidArray(riskReferences, true)\r\n    ? riskReferences\r\n        ?.reduce((acc, curr) => {\r\n          return [...acc, ...curr?.gxbAttributeDefaultValues?.accountExecutives];\r\n        }, [])\r\n        ?.filter((value, index, self) => index === self?.findIndex((t) => t?.name === value?.name)) // Add 'id' also for removing duplicate records from array once API sending 'id' info\r\n        ?.map((ae, idx) => ({ id: idx, name: ae?.name, emailId: ae?.emailId })) || [] // Will Remove 'idx' once API send gxbUserId\r\n    : [];\r\n  const producingBrokers = utils.generic.isValidArray(gxbProducingBrokers, true) ? gxbProducingBrokers : producingBrokersFromRoles;\r\n  const accountExecutives = utils.generic.isValidArray(gxbAccountExecutives, true) ? gxbAccountExecutives : accountExecutivesFromRoles;\r\n\r\n  const getFacilityTypeId = () => {\r\n    let facilityTypeId = instruction?.details?.facilityTypeId;\r\n\r\n    if (!facilityTypeId && utils.generic.isValidArray(facilityTypes, true)) {\r\n      const item = facilityTypes.find((type) => type.facilityTypeID === instruction?.details?.facilityTypeId);\r\n      facilityTypeId = item?.facilityTypeID;\r\n    }\r\n\r\n    return facilityTypeId || '';\r\n  };\r\n\r\n  const getRiskReferenceDocumentCount = () => {\r\n    if (utils.generic.isValidArray(documents?.riskReferences, true)) {\r\n      dispatch(updateReferenceDocumentCountLoading(true));\r\n      const referenceList = documents?.riskReferences?.map((refData) => {\r\n        return {\r\n          endorsementId: refData.endorsementId,\r\n          endorsementNumber: refData.endorsementNumber,\r\n          riskRefId: refData.riskRefId,\r\n          xbInstanceId: refData.xbInstanceId,\r\n          xbPolicyId: refData.xbPolicyId,\r\n        };\r\n      });\r\n      const documentTypeValue = isEndorsement\r\n        ? constants.PI_ENDORSEMENT_TYPE_DOCUMENT.documentTypeDescription\r\n        : faBorderProcessType\r\n        ? constants.PI_FABORDER_TYPE_DOCUMENT.documentTypeDescription\r\n        : constants.PI_CLOSING_FDO_TYPE_DOCUMENT.documentTypeDescription;\r\n      dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getRiskReferenceDocumentCount();\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const getSelectedProducingBrokerName = (pbId) => {\r\n    const selectedProducingBrokerName = producingBrokers?.find((pb) => pb?.name === pbId)?.name; // Will replace pb?.name with pb?.id once api send id information\r\n    return selectedProducingBrokerName;\r\n  };\r\n\r\n  // TODO\r\n  // const getSelectedProducingBrokerEmail = (pbId) => {\r\n  //   const selectedProducingBrokerEmail = producingBrokers?.find((pb) => pb?.id === pbId)?.emailId;\r\n  //   return selectedProducingBrokerEmail;\r\n  // };\r\n\r\n  const getSelectedAccountExecutiveName = (aeId) => {\r\n    const selectedAccountExecutiveName = accountExecutives?.find((ae) => ae?.name === aeId)?.name; // Will replace ae?.name with ae?.id once api send id information\r\n    return selectedAccountExecutiveName;\r\n  };\r\n  // TODO\r\n  // const getSelectedAccountExecutiveEmail = (aeId) => {\r\n  //   const selectedAccountExecutiveEmail = accountExecutives?.find((ae) => ae?.id === aeId)?.emailId;\r\n  //   return selectedAccountExecutiveEmail;\r\n  // };\r\n\r\n  const fields = [\r\n    {\r\n      name: 'invoicingClient',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.invoicingClient'),\r\n      value: leadRef?.clientName || '',\r\n      muiComponentProps: {\r\n        InputProps: {\r\n          readOnly: true,\r\n          disabled: true,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'contactName',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.contactName'),\r\n      value: instruction?.details?.contactName || '',\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'clientEmail',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.clientEmail'),\r\n      value: instruction?.details?.clientEmail || '',\r\n      validation: Yup.string().email(utils.string.t('validation.email')).required(utils.string.t('validation.required')),\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'eocInvoiceContactName',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceContactName'),\r\n      value: instruction?.details?.eocInvoiceContactName || '',\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'eocInvoiceMail',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceMail'),\r\n      validation: Yup.string().email(utils.string.t('validation.email')),\r\n      value: instruction?.details?.eocInvoiceMail || '',\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'producingBroker',\r\n      group: 'general',\r\n      type: 'select',\r\n      label: utils.string.t('processingInstructions.checklist.fields.producingBroker'),\r\n      value: instruction?.details?.producingBrokerName || leadRefProducingBrokerFirstGXBValue?.name || '',\r\n      options: producingBrokers,\r\n      optionKey: 'name', // Will update it with 'id' once api send id details\r\n      optionLabel: 'name',\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(producingBrokers),\r\n      },\r\n    },\r\n    {\r\n      name: 'accountExecutive',\r\n      group: 'general',\r\n      type: 'select',\r\n      label: utils.string.t('processingInstructions.checklist.fields.accountExecutive'),\r\n      value: instruction?.details?.accountExecutive || leadRefAccountExecutiveFirstGXBValue?.name || '',\r\n      options: accountExecutives,\r\n      optionKey: 'name', // Will update it with 'id' once api send id details\r\n      optionLabel: 'name',\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(accountExecutives),\r\n      },\r\n    },\r\n    ...(isFdo\r\n      ? [\r\n          {\r\n            name: 'businessType',\r\n            group: 'general',\r\n            type: 'text',\r\n            label: utils.string.t('processingInstructions.checklist.fields.businessType'),\r\n            value: leadRef?.businessType || '',\r\n            muiComponentProps: {\r\n              InputProps: {\r\n                readOnly: true,\r\n                disabled: true,\r\n              },\r\n            },\r\n          },\r\n          {\r\n            name: 'facilityType',\r\n            group: 'general',\r\n            type: 'select',\r\n            label: utils.string.t('processingInstructions.checklist.fields.facilityType'),\r\n            value: getFacilityTypeId(),\r\n            validation: Yup.string().required(utils.string.t('validation.required')),\r\n            options: facilityTypes,\r\n            optionKey: 'facilityTypeID',\r\n            optionLabel: 'facilityTypeDetails',\r\n            disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(facilityTypes),\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  useEffect(\r\n    () => {\r\n      const reset = childRef?.current?.props?.resetFunc;\r\n      const schema = utils.schemas.parsePiChecklist(piSchema, instruction);\r\n      const updatedDefaultValues = {\r\n        checklist: utils.form.getNestedInitialValues(schema?.rows, 'columnName'),\r\n        ...utils.form.getInitialValues(fields),\r\n      };\r\n\r\n      setSchemaData(schema);\r\n      setDefaultValues(updatedDefaultValues);\r\n\r\n      if (utils.generic.isFunction(reset)) {\r\n        reset(updatedDefaultValues, {\r\n          keepDirty: false,\r\n        });\r\n      }\r\n    },\r\n    [instruction] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  const validateChecklistDates = (valuesChecklist) => {\r\n    if (valuesChecklist?.quotesPutUp?.accountHandler === 'YES' && valuesChecklist?.quotesPutUp?.signedDate === null) {\r\n      return false;\r\n    }\r\n\r\n    if (valuesChecklist?.dutyOfDisclosure?.accountHandler === 'YES' && valuesChecklist?.dutyOfDisclosure?.signedDate === null) {\r\n      return false;\r\n    }\r\n\r\n    if (valuesChecklist?.evidence?.accountHandler === 'YES' && valuesChecklist?.evidence?.signedDate === null) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const validateYesNoNaToggle = (valuesChecklist) => {\r\n    return Object.values(valuesChecklist).every((c) => ['YES', 'NO', 'NA'].includes(c.accountHandler));\r\n  };\r\n\r\n  const validateChecklistTabs = (valuesChecklist) => {\r\n    return validateYesNoNaToggle(valuesChecklist) && validateChecklistDates(valuesChecklist);\r\n  };\r\n\r\n  const validateAllChecklistSelected = (valuesChecklist) => {\r\n    return validateYesNoNaToggle(valuesChecklist);\r\n  };\r\n\r\n  const validateMandateChecklistDates = (checklistRow) => {\r\n    if (checklistRow?.accountHandler === 'YES' && checklistRow?.signedDate === null) {\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const saveChecklist = ({ isNext, isSave, isSaveNext }) => {\r\n    const formValues = childRef.current.props?.values;\r\n    const updatedInstruction = {\r\n      ...instruction,\r\n      details: {\r\n        ...instruction.details,\r\n        ...(formValues?.accountExecutive && {\r\n          accountExecutive: getSelectedAccountExecutiveName(formValues?.accountExecutive),\r\n          // TODO\r\n          // accountExecutiveId: formValues?.accountExecutive,\r\n          // accountExecutiveEmailId: getSelectedAccountExecutiveEmail(formValues?.accountExecutive),\r\n        }),\r\n        ...(formValues?.producingBroker && {\r\n          producingBrokerName: getSelectedProducingBrokerName(formValues?.producingBroker),\r\n          // TODO\r\n          // producingBrokerId: formValues?.producingBroker,\r\n          // producingBrokerEmailId: getSelectedProducingBrokerEmail(formValues?.producingBroker),\r\n        }),\r\n      },\r\n    };\r\n\r\n    if (isSaveNext || isSave) {\r\n      dispatch(checkListUpdate(formValues, updatedInstruction)).then((data) => {\r\n        if (isSaveNext) {\r\n          if (data?.status === constants.API_RESPONSE_OK) {\r\n            handlers.next();\r\n          } else {\r\n            dispatch(enqueueNotification('app.somethingWentWrong', 'warning'));\r\n          }\r\n        }\r\n      });\r\n    } else if (isNext) {\r\n      handlers.next();\r\n    }\r\n  };\r\n\r\n  const handleSave = (type) => {\r\n    saveChecklist(type);\r\n  };\r\n\r\n  const handleNext = (generalTabErrors, type) => {\r\n    const formValues = childRef.current.props?.values;\r\n    const isChecklistDatesSelected = validateChecklistDates(formValues?.checklist);\r\n\r\n    const updatedContent = Object.entries(piSchema?.content)?.reduce((acc, [key, value]) => {\r\n      const newValue = value?.map((contentValue) => {\r\n        contentValue.cells[0].isError =\r\n          !Boolean(formValues?.checklist[contentValue?.rowKey]?.accountHandler) ||\r\n          (['quotesPutUp', 'dutyOfDisclosure', 'evidence'].includes(contentValue?.rowKey) &&\r\n            validateMandateChecklistDates(formValues?.checklist[contentValue?.rowKey]));\r\n\r\n        return contentValue;\r\n      });\r\n\r\n      return {\r\n        ...acc,\r\n        ...{\r\n          [key]: newValue,\r\n        },\r\n      };\r\n    }, {});\r\n\r\n    const updatePiSchema = { ...piSchema, content: updatedContent };\r\n    setPiSchema(updatePiSchema);\r\n    const schema = utils.schemas.parsePiChecklist(updatePiSchema, instruction);\r\n    setSchemaData(schema);\r\n\r\n    const prePlacingChcklist = Object.entries(formValues?.checklist)?.reduce((acc, [key, value]) => {\r\n      return {\r\n        ...acc,\r\n        ...(['quotesPutUp', 'dutyOfDisclosure', 'demandsNeeds', 'slipsSigned', 'evidence', 'atlas', 'bars'].includes(key) && {\r\n          [key]: value,\r\n        }),\r\n      };\r\n    }, {});\r\n    const mrcChcklist = Object.entries(formValues?.checklist)?.reduce((acc, [key, value]) => {\r\n      return {\r\n        ...acc,\r\n        ...([\r\n          'allWrittenLines',\r\n          'allUnderwriter',\r\n          'informationClearlyStated',\r\n          'allMarketsApproved',\r\n          'paymentTerms',\r\n          'subscriptionAgreement',\r\n          'riskCodes',\r\n        ].includes(key) && {\r\n          [key]: value,\r\n        }),\r\n      };\r\n    }, {});\r\n    const otherDetailsChcklist = Object.entries(formValues?.checklist)?.reduce((acc, [key, value]) => {\r\n      return {\r\n        ...acc,\r\n        ...(['marketSheet', 'confirmSanctioned', 'thirdParty', 'contractCertainty'].includes(key) && {\r\n          [key]: value,\r\n        }),\r\n      };\r\n    }, {});\r\n\r\n    const isChecklistCompleted = validateAllChecklistSelected(formValues?.checklist);\r\n    const isPrePlacingChecklistCompleted = validateChecklistTabs(prePlacingChcklist);\r\n    const isMrcChecklistCompleted = validateChecklistTabs(mrcChcklist);\r\n    const isOtherDetailsChecklistCompleted = validateChecklistTabs(otherDetailsChcklist);\r\n    const isAllRiskRefsHavingAtLeastADoc = !(\r\n      utils.generic.isValidArray(riskReferencesDocumentsCountList, true) &&\r\n      riskReferencesDocumentsCountList?.some((a) => Number(a?.documentCount) === 0)\r\n    );\r\n    const updatedTabs = tabs?.map((tab) => {\r\n      switch (tab.value) {\r\n        case constants.GENERAL:\r\n          return { ...tab, errors: generalTabErrors };\r\n        case constants.PRE_PLACING:\r\n          return { ...tab, errors: Number(!isPrePlacingChecklistCompleted) };\r\n        case constants.MRC:\r\n          return { ...tab, errors: Number(!isMrcChecklistCompleted) };\r\n        case constants.OTHER_DETAILS:\r\n          return { ...tab, errors: Number(!isOtherDetailsChecklistCompleted) };\r\n        case constants.RISK_REFERENCES:\r\n          return { ...tab, errors: Number(!isAllRiskRefsHavingAtLeastADoc) };\r\n        default:\r\n          return {};\r\n      }\r\n    });\r\n    setTabs(updatedTabs);\r\n\r\n    const isAllMandatoryFieldsCompleted = !Boolean(generalTabErrors) && isChecklistCompleted;\r\n\r\n    if (isAllRiskRefsHavingAtLeastADoc && isAllMandatoryFieldsCompleted && isChecklistDatesSelected) {\r\n      saveChecklist(type);\r\n    } else if (!isAllMandatoryFieldsCompleted && !isAllRiskRefsHavingAtLeastADoc && !isChecklistDatesSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFieldsDatesDocs', 'warning'));\r\n    } else if (!isAllRiskRefsHavingAtLeastADoc && !isChecklistDatesSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredDatesDocs', 'warning'));\r\n    } else if (!isAllMandatoryFieldsCompleted && !isChecklistDatesSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFieldsDates', 'warning'));\r\n    } else if (!isAllMandatoryFieldsCompleted && !isAllRiskRefsHavingAtLeastADoc) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFieldsDocs', 'warning'));\r\n    } else if (!isAllMandatoryFieldsCompleted) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredFields', 'warning'));\r\n    } else if (!isAllRiskRefsHavingAtLeastADoc) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredDocs', 'warning'));\r\n    } else if (!isChecklistDatesSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.missingRequiredDates', 'warning'));\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    const reset = childRef?.current?.props?.resetFunc;\r\n\r\n    setResetKey(new Date().getTime());\r\n    setTabs(checklistTabs);\r\n\r\n    const updatedContent = Object.entries(piSchema?.content)?.reduce((acc, [key, value]) => {\r\n      const newValue = value?.map((contentValue) => {\r\n        contentValue.cells[0].isError = false;\r\n        return contentValue;\r\n      });\r\n\r\n      return {\r\n        ...acc,\r\n        ...{\r\n          [key]: newValue,\r\n        },\r\n      };\r\n    }, {});\r\n\r\n    const updatePiSchema = { ...piSchema, content: updatedContent };\r\n    setPiSchema(updatePiSchema);\r\n    const schema = utils.schemas.parsePiChecklist(updatePiSchema, instruction);\r\n    setSchemaData(schema);\r\n    if (utils.generic.isFunction(reset)) {\r\n      reset(defaultValues, { keepDirty: false });\r\n    }\r\n  };\r\n\r\n  const toggleTab = (tab) => {\r\n    setSelectedTab(tab);\r\n    history.replace(`${config.routes.processingInstructions.steps}/${id}${step ? `/${step}` : ''}${tab ? `/${tab}` : ''}`);\r\n  };\r\n\r\n  // abort if data is not ready/available\r\n  if (!defaultValues || !instruction) return null;\r\n\r\n  return (\r\n    <ProcessingInstructionsChecklistView\r\n      instruction={instruction}\r\n      leadRef={leadRef}\r\n      defaultValues={defaultValues}\r\n      columns={columns}\r\n      tabs={tabs}\r\n      selectedTab={selectedTab}\r\n      fields={fields}\r\n      schemaData={schemaData}\r\n      isRiskReferenceDocumentCountLoading={isRiskReferenceDocumentCountLoading}\r\n      isFdo={isFdo}\r\n      isReadOnly={isReadOnly}\r\n      isEditable={isEditable}\r\n      isCheckboxesEditable={isCheckboxesEditable}\r\n      resetKey={resetKey}\r\n      handlers={{\r\n        ...handlers,\r\n        cancel: handleCancel,\r\n        save: handleSave,\r\n        next: handleNext,\r\n        toggleTab,\r\n        setTabs,\r\n      }}\r\n      ref={childRef}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}