{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\PremiumProcessingCaseRfiResolve\\\\PremiumProcessingCaseRfiResolve.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport * as Yup from 'yup'; // app\n\nimport styles from './PremiumProcessingCaseRfiResolve.styles';\nimport PremiumProcessingCaseRfiResolveView from './PremiumProcessingCaseRfiResolve.view';\nimport { getRfiResolutionCodes, selectRfiResolutionCodes, selectAssignedToUsers, getAssignedToUsersList, premiumProcessingResolveRFI, selectorDmsViewFiles, selectRefDataQueryCodes, getViewTableDocuments, selectCaseDetails } from 'stores';\nimport { useConfirmNavigation } from 'hooks';\nimport * as constants from 'consts';\nimport * as utils from 'utils'; // mui\n\nimport { makeStyles } from '@material-ui/core';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nPremiumProcessingCaseRfiResolve.propTypes = {\n  rfiDetails: PropTypes.object.isRequired,\n  isEditable: PropTypes.bool.isRequired,\n  isPageDirty: PropTypes.bool.isRequired,\n  isResolved: PropTypes.bool,\n  isWorklist: PropTypes.bool.isRequired,\n  handlers: PropTypes.shape({\n    setIsPageDirty: PropTypes.func.isRequired\n  })\n};\nexport default function PremiumProcessingCaseRfiResolve(_ref) {\n  _s();\n\n  var _rfiDetails$caseId;\n\n  var rfiDetails = _ref.rfiDetails,\n      isPageDirty = _ref.isPageDirty,\n      isEditable = _ref.isEditable,\n      isResolved = _ref.isResolved,\n      isWorklist = _ref.isWorklist,\n      handlers = _ref.handlers;\n  var classes = makeStyles(styles, {\n    name: 'PremiumProcessingCaseRfiResolve'\n  })();\n  var dispatch = useDispatch();\n  var queryCodes = useSelector(selectRefDataQueryCodes);\n  var queryCodesRfi = queryCodes.find(function (queryCode) {\n    return (queryCode === null || queryCode === void 0 ? void 0 : queryCode.queryCodeDetails) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryCode);\n  });\n\n  var _useConfirmNavigation = useConfirmNavigation({\n    title: utils.string.t('navigation.form.titleClear'),\n    subtitle: utils.string.t('navigation.form.subtitle')\n  }),\n      confirmNavigation = _useConfirmNavigation.confirmNavigation;\n\n  var caseRFIBureau = (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.rfiType) === constants.BUREAU_RFITYPE;\n  var caseDetails = useSelector(selectCaseDetails);\n  var tabDetails = (caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskView) === constants.WORKBASKET || (caseDetails === null || caseDetails === void 0 ? void 0 : caseDetails.taskView) === constants.ALL_CASES;\n  var selectAssignees = useSelector(selectAssignedToUsers);\n  var resolutionCodes = useSelector(selectRfiResolutionCodes);\n  var dmsViewFiles = useSelector(selectorDmsViewFiles);\n  var resolutionTypeInternals = utils.generic.isValidArray(resolutionCodes, true) ? resolutionCodes.filter(function (resolutionCodes) {\n    return resolutionCodes.rfiTypeID === constants.RFI_TYPE_FOR_QUERY_CODE;\n  }) : [];\n\n  var _useState = useState(constants.DMS_VIEW_TAB_VIEW),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedDmsTab = _useState2[0],\n      setSelectedDmsTab = _useState2[1];\n\n  var isAssignedToUserList = utils.generic.isValidArray(selectAssignees, true); // commenting until the dev who did this completes the story\n  // const assignedToUsers = selectAssignees?.map((item) => (item ? { ...item, email: item.email.toLowerCase() } : null));\n\n  var fetchDmsDocuments = function fetchDmsDocuments(id) {\n    if (id) {\n      dispatch(getViewTableDocuments({\n        referenceId: id,\n        sectionType: constants.DMS_CONTEXT_RFI\n      }));\n    }\n  };\n\n  useEffect(function () {\n    if (utils.generic.isInvalidOrEmptyArray(resolutionCodes)) {\n      dispatch(getRfiResolutionCodes());\n    }\n\n    if (!isAssignedToUserList) {\n      dispatch(getAssignedToUsersList());\n    } // fetch RFI documents\n\n\n    fetchDmsDocuments(rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId);\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    fetchDmsDocuments(rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId);\n  }, [rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var resetForm = function resetForm(resetFn) {\n    if (utils.generic.isFunction(resetFn)) {\n      resetFn(utils.form.getInitialValues(fields), {\n        keepDirty: false\n      });\n    }\n  };\n\n  var handleCancel = function handleCancel(resetFn) {\n    if (isPageDirty) {\n      confirmNavigation(function () {\n        return resetForm(resetFn);\n      });\n    } else {\n      resetForm(resetFn);\n    }\n  };\n\n  var selectDmsTab = function selectDmsTab(tabName) {\n    setSelectedDmsTab(tabName);\n  };\n\n  var fields = [{\n    name: 'resolutionCode',\n    type: 'autocompletemui',\n    value: !isEditable && resolutionCodes ? resolutionCodes.find(function (option) {\n      return (option === null || option === void 0 ? void 0 : option.resolutionCd) === (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.resolutionCode);\n    }) || null : null,\n    options: resolutionTypeInternals,\n    optionKey: 'resolutionCodeID',\n    optionLabel: 'resolutionCodeDescription',\n    label: utils.string.t('premiumProcessing.rfi.resolutionCode'),\n    validation: !caseRFIBureau ? Yup.object().nullable().required(utils.string.t('validation.required')) : '',\n    muiComponentProps: {\n      disabled: !isEditable || tabDetails\n    }\n  }, {\n    name: 'typeYourResponse',\n    type: 'textarea',\n    value: !isEditable ? (rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.resolutionComments) || '' : '',\n    validation: Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')).required(utils.string.t('validation.required')),\n    label: isEditable ? utils.string.t('premiumProcessing.rfi.resolutionNotes') : utils.string.t('premiumProcessing.rfi.typeYourResponse'),\n    fullWidth: true,\n    muiComponentProps: {\n      disabled: !isEditable || tabDetails,\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      InputProps: {\n        classes: {\n          root: classes.typeYourResponseTextWidth\n        }\n      }\n    }\n  }].concat(_toConsumableArray(rfiDetails.rfiType === constants.BUREAU_RFITYPE ? [{\n    name: 'bureauQueryDescription',\n    type: 'textarea',\n    label: utils.string.t('premiumProcessing.rfi.bureauQuery'),\n    value: rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.bureauQuery,\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      rows: 5,\n      rowsMax: 10,\n      disabled: true\n    },\n    validation: Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max'))\n  }] : []));\n  var actions = [{\n    name: 'cancel',\n    label: utils.string.t('app.cancel'),\n    handler: function handler(reset) {\n      return handleCancel(reset);\n    }\n  }, {\n    name: 'submit',\n    label: utils.string.t('premiumProcessing.rfi.resolveRfi'),\n    handler: function handler(reset) {\n      return function (values) {\n        if (values) {\n          var _values$resolutionCod;\n\n          handlers.setIsPageDirty(false);\n          dispatch(premiumProcessingResolveRFI({\n            queryId: rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.queryId,\n            taskId: rfiDetails === null || rfiDetails === void 0 ? void 0 : rfiDetails.taskId,\n            resolutionCode: values === null || values === void 0 ? void 0 : (_values$resolutionCod = values.resolutionCode) === null || _values$resolutionCod === void 0 ? void 0 : _values$resolutionCod.resolutionCd,\n            resolutionComments: values === null || values === void 0 ? void 0 : values.typeYourResponse,\n            documentId: []\n          })).then(function (response) {\n            // success POST\n            if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n              reset();\n            }\n          });\n        }\n      };\n    }\n  }];\n  var dms = {\n    context: constants.DMS_CONTEXT_CASE,\n    referenceId: rfiDetails === null || rfiDetails === void 0 ? void 0 : (_rfiDetails$caseId = rfiDetails.caseId) === null || _rfiDetails$caseId === void 0 ? void 0 : _rfiDetails$caseId.toString() // confirm with API which ID should be used for reference\n\n  };\n  var tabs = [{\n    value: constants.DMS_VIEW_TAB_VIEW,\n    label: utils.string.t('dms.wrapper.tabs.viewDocuments')\n  }]; // abort\n\n  if (!rfiDetails.taskId || !isResolved && utils.generic.isInvalidOrEmptyArray(resolutionCodes)) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsxDEV(PremiumProcessingCaseRfiResolveView, {\n    fields: fields,\n    actions: actions,\n    rfiDetails: rfiDetails,\n    dms: dms,\n    dmsTabs: tabs,\n    documents: dmsViewFiles,\n    selectedDmsTab: selectedDmsTab,\n    isEditable: isEditable,\n    isPageDirty: isPageDirty,\n    queryCodesRfi: queryCodesRfi,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      selectDmsTab: selectDmsTab\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 213,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PremiumProcessingCaseRfiResolve, \"2FKogPBSGXRy4tTPmzAr5XfP8Eo=\", false, function () {\n  return [useDispatch, useSelector, useConfirmNavigation, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PremiumProcessingCaseRfiResolve;\n\nvar _c;\n\n$RefreshReg$(_c, \"PremiumProcessingCaseRfiResolve\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/PremiumProcessingCaseRfiResolve/PremiumProcessingCaseRfiResolve.js"],"names":["React","useEffect","useState","useDispatch","useSelector","PropTypes","Yup","styles","PremiumProcessingCaseRfiResolveView","getRfiResolutionCodes","selectRfiResolutionCodes","selectAssignedToUsers","getAssignedToUsersList","premiumProcessingResolveRFI","selectorDmsViewFiles","selectRefDataQueryCodes","getViewTableDocuments","selectCaseDetails","useConfirmNavigation","constants","utils","makeStyles","PremiumProcessingCaseRfiResolve","propTypes","rfiDetails","object","isRequired","isEditable","bool","isPageDirty","isResolved","isWorklist","handlers","shape","setIsPageDirty","func","classes","name","dispatch","queryCodes","queryCodesRfi","find","queryCode","queryCodeDetails","title","string","t","subtitle","confirmNavigation","caseRFIBureau","rfiType","BUREAU_RFITYPE","caseDetails","tabDetails","taskView","WORKBASKET","ALL_CASES","selectAssignees","resolutionCodes","dmsViewFiles","resolutionTypeInternals","generic","isValidArray","filter","rfiTypeID","RFI_TYPE_FOR_QUERY_CODE","DMS_VIEW_TAB_VIEW","selectedDmsTab","setSelectedDmsTab","isAssignedToUserList","fetchDmsDocuments","id","referenceId","sectionType","DMS_CONTEXT_RFI","isInvalidOrEmptyArray","queryId","resetForm","resetFn","isFunction","form","getInitialValues","fields","keepDirty","handleCancel","selectDmsTab","tabName","type","value","option","resolutionCd","resolutionCode","options","optionKey","optionLabel","label","validation","nullable","required","muiComponentProps","disabled","resolutionComments","min","max","fullWidth","multiline","rows","rowsMax","InputProps","root","typeYourResponseTextWidth","bureauQuery","inputProps","maxLength","actions","handler","reset","values","taskId","typeYourResponse","documentId","then","response","status","API_RESPONSE_OK","dms","context","DMS_CONTEXT_CASE","caseId","toString","tabs"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport * as Yup from 'yup';\r\n\r\n// app\r\nimport styles from './PremiumProcessingCaseRfiResolve.styles';\r\nimport PremiumProcessingCaseRfiResolveView from './PremiumProcessingCaseRfiResolve.view';\r\nimport {\r\n  getRfiResolutionCodes,\r\n  selectRfiResolutionCodes,\r\n  selectAssignedToUsers,\r\n  getAssignedToUsersList,\r\n  premiumProcessingResolveRFI,\r\n  selectorDmsViewFiles,\r\n  selectRefDataQueryCodes,\r\n  getViewTableDocuments,\r\n  selectCaseDetails,\r\n} from 'stores';\r\nimport { useConfirmNavigation } from 'hooks';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\n\r\n// mui\r\nimport { makeStyles } from '@material-ui/core';\r\n\r\nPremiumProcessingCaseRfiResolve.propTypes = {\r\n  rfiDetails: PropTypes.object.isRequired,\r\n  isEditable: PropTypes.bool.isRequired,\r\n  isPageDirty: PropTypes.bool.isRequired,\r\n  isResolved: PropTypes.bool,\r\n  isWorklist: PropTypes.bool.isRequired,\r\n  handlers: PropTypes.shape({\r\n    setIsPageDirty: PropTypes.func.isRequired,\r\n  }),\r\n};\r\nexport default function PremiumProcessingCaseRfiResolve({ rfiDetails, isPageDirty, isEditable, isResolved, isWorklist, handlers }) {\r\n  const classes = makeStyles(styles, { name: 'PremiumProcessingCaseRfiResolve' })();\r\n  const dispatch = useDispatch();\r\n  const queryCodes = useSelector(selectRefDataQueryCodes);\r\n  const queryCodesRfi = queryCodes.find((queryCode) => queryCode?.queryCodeDetails === rfiDetails?.queryCode);\r\n  const { confirmNavigation } = useConfirmNavigation({\r\n    title: utils.string.t('navigation.form.titleClear'),\r\n    subtitle: utils.string.t('navigation.form.subtitle'),\r\n  });\r\n  const caseRFIBureau = rfiDetails?.rfiType === constants.BUREAU_RFITYPE;\r\n  const caseDetails = useSelector(selectCaseDetails);\r\n  const tabDetails = caseDetails?.taskView === constants.WORKBASKET || caseDetails?.taskView === constants.ALL_CASES;\r\n\r\n  const selectAssignees = useSelector(selectAssignedToUsers);\r\n  const resolutionCodes = useSelector(selectRfiResolutionCodes);\r\n  const dmsViewFiles = useSelector(selectorDmsViewFiles);\r\n  const resolutionTypeInternals = utils.generic.isValidArray(resolutionCodes, true)\r\n    ? resolutionCodes.filter((resolutionCodes) => resolutionCodes.rfiTypeID === constants.RFI_TYPE_FOR_QUERY_CODE)\r\n    : [];\r\n  const [selectedDmsTab, setSelectedDmsTab] = useState(constants.DMS_VIEW_TAB_VIEW);\r\n\r\n  const isAssignedToUserList = utils.generic.isValidArray(selectAssignees, true);\r\n  // commenting until the dev who did this completes the story\r\n  // const assignedToUsers = selectAssignees?.map((item) => (item ? { ...item, email: item.email.toLowerCase() } : null));\r\n\r\n  const fetchDmsDocuments = (id) => {\r\n    if (id) {\r\n      dispatch(getViewTableDocuments({ referenceId: id, sectionType: constants.DMS_CONTEXT_RFI }));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (utils.generic.isInvalidOrEmptyArray(resolutionCodes)) {\r\n      dispatch(getRfiResolutionCodes());\r\n    }\r\n\r\n    if (!isAssignedToUserList) {\r\n      dispatch(getAssignedToUsersList());\r\n    }\r\n\r\n    // fetch RFI documents\r\n    fetchDmsDocuments(rfiDetails?.queryId);\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    fetchDmsDocuments(rfiDetails?.queryId);\r\n  }, [rfiDetails?.queryId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const resetForm = (resetFn) => {\r\n    if (utils.generic.isFunction(resetFn)) {\r\n      resetFn(utils.form.getInitialValues(fields), { keepDirty: false });\r\n    }\r\n  };\r\n\r\n  const handleCancel = (resetFn) => {\r\n    if (isPageDirty) {\r\n      confirmNavigation(() => resetForm(resetFn));\r\n    } else {\r\n      resetForm(resetFn);\r\n    }\r\n  };\r\n\r\n  const selectDmsTab = (tabName) => {\r\n    setSelectedDmsTab(tabName);\r\n  };\r\n  const fields = [\r\n    {\r\n      name: 'resolutionCode',\r\n      type: 'autocompletemui',\r\n      value:\r\n        !isEditable && resolutionCodes\r\n          ? resolutionCodes.find((option) => option?.resolutionCd === rfiDetails?.resolutionCode) || null\r\n          : null,\r\n      options: resolutionTypeInternals,\r\n      optionKey: 'resolutionCodeID',\r\n      optionLabel: 'resolutionCodeDescription',\r\n      label: utils.string.t('premiumProcessing.rfi.resolutionCode'),\r\n      validation: !caseRFIBureau ? Yup.object().nullable().required(utils.string.t('validation.required')) : '',\r\n      muiComponentProps: {\r\n        disabled: !isEditable || tabDetails,\r\n      },\r\n    },\r\n    {\r\n      name: 'typeYourResponse',\r\n      type: 'textarea',\r\n      value: !isEditable ? rfiDetails?.resolutionComments || '' : '',\r\n      validation: Yup.string()\r\n        .min(5, utils.string.t('validation.string.min'))\r\n        .max(4000, utils.string.t('validation.string.max'))\r\n        .required(utils.string.t('validation.required')),\r\n      label: isEditable\r\n        ? utils.string.t('premiumProcessing.rfi.resolutionNotes')\r\n        : utils.string.t('premiumProcessing.rfi.typeYourResponse'),\r\n      fullWidth: true,\r\n      muiComponentProps: {\r\n        disabled: !isEditable || tabDetails,\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 10,\r\n        InputProps: {\r\n          classes: {\r\n            root: classes.typeYourResponseTextWidth,\r\n          },\r\n        },\r\n      },\r\n    },\r\n    ...(rfiDetails.rfiType === constants.BUREAU_RFITYPE\r\n      ? [\r\n          {\r\n            name: 'bureauQueryDescription',\r\n            type: 'textarea',\r\n            label: utils.string.t('premiumProcessing.rfi.bureauQuery'),\r\n            value: rfiDetails?.bureauQuery,\r\n            muiComponentProps: {\r\n              inputProps: { maxLength: 4000 },\r\n              multiline: true,\r\n              rows: 5,\r\n              rowsMax: 10,\r\n              disabled: true,\r\n            },\r\n            validation: Yup.string().min(5, utils.string.t('validation.string.min')).max(4000, utils.string.t('validation.string.max')),\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  const actions = [\r\n    {\r\n      name: 'cancel',\r\n      label: utils.string.t('app.cancel'),\r\n      handler: (reset) => handleCancel(reset),\r\n    },\r\n    {\r\n      name: 'submit',\r\n      label: utils.string.t('premiumProcessing.rfi.resolveRfi'),\r\n\r\n      handler: (reset) => (values) => {\r\n        if (values) {\r\n          handlers.setIsPageDirty(false);\r\n          dispatch(\r\n            premiumProcessingResolveRFI({\r\n              queryId: rfiDetails?.queryId,\r\n              taskId: rfiDetails?.taskId,\r\n              resolutionCode: values?.resolutionCode?.resolutionCd,\r\n              resolutionComments: values?.typeYourResponse,\r\n              documentId: [],\r\n            })\r\n          ).then((response) => {\r\n            // success POST\r\n            if (response?.status === constants.API_RESPONSE_OK) {\r\n              reset();\r\n            }\r\n          });\r\n        }\r\n      },\r\n    },\r\n  ];\r\n\r\n  const dms = {\r\n    context: constants.DMS_CONTEXT_CASE,\r\n    referenceId: rfiDetails?.caseId?.toString(), // confirm with API which ID should be used for reference\r\n  };\r\n\r\n  const tabs = [\r\n    {\r\n      value: constants.DMS_VIEW_TAB_VIEW,\r\n      label: utils.string.t('dms.wrapper.tabs.viewDocuments'),\r\n    },\r\n  ];\r\n\r\n  // abort\r\n  if (!rfiDetails.taskId || (!isResolved && utils.generic.isInvalidOrEmptyArray(resolutionCodes))) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <PremiumProcessingCaseRfiResolveView\r\n      fields={fields}\r\n      actions={actions}\r\n      rfiDetails={rfiDetails}\r\n      dms={dms}\r\n      dmsTabs={tabs}\r\n      documents={dmsViewFiles}\r\n      selectedDmsTab={selectedDmsTab}\r\n      isEditable={isEditable}\r\n      isPageDirty={isPageDirty}\r\n      queryCodesRfi={queryCodesRfi}\r\n      handlers={{ ...handlers, selectDmsTab }}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}