{"ast":null,"code":"import _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\pages\\\\ReportsExtended\\\\ReportsExtended.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useHistory, useParams, useLocation } from 'react-router';\nimport { Helmet } from 'react-helmet'; // app\n\nimport { ReportsExtendedView } from './ReportsExtended.view';\nimport * as utils from 'utils';\nimport config from 'config';\nimport * as constants from 'consts';\nimport { usePagination } from 'hooks';\nimport { showModal, getReportListExtended, selectReportListExtended, selectSelectedReportGroupExtended, deleteReportsExtended, selectReportListExtendedPagination, selectReportListExtendedSort, selectUser, selectReportListExtendedLoading } from 'stores';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ReportsExtended() {\n  _s();\n\n  var _location$state;\n\n  var history = useHistory();\n\n  var _useParams = useParams(),\n      groupId = _useParams.groupId;\n\n  var location = useLocation();\n  var dispatch = useDispatch();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      breadcrumbs = _useState2[0],\n      setBreadcrumbs = _useState2[1];\n\n  var brand = useSelector(function (state) {\n    return state.ui.brand;\n  });\n  var reportList = useSelector(selectReportListExtended);\n  var selectedReportGroup = useSelector(selectSelectedReportGroupExtended);\n  var reportListPagination = useSelector(selectReportListExtendedPagination);\n  var reportListSorting = useSelector(selectReportListExtendedSort);\n  var user = useSelector(selectUser);\n  var isReportListLoading = useSelector(selectReportListExtendedLoading);\n  var hasCreateReportPermission = utils.app.access.feature('reporting.addReport', ['read', 'create', 'update', 'delete'], user);\n  var hasEditReportPermission = utils.app.access.feature('reporting.editReport', ['update'], user);\n  var hasDeleteReportPermission = utils.app.access.feature('reporting.deleteReport', ['delete'], user);\n  var reportGroupTitle = (selectedReportGroup === null || selectedReportGroup === void 0 ? void 0 : selectedReportGroup.name) || (location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.reportGroupTitle);\n  var reportListParam = {};\n  useEffect(function () {\n    dispatch(getReportListExtended(reportListParam, groupId));\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    setBreadcrumbs([{\n      name: 'report-group',\n      label: utils.string.t('reportingExtended.title'),\n      link: \"\".concat(config.routes.reportingExtended.root)\n    }, {\n      name: 'report',\n      label: reportGroupTitle || '',\n      link: \"\".concat(config.routes.reportingExtended.root, \"/\").concat(groupId),\n      active: false\n    }]);\n  }, [reportGroupTitle] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  var setActiveBreadCrumbStep = function setActiveBreadCrumbStep(breadcrumbs) {\n    // abort\n    if (!utils.generic.isValidArray(breadcrumbs, true)) return [];\n    return breadcrumbs === null || breadcrumbs === void 0 ? void 0 : breadcrumbs.map(function (item) {\n      if (item.name === constants.REPORTING_EXTENDED_BREADCRUMB_REPORT && history.location.pathname.includes(\"reporting-extended/\".concat(groupId))) {\n        item.active = true;\n      } else {\n        item.active = history.location.pathname === item.link;\n      }\n\n      return item;\n    });\n  };\n\n  var cols = [{\n    id: 'reportName',\n    label: utils.string.t('reportingExtended.reporting.columns.reportName'),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'description',\n    label: utils.string.t('reportingExtended.reporting.columns.description'),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'createdBy',\n    label: utils.string.t('reportingExtended.reporting.columns.createdBy'),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'createdDate',\n    label: utils.string.t('reportingExtended.reporting.columns.createdDate'),\n    sort: {\n      type: 'date',\n      direction: 'asc'\n    }\n  }].concat(_toConsumableArray(hasEditReportPermission || hasDeleteReportPermission ? [{\n    id: 'actions',\n    menu: true,\n    visible: true\n  }] : []));\n\n  var handleClickRow = function handleClickRow(report) {\n    return function (event) {\n      var id = report.id,\n          title = report.title;\n\n      if (groupId && id) {\n        history.push(\"\".concat(config.routes.reportingExtended.root, \"/\").concat(groupId, \"/\").concat(id), {\n          reportGroupTitle: reportGroupTitle,\n          reportId: id,\n          reportTitle: title\n        });\n      }\n    };\n  };\n\n  var handleChangePage = function handleChangePage(newPage) {\n    dispatch(getReportListExtended({\n      page: newPage + 1\n    }, groupId));\n  };\n\n  var handleChangeRowsPerPage = function handleChangeRowsPerPage(rowsPerPage) {\n    dispatch(getReportListExtended({\n      size: rowsPerPage\n    }, groupId));\n  };\n\n  var searchSubmit = function searchSubmit(_ref) {\n    var search = _ref.search,\n        filters = _ref.filters;\n    dispatch(getReportListExtended({\n      searchBy: search,\n      filters: filters\n    }, groupId));\n  };\n\n  var onSortColumn = function onSortColumn(by, dir, type) {\n    dispatch(getReportListExtended({\n      sortBy: by,\n      direction: dir,\n      sortType: type\n    }, groupId));\n  };\n\n  var onSuccessfulCreateOrEditOrDeleteReport = function onSuccessfulCreateOrEditOrDeleteReport() {\n    dispatch(getReportListExtended(reportListParam, groupId));\n  };\n\n  var handleCreateEditReport = function handleCreateEditReport(isEditAddReport, report) {\n    dispatch(showModal({\n      component: 'REPORTS_EXTENDED_ADD_EDIT',\n      props: {\n        fullWidth: false,\n        maxWidth: 'sm',\n        title: isEditAddReport ? utils.string.t('reportingExtended.reporting.editReport') : utils.string.t('reportingExtended.reporting.createReport'),\n        componentProps: {\n          report: report,\n          groupId: groupId,\n          isEditAddReport: isEditAddReport,\n          handlers: {\n            onSuccessfulCreateOrEditOrDeleteReport: onSuccessfulCreateOrEditOrDeleteReport\n          }\n        }\n      }\n    }));\n  };\n\n  var handleDeleteReport = function handleDeleteReport(report) {\n    var id = report.id,\n        title = report.title;\n\n    var submitHandler = function submitHandler() {\n      dispatch(deleteReportsExtended(id)).then(function (response) {\n        if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_NO_CONTENT_STATUS) {\n          onSuccessfulCreateOrEditOrDeleteReport();\n        }\n      });\n    };\n\n    dispatch(showModal({\n      component: 'CONFIRM_DELETE',\n      props: {\n        title: \"\".concat(utils.string.t('reportingExtended.reporting.deleteReport')),\n        subtitle: title,\n        fullWidth: true,\n        maxWidth: 'xs',\n        disableAutoFocus: true,\n        componentProps: {\n          submitHandler: submitHandler\n        }\n      }\n    }));\n  };\n\n  var popoverActions = [].concat(_toConsumableArray(hasEditReportPermission ? [{\n    id: 'edit',\n    label: utils.string.t('reportingExtended.reporting.popOverMenuItems.edit'),\n    callback: function callback(_ref2) {\n      var report = _ref2.report;\n      return handleCreateEditReport(true, report);\n    }\n  }] : []), _toConsumableArray(hasDeleteReportPermission ? [{\n    id: 'delete',\n    label: utils.string.t('reportingExtended.reporting.popOverMenuItems.delete'),\n    callback: function callback(_ref3) {\n      var report = _ref3.report;\n      return handleDeleteReport(report);\n    }\n  }] : []));\n  var pagination = usePagination(reportList, reportListPagination, handleChangePage, handleChangeRowsPerPage);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"\".concat(reportGroupTitle, \" - \").concat(utils.app.getAppName(brand))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ReportsExtendedView, {\n      breadcrumbs: setActiveBreadCrumbStep(breadcrumbs),\n      columns: cols,\n      reports: reportList,\n      popoverActions: popoverActions,\n      pagination: pagination.obj,\n      sort: reportListSorting,\n      hasCreateReportPermission: hasCreateReportPermission,\n      reportGroupTitle: reportGroupTitle,\n      isReportListLoading: isReportListLoading,\n      handlers: {\n        handleClickRow: handleClickRow,\n        handleCreateEditReport: handleCreateEditReport,\n        handleChangePage: pagination.handlers.handleChangePage,\n        handleChangeRowsPerPage: pagination.handlers.handleChangeRowsPerPage,\n        searchSubmit: searchSubmit,\n        onSortColumn: onSortColumn\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(ReportsExtended, \"mg68NJ5hwNSC6mM039u/q2bv3xs=\", false, function () {\n  return [useHistory, useParams, useLocation, useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, usePagination];\n});\n\n_c = ReportsExtended;\n\nvar _c;\n\n$RefreshReg$(_c, \"ReportsExtended\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/pages/ReportsExtended/ReportsExtended.js"],"names":["React","useState","useEffect","useSelector","useDispatch","useHistory","useParams","useLocation","Helmet","ReportsExtendedView","utils","config","constants","usePagination","showModal","getReportListExtended","selectReportListExtended","selectSelectedReportGroupExtended","deleteReportsExtended","selectReportListExtendedPagination","selectReportListExtendedSort","selectUser","selectReportListExtendedLoading","ReportsExtended","history","groupId","location","dispatch","breadcrumbs","setBreadcrumbs","brand","state","ui","reportList","selectedReportGroup","reportListPagination","reportListSorting","user","isReportListLoading","hasCreateReportPermission","app","access","feature","hasEditReportPermission","hasDeleteReportPermission","reportGroupTitle","name","reportListParam","label","string","t","link","routes","reportingExtended","root","active","setActiveBreadCrumbStep","generic","isValidArray","map","item","REPORTING_EXTENDED_BREADCRUMB_REPORT","pathname","includes","cols","id","sort","type","direction","menu","visible","handleClickRow","report","event","title","push","reportId","reportTitle","handleChangePage","newPage","page","handleChangeRowsPerPage","rowsPerPage","size","searchSubmit","search","filters","searchBy","onSortColumn","by","dir","sortBy","sortType","onSuccessfulCreateOrEditOrDeleteReport","handleCreateEditReport","isEditAddReport","component","props","fullWidth","maxWidth","componentProps","handlers","handleDeleteReport","submitHandler","then","response","status","API_RESPONSE_NO_CONTENT_STATUS","subtitle","disableAutoFocus","popoverActions","callback","pagination","getAppName","obj"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useHistory, useParams, useLocation } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\n\r\n// app\r\nimport { ReportsExtendedView } from './ReportsExtended.view';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport * as constants from 'consts';\r\nimport { usePagination } from 'hooks';\r\nimport {\r\n  showModal,\r\n  getReportListExtended,\r\n  selectReportListExtended,\r\n  selectSelectedReportGroupExtended,\r\n  deleteReportsExtended,\r\n  selectReportListExtendedPagination,\r\n  selectReportListExtendedSort,\r\n  selectUser,\r\n  selectReportListExtendedLoading,\r\n} from 'stores';\r\n\r\nexport default function ReportsExtended() {\r\n  const history = useHistory();\r\n  const { groupId } = useParams();\r\n  const location = useLocation();\r\n  const dispatch = useDispatch();\r\n\r\n  const [breadcrumbs, setBreadcrumbs] = useState([]);\r\n\r\n  const brand = useSelector((state) => state.ui.brand);\r\n  const reportList = useSelector(selectReportListExtended);\r\n  const selectedReportGroup = useSelector(selectSelectedReportGroupExtended);\r\n  const reportListPagination = useSelector(selectReportListExtendedPagination);\r\n  const reportListSorting = useSelector(selectReportListExtendedSort);\r\n  const user = useSelector(selectUser);\r\n  const isReportListLoading = useSelector(selectReportListExtendedLoading);\r\n\r\n  const hasCreateReportPermission = utils.app.access.feature('reporting.addReport', ['read', 'create', 'update', 'delete'], user);\r\n  const hasEditReportPermission = utils.app.access.feature('reporting.editReport', ['update'], user);\r\n  const hasDeleteReportPermission = utils.app.access.feature('reporting.deleteReport', ['delete'], user);\r\n\r\n  const reportGroupTitle = selectedReportGroup?.name || location?.state?.reportGroupTitle;\r\n  const reportListParam = {};\r\n\r\n  useEffect(() => {\r\n    dispatch(getReportListExtended(reportListParam, groupId));\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(\r\n    () => {\r\n      setBreadcrumbs([\r\n        {\r\n          name: 'report-group',\r\n          label: utils.string.t('reportingExtended.title'),\r\n          link: `${config.routes.reportingExtended.root}`,\r\n        },\r\n        {\r\n          name: 'report',\r\n          label: reportGroupTitle || '',\r\n          link: `${config.routes.reportingExtended.root}/${groupId}`,\r\n          active: false,\r\n        },\r\n      ]);\r\n    },\r\n    [reportGroupTitle] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  const setActiveBreadCrumbStep = (breadcrumbs) => {\r\n    // abort\r\n    if (!utils.generic.isValidArray(breadcrumbs, true)) return [];\r\n\r\n    return breadcrumbs?.map((item) => {\r\n      if (\r\n        item.name === constants.REPORTING_EXTENDED_BREADCRUMB_REPORT &&\r\n        history.location.pathname.includes(`reporting-extended/${groupId}`)\r\n      ) {\r\n        item.active = true;\r\n      } else {\r\n        item.active = history.location.pathname === item.link;\r\n      }\r\n      return item;\r\n    });\r\n  };\r\n\r\n  const cols = [\r\n    {\r\n      id: 'reportName',\r\n      label: utils.string.t('reportingExtended.reporting.columns.reportName'),\r\n      sort: { type: 'lexical', direction: 'asc' },\r\n    },\r\n    {\r\n      id: 'description',\r\n      label: utils.string.t('reportingExtended.reporting.columns.description'),\r\n      sort: { type: 'lexical', direction: 'asc' },\r\n    },\r\n    {\r\n      id: 'createdBy',\r\n      label: utils.string.t('reportingExtended.reporting.columns.createdBy'),\r\n      sort: { type: 'lexical', direction: 'asc' },\r\n    },\r\n    {\r\n      id: 'createdDate',\r\n      label: utils.string.t('reportingExtended.reporting.columns.createdDate'),\r\n      sort: { type: 'date', direction: 'asc' },\r\n    },\r\n    ...(hasEditReportPermission || hasDeleteReportPermission ? [{ id: 'actions', menu: true, visible: true }] : []),\r\n  ];\r\n\r\n  const handleClickRow = (report) => (event) => {\r\n    const { id, title } = report;\r\n    if (groupId && id) {\r\n      history.push(`${config.routes.reportingExtended.root}/${groupId}/${id}`, {\r\n        reportGroupTitle,\r\n        reportId: id,\r\n        reportTitle: title,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleChangePage = (newPage) => {\r\n    dispatch(getReportListExtended({ page: newPage + 1 }, groupId));\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (rowsPerPage) => {\r\n    dispatch(getReportListExtended({ size: rowsPerPage }, groupId));\r\n  };\r\n\r\n  const searchSubmit = ({ search, filters }) => {\r\n    dispatch(getReportListExtended({ searchBy: search, filters }, groupId));\r\n  };\r\n\r\n  const onSortColumn = (by, dir, type) => {\r\n    dispatch(getReportListExtended({ sortBy: by, direction: dir, sortType: type }, groupId));\r\n  };\r\n\r\n  const onSuccessfulCreateOrEditOrDeleteReport = () => {\r\n    dispatch(getReportListExtended(reportListParam, groupId));\r\n  };\r\n\r\n  const handleCreateEditReport = (isEditAddReport, report) => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'REPORTS_EXTENDED_ADD_EDIT',\r\n        props: {\r\n          fullWidth: false,\r\n          maxWidth: 'sm',\r\n          title: isEditAddReport\r\n            ? utils.string.t('reportingExtended.reporting.editReport')\r\n            : utils.string.t('reportingExtended.reporting.createReport'),\r\n          componentProps: {\r\n            report,\r\n            groupId,\r\n            isEditAddReport,\r\n            handlers: {\r\n              onSuccessfulCreateOrEditOrDeleteReport,\r\n            },\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleDeleteReport = (report) => {\r\n    const { id, title } = report;\r\n    const submitHandler = () => {\r\n      dispatch(deleteReportsExtended(id)).then((response) => {\r\n        if (response?.status === constants.API_RESPONSE_NO_CONTENT_STATUS) {\r\n          onSuccessfulCreateOrEditOrDeleteReport();\r\n        }\r\n      });\r\n    };\r\n\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM_DELETE',\r\n        props: {\r\n          title: `${utils.string.t('reportingExtended.reporting.deleteReport')}`,\r\n          subtitle: title,\r\n          fullWidth: true,\r\n          maxWidth: 'xs',\r\n          disableAutoFocus: true,\r\n          componentProps: {\r\n            submitHandler,\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const popoverActions = [\r\n    ...(hasEditReportPermission\r\n      ? [\r\n          {\r\n            id: 'edit',\r\n            label: utils.string.t('reportingExtended.reporting.popOverMenuItems.edit'),\r\n            callback: ({ report }) => handleCreateEditReport(true, report),\r\n          },\r\n        ]\r\n      : []),\r\n    ...(hasDeleteReportPermission\r\n      ? [\r\n          {\r\n            id: 'delete',\r\n            label: utils.string.t('reportingExtended.reporting.popOverMenuItems.delete'),\r\n            callback: ({ report }) => handleDeleteReport(report),\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  const pagination = usePagination(reportList, reportListPagination, handleChangePage, handleChangeRowsPerPage);\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{`${reportGroupTitle} - ${utils.app.getAppName(brand)}`}</title>\r\n      </Helmet>\r\n      <ReportsExtendedView\r\n        breadcrumbs={setActiveBreadCrumbStep(breadcrumbs)}\r\n        columns={cols}\r\n        reports={reportList}\r\n        popoverActions={popoverActions}\r\n        pagination={pagination.obj}\r\n        sort={reportListSorting}\r\n        hasCreateReportPermission={hasCreateReportPermission}\r\n        reportGroupTitle={reportGroupTitle}\r\n        isReportListLoading={isReportListLoading}\r\n        handlers={{\r\n          handleClickRow,\r\n          handleCreateEditReport,\r\n          handleChangePage: pagination.handlers.handleChangePage,\r\n          handleChangeRowsPerPage: pagination.handlers.handleChangeRowsPerPage,\r\n          searchSubmit,\r\n          onSortColumn,\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}