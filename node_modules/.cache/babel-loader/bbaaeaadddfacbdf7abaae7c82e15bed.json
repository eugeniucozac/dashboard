{"ast":null,"code":"import _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\forms\\\\DmsEditMetadata\\\\DmsEditMetadata.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useForm } from 'react-hook-form';\nimport { useSelector, useDispatch } from 'react-redux';\nimport * as Yup from 'yup';\nimport { yupResolver } from '@hookform/resolvers/yup'; //app\n\nimport DmsEditMetadataView from './DmsEditMetadata.view';\nimport * as utils from 'utils';\nimport * as constants from 'consts';\nimport { selectRefDataXbInstances, getViewTableDocuments, selectRefDataNewDocumentTypesByContextSource, selectRefDataNewDocumentTypeLookUpByContextSource, selectCaseDetails, getDmsEditMetadataSelector, getDmsEditMetadata, selectSettlementCurrency, postEditedMetadataDetails, selectDmsMetaData, selectRefDataCatCodesList } from 'stores';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nDmsEditMetadata.propTypes = {\n  docData: PropTypes.object.isRequired,\n  context: PropTypes.string.isRequired,\n  selectedSourceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  referenceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\n  documentTypeKey: PropTypes.oneOf(Object.values(constants.DMS_DOCUMENT_TYPE_SECTION_KEYS)),\n  searchParamsAfterUpload: PropTypes.shape({\n    referenceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\n    sectionType: PropTypes.string.isRequired\n  }),\n  cancelHandler: PropTypes.func.isRequired\n};\nDmsEditMetadata.defaultProps = {\n  documentTypeKey: constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy\n};\nexport default function DmsEditMetadata(_ref) {\n  _s();\n\n  var _existedMetaData$meta, _existedMetaData$meta2, _existedMetaData$meta3, _existedMetaData$meta4, _existedMetaData$meta5, _existedMetaData$meta6, _existedMetaData$meta7, _existedMetaData$meta8;\n\n  var docData = _ref.docData,\n      context = _ref.context,\n      selectedSourceId = _ref.selectedSourceId,\n      referenceId = _ref.referenceId,\n      documentTypeKey = _ref.documentTypeKey,\n      searchParamsAfterUpload = _ref.searchParamsAfterUpload,\n      cancelHandler = _ref.cancelHandler;\n  var dispatch = useDispatch();\n  var documentMetaData = useSelector(selectDmsMetaData);\n  var refDataXbInstances = useSelector(selectRefDataXbInstances);\n  var ppSelectCaseDetails = useSelector(selectCaseDetails);\n  var existedMetaData = useSelector(getDmsEditMetadataSelector);\n  var catCodesData = useSelector(selectRefDataCatCodesList);\n  var currenciesList = useSelector(selectSettlementCurrency);\n  var currencies = currenciesList === null || currenciesList === void 0 ? void 0 : currenciesList.map(function (currency) {\n    return _objectSpread(_objectSpread({}, currency), {}, {\n      name: \"\".concat(currency.id, \" - \").concat(currency.name)\n    });\n  });\n  var docInfo = utils.dmsFormatter.formatDocumentMetaData(documentMetaData, context, refDataXbInstances, utils.referenceData.catCodes.getAllFormatted(catCodesData));\n  var xbInstanceId = selectedSourceId ? selectedSourceId : constants.DMS_CLAIM_SOURCE_ID;\n\n  var _utils$dmsFormatter$g = utils.dmsFormatter.getDocumentTypeFilterKeys(context, xbInstanceId, documentTypeKey),\n      dmsSectionKey = _utils$dmsFormatter$g.dmsSectionKey,\n      dmsSourceId = _utils$dmsFormatter$g.dmsSourceId,\n      documentTypeSource = _utils$dmsFormatter$g.dmsDocTypeSource;\n\n  var isDmsFromPi = utils.dmsFormatter.isDmsFromPi(documentTypeKey);\n\n  var _ref2 = isDmsFromPi && utils.dmsFormatter.getDocumentTypeInfo(documentTypeKey, dmsSourceId),\n      documentTypeDescription = _ref2.documentTypeDescription,\n      sectionKey = _ref2.sectionKey,\n      dmsSourceID = _ref2.dmsSourceID;\n\n  var documentTypesBeforeFilter = useSelector(dmsSectionKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy ? selectRefDataNewDocumentTypeLookUpByContextSource(dmsSectionKey, dmsSourceId) : selectRefDataNewDocumentTypesByContextSource(dmsSectionKey, dmsSourceId, documentTypeSource));\n  var documentTypesAfterFilter = (context === constants.DMS_CONTEXT_POLICY || context === constants.DMS_CONTEXT_PROCESSING_INSTRUCTION) && isDmsFromPi ? documentTypesBeforeFilter === null || documentTypesBeforeFilter === void 0 ? void 0 : documentTypesBeforeFilter.filter(function (type) {\n    return type.documentTypeDescription === documentTypeDescription && type.sectionKey === sectionKey && type.sourceID === dmsSourceID;\n  }) : documentTypesBeforeFilter;\n  var documentId = docData.documentId,\n      docClassification = docData.docClassification;\n\n  var _useState = useState((existedMetaData === null || existedMetaData === void 0 ? void 0 : existedMetaData.documentTypeDescription) === constants.DMS_EDIT_PAYMENT_TYPE),\n      _useState2 = _slicedToArray(_useState, 2),\n      isPaymentAllowed = _useState2[0],\n      setIsPaymentAllowed = _useState2[1];\n\n  var isDmsFromPiInstruction = utils.dmsFormatter.isDmsFromPiInstruction(documentTypeKey);\n  var policyRef = ppSelectCaseDetails.policyRef,\n      instructionId = ppSelectCaseDetails.instructionId; //if api is added for this, please update this\n\n  var docClassificationTypes = [{\n    id: 1,\n    value: utils.string.t('dms.upload.modalItems.classificationType.low')\n  }, {\n    id: 2,\n    value: utils.string.t('dms.upload.modalItems.classificationType.guarded')\n  }, {\n    id: 3,\n    value: utils.string.t('dms.upload.modalItems.classificationType.high')\n  }, {\n    id: 4,\n    value: utils.string.t('dms.upload.modalItems.classificationType.severe')\n  }];\n  var fields = [{\n    name: 'documentName',\n    type: 'text',\n    value: (existedMetaData === null || existedMetaData === void 0 ? void 0 : existedMetaData.documentName) || '',\n    validation: Yup.string().required(utils.string.t('validation.required'))\n  }, {\n    name: 'documentType',\n    type: 'autocompletemui',\n    options: documentTypesAfterFilter || [],\n    optionKey: 'id',\n    optionLabel: 'documentTypeDescription',\n    value: (documentTypesAfterFilter === null || documentTypesAfterFilter === void 0 ? void 0 : documentTypesAfterFilter.find(function (item) {\n      return item.documentTypeDescription === (existedMetaData === null || existedMetaData === void 0 ? void 0 : existedMetaData.documentTypeDescription);\n    })) || '',\n    validation: Yup.object().nullable().required(utils.string.t('validation.required'))\n  }, {\n    name: 'documentClassification',\n    type: 'autocompletemui',\n    options: docClassificationTypes || [],\n    optionKey: 'id',\n    optionLabel: 'value',\n    value: (docClassificationTypes === null || docClassificationTypes === void 0 ? void 0 : docClassificationTypes.find(function (item) {\n      return item.id === Number(docClassification);\n    })) || '',\n    validation: Yup.object().nullable().required(utils.string.t('validation.required'))\n  }, {\n    type: 'datepicker',\n    name: 'payment.paymentDate',\n    icon: 'TodayIcon',\n    muiComponentProps: {\n      fullWidth: true\n    },\n    outputFormat: 'iso',\n    value: (existedMetaData === null || existedMetaData === void 0 ? void 0 : (_existedMetaData$meta = existedMetaData.metadataFields) === null || _existedMetaData$meta === void 0 ? void 0 : (_existedMetaData$meta2 = _existedMetaData$meta.find(function (item) {\n      return item.prop === constants.DMS_EDIT_PAYMENT_DATE;\n    })) === null || _existedMetaData$meta2 === void 0 ? void 0 : _existedMetaData$meta2.value) || ''\n  }, {\n    name: 'payment.paymentReference',\n    type: 'text',\n    value: (existedMetaData === null || existedMetaData === void 0 ? void 0 : (_existedMetaData$meta3 = existedMetaData.metadataFields) === null || _existedMetaData$meta3 === void 0 ? void 0 : (_existedMetaData$meta4 = _existedMetaData$meta3.find(function (item) {\n      return item.prop === constants.DMS_EDIT_PAYMENT_REFERENCE;\n    })) === null || _existedMetaData$meta4 === void 0 ? void 0 : _existedMetaData$meta4.value) || ''\n  }, {\n    name: 'payment.lossPayee',\n    type: 'text',\n    value: (existedMetaData === null || existedMetaData === void 0 ? void 0 : (_existedMetaData$meta5 = existedMetaData.metadataFields) === null || _existedMetaData$meta5 === void 0 ? void 0 : (_existedMetaData$meta6 = _existedMetaData$meta5.find(function (item) {\n      return item.prop === constants.DMS_EDIT_PAYMENT_LOSS_PAYEE;\n    })) === null || _existedMetaData$meta6 === void 0 ? void 0 : _existedMetaData$meta6.value) || ''\n  }, {\n    name: 'payment.amount',\n    type: 'number',\n    value: (existedMetaData === null || existedMetaData === void 0 ? void 0 : (_existedMetaData$meta7 = existedMetaData.metadataFields) === null || _existedMetaData$meta7 === void 0 ? void 0 : (_existedMetaData$meta8 = _existedMetaData$meta7.find(function (item) {\n      return item.prop === constants.DMS_EDIT_PAYMENT_AMOUNT;\n    })) === null || _existedMetaData$meta8 === void 0 ? void 0 : _existedMetaData$meta8.value) || ''\n  }, {\n    name: 'payment.currency',\n    type: 'autocompletemui',\n    options: currencies || [],\n    optionKey: 'id',\n    optionLabel: 'name',\n    value: (currencies === null || currencies === void 0 ? void 0 : currencies.find(function (item) {\n      var _existedMetaData$meta9, _existedMetaData$meta10;\n\n      return item.id === (existedMetaData === null || existedMetaData === void 0 ? void 0 : (_existedMetaData$meta9 = existedMetaData.metadataFields) === null || _existedMetaData$meta9 === void 0 ? void 0 : (_existedMetaData$meta10 = _existedMetaData$meta9.find(function (subItem) {\n        return subItem.prop === constants.DMS_EDIT_PAYMENT_CURRENCY;\n      })) === null || _existedMetaData$meta10 === void 0 ? void 0 : _existedMetaData$meta10.value);\n    })) || ''\n  }];\n  var actions = [{\n    name: 'secondary',\n    label: utils.string.t('app.cancel'),\n    handler: function handler() {\n      cancelHandler();\n    }\n  }, {\n    name: 'submit',\n    label: utils.string.t('app.save'),\n    handler: function handler(values) {\n      handleMetaDataSubmit(values);\n    }\n  }];\n  var defaultValues = utils.form.getInitialValues(fields);\n  var validationSchema = utils.form.getValidationSchema(fields);\n\n  var _useForm = useForm(_objectSpread({\n    defaultValues: defaultValues\n  }, validationSchema && {\n    resolver: yupResolver(validationSchema)\n  })),\n      control = _useForm.control,\n      reset = _useForm.reset,\n      errors = _useForm.errors,\n      handleSubmit = _useForm.handleSubmit,\n      formState = _useForm.formState,\n      watch = _useForm.watch;\n\n  var documentType = watch('documentType');\n  useEffect(function () {\n    !utils.generic.isValidObject(existedMetaData) && dispatch(getDmsEditMetadata(documentId, docClassification));\n  }, [documentId]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    setIsPaymentAllowed((documentType === null || documentType === void 0 ? void 0 : documentType.documentTypeDescription) === constants.DMS_EDIT_PAYMENT_TYPE);\n  }, [documentType]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var handleMetaDataSubmit = function handleMetaDataSubmit(values) {\n    var _Object$keys, _values$documentType, _values$documentType2, _values$documentClass;\n\n    var metadataField = isPaymentAllowed && ((_Object$keys = Object.keys(values === null || values === void 0 ? void 0 : values.payment)) === null || _Object$keys === void 0 ? void 0 : _Object$keys.map(function (item) {\n      var _values$payment$item;\n\n      var propVal = item === 'currency' ? values === null || values === void 0 ? void 0 : (_values$payment$item = values.payment[item]) === null || _values$payment$item === void 0 ? void 0 : _values$payment$item.id : values === null || values === void 0 ? void 0 : values.payment[item];\n      return {\n        prop: constants.DMS_EDIT_PAYMENT_PAYLOAD[item],\n        value: (item === 'amount' ? parseInt(propVal) : propVal) || ''\n      };\n    }));\n    var editMetadata = {\n      documentExtType: (existedMetaData === null || existedMetaData === void 0 ? void 0 : existedMetaData.documentExtType) || '',\n      documentId: parseInt(existedMetaData === null || existedMetaData === void 0 ? void 0 : existedMetaData.documentId) || '',\n      documentTypeId: (values === null || values === void 0 ? void 0 : (_values$documentType = values.documentType) === null || _values$documentType === void 0 ? void 0 : _values$documentType.documentTypeID) || '',\n      documentTypeDescription: (values === null || values === void 0 ? void 0 : (_values$documentType2 = values.documentType) === null || _values$documentType2 === void 0 ? void 0 : _values$documentType2.documentTypeDescription) || '',\n      createdDate: (docData === null || docData === void 0 ? void 0 : docData.createdDate) || '',\n      createdBy: (existedMetaData === null || existedMetaData === void 0 ? void 0 : existedMetaData.createdBy) || '',\n      docClassificationId: (values === null || values === void 0 ? void 0 : (_values$documentClass = values.documentClassification) === null || _values$documentClass === void 0 ? void 0 : _values$documentClass.id) || '',\n      newFileName: values === null || values === void 0 ? void 0 : values.documentName,\n      metadataFields: metadataField || null\n    };\n    dispatch(postEditedMetadataDetails(editMetadata)).then(function (response) {\n      if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n        if (!isDmsFromPiInstruction) {\n          dispatch(getViewTableDocuments(_objectSpread({}, searchParamsAfterUpload ? searchParamsAfterUpload : _objectSpread({\n            referenceId: referenceId,\n            sectionType: context,\n            documentTypeKey: documentTypeKey\n          }, policyRef && instructionId && {\n            policyRef: policyRef,\n            instructionId: instructionId\n          }))));\n        }\n\n        cancelHandler();\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(DmsEditMetadataView, {\n    fields: fields,\n    control: control,\n    errors: errors,\n    actions: actions,\n    reset: reset,\n    handleSubmit: handleSubmit,\n    formState: formState,\n    dmsContext: context,\n    docInfo: docInfo,\n    documentData: docData,\n    existedMetaData: existedMetaData,\n    isPaymentAllowed: isPaymentAllowed\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n}\n\n_s(DmsEditMetadata, \"vQN1obgbu3pAFstKUor1IIZNEAo=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useForm];\n});\n\n_c = DmsEditMetadata;\n\nvar _c;\n\n$RefreshReg$(_c, \"DmsEditMetadata\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/forms/DmsEditMetadata/DmsEditMetadata.js"],"names":["React","useEffect","useState","PropTypes","useForm","useSelector","useDispatch","Yup","yupResolver","DmsEditMetadataView","utils","constants","selectRefDataXbInstances","getViewTableDocuments","selectRefDataNewDocumentTypesByContextSource","selectRefDataNewDocumentTypeLookUpByContextSource","selectCaseDetails","getDmsEditMetadataSelector","getDmsEditMetadata","selectSettlementCurrency","postEditedMetadataDetails","selectDmsMetaData","selectRefDataCatCodesList","DmsEditMetadata","propTypes","docData","object","isRequired","context","string","selectedSourceId","oneOfType","number","referenceId","documentTypeKey","oneOf","Object","values","DMS_DOCUMENT_TYPE_SECTION_KEYS","searchParamsAfterUpload","shape","sectionType","cancelHandler","func","defaultProps","policy","dispatch","documentMetaData","refDataXbInstances","ppSelectCaseDetails","existedMetaData","catCodesData","currenciesList","currencies","map","currency","name","id","docInfo","dmsFormatter","formatDocumentMetaData","referenceData","catCodes","getAllFormatted","xbInstanceId","DMS_CLAIM_SOURCE_ID","getDocumentTypeFilterKeys","dmsSectionKey","dmsSourceId","documentTypeSource","dmsDocTypeSource","isDmsFromPi","getDocumentTypeInfo","documentTypeDescription","sectionKey","dmsSourceID","documentTypesBeforeFilter","documentTypesAfterFilter","DMS_CONTEXT_POLICY","DMS_CONTEXT_PROCESSING_INSTRUCTION","filter","type","sourceID","documentId","docClassification","DMS_EDIT_PAYMENT_TYPE","isPaymentAllowed","setIsPaymentAllowed","isDmsFromPiInstruction","policyRef","instructionId","docClassificationTypes","value","t","fields","documentName","validation","required","options","optionKey","optionLabel","find","item","nullable","Number","icon","muiComponentProps","fullWidth","outputFormat","metadataFields","prop","DMS_EDIT_PAYMENT_DATE","DMS_EDIT_PAYMENT_REFERENCE","DMS_EDIT_PAYMENT_LOSS_PAYEE","DMS_EDIT_PAYMENT_AMOUNT","subItem","DMS_EDIT_PAYMENT_CURRENCY","actions","label","handler","handleMetaDataSubmit","defaultValues","form","getInitialValues","validationSchema","getValidationSchema","resolver","control","reset","errors","handleSubmit","formState","watch","documentType","generic","isValidObject","metadataField","keys","payment","propVal","DMS_EDIT_PAYMENT_PAYLOAD","parseInt","editMetadata","documentExtType","documentTypeId","documentTypeID","createdDate","createdBy","docClassificationId","documentClassification","newFileName","then","response","status","API_RESPONSE_OK"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useForm } from 'react-hook-form';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport * as Yup from 'yup';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\n\r\n//app\r\nimport DmsEditMetadataView from './DmsEditMetadata.view';\r\nimport * as utils from 'utils';\r\nimport * as constants from 'consts';\r\nimport {\r\n  selectRefDataXbInstances,\r\n  getViewTableDocuments,\r\n  selectRefDataNewDocumentTypesByContextSource,\r\n  selectRefDataNewDocumentTypeLookUpByContextSource,\r\n  selectCaseDetails,\r\n  getDmsEditMetadataSelector,\r\n  getDmsEditMetadata,\r\n  selectSettlementCurrency,\r\n  postEditedMetadataDetails,\r\n  selectDmsMetaData,\r\n  selectRefDataCatCodesList,\r\n} from 'stores';\r\n\r\nDmsEditMetadata.propTypes = {\r\n  docData: PropTypes.object.isRequired,\r\n  context: PropTypes.string.isRequired,\r\n  selectedSourceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n  referenceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\r\n  documentTypeKey: PropTypes.oneOf(Object.values(constants.DMS_DOCUMENT_TYPE_SECTION_KEYS)),\r\n  searchParamsAfterUpload: PropTypes.shape({\r\n    referenceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\r\n    sectionType: PropTypes.string.isRequired,\r\n  }),\r\n  cancelHandler: PropTypes.func.isRequired,\r\n};\r\n\r\nDmsEditMetadata.defaultProps = {\r\n  documentTypeKey: constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy,\r\n};\r\n\r\nexport default function DmsEditMetadata({\r\n  docData,\r\n  context,\r\n  selectedSourceId,\r\n  referenceId,\r\n  documentTypeKey,\r\n  searchParamsAfterUpload,\r\n  cancelHandler,\r\n}) {\r\n  const dispatch = useDispatch();\r\n  const documentMetaData = useSelector(selectDmsMetaData);\r\n  const refDataXbInstances = useSelector(selectRefDataXbInstances);\r\n  const ppSelectCaseDetails = useSelector(selectCaseDetails);\r\n  const existedMetaData = useSelector(getDmsEditMetadataSelector);\r\n  const catCodesData = useSelector(selectRefDataCatCodesList);\r\n  const currenciesList = useSelector(selectSettlementCurrency);\r\n\r\n  const currencies = currenciesList?.map((currency) => ({ ...currency, name: `${currency.id} - ${currency.name}` }));\r\n  const docInfo = utils.dmsFormatter.formatDocumentMetaData(\r\n    documentMetaData,\r\n    context,\r\n    refDataXbInstances,\r\n    utils.referenceData.catCodes.getAllFormatted(catCodesData)\r\n  );\r\n\r\n  const xbInstanceId = selectedSourceId ? selectedSourceId : constants.DMS_CLAIM_SOURCE_ID;\r\n\r\n  const {\r\n    dmsSectionKey,\r\n    dmsSourceId,\r\n    dmsDocTypeSource: documentTypeSource,\r\n  } = utils.dmsFormatter.getDocumentTypeFilterKeys(context, xbInstanceId, documentTypeKey);\r\n\r\n  const isDmsFromPi = utils.dmsFormatter.isDmsFromPi(documentTypeKey);\r\n  const { documentTypeDescription, sectionKey, dmsSourceID } =\r\n    isDmsFromPi && utils.dmsFormatter.getDocumentTypeInfo(documentTypeKey, dmsSourceId);\r\n  const documentTypesBeforeFilter = useSelector(\r\n    dmsSectionKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy\r\n      ? selectRefDataNewDocumentTypeLookUpByContextSource(dmsSectionKey, dmsSourceId)\r\n      : selectRefDataNewDocumentTypesByContextSource(dmsSectionKey, dmsSourceId, documentTypeSource)\r\n  );\r\n  const documentTypesAfterFilter =\r\n    (context === constants.DMS_CONTEXT_POLICY || context === constants.DMS_CONTEXT_PROCESSING_INSTRUCTION) && isDmsFromPi\r\n      ? documentTypesBeforeFilter?.filter(\r\n          (type) =>\r\n            type.documentTypeDescription === documentTypeDescription && type.sectionKey === sectionKey && type.sourceID === dmsSourceID\r\n        )\r\n      : documentTypesBeforeFilter;\r\n\r\n  const { documentId, docClassification } = docData;\r\n  const [isPaymentAllowed, setIsPaymentAllowed] = useState(existedMetaData?.documentTypeDescription === constants.DMS_EDIT_PAYMENT_TYPE);\r\n  const isDmsFromPiInstruction = utils.dmsFormatter.isDmsFromPiInstruction(documentTypeKey);\r\n  const { policyRef, instructionId } = ppSelectCaseDetails;\r\n\r\n  //if api is added for this, please update this\r\n  const docClassificationTypes = [\r\n    { id: 1, value: utils.string.t('dms.upload.modalItems.classificationType.low') },\r\n    { id: 2, value: utils.string.t('dms.upload.modalItems.classificationType.guarded') },\r\n    { id: 3, value: utils.string.t('dms.upload.modalItems.classificationType.high') },\r\n    { id: 4, value: utils.string.t('dms.upload.modalItems.classificationType.severe') },\r\n  ];\r\n\r\n  const fields = [\r\n    {\r\n      name: 'documentName',\r\n      type: 'text',\r\n      value: existedMetaData?.documentName || '',\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n    },\r\n    {\r\n      name: 'documentType',\r\n      type: 'autocompletemui',\r\n      options: documentTypesAfterFilter || [],\r\n      optionKey: 'id',\r\n      optionLabel: 'documentTypeDescription',\r\n      value: documentTypesAfterFilter?.find((item) => item.documentTypeDescription === existedMetaData?.documentTypeDescription) || '',\r\n      validation: Yup.object().nullable().required(utils.string.t('validation.required')),\r\n    },\r\n    {\r\n      name: 'documentClassification',\r\n      type: 'autocompletemui',\r\n      options: docClassificationTypes || [],\r\n      optionKey: 'id',\r\n      optionLabel: 'value',\r\n      value: docClassificationTypes?.find((item) => item.id === Number(docClassification)) || '',\r\n      validation: Yup.object().nullable().required(utils.string.t('validation.required')),\r\n    },\r\n    {\r\n      type: 'datepicker',\r\n      name: 'payment.paymentDate',\r\n      icon: 'TodayIcon',\r\n      muiComponentProps: {\r\n        fullWidth: true,\r\n      },\r\n      outputFormat: 'iso',\r\n      value: existedMetaData?.metadataFields?.find((item) => item.prop === constants.DMS_EDIT_PAYMENT_DATE)?.value || '',\r\n    },\r\n    {\r\n      name: 'payment.paymentReference',\r\n      type: 'text',\r\n      value: existedMetaData?.metadataFields?.find((item) => item.prop === constants.DMS_EDIT_PAYMENT_REFERENCE)?.value || '',\r\n    },\r\n    {\r\n      name: 'payment.lossPayee',\r\n      type: 'text',\r\n      value: existedMetaData?.metadataFields?.find((item) => item.prop === constants.DMS_EDIT_PAYMENT_LOSS_PAYEE)?.value || '',\r\n    },\r\n    {\r\n      name: 'payment.amount',\r\n      type: 'number',\r\n      value: existedMetaData?.metadataFields?.find((item) => item.prop === constants.DMS_EDIT_PAYMENT_AMOUNT)?.value || '',\r\n    },\r\n    {\r\n      name: 'payment.currency',\r\n      type: 'autocompletemui',\r\n      options: currencies || [],\r\n      optionKey: 'id',\r\n      optionLabel: 'name',\r\n      value:\r\n        currencies?.find((item) => {\r\n          return (\r\n            item.id === existedMetaData?.metadataFields?.find((subItem) => subItem.prop === constants.DMS_EDIT_PAYMENT_CURRENCY)?.value\r\n          );\r\n        }) || '',\r\n    },\r\n  ];\r\n\r\n  const actions = [\r\n    {\r\n      name: 'secondary',\r\n      label: utils.string.t('app.cancel'),\r\n      handler: () => {\r\n        cancelHandler();\r\n      },\r\n    },\r\n    {\r\n      name: 'submit',\r\n      label: utils.string.t('app.save'),\r\n      handler: (values) => {\r\n        handleMetaDataSubmit(values);\r\n      },\r\n    },\r\n  ];\r\n\r\n  const defaultValues = utils.form.getInitialValues(fields);\r\n  const validationSchema = utils.form.getValidationSchema(fields);\r\n  const { control, reset, errors, handleSubmit, formState, watch } = useForm({\r\n    defaultValues,\r\n    ...(validationSchema && { resolver: yupResolver(validationSchema) }),\r\n  });\r\n  const documentType = watch('documentType');\r\n\r\n  useEffect(() => {\r\n    !utils.generic.isValidObject(existedMetaData) && dispatch(getDmsEditMetadata(documentId, docClassification));\r\n  }, [documentId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    setIsPaymentAllowed(documentType?.documentTypeDescription === constants.DMS_EDIT_PAYMENT_TYPE);\r\n  }, [documentType]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const handleMetaDataSubmit = (values) => {\r\n    const metadataField =\r\n      isPaymentAllowed &&\r\n      Object.keys(values?.payment)?.map((item) => {\r\n        const propVal = item === 'currency' ? values?.payment[item]?.id : values?.payment[item];\r\n        return {\r\n          prop: constants.DMS_EDIT_PAYMENT_PAYLOAD[item],\r\n          value: (item === 'amount' ? parseInt(propVal) : propVal) || '',\r\n        };\r\n      });\r\n    const editMetadata = {\r\n      documentExtType: existedMetaData?.documentExtType || '',\r\n      documentId: parseInt(existedMetaData?.documentId) || '',\r\n      documentTypeId: values?.documentType?.documentTypeID || '',\r\n      documentTypeDescription: values?.documentType?.documentTypeDescription || '',\r\n      createdDate: docData?.createdDate || '',\r\n      createdBy: existedMetaData?.createdBy || '',\r\n      docClassificationId: values?.documentClassification?.id || '',\r\n      newFileName: values?.documentName,\r\n      metadataFields: metadataField || null,\r\n    };\r\n\r\n    dispatch(postEditedMetadataDetails(editMetadata)).then((response) => {\r\n      if (response?.status === constants.API_RESPONSE_OK) {\r\n        if (!isDmsFromPiInstruction) {\r\n          dispatch(\r\n            getViewTableDocuments({\r\n              ...(searchParamsAfterUpload\r\n                ? searchParamsAfterUpload\r\n                : {\r\n                    referenceId,\r\n                    sectionType: context,\r\n                    documentTypeKey,\r\n                    ...(policyRef && instructionId && { policyRef, instructionId }),\r\n                  }),\r\n            })\r\n          );\r\n        }\r\n        cancelHandler();\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <DmsEditMetadataView\r\n      fields={fields}\r\n      control={control}\r\n      errors={errors}\r\n      actions={actions}\r\n      reset={reset}\r\n      handleSubmit={handleSubmit}\r\n      formState={formState}\r\n      dmsContext={context}\r\n      docInfo={docInfo}\r\n      documentData={docData}\r\n      existedMetaData={existedMetaData}\r\n      isPaymentAllowed={isPaymentAllowed}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}