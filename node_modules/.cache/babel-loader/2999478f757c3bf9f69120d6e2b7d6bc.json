{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\RiskMap\\\\RiskMap.js\",\n    _s = $RefreshSig$();\n\nimport * as React from 'react';\nimport { firstBy } from 'thenby';\nimport startCase from 'lodash/startCase';\nimport toLower from 'lodash/toLower';\nimport { Pagination, TableCell, TableHead, Translate, MapBox, MapBoxTooltip, Overflow } from 'components';\nimport { Box, Table, TableRow, TableBody, Typography } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport LocationOnIcon from '@material-ui/icons/LocationOn'; // app\n\nimport { LocationTooltip } from './LocationTooltip';\nimport { useSort } from 'hooks';\nimport * as utils from 'utils';\nimport { mapLayers } from 'utils/map/mapLayers';\nimport config from 'config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _config$ui = config === null || config === void 0 ? void 0 : config.ui,\n    paginationConfig = _config$ui.pagination;\n\nvar useStyles = makeStyles(function () {\n  return {\n    root: {\n      color: 'red',\n      '& .MuiTableCell-sizeSmall': {\n        '&:first-child': {\n          paddingLeft: 30\n        },\n        '&:last-child': {\n          paddingRight: 0\n        }\n      }\n    }\n  };\n});\n\nfunction RiskMap(_ref) {\n  _s();\n\n  var _this = this;\n\n  var title = _ref.title,\n      locations = _ref.locations,\n      locationDefinitions = _ref.locationDefinitions;\n  var classes = useStyles();\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isTooltipOpen = _React$useState2[0],\n      setIsTooltipOpen = _React$useState2[1];\n\n  var _React$useState3 = React.useState({}),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      viewport = _React$useState4[0],\n      setViewport = _React$useState4[1];\n\n  var _React$useState5 = React.useState([]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      activeMarkers = _React$useState6[0],\n      setActiveMarkers = _React$useState6[1];\n\n  var _React$useState7 = React.useState({\n    page: 0,\n    rowsPerPage: paginationConfig.default,\n    rowsPerPageOptions: paginationConfig.options,\n    count: locations === null || locations === void 0 ? void 0 : locations.length\n  }),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      pagination = _React$useState8[0],\n      setPagination = _React$useState8[1];\n\n  var defaultSort = {\n    by: 'id',\n    direction: 'asc',\n    type: 'numeric'\n  };\n  var columns = [{\n    id: 'id',\n    label: /*#__PURE__*/_jsxDEV(Translate, {\n      label: \"risks.building\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 24\n    }, this),\n    sort: {\n      by: 'id',\n      type: 'numeric',\n      direction: 'asc'\n    }\n  }, {\n    id: 'streetAddress',\n    label: /*#__PURE__*/_jsxDEV(Translate, {\n      label: \"app.streetAddress\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 35\n    }, this),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'city',\n    label: /*#__PURE__*/_jsxDEV(Translate, {\n      label: \"app.city\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 26\n    }, this),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'county',\n    label: 'County',\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'state',\n    label: /*#__PURE__*/_jsxDEV(Translate, {\n      label: \"app.state\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 27\n    }, this),\n    sort: {\n      type: 'lexical',\n      direction: 'asc'\n    }\n  }, {\n    id: 'distanceToCoast',\n    label: /*#__PURE__*/_jsxDEV(Translate, {\n      label: \"risks.address.distanceToCoast\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 37\n    }, this),\n    sort: {\n      type: 'numeric',\n      direction: 'asc'\n    }\n  }, {\n    id: 'totalInsurableValue',\n    label: /*#__PURE__*/_jsxDEV(Translate, {\n      label: \"app.tiv\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 41\n    }, this),\n    sort: {\n      type: 'numeric',\n      direction: 'desc'\n    }\n  }, {\n    id: 'buildingInfo',\n    label: ''\n  }];\n\n  var _useSort = useSort(columns, defaultSort),\n      cols = _useSort.cols,\n      sort = _useSort.sort;\n\n  var sortedLocations = locations.sort(firstBy(utils.sort.array(sort.type, sort.by, sort.direction)));\n  var start = pagination.page * pagination.rowsPerPage;\n  var end = start + pagination.rowsPerPage;\n\n  var handleChangePage = function handleChangePage(_, page) {\n    setPagination(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        page: page\n      });\n    });\n  };\n\n  var handleChangeRowsPerPage = function handleChangeRowsPerPage(event) {\n    setPagination(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        rowsPerPage: event.target.value\n      });\n    });\n  };\n\n  var handleOpenTooltip = function handleOpenTooltip(open) {\n    setIsTooltipOpen(open);\n  };\n\n  var handleMarkerClick = function handleMarkerClick(_ref2) {\n    var id = _ref2.id;\n    var locationIndex = sortedLocations.findIndex(function (location) {\n      return location.id === id;\n    });\n    setPagination(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        page: Math.floor(locationIndex / prevState.rowsPerPage)\n      });\n    });\n    setActiveMarkers([id]);\n  };\n\n  var handleRowClick = function handleRowClick(location) {\n    setViewport(_objectSpread(_objectSpread({}, viewport), {}, {\n      center: [location.longitude, location.latitude],\n      zoom: config.mapbox.marker.maxZoom\n    }));\n    setActiveMarkers([location.id]);\n  };\n\n  var customTooltipComponent = function customTooltipComponent(_ref3) {\n    var tooltip = _ref3.tooltip;\n    var title = \"\".concat(tooltip.streetAddress, \", \").concat(tooltip.zip, \", \").concat(tooltip.city, \", \").concat(tooltip.county, \", \").concat(tooltip.state);\n    return tooltip.buildingTitle ? /*#__PURE__*/_jsxDEV(MapBoxTooltip, {\n      title: tooltip.buildingTitle,\n      list: [{\n        icon: /*#__PURE__*/_jsxDEV(LocationOnIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 96\n        }, _this),\n        title: title\n      }]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 36\n    }, _this) : null;\n  };\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      m: 3,\n      mb: 1,\n      display: \"flex\",\n      alignItems: \"center\",\n      \"data-testid\": \"risk-map\",\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h3\",\n        children: startCase(toLower(title))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      children: /*#__PURE__*/_jsxDEV(MapBox, _objectSpread({\n        \"data-testid\": \"mapbox\",\n        id: \"markers\",\n        height: 400,\n        activeMarkers: activeMarkers,\n        onClickMarker: handleMarkerClick,\n        fitBounds: true,\n        locations: sortedLocations,\n        allowFullscreen: true,\n        allowSatelliteView: true,\n        allowScrollZoom: true,\n        allowMarkerClickZoom: true,\n        layers: mapLayers,\n        tooltipComponent: customTooltipComponent\n      }, viewport), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      children: /*#__PURE__*/_jsxDEV(Overflow, {\n        children: [/*#__PURE__*/_jsxDEV(Table, {\n          size: \"small\",\n          classes: {\n            root: classes.root\n          },\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            columns: cols,\n            sorting: {\n              by: sort.by,\n              direction: sort.direction\n            },\n            nestedClasses: {\n              tableHead: classes.tableHead\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n            children: sortedLocations.slice(start, end).map(function (location) {\n              return /*#__PURE__*/_jsxDEV(TableRow, {\n                \"data-testid\": \"location-row\",\n                hover: true,\n                selected: activeMarkers.includes(location.id),\n                style: {\n                  cursor: 'pointer'\n                },\n                onClick: function onClick() {\n                  return handleRowClick(location);\n                },\n                children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                  children: location.buildingTitle\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: location.streetAddress\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: location.city\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: location.county\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: location.state\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: [location.distanceToCoast, \" miles\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: utils.number.formatNumber(location.totalInsurableValue)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: /*#__PURE__*/_jsxDEV(LocationTooltip, {\n                    location: location,\n                    locationDefinitions: locationDefinitions,\n                    excludeColumns: columns,\n                    handleOpen: handleOpenTooltip,\n                    disabled: isTooltipOpen\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 161,\n                    columnNumber: 23\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 160,\n                  columnNumber: 21\n                }, _this)]\n              }, location.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 19\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n          page: pagination.page,\n          count: pagination.count,\n          rowsPerPage: pagination.rowsPerPage,\n          rowsPerPageOptions: pagination.rowsPerPageOptions,\n          onChangePage: handleChangePage,\n          onChangeRowsPerPage: handleChangeRowsPerPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n}\n\n_s(RiskMap, \"ziXdWHTKiNxpQP7IH8sgmx9NB0g=\", false, function () {\n  return [useStyles, useSort];\n});\n\n_c = RiskMap;\nexport default RiskMap;\n\nvar _c;\n\n$RefreshReg$(_c, \"RiskMap\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/RiskMap/RiskMap.js"],"names":["React","firstBy","startCase","toLower","Pagination","TableCell","TableHead","Translate","MapBox","MapBoxTooltip","Overflow","Box","Table","TableRow","TableBody","Typography","makeStyles","LocationOnIcon","LocationTooltip","useSort","utils","mapLayers","config","ui","paginationConfig","pagination","useStyles","root","color","paddingLeft","paddingRight","RiskMap","title","locations","locationDefinitions","classes","useState","isTooltipOpen","setIsTooltipOpen","viewport","setViewport","activeMarkers","setActiveMarkers","page","rowsPerPage","default","rowsPerPageOptions","options","count","length","setPagination","defaultSort","by","direction","type","columns","id","label","sort","cols","sortedLocations","array","start","end","handleChangePage","_","prevState","handleChangeRowsPerPage","event","target","value","handleOpenTooltip","open","handleMarkerClick","locationIndex","findIndex","location","Math","floor","handleRowClick","center","longitude","latitude","zoom","mapbox","marker","maxZoom","customTooltipComponent","tooltip","streetAddress","zip","city","county","state","buildingTitle","icon","tableHead","slice","map","includes","cursor","distanceToCoast","number","formatNumber","totalInsurableValue"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { firstBy } from 'thenby';\r\nimport startCase from 'lodash/startCase';\r\nimport toLower from 'lodash/toLower';\r\n\r\nimport { Pagination, TableCell, TableHead, Translate, MapBox, MapBoxTooltip, Overflow } from 'components';\r\nimport { Box, Table, TableRow, TableBody, Typography } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\n\r\n// app\r\nimport { LocationTooltip } from './LocationTooltip';\r\nimport { useSort } from 'hooks';\r\nimport * as utils from 'utils';\r\nimport { mapLayers } from 'utils/map/mapLayers';\r\nimport config from 'config';\r\n\r\nconst { pagination: paginationConfig } = config?.ui;\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    color: 'red',\r\n    '& .MuiTableCell-sizeSmall': {\r\n      '&:first-child': {\r\n        paddingLeft: 30,\r\n      },\r\n\r\n      '&:last-child': {\r\n        paddingRight: 0,\r\n      },\r\n    },\r\n  },\r\n}));\r\n\r\nfunction RiskMap({ title, locations, locationDefinitions }) {\r\n  const classes = useStyles();\r\n  const [isTooltipOpen, setIsTooltipOpen] = React.useState(false);\r\n  const [viewport, setViewport] = React.useState({});\r\n  const [activeMarkers, setActiveMarkers] = React.useState([]);\r\n  const [pagination, setPagination] = React.useState({\r\n    page: 0,\r\n    rowsPerPage: paginationConfig.default,\r\n    rowsPerPageOptions: paginationConfig.options,\r\n    count: locations?.length,\r\n  });\r\n\r\n  const defaultSort = {\r\n    by: 'id',\r\n    direction: 'asc',\r\n    type: 'numeric',\r\n  };\r\n\r\n  const columns = [\r\n    { id: 'id', label: <Translate label=\"risks.building\" />, sort: { by: 'id', type: 'numeric', direction: 'asc' } },\r\n    { id: 'streetAddress', label: <Translate label=\"app.streetAddress\" />, sort: { type: 'lexical', direction: 'asc' } },\r\n    { id: 'city', label: <Translate label=\"app.city\" />, sort: { type: 'lexical', direction: 'asc' } },\r\n    { id: 'county', label: 'County', sort: { type: 'lexical', direction: 'asc' } },\r\n    { id: 'state', label: <Translate label=\"app.state\" />, sort: { type: 'lexical', direction: 'asc' } },\r\n    { id: 'distanceToCoast', label: <Translate label=\"risks.address.distanceToCoast\" />, sort: { type: 'numeric', direction: 'asc' } },\r\n    { id: 'totalInsurableValue', label: <Translate label=\"app.tiv\" />, sort: { type: 'numeric', direction: 'desc' } },\r\n    { id: 'buildingInfo', label: '' },\r\n  ];\r\n\r\n  const { cols, sort } = useSort(columns, defaultSort);\r\n  const sortedLocations = locations.sort(firstBy(utils.sort.array(sort.type, sort.by, sort.direction)));\r\n\r\n  const start = pagination.page * pagination.rowsPerPage;\r\n  const end = start + pagination.rowsPerPage;\r\n\r\n  const handleChangePage = (_, page) => {\r\n    setPagination((prevState) => {\r\n      return { ...prevState, page };\r\n    });\r\n  };\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setPagination((prevState) => {\r\n      return { ...prevState, rowsPerPage: event.target.value };\r\n    });\r\n  };\r\n\r\n  const handleOpenTooltip = (open) => {\r\n    setIsTooltipOpen(open);\r\n  };\r\n\r\n  const handleMarkerClick = ({ id }) => {\r\n    const locationIndex = sortedLocations.findIndex((location) => location.id === id);\r\n\r\n    setPagination((prevState) => {\r\n      return { ...prevState, page: Math.floor(locationIndex / prevState.rowsPerPage) };\r\n    });\r\n    setActiveMarkers([id]);\r\n  };\r\n\r\n  const handleRowClick = (location) => {\r\n    setViewport({\r\n      ...viewport,\r\n      center: [location.longitude, location.latitude],\r\n      zoom: config.mapbox.marker.maxZoom,\r\n    });\r\n\r\n    setActiveMarkers([location.id]);\r\n  };\r\n\r\n  const customTooltipComponent = ({ tooltip }) => {\r\n    const title = `${tooltip.streetAddress}, ${tooltip.zip}, ${tooltip.city}, ${tooltip.county}, ${tooltip.state}`;\r\n\r\n    return tooltip.buildingTitle ? <MapBoxTooltip title={tooltip.buildingTitle} list={[{ icon: <LocationOnIcon />, title }]} /> : null;\r\n  };\r\n\r\n  return (\r\n    <Box>\r\n      <Box m={3} mb={1} display=\"flex\" alignItems=\"center\" data-testid=\"risk-map\">\r\n        <Typography variant=\"h3\">{startCase(toLower(title))}</Typography>\r\n      </Box>\r\n\r\n      <Box>\r\n        <MapBox\r\n          data-testid=\"mapbox\"\r\n          id=\"markers\"\r\n          height={400}\r\n          activeMarkers={activeMarkers}\r\n          onClickMarker={handleMarkerClick}\r\n          fitBounds\r\n          locations={sortedLocations}\r\n          allowFullscreen\r\n          allowSatelliteView\r\n          allowScrollZoom\r\n          allowMarkerClickZoom\r\n          layers={mapLayers}\r\n          tooltipComponent={customTooltipComponent}\r\n          {...viewport}\r\n        />\r\n      </Box>\r\n      <Box>\r\n        <Overflow>\r\n          <Table size=\"small\" classes={{ root: classes.root }}>\r\n            <TableHead\r\n              columns={cols}\r\n              sorting={{ by: sort.by, direction: sort.direction }}\r\n              nestedClasses={{ tableHead: classes.tableHead }}\r\n            />\r\n            <TableBody>\r\n              {sortedLocations.slice(start, end).map((location) => {\r\n                return (\r\n                  <TableRow\r\n                    key={location.id}\r\n                    data-testid={`location-row`}\r\n                    hover\r\n                    selected={activeMarkers.includes(location.id)}\r\n                    style={{ cursor: 'pointer' }}\r\n                    onClick={() => handleRowClick(location)}\r\n                  >\r\n                    <TableCell>{location.buildingTitle}</TableCell>\r\n                    <TableCell>{location.streetAddress}</TableCell>\r\n                    <TableCell>{location.city}</TableCell>\r\n                    <TableCell>{location.county}</TableCell>\r\n                    <TableCell>{location.state}</TableCell>\r\n                    <TableCell>{location.distanceToCoast} miles</TableCell>\r\n                    <TableCell>{utils.number.formatNumber(location.totalInsurableValue)}</TableCell>\r\n                    <TableCell>\r\n                      <LocationTooltip\r\n                        location={location}\r\n                        locationDefinitions={locationDefinitions}\r\n                        excludeColumns={columns}\r\n                        handleOpen={handleOpenTooltip}\r\n                        disabled={isTooltipOpen}\r\n                      />\r\n                    </TableCell>\r\n                  </TableRow>\r\n                );\r\n              })}\r\n            </TableBody>\r\n          </Table>\r\n          <Pagination\r\n            page={pagination.page}\r\n            count={pagination.count}\r\n            rowsPerPage={pagination.rowsPerPage}\r\n            rowsPerPageOptions={pagination.rowsPerPageOptions}\r\n            onChangePage={handleChangePage}\r\n            onChangeRowsPerPage={handleChangeRowsPerPage}\r\n          />\r\n        </Overflow>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default RiskMap;\r\n"]},"metadata":{},"sourceType":"module"}