{"ast":null,"code":"import _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\DmsAttachDocuments\\\\DmsAttachDocuments.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport PropTypes from 'prop-types'; // app\n\nimport { DmsAttachDocumentsView } from './DmsAttachDocuments.view';\nimport { showModal, addLoader, selectContextSubType, selectDmsClientSideUploadFiles } from 'stores';\nimport * as utils from 'utils';\nimport * as constants from 'consts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nDmsAttachDocuments.propTypes = {\n  referenceId: PropTypes.string,\n  sourceId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  documentTypeKey: PropTypes.string\n};\nexport default function DmsAttachDocuments(_ref) {\n  _s();\n\n  var referenceId = _ref.referenceId,\n      sourceId = _ref.sourceId,\n      documentTypeKey = _ref.documentTypeKey;\n  var dispatch = useDispatch();\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      resetKey = _useState4[0],\n      setResetKey = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      searchIndex = _useState6[0],\n      setSearchIndex = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      filteredTableData = _useState8[0],\n      setFilteredTableData = _useState8[1];\n\n  var contextSubType = useSelector(selectContextSubType);\n  var clientUploadedFiles = useSelector(selectDmsClientSideUploadFiles);\n  var documentList = clientUploadedFiles === null || clientUploadedFiles === void 0 ? void 0 : clientUploadedFiles.documentTableList;\n\n  var launchDmsUpload = function launchDmsUpload() {\n    return function (files) {\n      dispatch(addLoader('DmsUploadFiles'));\n      var refinedReferenceId = getRefIdForContext();\n      dispatch(showModal({\n        component: 'DMS_UPLOAD_FILES',\n        props: {\n          fullWidth: true,\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\n          hideCompOnBlur: false,\n          maxWidth: 'lg',\n          componentProps: {\n            files: files,\n            context: constants.DMS_CONTEXT_TASK,\n            referenceId: refinedReferenceId,\n            sourceId: sourceId,\n            documentTypeKey: documentTypeKey,\n            confirmLabel: utils.string.t('app.ok'),\n            cancelLabel: utils.string.t('app.goBack'),\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\n            buttonColors: {\n              confirm: 'secondary',\n              cancel: 'primary'\n            },\n            isClientSideUpload: true\n          }\n        }\n      }));\n    };\n  };\n\n  var getRefIdForContext = function getRefIdForContext() {\n    var type = contextSubType.type,\n        caseIncidentNotesID = contextSubType.caseIncidentNotesID,\n        refId = contextSubType.refId;\n\n    if (type === constants.DMS_TASK_CONTEXT_TYPE_RFI_RESPONSE) {\n      return caseIncidentNotesID ? \"\".concat(refId, \"-\").concat(caseIncidentNotesID) : refId;\n    } else if (type === constants.DMS_TASK_CONTEXT_TYPE_RFI || type === constants.DMS_TASK_CONTEXT_TYPE_ADHOC) {\n      return refId;\n    } else {\n      return referenceId;\n    }\n  };\n\n  var resetSearch = function resetSearch() {\n    setResetKey(new Date().getTime());\n    setSearch('');\n  };\n\n  var submitSearch = function submitSearch(query) {\n    setSearch(query);\n  };\n\n  useEffect(function () {\n    var getTableValues = function getTableValues(document) {\n      return Object.values(document);\n    };\n\n    var searchInd = documentList === null || documentList === void 0 ? void 0 : documentList.map(function (document) {\n      var allValues = getTableValues(document);\n      return {\n        allValues: allValues.toString()\n      };\n    });\n    setSearchIndex(searchInd);\n  }, [documentList]);\n  useEffect(function () {\n    if (search) {\n      applySearch(searchIndex);\n    } else {\n      setFilteredTableData(documentList);\n    }\n  }, [search, documentList]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var applySearch = function applySearch(searchInd) {\n    var newFilteredData = searchInd === null || searchInd === void 0 ? void 0 : searchInd.map(function (data, index) {\n      var _data$allValues;\n\n      if ((data === null || data === void 0 ? void 0 : (_data$allValues = data.allValues) === null || _data$allValues === void 0 ? void 0 : _data$allValues.toLowerCase().indexOf(search === null || search === void 0 ? void 0 : search.toLowerCase())) >= 0) {\n        return documentList[index];\n      }\n\n      return null;\n    });\n    var filteredList = newFilteredData === null || newFilteredData === void 0 ? void 0 : newFilteredData.filter(function (data) {\n      return data ? true : false;\n    });\n    setFilteredTableData(filteredList);\n  };\n\n  return /*#__PURE__*/_jsxDEV(DmsAttachDocumentsView, {\n    search: search,\n    resetKey: resetKey,\n    documentList: filteredTableData,\n    handlers: {\n      uploadModal: launchDmsUpload,\n      resetSearch: resetSearch,\n      submitSearch: submitSearch\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n}\n\n_s(DmsAttachDocuments, \"sRn6kngSzN7X6sbwYXev2za6eAs=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n\n_c = DmsAttachDocuments;\n\nvar _c;\n\n$RefreshReg$(_c, \"DmsAttachDocuments\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/DmsAttachDocuments/DmsAttachDocuments.js"],"names":["useState","useEffect","useDispatch","useSelector","PropTypes","DmsAttachDocumentsView","showModal","addLoader","selectContextSubType","selectDmsClientSideUploadFiles","utils","constants","DmsAttachDocuments","propTypes","referenceId","string","sourceId","oneOfType","number","documentTypeKey","dispatch","search","setSearch","resetKey","setResetKey","searchIndex","setSearchIndex","filteredTableData","setFilteredTableData","contextSubType","clientUploadedFiles","documentList","documentTableList","launchDmsUpload","files","refinedReferenceId","getRefIdForContext","component","props","fullWidth","title","t","hideCompOnBlur","maxWidth","componentProps","context","DMS_CONTEXT_TASK","confirmLabel","cancelLabel","confirmMessage","buttonColors","confirm","cancel","isClientSideUpload","type","caseIncidentNotesID","refId","DMS_TASK_CONTEXT_TYPE_RFI_RESPONSE","DMS_TASK_CONTEXT_TYPE_RFI","DMS_TASK_CONTEXT_TYPE_ADHOC","resetSearch","Date","getTime","submitSearch","query","getTableValues","document","Object","values","searchInd","map","allValues","toString","applySearch","newFilteredData","data","index","toLowerCase","indexOf","filteredList","filter","uploadModal"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\n\r\n// app\r\nimport { DmsAttachDocumentsView } from './DmsAttachDocuments.view';\r\nimport { showModal, addLoader, selectContextSubType, selectDmsClientSideUploadFiles } from 'stores';\r\nimport * as utils from 'utils';\r\nimport * as constants from 'consts';\r\n\r\nDmsAttachDocuments.propTypes = {\r\n  referenceId: PropTypes.string,\r\n  sourceId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n  documentTypeKey: PropTypes.string,\r\n};\r\n\r\nexport default function DmsAttachDocuments({ referenceId, sourceId, documentTypeKey }) {\r\n  const dispatch = useDispatch();\r\n  const [search, setSearch] = useState('');\r\n  const [resetKey, setResetKey] = useState();\r\n  const [searchIndex, setSearchIndex] = useState([]);\r\n  const [filteredTableData, setFilteredTableData] = useState([]);\r\n\r\n  const contextSubType = useSelector(selectContextSubType);\r\n  const clientUploadedFiles = useSelector(selectDmsClientSideUploadFiles);\r\n  const documentList = clientUploadedFiles?.documentTableList;\r\n\r\n  const launchDmsUpload = () => (files) => {\r\n    dispatch(addLoader('DmsUploadFiles'));\r\n    const refinedReferenceId = getRefIdForContext();\r\n\r\n    dispatch(\r\n      showModal({\r\n        component: 'DMS_UPLOAD_FILES',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\r\n          hideCompOnBlur: false,\r\n          maxWidth: 'lg',\r\n          componentProps: {\r\n            files,\r\n            context: constants.DMS_CONTEXT_TASK,\r\n            referenceId: refinedReferenceId,\r\n            sourceId,\r\n            documentTypeKey,\r\n            confirmLabel: utils.string.t('app.ok'),\r\n            cancelLabel: utils.string.t('app.goBack'),\r\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n            isClientSideUpload: true,\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const getRefIdForContext = () => {\r\n    const { type, caseIncidentNotesID, refId } = contextSubType;\r\n    if (type === constants.DMS_TASK_CONTEXT_TYPE_RFI_RESPONSE) {\r\n      return caseIncidentNotesID ? `${refId}-${caseIncidentNotesID}` : refId;\r\n    } else if (type === constants.DMS_TASK_CONTEXT_TYPE_RFI || type === constants.DMS_TASK_CONTEXT_TYPE_ADHOC) {\r\n      return refId;\r\n    } else {\r\n      return referenceId;\r\n    }\r\n  };\r\n\r\n  const resetSearch = () => {\r\n    setResetKey(new Date().getTime());\r\n    setSearch('');\r\n  };\r\n\r\n  const submitSearch = (query) => {\r\n    setSearch(query);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const getTableValues = (document) => {\r\n      return Object.values(document);\r\n    };\r\n\r\n    const searchInd = documentList?.map((document) => {\r\n      const allValues = getTableValues(document);\r\n      return { allValues: allValues.toString() };\r\n    });\r\n    setSearchIndex(searchInd);\r\n  }, [documentList]);\r\n\r\n  useEffect(() => {\r\n    if (search) {\r\n      applySearch(searchIndex);\r\n    } else {\r\n      setFilteredTableData(documentList);\r\n    }\r\n  }, [search, documentList]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const applySearch = (searchInd) => {\r\n    const newFilteredData = searchInd?.map((data, index) => {\r\n      if (data?.allValues?.toLowerCase().indexOf(search?.toLowerCase()) >= 0) {\r\n        return documentList[index];\r\n      }\r\n      return null;\r\n    });\r\n    const filteredList = newFilteredData?.filter((data) => {\r\n      return data ? true : false;\r\n    });\r\n    setFilteredTableData(filteredList);\r\n  };\r\n\r\n  return (\r\n    <DmsAttachDocumentsView\r\n      search={search}\r\n      resetKey={resetKey}\r\n      documentList={filteredTableData}\r\n      handlers={{\r\n        uploadModal: launchDmsUpload,\r\n        resetSearch: resetSearch,\r\n        submitSearch: submitSearch,\r\n      }}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}