{"ast":null,"code":"import _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ProcessingInstructionsDetails\\\\ProcessingInstructionsDetails.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport moment from 'moment';\nimport get from 'lodash/get';\nimport isNumber from 'lodash/isNumber';\nimport uniqBy from 'lodash/uniqBy'; // app\n\nimport ProcessingInstructionsDetailsView from './ProcessingInstructionsDetails.view';\nimport { selectUser, showModal, updateProcessingInstruction, removePremiumTaxSignedLinesDocument, storeRetainedBrokerageAmountForPdf, storeTotalAmountForPdf, addLoader, storeProcessingInstructionDocuments, viewDocumentsDownload, enqueueNotification, selectRefDataThirdPartyList } from 'stores';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport config from 'config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nProcessingInstructionsDetails.propTypes = {\n  instruction: PropTypes.object.isRequired,\n  handlers: PropTypes.shape({\n    back: PropTypes.func.isRequired,\n    next: PropTypes.func.isRequired\n  }).isRequired,\n  childRef: PropTypes.object.isRequired\n};\nexport default function ProcessingInstructionsDetails(_ref) {\n  _s();\n\n  var _uniqBy, _uniqBy$map, _instruction$riskRefe, _uniqBy2, _instruction$details, _instruction$details2, _utils$processingInst, _utils$processingInst2, _utils$processingInst3, _utils$processingInst4, _utils$processingInst5, _utils$processingInst6, _utils$processingInst7, _utils$processingInst8, _utils$processingInst9, _utils$processingInst10, _utils$processingInst11, _utils$processingInst12, _utils$processingInst13, _utils$processingInst14, _utils$processingInst15, _utils$processingInst16, _utils$processingInst17, _utils$processingInst18, _utils$processingInst19, _utils$processingInst20, _utils$processingInst21, _utils$processingInst22, _utils$processingInst23, _utils$processingInst24, _utils$processingInst25, _utils$processingInst26, _utils$processingInst27, _utils$processingInst28, _utils$processingInst29, _utils$processingInst30, _validateWarrantyList, _utils$processingInst31, _validateWarrantyList2, _validateWarrantyList3, _validateWarrantyList4, _utils$processingInst32, _utils$processingInst33, _utils$processingInst34, _instruction$details3, _childRef$current, _childRef$current$pro;\n\n  var instruction = _ref.instruction,\n      handlers = _ref.handlers,\n      childRef = _ref.childRef,\n      checkListMandatoryDataStatus = _ref.checkListMandatoryDataStatus;\n  var dispatch = useDispatch();\n  var user = useSelector(selectUser);\n  var documents = useSelector(function (state) {\n    return get(state, 'processingInstructions.documents');\n  }) || {};\n  var refDataCurrencies = useSelector(function (state) {\n    return get(state, 'referenceData.currencyCodes');\n  }) || [];\n  var optionsDepartments = useSelector(function (state) {\n    return state.processingInstructions.departmentList;\n  }) || [];\n  var departments = utils.generic.isValidArray(optionsDepartments, true) ? (_uniqBy = uniqBy(optionsDepartments, 'deptName')) === null || _uniqBy === void 0 ? void 0 : (_uniqBy$map = _uniqBy.map(function (d) {\n    return {\n      id: d.id,\n      deptName: d.deptName\n    };\n  })) === null || _uniqBy$map === void 0 ? void 0 : _uniqBy$map.sort(function (a, b) {\n    return a.deptName > b.deptName ? 1 : b.deptName > a.deptName ? -1 : 0;\n  }) : [];\n  var warrantyTypes = useSelector(function (state) {\n    return get(state, 'referenceData.warrantyTypes');\n  }) || [];\n  var optionsThirdParty = useSelector(selectRefDataThirdPartyList) || [];\n  var isDraft = utils.processingInstructions.status.isDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isReopened = utils.processingInstructions.status.isReopened(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\n  var userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\n  var isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\n  var isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\n  var isReadOnly = !isEditable;\n  var selectedRiskRef = instruction === null || instruction === void 0 ? void 0 : (_instruction$riskRefe = instruction.riskReferences) === null || _instruction$riskRefe === void 0 ? void 0 : _instruction$riskRefe.find(function (r) {\n    return r.leadPolicy;\n  });\n  var warrantyListOptions = utils.generic.isValidArray(warrantyTypes, true) ? (_uniqBy2 = uniqBy(warrantyTypes, 'code')) === null || _uniqBy2 === void 0 ? void 0 : _uniqBy2.sort(function (a, b) {\n    return a.code > b.code ? 1 : b.code > a.code ? -1 : 0;\n  }) : [];\n  warrantyListOptions = [].concat(_toConsumableArray(warrantyListOptions), [{\n    code: 'NA',\n    warrantyName: 'NA'\n  }]);\n  var paymentBasisOptions = [{\n    id: '1',\n    code: 'cash',\n    name: 'Cash'\n  }, {\n    id: '2',\n    code: 'quaterly',\n    name: 'Quaterly'\n  }, {\n    id: '3',\n    code: 'otherDeferred',\n    name: 'Other Deferred'\n  }];\n  var toggleOptions = [{\n    label: utils.string.t('app.yes'),\n    value: 1\n  }, {\n    label: utils.string.t('app.no'),\n    value: 0\n  }, {\n    label: utils.string.t('app.na'),\n    value: -1\n  }];\n\n  var getToggleValue = function getToggleValue(value) {\n    return toggleOptions.map(function (o) {\n      return o.value;\n    }).includes(value) ? value : null;\n  };\n\n  var selectedThirdParty = function selectedThirdParty() {\n    var _instruction$financia, _instruction$financia2, _optionsThirdParty$fi;\n\n    var thirdvalue = utils.generic.isValidArray(instruction === null || instruction === void 0 ? void 0 : instruction.financialChecklist, true) ? (_instruction$financia = instruction.financialChecklist) === null || _instruction$financia === void 0 ? void 0 : (_instruction$financia2 = _instruction$financia.find(function (a) {\n      return a.name === 'thirdParty';\n    })) === null || _instruction$financia2 === void 0 ? void 0 : _instruction$financia2.stringValue : null;\n    return utils.generic.isValidArray(optionsThirdParty, true) && thirdvalue ? ((_optionsThirdParty$fi = optionsThirdParty.find(function (value) {\n      return (value === null || value === void 0 ? void 0 : value.partnerName) === thirdvalue;\n    })) === null || _optionsThirdParty$fi === void 0 ? void 0 : _optionsThirdParty$fi.id) || null : null;\n  };\n\n  var validateWarrantyListValue = function validateWarrantyListValue() {\n    var _instruction$financia3, _instruction$financia4;\n\n    var isFinancialListAvailable = utils.generic.isValidArray(instruction === null || instruction === void 0 ? void 0 : instruction.financialChecklist, true) ? (instruction === null || instruction === void 0 ? void 0 : (_instruction$financia3 = instruction.financialChecklist) === null || _instruction$financia3 === void 0 ? void 0 : (_instruction$financia4 = _instruction$financia3.find(function (a) {\n      return a.name === 'ppwOrPpc';\n    })) === null || _instruction$financia4 === void 0 ? void 0 : _instruction$financia4.stringValue) ? true : false : false;\n\n    if (!isFinancialListAvailable) {\n      var _selectedRiskRef$warr, _selectedRiskRef$warr2, _selectedRiskRef$warr3, _selectedRiskRef$warr4, _selectedRiskRef$warr5;\n\n      if ((selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : (_selectedRiskRef$warr = selectedRiskRef.warrantyDetails) === null || _selectedRiskRef$warr === void 0 ? void 0 : _selectedRiskRef$warr.isInvalidData) === 0 && utils.generic.isValidArray(selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : (_selectedRiskRef$warr2 = selectedRiskRef.warrantyDetails) === null || _selectedRiskRef$warr2 === void 0 ? void 0 : _selectedRiskRef$warr2.warrantyList, true)) {\n        return selectedRiskRef.warrantyDetails.warrantyList.find(function (a) {\n          return a.isSelected;\n        }) || null;\n      } else if (((selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : (_selectedRiskRef$warr3 = selectedRiskRef.warrantyDetails) === null || _selectedRiskRef$warr3 === void 0 ? void 0 : _selectedRiskRef$warr3.isInvalidData) === 0 || (selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : (_selectedRiskRef$warr4 = selectedRiskRef.warrantyDetails) === null || _selectedRiskRef$warr4 === void 0 ? void 0 : _selectedRiskRef$warr4.isInvalidData) === 1) && !utils.generic.isValidArray(selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : (_selectedRiskRef$warr5 = selectedRiskRef.warrantyDetails) === null || _selectedRiskRef$warr5 === void 0 ? void 0 : _selectedRiskRef$warr5.warrantyList, true)) {\n        var _selectedRiskRef$warr6;\n\n        return {\n          warrantyCode: 'NA',\n          warrantyDate: null,\n          displayError: (selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : (_selectedRiskRef$warr6 = selectedRiskRef.warrantyDetails) === null || _selectedRiskRef$warr6 === void 0 ? void 0 : _selectedRiskRef$warr6.isInvalidData) === 1\n        };\n      }\n    }\n\n    return null;\n  };\n\n  var fields = [{\n    name: 'highPriority',\n    type: 'checkbox',\n    value: instruction === null || instruction === void 0 ? void 0 : (_instruction$details = instruction.details) === null || _instruction$details === void 0 ? void 0 : _instruction$details.highPriority,\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'frontEndSendDocs',\n    type: 'checkbox',\n    value: instruction === null || instruction === void 0 ? void 0 : (_instruction$details2 = instruction.details) === null || _instruction$details2 === void 0 ? void 0 : _instruction$details2.frontEndSendDocs,\n    label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'premiumTaxCalculationSheetAttachedNumber',\n    type: 'toggle',\n    value: getToggleValue((_utils$processingInst = utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')) === null || _utils$processingInst === void 0 ? void 0 : _utils$processingInst.numberValue),\n    options: toggleOptions,\n    buttonGroupProps: {\n      exclusive: true,\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'premiumTaxCalculationSheetAttachedCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst2 = utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')) === null || _utils$processingInst2 === void 0 ? void 0 : _utils$processingInst2.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'signedLinesCalculationSheetAttachedNumber',\n    type: 'toggle',\n    value: getToggleValue((_utils$processingInst3 = utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')) === null || _utils$processingInst3 === void 0 ? void 0 : _utils$processingInst3.numberValue),\n    options: toggleOptions,\n    buttonGroupProps: {\n      exclusive: true,\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'signedLinesCalculationSheetAttachedCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst4 = utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')) === null || _utils$processingInst4 === void 0 ? void 0 : _utils$processingInst4.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'grossPremiumAmountNumber',\n    type: 'number',\n    value: ((_utils$processingInst5 = utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')) === null || _utils$processingInst5 === void 0 ? void 0 : _utils$processingInst5.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'grossPremiumAmountCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst6 = utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')) === null || _utils$processingInst6 === void 0 ? void 0 : _utils$processingInst6.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'slipOrderNumber',\n    type: 'number',\n    value: ((_utils$processingInst7 = utils.processingInstructions.getFinancialField(instruction, 'slipOrder')) === null || _utils$processingInst7 === void 0 ? void 0 : _utils$processingInst7.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'slipOrderCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst8 = utils.processingInstructions.getFinancialField(instruction, 'slipOrder')) === null || _utils$processingInst8 === void 0 ? void 0 : _utils$processingInst8.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'totalBrokerageNumber',\n    type: 'number',\n    value: ((_utils$processingInst9 = utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')) === null || _utils$processingInst9 === void 0 ? void 0 : _utils$processingInst9.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'totalBrokerageCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst10 = utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')) === null || _utils$processingInst10 === void 0 ? void 0 : _utils$processingInst10.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'clientDiscountNumber',\n    type: 'number',\n    value: ((_utils$processingInst11 = utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')) === null || _utils$processingInst11 === void 0 ? void 0 : _utils$processingInst11.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'clientDiscountCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst12 = utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')) === null || _utils$processingInst12 === void 0 ? void 0 : _utils$processingInst12.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'thirdPartyNumber',\n    type: 'number',\n    value: ((_utils$processingInst13 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst13 === void 0 ? void 0 : _utils$processingInst13.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'thirdPartyString',\n    type: 'select',\n    value: selectedThirdParty() || ((_utils$processingInst14 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst14 === void 0 ? void 0 : _utils$processingInst14.stringValue) || '',\n    options: (optionsThirdParty === null || optionsThirdParty === void 0 ? void 0 : optionsThirdParty.map(function (option) {\n      return {\n        value: option === null || option === void 0 ? void 0 : option.id,\n        label: option === null || option === void 0 ? void 0 : option.partnerName\n      };\n    })) || [],\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'thirdPartyCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst15 = utils.processingInstructions.getFinancialField(instruction, 'thirdParty')) === null || _utils$processingInst15 === void 0 ? void 0 : _utils$processingInst15.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'pfinternalNumber',\n    type: 'number',\n    value: ((_utils$processingInst16 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst16 === void 0 ? void 0 : _utils$processingInst16.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'pfinternalString',\n    type: 'select',\n    value: ((_utils$processingInst17 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst17 === void 0 ? void 0 : _utils$processingInst17.stringValue) || '',\n    options: departments,\n    optionKey: 'id',\n    optionLabel: 'deptName',\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'pfinternalCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst18 = utils.processingInstructions.getFinancialField(instruction, 'pfinternal')) === null || _utils$processingInst18 === void 0 ? void 0 : _utils$processingInst18.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'retainedBrokerageNumber',\n    type: 'number',\n    value: ((_utils$processingInst19 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')) === null || _utils$processingInst19 === void 0 ? void 0 : _utils$processingInst19.numberValue) || '',\n    muiComponentProps: {\n      autoComplete: 'off',\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'retainedBrokerageCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst20 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')) === null || _utils$processingInst20 === void 0 ? void 0 : _utils$processingInst20.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'retainedBrokerageCurrencyCodeString',\n    value: ((_utils$processingInst21 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')) === null || _utils$processingInst21 === void 0 ? void 0 : _utils$processingInst21.stringValue) || constants.CURRENCY_USD,\n    optionsKey: 'premiumCurrency',\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'retainedBrokerageCurrencyCodeCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst22 = utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')) === null || _utils$processingInst22 === void 0 ? void 0 : _utils$processingInst22.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'feesNumber',\n    type: 'number',\n    value: ((_utils$processingInst23 = utils.processingInstructions.getFinancialField(instruction, 'fees')) === null || _utils$processingInst23 === void 0 ? void 0 : _utils$processingInst23.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'feesCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst24 = utils.processingInstructions.getFinancialField(instruction, 'fees')) === null || _utils$processingInst24 === void 0 ? void 0 : _utils$processingInst24.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'otherDeductionsNumber',\n    type: 'number',\n    value: ((_utils$processingInst25 = utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')) === null || _utils$processingInst25 === void 0 ? void 0 : _utils$processingInst25.numberValue) || '',\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'otherDeductionsCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst26 = utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')) === null || _utils$processingInst26 === void 0 ? void 0 : _utils$processingInst26.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'settlementCurrencyCodeIdNumber',\n    type: 'select',\n    value: ((_utils$processingInst27 = utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')) === null || _utils$processingInst27 === void 0 ? void 0 : _utils$processingInst27.numberValue) || '',\n    options: refDataCurrencies,\n    optionKey: 'currencyCodeID',\n    optionLabel: 'currencyCd',\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'settlementCurrencyCodeIdCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst28 = utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')) === null || _utils$processingInst28 === void 0 ? void 0 : _utils$processingInst28.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'paymentBasisNumber',\n    type: 'select',\n    value: ((_utils$processingInst29 = utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')) === null || _utils$processingInst29 === void 0 ? void 0 : _utils$processingInst29.numberValue) || '',\n    options: paymentBasisOptions,\n    optionKey: 'id',\n    optionLabel: 'name',\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'paymentBasisCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst30 = utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')) === null || _utils$processingInst30 === void 0 ? void 0 : _utils$processingInst30.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'ppwOrPpcString',\n    type: 'select',\n    value: ((_validateWarrantyList = validateWarrantyListValue()) === null || _validateWarrantyList === void 0 ? void 0 : _validateWarrantyList.warrantyCode) || ((_utils$processingInst31 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst31 === void 0 ? void 0 : _utils$processingInst31.stringValue) || '',\n    options: warrantyListOptions,\n    optionKey: 'code',\n    optionLabel: 'warrantyName',\n    displayError: ((_validateWarrantyList2 = validateWarrantyListValue()) === null || _validateWarrantyList2 === void 0 ? void 0 : _validateWarrantyList2.displayError) || false,\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }, {\n    name: 'ppwOrPpcDate',\n    type: 'datepicker',\n    value: ((_validateWarrantyList3 = validateWarrantyListValue()) === null || _validateWarrantyList3 === void 0 ? void 0 : _validateWarrantyList3.warrantyDate) ? moment((_validateWarrantyList4 = validateWarrantyListValue()) === null || _validateWarrantyList4 === void 0 ? void 0 : _validateWarrantyList4.warrantyDate) : null || ((_utils$processingInst32 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst32 === void 0 ? void 0 : _utils$processingInst32.dateValue) ? moment((_utils$processingInst33 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst33 === void 0 ? void 0 : _utils$processingInst33.dateValue) : null,\n    outputFormat: 'iso',\n    placeholder: utils.string.t('app.selectDate'),\n    muiComponentProps: {\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    },\n    muiPickerProps: {\n      format: config.ui.format.date.text,\n      clearable: true\n    }\n  }, {\n    name: 'ppwOrPpcCheckbox',\n    type: 'checkbox',\n    value: (_utils$processingInst34 = utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')) === null || _utils$processingInst34 === void 0 ? void 0 : _utils$processingInst34.approvedByAuthorisedSignatory,\n    disabled: !isCheckboxesEditable || checkListMandatoryDataStatus\n  }, {\n    name: 'notes',\n    label: utils.string.t('processingInstructions.details.notes'),\n    type: 'textarea',\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details3 = instruction.details) === null || _instruction$details3 === void 0 ? void 0 : _instruction$details3.notes) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 4000\n      },\n      multiline: true,\n      minRows: 4,\n      maxRows: 8,\n      disabled: isReadOnly || checkListMandatoryDataStatus\n    }\n  }];\n  var retainedBrokerageCurrencyCodeField = utils.form.getFieldProps(fields, 'retainedBrokerageCurrencyCodeString');\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      defaultValues = _useState2[0],\n      setDefaultValues = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      retainedBrokerageAmount = _useState4[0],\n      setRetainedBrokerageAmount = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      convertedBrokerage = _useState6[0],\n      setConvertedBrokerage = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      totalAmount = _useState8[0],\n      setTotalAmount = _useState8[1];\n\n  var _useState9 = useState({\n    premiumTaxDocument: false,\n    signedLinesDocument: false\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      documentNotUploadedError = _useState10[0],\n      setDocumentNotUploadedError = _useState10[1];\n\n  var formValues = childRef === null || childRef === void 0 ? void 0 : (_childRef$current = childRef.current) === null || _childRef$current === void 0 ? void 0 : (_childRef$current$pro = _childRef$current.props) === null || _childRef$current$pro === void 0 ? void 0 : _childRef$current$pro.values;\n  var retainedBrokerageCurrencyCode = (formValues === null || formValues === void 0 ? void 0 : formValues.retainedBrokerageCurrencyCodeString) || (retainedBrokerageCurrencyCodeField === null || retainedBrokerageCurrencyCodeField === void 0 ? void 0 : retainedBrokerageCurrencyCodeField.defaultValue) || (retainedBrokerageCurrencyCodeField === null || retainedBrokerageCurrencyCodeField === void 0 ? void 0 : retainedBrokerageCurrencyCodeField.value);\n\n  var getRetainedBrokerageAmount = function getRetainedBrokerageAmount(_ref2) {\n    var grossPremiumAmount = _ref2.grossPremiumAmount,\n        slipOrder = _ref2.slipOrder,\n        retainedBrokerage = _ref2.retainedBrokerage,\n        retainedBrokerageCurrencyCode = _ref2.retainedBrokerageCurrencyCode,\n        retainedBrokerageAmount = _ref2.retainedBrokerageAmount;\n    var amount = utils.processingInstructions.getRetainedBrokerageValue(grossPremiumAmount, slipOrder, retainedBrokerage);\n    var brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(retainedBrokerageCurrencyCode, retainedBrokerageAmount);\n    setRetainedBrokerageAmount(amount);\n    setConvertedBrokerage(brokerage);\n    dispatch(storeRetainedBrokerageAmountForPdf({\n      retBrokerageAmt: amount,\n      convertedBrokerageAmt: brokerage\n    }));\n  };\n\n  var getTotalAmount = function getTotalAmount(_ref3) {\n    var clientDiscount = _ref3.clientDiscount,\n        thirdPartyCommissionSharing = _ref3.thirdPartyCommissionSharing,\n        pfinternalCommissionSharing = _ref3.pfinternalCommissionSharing,\n        retainedBrokerage = _ref3.retainedBrokerage;\n\n    if (clientDiscount && thirdPartyCommissionSharing && pfinternalCommissionSharing && retainedBrokerage) {\n      var sumValuesArray = [clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage];\n      setTotalAmount(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal));\n      dispatch(storeTotalAmountForPdf(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal)));\n    } else {\n      setTotalAmount('');\n    }\n  };\n\n  var checkPremiumTaxDocumentAndSignedLinesDocument = function checkPremiumTaxDocumentAndSignedLinesDocument() {\n    var _childRef$current2, _childRef$current2$pr;\n\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current2 = childRef.current) === null || _childRef$current2 === void 0 ? void 0 : (_childRef$current2$pr = _childRef$current2.props) === null || _childRef$current2$pr === void 0 ? void 0 : _childRef$current2$pr.values) || {};\n\n    if (formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument || formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument) {\n      if (formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument && formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument) {\n        dispatch(enqueueNotification('processingInstructions.details.missingPremiumTaxAndSignedLines', 'warning'));\n      } else if (formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument) {\n        dispatch(enqueueNotification('processingInstructions.details.missingPremiumTaxCalculationSheet', 'warning'));\n      } else if (formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument) {\n        dispatch(enqueueNotification('processingInstructions.details.missingSignedLinesCalculation', 'warning'));\n      }\n\n      setDocumentNotUploadedError({\n        premiumTaxDocument: formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocumen,\n        signedLinesDocument: formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument\n      });\n      return true;\n    }\n\n    setDocumentNotUploadedError({\n      premiumTaxDocument: false,\n      signedLinesDocument: false\n    });\n    return false;\n  };\n\n  var handleNext = function handleNext() {\n    if (checkPremiumTaxDocumentAndSignedLinesDocument()) {\n      return;\n    }\n\n    handlers.next();\n  };\n\n  var handleSave = function handleSave(type) {\n    var _childRef$current3, _childRef$current3$pr, _selectedRiskRef$warr7, _defaultWarrantyDetai, _defaultWarrantyDetai2, _defaultWarrantyDetai3, _defaultWarrantyDetai4, _defaultWarrantyDetai5, _defaultWarrantyDetai6, _defaultWarrantyDetai7;\n\n    if (type === constants.SAVE_NEXT && checkPremiumTaxDocumentAndSignedLinesDocument()) {\n      return;\n    }\n\n    setDocumentNotUploadedError({\n      premiumTaxDocument: false,\n      signedLinesDocument: false\n    });\n    var formValues = (childRef === null || childRef === void 0 ? void 0 : (_childRef$current3 = childRef.current) === null || _childRef$current3 === void 0 ? void 0 : (_childRef$current3$pr = _childRef$current3.props) === null || _childRef$current3$pr === void 0 ? void 0 : _childRef$current3$pr.values) || {};\n    var financialChecklistBlank = [{\n      name: 'signedLinesCalculationSheetAttached',\n      types: ['Number']\n    }, {\n      name: 'premiumTaxCalculationSheetAttached',\n      types: ['Number']\n    }, {\n      name: 'grossPremiumAmount',\n      types: ['Number']\n    }, {\n      name: 'slipOrder',\n      types: ['Number']\n    }, {\n      name: 'totalBrokerage',\n      types: ['Number']\n    }, {\n      name: 'fees',\n      types: ['Number']\n    }, {\n      name: 'otherDeductions',\n      types: ['Number']\n    }, {\n      name: 'settlementCurrencyCodeId',\n      types: ['Number']\n    }, {\n      name: 'paymentBasis',\n      types: ['Number']\n    }, {\n      name: 'ppwOrPpc',\n      types: ['String', 'Date']\n    }, {\n      name: 'clientDiscount',\n      types: ['Number']\n    }, {\n      name: 'thirdParty',\n      types: ['Number', 'String']\n    }, {\n      name: 'pfinternal',\n      types: ['Number', 'String']\n    }, {\n      name: 'retainedBrokerage',\n      types: ['Number']\n    }, {\n      name: 'retainedBrokerageCurrencyCode',\n      types: ['String']\n    }];\n    var defaultWarrantyDetails = utils.generic.isValidArray(selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : (_selectedRiskRef$warr7 = selectedRiskRef.warrantyDetails) === null || _selectedRiskRef$warr7 === void 0 ? void 0 : _selectedRiskRef$warr7.warrantyList, true) ? isNumber(formValues['ppwOrPpcString']) ? selectedRiskRef.warrantyDetails.warrantyList.find(function (a) {\n      return a.warrantyTypeId === formValues['ppwOrPpcString'];\n    }) : selectedRiskRef.warrantyDetails.warrantyList.find(function (a) {\n      var _a$warrantyCode, _formValues$ppwOrPpcS;\n\n      return ((_a$warrantyCode = a.warrantyCode) === null || _a$warrantyCode === void 0 ? void 0 : _a$warrantyCode.toLowerCase()) === ((_formValues$ppwOrPpcS = formValues['ppwOrPpcString']) === null || _formValues$ppwOrPpcS === void 0 ? void 0 : _formValues$ppwOrPpcS.toLowerCase());\n    }) : null;\n\n    if (!defaultWarrantyDetails) {\n      defaultWarrantyDetails = utils.generic.isValidArray(warrantyListOptions, true) ? warrantyListOptions.find(function (a) {\n        var _a$code, _formValues$ppwOrPpcS2;\n\n        return ((_a$code = a.code) === null || _a$code === void 0 ? void 0 : _a$code.toLowerCase()) === ((_formValues$ppwOrPpcS2 = formValues['ppwOrPpcString']) === null || _formValues$ppwOrPpcS2 === void 0 ? void 0 : _formValues$ppwOrPpcS2.toLowerCase());\n      }) : null;\n    }\n\n    var updatedInstruction = _objectSpread(_objectSpread({}, instruction), {}, {\n      details: _objectSpread(_objectSpread({}, instruction.details), {}, {\n        highPriority: formValues.highPriority,\n        frontEndSendDocs: formValues.frontEndSendDocs,\n        notes: formValues.notes,\n        retainedBrokerageCurrencyCode: retainedBrokerageCurrencyCode,\n        warrantyDescription: ((_defaultWarrantyDetai = defaultWarrantyDetails) === null || _defaultWarrantyDetai === void 0 ? void 0 : _defaultWarrantyDetai.warrantyName) || ((_defaultWarrantyDetai2 = defaultWarrantyDetails) === null || _defaultWarrantyDetai2 === void 0 ? void 0 : _defaultWarrantyDetai2.warrantyDescription) || '',\n        warrantyTypeId: ((_defaultWarrantyDetai3 = defaultWarrantyDetails) === null || _defaultWarrantyDetai3 === void 0 ? void 0 : _defaultWarrantyDetai3.warrantyTypeId) || ((_defaultWarrantyDetai4 = defaultWarrantyDetails) === null || _defaultWarrantyDetai4 === void 0 ? void 0 : _defaultWarrantyDetai4.warrantyTypeID) || '',\n        warrantyDate: ((_defaultWarrantyDetai5 = defaultWarrantyDetails) === null || _defaultWarrantyDetai5 === void 0 ? void 0 : _defaultWarrantyDetai5.warrantyDate) || '',\n        warrantyCode: ((_defaultWarrantyDetai6 = defaultWarrantyDetails) === null || _defaultWarrantyDetai6 === void 0 ? void 0 : _defaultWarrantyDetai6.warrantyCode) || ((_defaultWarrantyDetai7 = defaultWarrantyDetails) === null || _defaultWarrantyDetai7 === void 0 ? void 0 : _defaultWarrantyDetai7.code) || formValues['ppwOrPpcString'] || ''\n      }),\n      financialChecklist: financialChecklistBlank.map(function (_ref4) {\n        var name = _ref4.name,\n            types = _ref4.types;\n        return types.reduce(function (acc, type) {\n          var _objectSpread2;\n\n          var valueKey = \"\".concat(name).concat(type);\n          var isWarrantyType = valueKey === 'ppwOrPpcString';\n          var warrantyType = isWarrantyType ? formValues['ppwOrPpcString'] : '';\n          var isThirdPartyString = valueKey === 'thirdPartyString';\n          var thirdPartyNumberValue = formValues['thirdPartyNumber'];\n          var thirdPartyStringValue = Boolean(thirdPartyNumberValue) && formValues[valueKey] ? optionsThirdParty === null || optionsThirdParty === void 0 ? void 0 : optionsThirdParty.find(function (val) {\n            return val.id === formValues[valueKey];\n          }) : null || {};\n          var isPfInternalString = valueKey === 'pfinternalString';\n          var pfInternalNumberValue = formValues['pfinternalNumber'];\n          var pfInternalStringValue = Boolean(pfInternalNumberValue) ? formValues[valueKey] : '';\n          var value = isWarrantyType ? warrantyType : isThirdPartyString ? thirdPartyStringValue === null || thirdPartyStringValue === void 0 ? void 0 : thirdPartyStringValue.partnerName : isPfInternalString ? pfInternalStringValue : formValues[valueKey];\n          var isDate = type === 'Date';\n          var isValidDate = isDate && moment(value).isValid();\n          return _objectSpread(_objectSpread({}, acc), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, \"\".concat(type.toLowerCase(), \"Value\"), isDate ? isValidDate ? moment(value).format('YYYY-MM-DD') : '' : value), _defineProperty(_objectSpread2, \"approvedByAuthorisedSignatory\", formValues[\"\".concat(name, \"Checkbox\")]), _objectSpread2));\n        }, {\n          name: name\n        });\n      })\n    });\n\n    dispatch(updateProcessingInstruction(updatedInstruction, formValues)).then(function (response) {\n      if ((response === null || response === void 0 ? void 0 : response.status) === constants.API_RESPONSE_OK) {\n        if (type === 'saveNext') {\n          handlers.next();\n        }\n      }\n    });\n  };\n\n  var handleCancel = function handleCancel() {\n    var _childRef$current4, _childRef$current4$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current4 = childRef.current) === null || _childRef$current4 === void 0 ? void 0 : (_childRef$current4$pr = _childRef$current4.props) === null || _childRef$current4$pr === void 0 ? void 0 : _childRef$current4$pr.resetFunc;\n\n    if (utils.generic.isFunction(reset)) {\n      reset(defaultValues, {\n        keepDirty: false\n      });\n    }\n\n    setDocumentNotUploadedError({\n      premiumTaxDocument: false,\n      signedLinesDocument: false\n    });\n  };\n\n  useEffect(function () {\n    var _childRef$current5, _childRef$current5$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current5 = childRef.current) === null || _childRef$current5 === void 0 ? void 0 : (_childRef$current5$pr = _childRef$current5.props) === null || _childRef$current5$pr === void 0 ? void 0 : _childRef$current5$pr.resetFunc;\n\n    var updatedDefaultValues = _objectSpread({}, utils.form.getInitialValues(fields));\n\n    setDefaultValues(updatedDefaultValues);\n\n    if (utils.generic.isFunction(reset)) {\n      reset(updatedDefaultValues, {\n        keepDirty: false\n      });\n    }\n  }, [instruction] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  var handleUploadedDocument = function handleUploadedDocument(data, documentTypeKey) {\n    var _data$data;\n\n    var newFiles = data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.documentDto;\n    if (!utils.generic.isValidArray(newFiles)) return;\n    var newGxbDocs = newFiles.map(function (file) {\n      return _objectSpread(_objectSpread({}, file), {}, {\n        folderUuid: file === null || file === void 0 ? void 0 : file.folderUid,\n        name: file === null || file === void 0 ? void 0 : file.documentName,\n        path: file === null || file === void 0 ? void 0 : file.documentPath,\n        source: file === null || file === void 0 ? void 0 : file.documentSource,\n        typeId: file === null || file === void 0 ? void 0 : file.documentTypeId,\n        uuid: file === null || file === void 0 ? void 0 : file.documentUid\n      });\n    });\n\n    var updatedDocuments = _objectSpread(_objectSpread(_objectSpread({}, documents), documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piPremiumCalculation && {\n      premiumTaxDocument: newGxbDocs[0]\n    }), documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piMarketSigned && {\n      signedLinesDocument: newGxbDocs[0]\n    });\n\n    dispatch(storeProcessingInstructionDocuments(updatedDocuments));\n  };\n\n  var uploadPremiumTaxSignedLinesModal = function uploadPremiumTaxSignedLinesModal(documentTypeKey) {\n    return function (files) {\n      dispatch(addLoader('DmsUploadFiles'));\n      dispatch(showModal({\n        component: 'DMS_UPLOAD_FILES',\n        props: {\n          fullWidth: true,\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\n          hideCompOnBlur: false,\n          maxWidth: 'xl',\n          componentProps: {\n            files: files,\n            context: constants.DMS_CONTEXT_PROCESSING_INSTRUCTION,\n            referenceId: Number(instruction === null || instruction === void 0 ? void 0 : instruction.id),\n            sourceId: Number(selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : selectedRiskRef.xbInstanceId),\n            documentTypeKey: documentTypeKey,\n            postDmsDocumentsSuccess: function postDmsDocumentsSuccess(data) {\n              return handleUploadedDocument(data, documentTypeKey);\n            },\n            confirmLabel: utils.string.t('app.ok'),\n            cancelLabel: utils.string.t('app.goBack'),\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\n            buttonColors: {\n              confirm: 'secondary',\n              cancel: 'primary'\n            }\n          }\n        }\n      }));\n    };\n  };\n\n  var confirmRemoveDocumentModal = function confirmRemoveDocumentModal(file, removeDocumentType) {\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        fullWidth: true,\n        title: utils.string.t('processingInstructions.checklist.warning.title'),\n        maxWidth: 'xs',\n        componentProps: {\n          confirmLabel: utils.string.t('app.yes'),\n          cancelLabel: utils.string.t('app.no'),\n          confirmMessage: utils.string.t('processingInstructions.removeDocumentWarning'),\n          buttonColors: {\n            confirm: 'secondary',\n            cancel: 'primary'\n          },\n          submitHandler: function submitHandler() {\n            dispatch(removePremiumTaxSignedLinesDocument({\n              docIds: file === null || file === void 0 ? void 0 : file.documentId,\n              removeDocumentType: removeDocumentType,\n              documents: documents\n            }));\n          },\n          cancelHandler: function cancelHandler() {},\n          handleClose: function handleClose() {}\n        }\n      }\n    }));\n  };\n\n  var handleLinkDownload = function handleLinkDownload(file) {\n    dispatch(viewDocumentsDownload({\n      documentId: file === null || file === void 0 ? void 0 : file.documentId,\n      documentName: file === null || file === void 0 ? void 0 : file.name\n    }));\n  }; // abort if data is not ready/available\n\n\n  if (!defaultValues || !instruction) return null;\n  return /*#__PURE__*/_jsxDEV(ProcessingInstructionsDetailsView, {\n    instructionId: instruction === null || instruction === void 0 ? void 0 : instruction.id,\n    documents: documents,\n    fields: fields,\n    defaultValues: defaultValues,\n    retainedBrokerageAmount: retainedBrokerageAmount,\n    convertedBrokerage: convertedBrokerage,\n    premiumCurrency: retainedBrokerageCurrencyCode,\n    sumTotal: totalAmount,\n    riskRefId: selectedRiskRef === null || selectedRiskRef === void 0 ? void 0 : selectedRiskRef.riskRefId,\n    isEditable: isEditable,\n    isReadOnly: isReadOnly,\n    documentNotUploadedError: documentNotUploadedError,\n    checkListMandatoryDataStatus: checkListMandatoryDataStatus,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      next: handleNext,\n      save: handleSave,\n      cancel: handleCancel,\n      getRetainedBrokerageAmount: getRetainedBrokerageAmount,\n      getTotalAmount: getTotalAmount,\n      uploadPremiumTaxSignedLinesModal: uploadPremiumTaxSignedLinesModal,\n      confirmRemoveDocumentModal: confirmRemoveDocumentModal,\n      download: handleLinkDownload\n    }),\n    ref: childRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 735,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProcessingInstructionsDetails, \"d5eJraVu97n3xM65g1huLA0FrS8=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ProcessingInstructionsDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProcessingInstructionsDetails\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsDetails/ProcessingInstructionsDetails.js"],"names":["React","useState","useEffect","PropTypes","useDispatch","useSelector","moment","get","isNumber","uniqBy","ProcessingInstructionsDetailsView","selectUser","showModal","updateProcessingInstruction","removePremiumTaxSignedLinesDocument","storeRetainedBrokerageAmountForPdf","storeTotalAmountForPdf","addLoader","storeProcessingInstructionDocuments","viewDocumentsDownload","enqueueNotification","selectRefDataThirdPartyList","constants","utils","config","ProcessingInstructionsDetails","propTypes","instruction","object","isRequired","handlers","shape","back","func","next","childRef","checkListMandatoryDataStatus","dispatch","user","documents","state","refDataCurrencies","optionsDepartments","processingInstructions","departmentList","departments","generic","isValidArray","map","d","id","deptName","sort","a","b","warrantyTypes","optionsThirdParty","isDraft","status","statusId","isRejectedDraft","isSubmittedAuthorisedSignatory","isReopened","userHasWritePermission","app","access","feature","userHasApproverAccess","isCheckboxesEditable","isEditable","isReadOnly","selectedRiskRef","riskReferences","find","r","leadPolicy","warrantyListOptions","code","warrantyName","paymentBasisOptions","name","toggleOptions","label","string","t","value","getToggleValue","o","includes","selectedThirdParty","thirdvalue","financialChecklist","stringValue","partnerName","validateWarrantyListValue","isFinancialListAvailable","warrantyDetails","isInvalidData","warrantyList","isSelected","warrantyCode","warrantyDate","displayError","fields","type","details","highPriority","muiComponentProps","disabled","frontEndSendDocs","getFinancialField","numberValue","options","buttonGroupProps","exclusive","approvedByAuthorisedSignatory","autoComplete","option","optionKey","optionLabel","CURRENCY_USD","optionsKey","dateValue","outputFormat","placeholder","muiPickerProps","format","ui","date","text","clearable","notes","inputProps","maxLength","multiline","minRows","maxRows","retainedBrokerageCurrencyCodeField","form","getFieldProps","defaultValues","setDefaultValues","retainedBrokerageAmount","setRetainedBrokerageAmount","convertedBrokerage","setConvertedBrokerage","totalAmount","setTotalAmount","premiumTaxDocument","signedLinesDocument","documentNotUploadedError","setDocumentNotUploadedError","formValues","current","props","values","retainedBrokerageCurrencyCode","retainedBrokerageCurrencyCodeString","defaultValue","getRetainedBrokerageAmount","grossPremiumAmount","slipOrder","retainedBrokerage","amount","getRetainedBrokerageValue","brokerage","getRetainedBrokerageConvertedValue","retBrokerageAmt","convertedBrokerageAmt","getTotalAmount","clientDiscount","thirdPartyCommissionSharing","pfinternalCommissionSharing","sumValuesArray","getSumOfArray","percent","decimal","checkPremiumTaxDocumentAndSignedLinesDocument","premiumTaxCalculationSheetAttachedNumber","signedLinesCalculationSheetAttachedNumber","premiumTaxDocumen","handleNext","handleSave","SAVE_NEXT","financialChecklistBlank","types","defaultWarrantyDetails","warrantyTypeId","toLowerCase","updatedInstruction","warrantyDescription","warrantyTypeID","reduce","acc","valueKey","isWarrantyType","warrantyType","isThirdPartyString","thirdPartyNumberValue","thirdPartyStringValue","Boolean","val","isPfInternalString","pfInternalNumberValue","pfInternalStringValue","isDate","isValidDate","isValid","then","response","API_RESPONSE_OK","handleCancel","reset","resetFunc","isFunction","keepDirty","updatedDefaultValues","getInitialValues","handleUploadedDocument","data","documentTypeKey","newFiles","documentDto","newGxbDocs","file","folderUuid","folderUid","documentName","path","documentPath","source","documentSource","typeId","documentTypeId","uuid","documentUid","updatedDocuments","DMS_DOCUMENT_TYPE_SECTION_KEYS","piPremiumCalculation","piMarketSigned","uploadPremiumTaxSignedLinesModal","files","component","fullWidth","title","hideCompOnBlur","maxWidth","componentProps","context","DMS_CONTEXT_PROCESSING_INSTRUCTION","referenceId","Number","sourceId","xbInstanceId","postDmsDocumentsSuccess","confirmLabel","cancelLabel","confirmMessage","buttonColors","confirm","cancel","confirmRemoveDocumentModal","removeDocumentType","submitHandler","docIds","documentId","cancelHandler","handleClose","handleLinkDownload","riskRefId","save","download"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport moment from 'moment';\r\nimport get from 'lodash/get';\r\nimport isNumber from 'lodash/isNumber';\r\nimport uniqBy from 'lodash/uniqBy';\r\n\r\n// app\r\nimport ProcessingInstructionsDetailsView from './ProcessingInstructionsDetails.view';\r\nimport {\r\n  selectUser,\r\n  showModal,\r\n  updateProcessingInstruction,\r\n  removePremiumTaxSignedLinesDocument,\r\n  storeRetainedBrokerageAmountForPdf,\r\n  storeTotalAmountForPdf,\r\n  addLoader,\r\n  storeProcessingInstructionDocuments,\r\n  viewDocumentsDownload,\r\n  enqueueNotification,\r\n  selectRefDataThirdPartyList,\r\n} from 'stores';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\nProcessingInstructionsDetails.propTypes = {\r\n  instruction: PropTypes.object.isRequired,\r\n  handlers: PropTypes.shape({\r\n    back: PropTypes.func.isRequired,\r\n    next: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n  childRef: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default function ProcessingInstructionsDetails({ instruction, handlers, childRef, checkListMandatoryDataStatus }) {\r\n  const dispatch = useDispatch();\r\n  const user = useSelector(selectUser);\r\n  const documents = useSelector((state) => get(state, 'processingInstructions.documents')) || {};\r\n  const refDataCurrencies = useSelector((state) => get(state, 'referenceData.currencyCodes')) || [];\r\n  const optionsDepartments = useSelector((state) => state.processingInstructions.departmentList) || [];\r\n  const departments = utils.generic.isValidArray(optionsDepartments, true)\r\n    ? uniqBy(optionsDepartments, 'deptName')\r\n        ?.map((d) => ({ id: d.id, deptName: d.deptName }))\r\n        ?.sort((a, b) => (a.deptName > b.deptName ? 1 : b.deptName > a.deptName ? -1 : 0))\r\n    : [];\r\n  const warrantyTypes = useSelector((state) => get(state, 'referenceData.warrantyTypes')) || [];\r\n\r\n  const optionsThirdParty = useSelector(selectRefDataThirdPartyList) || [];\r\n  const isDraft = utils.processingInstructions.status.isDraft(instruction?.statusId);\r\n  const isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction?.statusId);\r\n  const isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction?.statusId);\r\n  const isReopened = utils.processingInstructions.status.isReopened(instruction?.statusId);\r\n  const userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\r\n  const userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\r\n  const isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\r\n\r\n  const isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\r\n  const isReadOnly = !isEditable;\r\n  const selectedRiskRef = instruction?.riskReferences?.find((r) => r.leadPolicy);\r\n\r\n  let warrantyListOptions = utils.generic.isValidArray(warrantyTypes, true)\r\n    ? uniqBy(warrantyTypes, 'code')?.sort((a, b) => (a.code > b.code ? 1 : b.code > a.code ? -1 : 0))\r\n    : [];\r\n  warrantyListOptions = [...warrantyListOptions, { code: 'NA', warrantyName: 'NA' }];\r\n\r\n  const paymentBasisOptions = [\r\n    { id: '1', code: 'cash', name: 'Cash' },\r\n    { id: '2', code: 'quaterly', name: 'Quaterly' },\r\n    { id: '3', code: 'otherDeferred', name: 'Other Deferred' },\r\n  ];\r\n\r\n  const toggleOptions = [\r\n    { label: utils.string.t('app.yes'), value: 1 },\r\n    { label: utils.string.t('app.no'), value: 0 },\r\n    { label: utils.string.t('app.na'), value: -1 },\r\n  ];\r\n\r\n  const getToggleValue = (value) => {\r\n    return toggleOptions.map((o) => o.value).includes(value) ? value : null;\r\n  };\r\n\r\n  const selectedThirdParty = () => {\r\n    const thirdvalue = utils.generic.isValidArray(instruction?.financialChecklist, true)\r\n      ? instruction.financialChecklist?.find((a) => a.name === 'thirdParty')?.stringValue\r\n      : null;\r\n    return utils.generic.isValidArray(optionsThirdParty, true) && thirdvalue\r\n      ? optionsThirdParty.find((value) => value?.partnerName === thirdvalue)?.id || null\r\n      : null;\r\n  };\r\n  const validateWarrantyListValue = () => {\r\n    const isFinancialListAvailable = utils.generic.isValidArray(instruction?.financialChecklist, true)\r\n      ? instruction?.financialChecklist?.find((a) => a.name === 'ppwOrPpc')?.stringValue\r\n        ? true\r\n        : false\r\n      : false;\r\n    if (!isFinancialListAvailable) {\r\n      if (\r\n        selectedRiskRef?.warrantyDetails?.isInvalidData === 0 &&\r\n        utils.generic.isValidArray(selectedRiskRef?.warrantyDetails?.warrantyList, true)\r\n      ) {\r\n        return selectedRiskRef.warrantyDetails.warrantyList.find((a) => a.isSelected) || null;\r\n      } else if (\r\n        (selectedRiskRef?.warrantyDetails?.isInvalidData === 0 || selectedRiskRef?.warrantyDetails?.isInvalidData === 1) &&\r\n        !utils.generic.isValidArray(selectedRiskRef?.warrantyDetails?.warrantyList, true)\r\n      ) {\r\n        return {\r\n          warrantyCode: 'NA',\r\n          warrantyDate: null,\r\n          displayError: selectedRiskRef?.warrantyDetails?.isInvalidData === 1,\r\n        };\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const fields = [\r\n    {\r\n      name: 'highPriority',\r\n      type: 'checkbox',\r\n      value: instruction?.details?.highPriority,\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.highPriority'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'frontEndSendDocs',\r\n      type: 'checkbox',\r\n      value: instruction?.details?.frontEndSendDocs,\r\n      label: utils.string.t('processingInstructions.processingInstructionsForEndFaBorder.fields.frontEndSendDocuments'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'premiumTaxCalculationSheetAttachedNumber',\r\n      type: 'toggle',\r\n      value: getToggleValue(utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')?.numberValue),\r\n      options: toggleOptions,\r\n      buttonGroupProps: {\r\n        exclusive: true,\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'premiumTaxCalculationSheetAttachedCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'premiumTaxCalculationSheetAttached')\r\n        ?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'signedLinesCalculationSheetAttachedNumber',\r\n      type: 'toggle',\r\n      value: getToggleValue(\r\n        utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')?.numberValue\r\n      ),\r\n      options: toggleOptions,\r\n      buttonGroupProps: {\r\n        exclusive: true,\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'signedLinesCalculationSheetAttachedCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'signedLinesCalculationSheetAttached')\r\n        ?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'grossPremiumAmountNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'grossPremiumAmountCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'grossPremiumAmount')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'slipOrderNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'slipOrder')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'slipOrderCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'slipOrder')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'totalBrokerageNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'totalBrokerageCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'totalBrokerage')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'clientDiscountNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'clientDiscountCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'clientDiscount')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'thirdPartyNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'thirdPartyString',\r\n      type: 'select',\r\n      value: selectedThirdParty() || utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.stringValue || '',\r\n      options:\r\n        optionsThirdParty?.map((option) => ({\r\n          value: option?.id,\r\n          label: option?.partnerName,\r\n        })) || [],\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'thirdPartyCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'thirdParty')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'pfinternalNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'pfinternalString',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.stringValue || '',\r\n      options: departments,\r\n      optionKey: 'id',\r\n      optionLabel: 'deptName',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'pfinternalCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'pfinternal')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'retainedBrokerageNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')?.numberValue || '',\r\n      muiComponentProps: {\r\n        autoComplete: 'off',\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerage')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCurrencyCodeString',\r\n      value:\r\n        utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')?.stringValue || constants.CURRENCY_USD,\r\n      optionsKey: 'premiumCurrency',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'retainedBrokerageCurrencyCodeCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'retainedBrokerageCurrencyCode')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'feesNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'fees')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'feesCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'fees')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'otherDeductionsNumber',\r\n      type: 'number',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')?.numberValue || '',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'otherDeductionsCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'otherDeductions')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'settlementCurrencyCodeIdNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')?.numberValue || '',\r\n      options: refDataCurrencies,\r\n      optionKey: 'currencyCodeID',\r\n      optionLabel: 'currencyCd',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'settlementCurrencyCodeIdCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'settlementCurrencyCodeId')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'paymentBasisNumber',\r\n      type: 'select',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')?.numberValue || '',\r\n      options: paymentBasisOptions,\r\n      optionKey: 'id',\r\n      optionLabel: 'name',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'paymentBasisCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'paymentBasis')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'ppwOrPpcString',\r\n      type: 'select',\r\n      value:\r\n        validateWarrantyListValue()?.warrantyCode ||\r\n        utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.stringValue ||\r\n        '',\r\n      options: warrantyListOptions,\r\n      optionKey: 'code',\r\n      optionLabel: 'warrantyName',\r\n      displayError: validateWarrantyListValue()?.displayError || false,\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n    {\r\n      name: 'ppwOrPpcDate',\r\n      type: 'datepicker',\r\n      value: validateWarrantyListValue()?.warrantyDate\r\n        ? moment(validateWarrantyListValue()?.warrantyDate)\r\n        : null || utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.dateValue\r\n        ? moment(utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.dateValue)\r\n        : null,\r\n      outputFormat: 'iso',\r\n      placeholder: utils.string.t('app.selectDate'),\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n      muiPickerProps: {\r\n        format: config.ui.format.date.text,\r\n        clearable: true,\r\n      },\r\n    },\r\n    {\r\n      name: 'ppwOrPpcCheckbox',\r\n      type: 'checkbox',\r\n      value: utils.processingInstructions.getFinancialField(instruction, 'ppwOrPpc')?.approvedByAuthorisedSignatory,\r\n      disabled: !isCheckboxesEditable || checkListMandatoryDataStatus,\r\n    },\r\n    {\r\n      name: 'notes',\r\n      label: utils.string.t('processingInstructions.details.notes'),\r\n      type: 'textarea',\r\n      value: instruction?.details?.notes || '',\r\n      muiComponentProps: {\r\n        inputProps: { maxLength: 4000 },\r\n        multiline: true,\r\n        minRows: 4,\r\n        maxRows: 8,\r\n        disabled: isReadOnly || checkListMandatoryDataStatus,\r\n      },\r\n    },\r\n  ];\r\n  const retainedBrokerageCurrencyCodeField = utils.form.getFieldProps(fields, 'retainedBrokerageCurrencyCodeString');\r\n\r\n  const [defaultValues, setDefaultValues] = useState();\r\n  const [retainedBrokerageAmount, setRetainedBrokerageAmount] = useState('');\r\n  const [convertedBrokerage, setConvertedBrokerage] = useState();\r\n  const [totalAmount, setTotalAmount] = useState('');\r\n  const [documentNotUploadedError, setDocumentNotUploadedError] = useState({ premiumTaxDocument: false, signedLinesDocument: false });\r\n\r\n  const formValues = childRef?.current?.props?.values;\r\n  const retainedBrokerageCurrencyCode =\r\n    formValues?.retainedBrokerageCurrencyCodeString ||\r\n    retainedBrokerageCurrencyCodeField?.defaultValue ||\r\n    retainedBrokerageCurrencyCodeField?.value;\r\n\r\n  const getRetainedBrokerageAmount = ({\r\n    grossPremiumAmount,\r\n    slipOrder,\r\n    retainedBrokerage,\r\n    retainedBrokerageCurrencyCode,\r\n    retainedBrokerageAmount,\r\n  }) => {\r\n    const amount = utils.processingInstructions.getRetainedBrokerageValue(grossPremiumAmount, slipOrder, retainedBrokerage);\r\n    const brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(\r\n      retainedBrokerageCurrencyCode,\r\n      retainedBrokerageAmount\r\n    );\r\n\r\n    setRetainedBrokerageAmount(amount);\r\n    setConvertedBrokerage(brokerage);\r\n    dispatch(\r\n      storeRetainedBrokerageAmountForPdf({\r\n        retBrokerageAmt: amount,\r\n        convertedBrokerageAmt: brokerage,\r\n      })\r\n    );\r\n  };\r\n\r\n  const getTotalAmount = ({ clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage }) => {\r\n    if (clientDiscount && thirdPartyCommissionSharing && pfinternalCommissionSharing && retainedBrokerage) {\r\n      const sumValuesArray = [clientDiscount, thirdPartyCommissionSharing, pfinternalCommissionSharing, retainedBrokerage];\r\n\r\n      setTotalAmount(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal));\r\n      dispatch(storeTotalAmountForPdf(utils.generic.getSumOfArray(sumValuesArray, config.ui.format.percent.decimal)));\r\n    } else {\r\n      setTotalAmount('');\r\n    }\r\n  };\r\n\r\n  const checkPremiumTaxDocumentAndSignedLinesDocument = () => {\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    if (\r\n      (formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument) ||\r\n      (formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument)\r\n    ) {\r\n      if (\r\n        formValues.premiumTaxCalculationSheetAttachedNumber === 1 &&\r\n        !documents.premiumTaxDocument &&\r\n        formValues.signedLinesCalculationSheetAttachedNumber === 1 &&\r\n        !documents.signedLinesDocument\r\n      ) {\r\n        dispatch(enqueueNotification('processingInstructions.details.missingPremiumTaxAndSignedLines', 'warning'));\r\n      } else if (formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocument) {\r\n        dispatch(enqueueNotification('processingInstructions.details.missingPremiumTaxCalculationSheet', 'warning'));\r\n      } else if (formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument) {\r\n        dispatch(enqueueNotification('processingInstructions.details.missingSignedLinesCalculation', 'warning'));\r\n      }\r\n\r\n      setDocumentNotUploadedError({\r\n        premiumTaxDocument: formValues.premiumTaxCalculationSheetAttachedNumber === 1 && !documents.premiumTaxDocumen,\r\n        signedLinesDocument: formValues.signedLinesCalculationSheetAttachedNumber === 1 && !documents.signedLinesDocument,\r\n      });\r\n      return true;\r\n    }\r\n    setDocumentNotUploadedError({\r\n      premiumTaxDocument: false,\r\n      signedLinesDocument: false,\r\n    });\r\n    return false;\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (checkPremiumTaxDocumentAndSignedLinesDocument()) {\r\n      return;\r\n    }\r\n    handlers.next();\r\n  };\r\n\r\n  const handleSave = (type) => {\r\n    if (type === constants.SAVE_NEXT && checkPremiumTaxDocumentAndSignedLinesDocument()) {\r\n      return;\r\n    }\r\n    setDocumentNotUploadedError({\r\n      premiumTaxDocument: false,\r\n      signedLinesDocument: false,\r\n    });\r\n    const formValues = childRef?.current?.props?.values || {};\r\n    const financialChecklistBlank = [\r\n      { name: 'signedLinesCalculationSheetAttached', types: ['Number'] },\r\n      { name: 'premiumTaxCalculationSheetAttached', types: ['Number'] },\r\n      { name: 'grossPremiumAmount', types: ['Number'] },\r\n      { name: 'slipOrder', types: ['Number'] },\r\n      { name: 'totalBrokerage', types: ['Number'] },\r\n      { name: 'fees', types: ['Number'] },\r\n      { name: 'otherDeductions', types: ['Number'] },\r\n      { name: 'settlementCurrencyCodeId', types: ['Number'] },\r\n      { name: 'paymentBasis', types: ['Number'] },\r\n      { name: 'ppwOrPpc', types: ['String', 'Date'] },\r\n      { name: 'clientDiscount', types: ['Number'] },\r\n      { name: 'thirdParty', types: ['Number', 'String'] },\r\n      { name: 'pfinternal', types: ['Number', 'String'] },\r\n      { name: 'retainedBrokerage', types: ['Number'] },\r\n      { name: 'retainedBrokerageCurrencyCode', types: ['String'] },\r\n    ];\r\n    let defaultWarrantyDetails = utils.generic.isValidArray(selectedRiskRef?.warrantyDetails?.warrantyList, true)\r\n      ? isNumber(formValues['ppwOrPpcString'])\r\n        ? selectedRiskRef.warrantyDetails.warrantyList.find((a) => a.warrantyTypeId === formValues['ppwOrPpcString'])\r\n        : selectedRiskRef.warrantyDetails.warrantyList.find(\r\n            (a) => a.warrantyCode?.toLowerCase() === formValues['ppwOrPpcString']?.toLowerCase()\r\n          )\r\n      : null;\r\n    if (!defaultWarrantyDetails) {\r\n      defaultWarrantyDetails = utils.generic.isValidArray(warrantyListOptions, true)\r\n        ? warrantyListOptions.find((a) => a.code?.toLowerCase() === formValues['ppwOrPpcString']?.toLowerCase())\r\n        : null;\r\n    }\r\n    const updatedInstruction = {\r\n      ...instruction,\r\n      details: {\r\n        ...instruction.details,\r\n        highPriority: formValues.highPriority,\r\n        frontEndSendDocs: formValues.frontEndSendDocs,\r\n        notes: formValues.notes,\r\n        retainedBrokerageCurrencyCode,\r\n\r\n        warrantyDescription: defaultWarrantyDetails?.warrantyName || defaultWarrantyDetails?.warrantyDescription || '',\r\n        warrantyTypeId: defaultWarrantyDetails?.warrantyTypeId || defaultWarrantyDetails?.warrantyTypeID || '',\r\n        warrantyDate: defaultWarrantyDetails?.warrantyDate || '',\r\n        warrantyCode: defaultWarrantyDetails?.warrantyCode || defaultWarrantyDetails?.code || formValues['ppwOrPpcString'] || '',\r\n      },\r\n      financialChecklist: financialChecklistBlank.map(({ name, types }) => {\r\n        return types.reduce(\r\n          (acc, type) => {\r\n            const valueKey = `${name}${type}`;\r\n            const isWarrantyType = valueKey === 'ppwOrPpcString';\r\n            const warrantyType = isWarrantyType ? formValues['ppwOrPpcString'] : '';\r\n\r\n            const isThirdPartyString = valueKey === 'thirdPartyString';\r\n            const thirdPartyNumberValue = formValues['thirdPartyNumber'];\r\n            const thirdPartyStringValue =\r\n              Boolean(thirdPartyNumberValue) && formValues[valueKey]\r\n                ? optionsThirdParty?.find((val) => val.id === formValues[valueKey])\r\n                : null || {};\r\n\r\n            const isPfInternalString = valueKey === 'pfinternalString';\r\n            const pfInternalNumberValue = formValues['pfinternalNumber'];\r\n            const pfInternalStringValue = Boolean(pfInternalNumberValue) ? formValues[valueKey] : '';\r\n\r\n            const value = isWarrantyType\r\n              ? warrantyType\r\n              : isThirdPartyString\r\n              ? thirdPartyStringValue?.partnerName\r\n              : isPfInternalString\r\n              ? pfInternalStringValue\r\n              : formValues[valueKey];\r\n            const isDate = type === 'Date';\r\n            const isValidDate = isDate && moment(value).isValid();\r\n\r\n            return {\r\n              ...acc,\r\n              [`${type.toLowerCase()}Value`]: isDate ? (isValidDate ? moment(value).format('YYYY-MM-DD') : '') : value,\r\n              approvedByAuthorisedSignatory: formValues[`${name}Checkbox`],\r\n            };\r\n          },\r\n          { name }\r\n        );\r\n      }),\r\n    };\r\n\r\n    dispatch(updateProcessingInstruction(updatedInstruction, formValues)).then((response) => {\r\n      if (response?.status === constants.API_RESPONSE_OK) {\r\n        if (type === 'saveNext') {\r\n          handlers.next();\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    const reset = childRef?.current?.props?.resetFunc;\r\n\r\n    if (utils.generic.isFunction(reset)) {\r\n      reset(defaultValues, { keepDirty: false });\r\n    }\r\n    setDocumentNotUploadedError({\r\n      premiumTaxDocument: false,\r\n      signedLinesDocument: false,\r\n    });\r\n  };\r\n\r\n  useEffect(\r\n    () => {\r\n      const reset = childRef?.current?.props?.resetFunc;\r\n      const updatedDefaultValues = {\r\n        ...utils.form.getInitialValues(fields),\r\n      };\r\n\r\n      setDefaultValues(updatedDefaultValues);\r\n\r\n      if (utils.generic.isFunction(reset)) {\r\n        reset(updatedDefaultValues, {\r\n          keepDirty: false,\r\n        });\r\n      }\r\n    },\r\n    [instruction] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  const handleUploadedDocument = (data, documentTypeKey) => {\r\n    const newFiles = data?.data?.documentDto;\r\n    if (!utils.generic.isValidArray(newFiles)) return;\r\n    const newGxbDocs = newFiles.map((file) => {\r\n      return {\r\n        ...file,\r\n        folderUuid: file?.folderUid,\r\n        name: file?.documentName,\r\n        path: file?.documentPath,\r\n        source: file?.documentSource,\r\n        typeId: file?.documentTypeId,\r\n        uuid: file?.documentUid,\r\n      };\r\n    });\r\n\r\n    const updatedDocuments = {\r\n      ...documents,\r\n      ...(documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piPremiumCalculation && {\r\n        premiumTaxDocument: newGxbDocs[0],\r\n      }),\r\n      ...(documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.piMarketSigned && {\r\n        signedLinesDocument: newGxbDocs[0],\r\n      }),\r\n    };\r\n    dispatch(storeProcessingInstructionDocuments(updatedDocuments));\r\n  };\r\n\r\n  const uploadPremiumTaxSignedLinesModal = (documentTypeKey) => (files) => {\r\n    dispatch(addLoader('DmsUploadFiles'));\r\n\r\n    dispatch(\r\n      showModal({\r\n        component: 'DMS_UPLOAD_FILES',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('dms.upload.modalItems.uploadDocuments'),\r\n          hideCompOnBlur: false,\r\n          maxWidth: 'xl',\r\n          componentProps: {\r\n            files,\r\n            context: constants.DMS_CONTEXT_PROCESSING_INSTRUCTION,\r\n            referenceId: Number(instruction?.id),\r\n            sourceId: Number(selectedRiskRef?.xbInstanceId),\r\n            documentTypeKey,\r\n            postDmsDocumentsSuccess: (data) => handleUploadedDocument(data, documentTypeKey),\r\n            confirmLabel: utils.string.t('app.ok'),\r\n            cancelLabel: utils.string.t('app.goBack'),\r\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const confirmRemoveDocumentModal = (file, removeDocumentType) => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('processingInstructions.checklist.warning.title'),\r\n          maxWidth: 'xs',\r\n          componentProps: {\r\n            confirmLabel: utils.string.t('app.yes'),\r\n            cancelLabel: utils.string.t('app.no'),\r\n            confirmMessage: utils.string.t('processingInstructions.removeDocumentWarning'),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n            submitHandler: () => {\r\n              dispatch(removePremiumTaxSignedLinesDocument({ docIds: file?.documentId, removeDocumentType, documents }));\r\n            },\r\n            cancelHandler: () => {},\r\n            handleClose: () => {},\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleLinkDownload = (file) => {\r\n    dispatch(viewDocumentsDownload({ documentId: file?.documentId, documentName: file?.name }));\r\n  };\r\n\r\n  // abort if data is not ready/available\r\n  if (!defaultValues || !instruction) return null;\r\n\r\n  return (\r\n    <ProcessingInstructionsDetailsView\r\n      instructionId={instruction?.id}\r\n      documents={documents}\r\n      fields={fields}\r\n      defaultValues={defaultValues}\r\n      retainedBrokerageAmount={retainedBrokerageAmount}\r\n      convertedBrokerage={convertedBrokerage}\r\n      premiumCurrency={retainedBrokerageCurrencyCode}\r\n      sumTotal={totalAmount}\r\n      riskRefId={selectedRiskRef?.riskRefId}\r\n      isEditable={isEditable}\r\n      isReadOnly={isReadOnly}\r\n      documentNotUploadedError={documentNotUploadedError}\r\n      checkListMandatoryDataStatus={checkListMandatoryDataStatus}\r\n      handlers={{\r\n        ...handlers,\r\n        next: handleNext,\r\n        save: handleSave,\r\n        cancel: handleCancel,\r\n        getRetainedBrokerageAmount,\r\n        getTotalAmount,\r\n        uploadPremiumTaxSignedLinesModal,\r\n        confirmRemoveDocumentModal,\r\n        download: handleLinkDownload,\r\n      }}\r\n      ref={childRef}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}