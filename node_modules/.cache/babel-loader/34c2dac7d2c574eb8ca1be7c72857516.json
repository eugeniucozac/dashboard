{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\pages\\\\ClaimsNewLoss\\\\ClaimsNewLoss.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router';\nimport { Helmet } from 'react-helmet'; // app\n\nimport { showModal, selectClaimsStepper, selectCatCodes, selectClaimsStatuses, selectPriorities, selectLossQualifiers, selectSettlementCurrency, selectReferralResponse, getCatCodes, getStatuses, getPriorityLevels, getLossQualifiers, getSettlementCurrency, getReferralResponse, submitClaimDetailsInformation, resetClaimsPolicies, resetLinkPolicies, resetClaimsDMSDocumentDetails, resetLossPolicyClaimData, resetSelectedLossItem, resetWidgetClaimsMetadata, resetLossData, setClaimData, setClaimsStepperControl } from 'stores';\nimport { CustomizedDialog, DrawerComponent } from 'components';\nimport { ClaimsRegisterNewLoss } from 'forms';\nimport * as utils from 'utils';\nimport config from 'config';\nimport { DmsFnolWidget } from 'modules';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ClaimsNewLoss() {\n  _s();\n\n  var _location$state, _location$state2, _location$state$loss, _location$state3, _location$state$linkP, _location$state4;\n\n  var location = useLocation();\n  var dispatch = useDispatch();\n  var history = useHistory();\n  var rootRef = useRef(null);\n  var brand = useSelector(function (state) {\n    return state.ui.brand;\n  });\n  var catCodes = useSelector(selectCatCodes);\n  var priorities = useSelector(selectPriorities);\n  var lossQualifiers = useSelector(selectLossQualifiers);\n  var claimsStatuses = useSelector(selectClaimsStatuses);\n  var settlementCurrency = useSelector(selectSettlementCurrency);\n  var referralResponse = useSelector(selectReferralResponse);\n  var currentStep = useSelector(selectClaimsStepper);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      fnolModalOpen = _useState2[0],\n      setFnolModalOpen = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isAnyformDirty = _useState4[0],\n      checkDirtyStatus = _useState4[1];\n\n  var _useState5 = useState([{\n    id: 0,\n    form: utils.string.t('claims.modalStepperLabel.createLoss'),\n    formEditedStatus: false,\n    isSubmitted: false\n  }, {\n    id: 1,\n    form: utils.string.t('claims.modalStepperLabel.linkPolicies'),\n    formEditedStatus: false,\n    isSubmitted: false\n  }, {\n    id: 2,\n    form: utils.string.t('claims.modalStepperLabel.createClaim'),\n    formEditedStatus: false,\n    isSubmitted: false\n  }, {\n    id: 3,\n    form: utils.string.t('claims.modalStepperLabel.manageDocuments'),\n    formEditedStatus: false,\n    isSubmitted: false\n  }, {\n    id: 4,\n    form: utils.string.t('claims.modalStepperLabel.confirmation'),\n    formEditedStatus: false,\n    isSubmitted: false\n  }]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      forms = _useState6[0],\n      editFormStatus = _useState6[1];\n\n  var redirectUrl = (location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.redirectUrl) || '';\n  var isNewLoss = location === null || location === void 0 ? void 0 : (_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.isNewLoss; // On click of Finish button\n\n  var launchFinishModal = function launchFinishModal() {\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        title: utils.string.t('claims.modals.confirmClaimSubmission.title'),\n        fullWidth: true,\n        maxWidth: 'sm',\n        componentProps: {\n          confirmLabel: utils.string.t('app.yes'),\n          cancelLabel: utils.string.t('app.no'),\n          confirmMessage: utils.string.t('claims.modals.confirmClaimSubmission.content'),\n          submitHandler: function submitHandler() {\n            dispatch(submitClaimDetailsInformation({\n              successCallback: function successCallback(data) {\n                if (typeof data === 'string') {\n                  dispatch(resetLossPolicyClaimData());\n                  history.push(redirectUrl || config.routes.claimsFNOL.root);\n                }\n              }\n            }));\n          },\n          handleClose: function handleClose() {}\n        }\n      }\n    }));\n  };\n\n  var getAllReferentialData = function getAllReferentialData() {\n    if (utils.generic.isInvalidOrEmptyArray(catCodes)) {\n      dispatch(getCatCodes());\n    }\n\n    if (utils.generic.isInvalidOrEmptyArray(priorities)) {\n      dispatch(getPriorityLevels());\n    }\n\n    if (utils.generic.isInvalidOrEmptyArray(lossQualifiers)) {\n      dispatch(getLossQualifiers());\n    }\n\n    if (utils.generic.isInvalidOrEmptyArray(claimsStatuses)) {\n      dispatch(getStatuses());\n    }\n\n    if (utils.generic.isInvalidOrEmptyArray(settlementCurrency)) {\n      dispatch(getSettlementCurrency());\n    }\n\n    if (utils.generic.isInvalidOrEmptyArray(referralResponse)) {\n      dispatch(getReferralResponse());\n    }\n  };\n\n  useEffect(function () {\n    getAllReferentialData();\n    setFnolModalOpen(true);\n    return function () {\n      dispatch(setClaimsStepperControl(0));\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var handleFnolModalClose = function handleFnolModalClose() {\n    if (isAnyformDirty) {\n      dispatch(showModal({\n        component: 'CONFIRM',\n        props: {\n          title: utils.string.t('status.alert'),\n          hint: utils.string.t('navigation.title'),\n          fullWidth: true,\n          maxWidth: 'xs',\n          componentProps: {\n            cancelLabel: utils.string.t('app.no'),\n            confirmLabel: utils.string.t('app.yes'),\n            submitHandler: function () {\n              var _submitHandler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        setFnolModalOpen(false);\n                        handleCleanUp();\n                        history.push(redirectUrl || config.routes.claimsFNOL.root);\n\n                      case 3:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              }));\n\n              function submitHandler() {\n                return _submitHandler.apply(this, arguments);\n              }\n\n              return submitHandler;\n            }()\n          }\n        }\n      }));\n    }\n  };\n\n  var _findDirtyForm = function findDirtyForm(forms) {\n    editFormStatus(forms === null || forms === void 0 ? void 0 : forms.map(function (form) {\n      return _objectSpread({}, form);\n    }));\n    checkDirtyStatus(forms.some(function (form) {\n      return (form === null || form === void 0 ? void 0 : form.formEditedStatus) === true;\n    }));\n  };\n\n  var handleCleanUp = function handleCleanUp() {\n    // if it's a new loss being registered, cleanup all the data\n    // it we're editing a loss or claim, we need to keep the data to redirect to the previous page/tab\n    if (isNewLoss) {\n      dispatch(resetLinkPolicies());\n      dispatch(resetClaimsDMSDocumentDetails());\n      dispatch(resetClaimsPolicies());\n      dispatch(resetLossPolicyClaimData());\n      dispatch(resetWidgetClaimsMetadata());\n      dispatch(resetSelectedLossItem());\n      dispatch(resetLossData());\n      dispatch(setClaimData({}));\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"\".concat(utils.string.t('claims.actions.registerNewLoss'), \" - \").concat(utils.app.getAppName(brand))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CustomizedDialog, {\n      parentRef: rootRef,\n      dialogOpen: fnolModalOpen,\n      modalTitle: utils.string.t('claims.modalStepperLabel.title'),\n      redirectUrl: redirectUrl,\n      isDirty: isAnyformDirty,\n      handlers: {\n        handleDialogClose: handleFnolModalClose,\n        handleCleanUp: handleCleanUp\n      },\n      children: /*#__PURE__*/_jsxDEV(ClaimsRegisterNewLoss, {\n        initialFormStatus: forms,\n        steps: forms.map(function (frm) {\n          return frm === null || frm === void 0 ? void 0 : frm.form;\n        }),\n        stepsForms: forms,\n        currentStep: currentStep,\n        launchFinishModal: launchFinishModal,\n        findDirtyForm: function findDirtyForm(forms) {\n          _findDirtyForm(forms);\n        },\n        lossProperties: (_location$state$loss = location === null || location === void 0 ? void 0 : (_location$state3 = location.state) === null || _location$state3 === void 0 ? void 0 : _location$state3.loss) !== null && _location$state$loss !== void 0 ? _location$state$loss : {},\n        claimProperties: (_location$state$linkP = location === null || location === void 0 ? void 0 : (_location$state4 = location.state) === null || _location$state4 === void 0 ? void 0 : _location$state4.linkPolicy) !== null && _location$state$linkP !== void 0 ? _location$state$linkP : {}\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }, this), fnolModalOpen && /*#__PURE__*/_jsxDEV(DrawerComponent, {\n      isDrawerOpen: true,\n      children: /*#__PURE__*/_jsxDEV(DmsFnolWidget, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n\n_s(ClaimsNewLoss, \"sEU14lPDxGdlEuUvESq6/AQd2rE=\", false, function () {\n  return [useLocation, useDispatch, useHistory, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ClaimsNewLoss;\n\nvar _c;\n\n$RefreshReg$(_c, \"ClaimsNewLoss\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/pages/ClaimsNewLoss/ClaimsNewLoss.js"],"names":["React","useState","useEffect","useRef","useDispatch","useSelector","useHistory","useLocation","Helmet","showModal","selectClaimsStepper","selectCatCodes","selectClaimsStatuses","selectPriorities","selectLossQualifiers","selectSettlementCurrency","selectReferralResponse","getCatCodes","getStatuses","getPriorityLevels","getLossQualifiers","getSettlementCurrency","getReferralResponse","submitClaimDetailsInformation","resetClaimsPolicies","resetLinkPolicies","resetClaimsDMSDocumentDetails","resetLossPolicyClaimData","resetSelectedLossItem","resetWidgetClaimsMetadata","resetLossData","setClaimData","setClaimsStepperControl","CustomizedDialog","DrawerComponent","ClaimsRegisterNewLoss","utils","config","DmsFnolWidget","ClaimsNewLoss","location","dispatch","history","rootRef","brand","state","ui","catCodes","priorities","lossQualifiers","claimsStatuses","settlementCurrency","referralResponse","currentStep","fnolModalOpen","setFnolModalOpen","isAnyformDirty","checkDirtyStatus","id","form","string","t","formEditedStatus","isSubmitted","forms","editFormStatus","redirectUrl","isNewLoss","launchFinishModal","component","props","title","fullWidth","maxWidth","componentProps","confirmLabel","cancelLabel","confirmMessage","submitHandler","successCallback","data","push","routes","claimsFNOL","root","handleClose","getAllReferentialData","generic","isInvalidOrEmptyArray","handleFnolModalClose","hint","handleCleanUp","findDirtyForm","map","some","app","getAppName","handleDialogClose","frm","loss","linkPolicy"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory, useLocation } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\n\r\n// app\r\nimport {\r\n  showModal,\r\n  selectClaimsStepper,\r\n  selectCatCodes,\r\n  selectClaimsStatuses,\r\n  selectPriorities,\r\n  selectLossQualifiers,\r\n  selectSettlementCurrency,\r\n  selectReferralResponse,\r\n  getCatCodes,\r\n  getStatuses,\r\n  getPriorityLevels,\r\n  getLossQualifiers,\r\n  getSettlementCurrency,\r\n  getReferralResponse,\r\n  submitClaimDetailsInformation,\r\n  resetClaimsPolicies,\r\n  resetLinkPolicies,\r\n  resetClaimsDMSDocumentDetails,\r\n  resetLossPolicyClaimData,\r\n  resetSelectedLossItem,\r\n  resetWidgetClaimsMetadata,\r\n  resetLossData,\r\n  setClaimData,\r\n  setClaimsStepperControl,\r\n} from 'stores';\r\nimport { CustomizedDialog, DrawerComponent } from 'components';\r\nimport { ClaimsRegisterNewLoss } from 'forms';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport { DmsFnolWidget } from 'modules';\r\n\r\nexport default function ClaimsNewLoss() {\r\n  const location = useLocation();\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const rootRef = useRef(null);\r\n\r\n  const brand = useSelector((state) => state.ui.brand);\r\n  const catCodes = useSelector(selectCatCodes);\r\n  const priorities = useSelector(selectPriorities);\r\n  const lossQualifiers = useSelector(selectLossQualifiers);\r\n  const claimsStatuses = useSelector(selectClaimsStatuses);\r\n  const settlementCurrency = useSelector(selectSettlementCurrency);\r\n  const referralResponse = useSelector(selectReferralResponse);\r\n  const currentStep = useSelector(selectClaimsStepper);\r\n\r\n  const [fnolModalOpen, setFnolModalOpen] = useState(false);\r\n  const [isAnyformDirty, checkDirtyStatus] = useState(false);\r\n\r\n  const [forms, editFormStatus] = useState([\r\n    { id: 0, form: utils.string.t('claims.modalStepperLabel.createLoss'), formEditedStatus: false, isSubmitted: false },\r\n    { id: 1, form: utils.string.t('claims.modalStepperLabel.linkPolicies'), formEditedStatus: false, isSubmitted: false },\r\n    { id: 2, form: utils.string.t('claims.modalStepperLabel.createClaim'), formEditedStatus: false, isSubmitted: false },\r\n    { id: 3, form: utils.string.t('claims.modalStepperLabel.manageDocuments'), formEditedStatus: false, isSubmitted: false },\r\n    { id: 4, form: utils.string.t('claims.modalStepperLabel.confirmation'), formEditedStatus: false, isSubmitted: false },\r\n  ]);\r\n\r\n  const redirectUrl = location?.state?.redirectUrl || '';\r\n  const isNewLoss = location?.state?.isNewLoss;\r\n\r\n  // On click of Finish button\r\n  const launchFinishModal = () => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          title: utils.string.t('claims.modals.confirmClaimSubmission.title'),\r\n          fullWidth: true,\r\n          maxWidth: 'sm',\r\n          componentProps: {\r\n            confirmLabel: utils.string.t('app.yes'),\r\n            cancelLabel: utils.string.t('app.no'),\r\n            confirmMessage: utils.string.t('claims.modals.confirmClaimSubmission.content'),\r\n            submitHandler: () => {\r\n              dispatch(\r\n                submitClaimDetailsInformation({\r\n                  successCallback: (data) => {\r\n                    if (typeof data === 'string') {\r\n                      dispatch(resetLossPolicyClaimData());\r\n                      history.push(redirectUrl || config.routes.claimsFNOL.root);\r\n                    }\r\n                  },\r\n                })\r\n              );\r\n            },\r\n            handleClose: () => {},\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const getAllReferentialData = () => {\r\n    if (utils.generic.isInvalidOrEmptyArray(catCodes)) {\r\n      dispatch(getCatCodes());\r\n    }\r\n    if (utils.generic.isInvalidOrEmptyArray(priorities)) {\r\n      dispatch(getPriorityLevels());\r\n    }\r\n    if (utils.generic.isInvalidOrEmptyArray(lossQualifiers)) {\r\n      dispatch(getLossQualifiers());\r\n    }\r\n    if (utils.generic.isInvalidOrEmptyArray(claimsStatuses)) {\r\n      dispatch(getStatuses());\r\n    }\r\n    if (utils.generic.isInvalidOrEmptyArray(settlementCurrency)) {\r\n      dispatch(getSettlementCurrency());\r\n    }\r\n    if (utils.generic.isInvalidOrEmptyArray(referralResponse)) {\r\n      dispatch(getReferralResponse());\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getAllReferentialData();\r\n    setFnolModalOpen(true);\r\n    return () => {\r\n      dispatch(setClaimsStepperControl(0));\r\n    };\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const handleFnolModalClose = () => {\r\n    if (isAnyformDirty) {\r\n      dispatch(\r\n        showModal({\r\n          component: 'CONFIRM',\r\n          props: {\r\n            title: utils.string.t('status.alert'),\r\n            hint: utils.string.t('navigation.title'),\r\n            fullWidth: true,\r\n            maxWidth: 'xs',\r\n            componentProps: {\r\n              cancelLabel: utils.string.t('app.no'),\r\n              confirmLabel: utils.string.t('app.yes'),\r\n              submitHandler: async () => {\r\n                setFnolModalOpen(false);\r\n                handleCleanUp();\r\n                history.push(redirectUrl || config.routes.claimsFNOL.root);\r\n              },\r\n            },\r\n          },\r\n        })\r\n      );\r\n    }\r\n  };\r\n\r\n  const findDirtyForm = (forms) => {\r\n    editFormStatus(forms?.map((form) => ({ ...form })));\r\n    checkDirtyStatus(forms.some((form) => form?.formEditedStatus === true));\r\n  };\r\n\r\n  const handleCleanUp = () => {\r\n    // if it's a new loss being registered, cleanup all the data\r\n    // it we're editing a loss or claim, we need to keep the data to redirect to the previous page/tab\r\n    if (isNewLoss) {\r\n      dispatch(resetLinkPolicies());\r\n      dispatch(resetClaimsDMSDocumentDetails());\r\n      dispatch(resetClaimsPolicies());\r\n      dispatch(resetLossPolicyClaimData());\r\n      dispatch(resetWidgetClaimsMetadata());\r\n      dispatch(resetSelectedLossItem());\r\n      dispatch(resetLossData());\r\n      dispatch(setClaimData({}));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{`${utils.string.t('claims.actions.registerNewLoss')} - ${utils.app.getAppName(brand)}`}</title>\r\n      </Helmet>\r\n      <CustomizedDialog\r\n        parentRef={rootRef}\r\n        dialogOpen={fnolModalOpen}\r\n        modalTitle={utils.string.t('claims.modalStepperLabel.title')}\r\n        redirectUrl={redirectUrl}\r\n        isDirty={isAnyformDirty}\r\n        handlers={{\r\n          handleDialogClose: handleFnolModalClose,\r\n          handleCleanUp: handleCleanUp,\r\n        }}\r\n      >\r\n        <ClaimsRegisterNewLoss\r\n          initialFormStatus={forms}\r\n          steps={forms.map((frm) => frm?.form)}\r\n          stepsForms={forms}\r\n          currentStep={currentStep}\r\n          launchFinishModal={launchFinishModal}\r\n          findDirtyForm={(forms) => {\r\n            findDirtyForm(forms);\r\n          }}\r\n          lossProperties={location?.state?.loss ?? {}}\r\n          claimProperties={location?.state?.linkPolicy ?? {}}\r\n        />\r\n      </CustomizedDialog>\r\n      {fnolModalOpen && (\r\n        <DrawerComponent isDrawerOpen>\r\n          <DmsFnolWidget />\r\n        </DrawerComponent>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}