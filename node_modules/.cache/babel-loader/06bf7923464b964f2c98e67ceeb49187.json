{"ast":null,"code":"import \"core-js/modules/es.array.find\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\forms\\\\PremiumTaxSignedLinesDocumentUpload\\\\PremiumTaxSignedLinesDocumentUpload.view.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport { useDispatch } from 'react-redux'; // app\n\nimport styles from './PremiumTaxSignedLinesDocumentUpload.styles';\nimport * as utils from 'utils';\nimport { showModal, hideModal } from 'stores';\nimport { FormFileDrop, FormGrid, FormFields, Button, TableHead, TableCell, FormText, FormHidden, FormContainer, FormActions, Warning, Overflow } from 'components'; // mui\n\nimport { makeStyles, Box, Table, TableBody, TableRow, Typography, Divider } from '@material-ui/core';\nimport HighlightOffIcon from '@material-ui/icons/HighlightOff';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nPremiumTaxSignedLinesDocumentUploadView.propTypes = {\n  riskRef: PropTypes.object.isRequired,\n  actions: PropTypes.array.isRequired,\n  warnings: PropTypes.object.isRequired,\n  fields: PropTypes.array.isRequired,\n  handlers: PropTypes.shape({\n    getFileKey: PropTypes.func.isRequired,\n    onFilesAdded: PropTypes.func.isRequired,\n    onFilesRemoved: PropTypes.func.isRequired\n  }).isRequired\n};\nexport function PremiumTaxSignedLinesDocumentUploadView(_ref) {\n  _s();\n\n  var _warnings$tooManyFile,\n      _this = this;\n\n  var riskRef = _ref.riskRef,\n      actions = _ref.actions,\n      warnings = _ref.warnings,\n      fields = _ref.fields,\n      handlers = _ref.handlers;\n  var classes = makeStyles(styles, {\n    name: 'AddManageSetting'\n  })();\n  var dispatch = useDispatch();\n  var defaultValues = utils.form.getInitialValues(fields);\n  var cancel = actions && actions.find(function (action) {\n    return action.name === 'cancel' && action.handler;\n  });\n  var submit = actions && actions.find(function (action) {\n    return action.name === 'submit' && action.handler;\n  });\n  var validationSchema = utils.form.getValidationSchema(fields);\n  var cols = [{\n    id: 'filename',\n    label: utils.string.t('app.filename')\n  }];\n  var hasTooManyFilesErrors = Boolean(warnings === null || warnings === void 0 ? void 0 : (_warnings$tooManyFile = warnings.tooManyFiles) === null || _warnings$tooManyFile === void 0 ? void 0 : _warnings$tooManyFile.message);\n  var hasWarnings = Boolean(Object.values(warnings).some(function (w) {\n    return w.message;\n  }));\n\n  var _useForm = useForm(_objectSpread({\n    defaultValues: defaultValues\n  }, validationSchema && {\n    resolver: yupResolver(validationSchema)\n  })),\n      control = _useForm.control,\n      reset = _useForm.reset,\n      errors = _useForm.errors,\n      handleSubmit = _useForm.handleSubmit,\n      formState = _useForm.formState;\n\n  var _useFieldArray = useFieldArray({\n    control: control,\n    name: 'files'\n  }),\n      fieldsArray = _useFieldArray.fields,\n      appendFieldArray = _useFieldArray.append,\n      removeFieldArray = _useFieldArray.remove;\n\n  var cancelModal = function cancelModal() {\n    if (utils.generic.isValidArray(fieldsArray, true)) {\n      dispatch(showModal({\n        component: 'CONFIRM',\n        props: {\n          fullWidth: true,\n          title: utils.string.t('app.confirmation'),\n          maxWidth: 'xs',\n          componentProps: {\n            confirmLabel: utils.string.t('app.ok'),\n            cancelLabel: utils.string.t('app.goBack'),\n            confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\n            buttonColors: {\n              confirm: 'secondary',\n              cancel: 'primary'\n            },\n            submitHandler: function submitHandler() {\n              dispatch(hideModal());\n            },\n            cancelHandler: function cancelHandler() {},\n            handleClose: function handleClose() {}\n          }\n        }\n      }));\n    } else {\n      dispatch(hideModal());\n    }\n  };\n\n  useEffect(function () {\n    reset(defaultValues);\n  }, [] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.root,\n    children: /*#__PURE__*/_jsxDEV(Overflow, {\n      children: /*#__PURE__*/_jsxDEV(FormContainer, {\n        onSubmit: handleSubmit(submit.handler),\n        nestedClasses: {\n          root: classes.margin0\n        },\n        children: [/*#__PURE__*/_jsxDEV(FormFields, {\n          nestedClasses: {\n            root: classes.padding_0_30\n          },\n          children: [/*#__PURE__*/_jsxDEV(FormGrid, {\n            item: true,\n            xs: 12,\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              my: 2,\n              children: /*#__PURE__*/_jsxDEV(FormFileDrop, _objectSpread(_objectSpread({}, utils.form.getFieldProps(fields, 'filesUpload')), {}, {\n                onChange: function onChange(files, rejectedFiles) {\n                  var hasDuplicates = false;\n                  var uniqueFiles = files.reduce(function (acc, cur) {\n                    var isDuplicate = fieldsArray.find(function (f) {\n                      return handlers.getFileKey(f.file) === handlers.getFileKey(cur);\n                    });\n\n                    if (isDuplicate) {\n                      hasDuplicates = true;\n                    }\n\n                    return isDuplicate ? acc : [].concat(_toConsumableArray(acc), [cur]);\n                  }, []).map(function (f) {\n                    return {\n                      file: f,\n                      name: f.name,\n                      type: null\n                    };\n                  });\n                  handlers.onFilesAdded([].concat(_toConsumableArray(fieldsArray), _toConsumableArray(uniqueFiles)), rejectedFiles, hasDuplicates);\n\n                  if (utils.generic.isValidArray(uniqueFiles, true)) {\n                    appendFieldArray(uniqueFiles);\n                  }\n                }\n              }), void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FormGrid, {\n            item: true,\n            xs: 12,\n            children: [hasWarnings && /*#__PURE__*/_jsxDEV(FormGrid, {\n              item: true,\n              xs: 12,\n              children: /*#__PURE__*/_jsxDEV(Box, {\n                mb: -3,\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                flexDirection: \"column\",\n                children: Object.entries(warnings).filter(function (_ref2) {\n                  var _ref3 = _slicedToArray(_ref2, 2),\n                      type = _ref3[0],\n                      obj = _ref3[1];\n\n                  return Boolean(obj.message);\n                }).map(function (_ref4) {\n                  var _ref5 = _slicedToArray(_ref4, 2),\n                      type = _ref5[0],\n                      obj = _ref5[1];\n\n                  return /*#__PURE__*/_jsxDEV(Box, {\n                    mb: 1,\n                    children: /*#__PURE__*/_jsxDEV(Warning, {\n                      icon: true,\n                      border: true,\n                      type: obj.type,\n                      text: obj.message\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 141,\n                      columnNumber: 29\n                    }, _this)\n                  }, type, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 140,\n                    columnNumber: 27\n                  }, _this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 17\n            }, this), utils.generic.isValidArray(fieldsArray, true) && /*#__PURE__*/_jsxDEV(Box, {\n              children: [/*#__PURE__*/_jsxDEV(Typography, {\n                className: classes.subTitle,\n                children: utils.string.t('processingInstructions.manageDocuments.documentsAddedGxbForRiskRef', {\n                  riskRefId: riskRef.riskRefId\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classes.enableScroll,\n                children: /*#__PURE__*/_jsxDEV(Table, {\n                  children: [/*#__PURE__*/_jsxDEV(TableHead, {\n                    columns: cols\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 157,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n                    children: fieldsArray.map(function (_ref6, index) {\n                      var file = _ref6.file,\n                          name = _ref6.name,\n                          type = _ref6.type;\n                      return /*#__PURE__*/_jsxDEV(TableRow, {\n                        children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                          compact: true,\n                          children: [/*#__PURE__*/_jsxDEV(FormText, {\n                            control: control,\n                            type: \"text\",\n                            name: \"files.\".concat(index, \".name\"),\n                            defaultValue: name,\n                            muiComponentProps: {\n                              size: 'small',\n                              classes: {\n                                root: classes.filenameRoot\n                              },\n                              InputProps: {\n                                readOnly: true,\n                                disabled: true,\n                                classes: {\n                                  root: classes.filenameBase,\n                                  input: classes.filenameInput\n                                }\n                              }\n                            },\n                            errors: errors\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 163,\n                            columnNumber: 33\n                          }, _this), /*#__PURE__*/_jsxDEV(FormHidden, {\n                            type: \"hidden\",\n                            control: control,\n                            name: \"files.\".concat(index, \".file\"),\n                            defaultValue: file\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 179,\n                            columnNumber: 33\n                          }, _this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 162,\n                          columnNumber: 31\n                        }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                          menu: true,\n                          children: /*#__PURE__*/_jsxDEV(Button, {\n                            icon: HighlightOffIcon,\n                            variant: \"text\",\n                            danger: true,\n                            size: \"small\",\n                            onClick: function onClick() {\n                              var updatedFilesArray = fieldsArray.filter(function (file, fileIndex) {\n                                return fileIndex !== index;\n                              });\n                              handlers.onFilesRemoved(updatedFilesArray);\n                              removeFieldArray(index);\n                            }\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 182,\n                            columnNumber: 33\n                          }, _this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 181,\n                          columnNumber: 31\n                        }, _this)]\n                      }, handlers.getFileKey(file), true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 161,\n                        columnNumber: 29\n                      }, _this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormActions, {\n          type: \"dialog\",\n          children: [cancel && /*#__PURE__*/_jsxDEV(Button, {\n            text: cancel.label,\n            variant: \"text\",\n            disabled: formState.isSubmitting,\n            onClick: function onClick() {\n              cancelModal();\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 15\n          }, this), submit && /*#__PURE__*/_jsxDEV(Button, {\n            text: submit.label,\n            type: \"submit\",\n            disabled: fieldsArray.length === 0 || formState.isSubmitting || hasTooManyFilesErrors,\n            color: \"primary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PremiumTaxSignedLinesDocumentUploadView, \"8yVB1PDYlXW2Z+VdyFEZPdcaP60=\", false, function () {\n  return [useDispatch, useForm, useFieldArray];\n});\n\n_c = PremiumTaxSignedLinesDocumentUploadView;\nPremiumTaxSignedLinesDocumentUploadView.displayName = \"PremiumTaxSignedLinesDocumentUploadView\";\nPremiumTaxSignedLinesDocumentUploadView.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [],\n  \"displayName\": \"PremiumTaxSignedLinesDocumentUploadView\",\n  \"props\": {\n    \"riskRef\": {\n      \"type\": {\n        \"name\": \"object\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"actions\": {\n      \"type\": {\n        \"name\": \"array\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"warnings\": {\n      \"type\": {\n        \"name\": \"object\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"fields\": {\n      \"type\": {\n        \"name\": \"array\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"handlers\": {\n      \"type\": {\n        \"name\": \"shape\",\n        \"value\": {\n          \"getFileKey\": {\n            \"name\": \"func\",\n            \"required\": true\n          },\n          \"onFilesAdded\": {\n            \"name\": \"func\",\n            \"required\": true\n          },\n          \"onFilesRemoved\": {\n            \"name\": \"func\",\n            \"required\": true\n          }\n        }\n      },\n      \"required\": true,\n      \"description\": \"\"\n    }\n  }\n};\n\nif (typeof STORYBOOK_REACT_CLASSES !== \"undefined\") {\n  STORYBOOK_REACT_CLASSES[\"src\\\\forms\\\\PremiumTaxSignedLinesDocumentUpload\\\\PremiumTaxSignedLinesDocumentUpload.view.js\"] = {\n    name: \"PremiumTaxSignedLinesDocumentUploadView\",\n    docgenInfo: PremiumTaxSignedLinesDocumentUploadView.__docgenInfo,\n    path: \"src\\\\forms\\\\PremiumTaxSignedLinesDocumentUpload\\\\PremiumTaxSignedLinesDocumentUpload.view.js\"\n  };\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"PremiumTaxSignedLinesDocumentUploadView\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/forms/PremiumTaxSignedLinesDocumentUpload/PremiumTaxSignedLinesDocumentUpload.view.js"],"names":["React","useEffect","PropTypes","useForm","useFieldArray","yupResolver","useDispatch","styles","utils","showModal","hideModal","FormFileDrop","FormGrid","FormFields","Button","TableHead","TableCell","FormText","FormHidden","FormContainer","FormActions","Warning","Overflow","makeStyles","Box","Table","TableBody","TableRow","Typography","Divider","HighlightOffIcon","PremiumTaxSignedLinesDocumentUploadView","propTypes","riskRef","object","isRequired","actions","array","warnings","fields","handlers","shape","getFileKey","func","onFilesAdded","onFilesRemoved","classes","name","dispatch","defaultValues","form","getInitialValues","cancel","find","action","handler","submit","validationSchema","getValidationSchema","cols","id","label","string","t","hasTooManyFilesErrors","Boolean","tooManyFiles","message","hasWarnings","Object","values","some","w","resolver","control","reset","errors","handleSubmit","formState","fieldsArray","appendFieldArray","append","removeFieldArray","remove","cancelModal","generic","isValidArray","component","props","fullWidth","title","maxWidth","componentProps","confirmLabel","cancelLabel","confirmMessage","buttonColors","confirm","submitHandler","cancelHandler","handleClose","root","margin0","padding_0_30","getFieldProps","files","rejectedFiles","hasDuplicates","uniqueFiles","reduce","acc","cur","isDuplicate","f","file","map","type","entries","filter","obj","subTitle","riskRefId","enableScroll","index","size","filenameRoot","InputProps","readOnly","disabled","filenameBase","input","filenameInput","updatedFilesArray","fileIndex","isSubmitting","length"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useForm, useFieldArray } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport { useDispatch } from 'react-redux';\r\n\r\n// app\r\nimport styles from './PremiumTaxSignedLinesDocumentUpload.styles';\r\nimport * as utils from 'utils';\r\nimport { showModal, hideModal } from 'stores';\r\nimport {\r\n  FormFileDrop,\r\n  FormGrid,\r\n  FormFields,\r\n  Button,\r\n  TableHead,\r\n  TableCell,\r\n  FormText,\r\n  FormHidden,\r\n  FormContainer,\r\n  FormActions,\r\n  Warning,\r\n  Overflow,\r\n} from 'components';\r\n\r\n// mui\r\nimport { makeStyles, Box, Table, TableBody, TableRow, Typography, Divider } from '@material-ui/core';\r\nimport HighlightOffIcon from '@material-ui/icons/HighlightOff';\r\n\r\nPremiumTaxSignedLinesDocumentUploadView.propTypes = {\r\n  riskRef: PropTypes.object.isRequired,\r\n  actions: PropTypes.array.isRequired,\r\n  warnings: PropTypes.object.isRequired,\r\n  fields: PropTypes.array.isRequired,\r\n  handlers: PropTypes.shape({\r\n    getFileKey: PropTypes.func.isRequired,\r\n    onFilesAdded: PropTypes.func.isRequired,\r\n    onFilesRemoved: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nexport function PremiumTaxSignedLinesDocumentUploadView({ riskRef, actions, warnings, fields, handlers }) {\r\n  const classes = makeStyles(styles, { name: 'AddManageSetting' })();\r\n  const dispatch = useDispatch();\r\n  const defaultValues = utils.form.getInitialValues(fields);\r\n  const cancel = actions && actions.find((action) => action.name === 'cancel' && action.handler);\r\n  const submit = actions && actions.find((action) => action.name === 'submit' && action.handler);\r\n  const validationSchema = utils.form.getValidationSchema(fields);\r\n  const cols = [{ id: 'filename', label: utils.string.t('app.filename') }];\r\n  const hasTooManyFilesErrors = Boolean(warnings?.tooManyFiles?.message);\r\n  const hasWarnings = Boolean(Object.values(warnings).some((w) => w.message));\r\n  const { control, reset, errors, handleSubmit, formState } = useForm({\r\n    defaultValues,\r\n    ...(validationSchema && { resolver: yupResolver(validationSchema) }),\r\n  });\r\n\r\n  const {\r\n    fields: fieldsArray,\r\n    append: appendFieldArray,\r\n    remove: removeFieldArray,\r\n  } = useFieldArray({\r\n    control,\r\n    name: 'files',\r\n  });\r\n\r\n  const cancelModal = () => {\r\n    if (utils.generic.isValidArray(fieldsArray, true)) {\r\n      dispatch(\r\n        showModal({\r\n          component: 'CONFIRM',\r\n          props: {\r\n            fullWidth: true,\r\n            title: utils.string.t('app.confirmation'),\r\n            maxWidth: 'xs',\r\n            componentProps: {\r\n              confirmLabel: utils.string.t('app.ok'),\r\n              cancelLabel: utils.string.t('app.goBack'),\r\n              confirmMessage: utils.string.t('processingInstructions.documentsWillNotBeSaved'),\r\n              buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n              submitHandler: () => {\r\n                dispatch(hideModal());\r\n              },\r\n              cancelHandler: () => {},\r\n              handleClose: () => {},\r\n            },\r\n          },\r\n        })\r\n      );\r\n    } else {\r\n      dispatch(hideModal());\r\n    }\r\n  };\r\n\r\n  useEffect(\r\n    () => {\r\n      reset(defaultValues);\r\n    },\r\n    [] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Overflow>\r\n        <FormContainer onSubmit={handleSubmit(submit.handler)} nestedClasses={{ root: classes.margin0 }}>\r\n          <FormFields nestedClasses={{ root: classes.padding_0_30 }}>\r\n            <FormGrid item xs={12}>\r\n              <Box my={2}>\r\n                <FormFileDrop\r\n                  {...utils.form.getFieldProps(fields, 'filesUpload')}\r\n                  onChange={(files, rejectedFiles) => {\r\n                    let hasDuplicates = false;\r\n\r\n                    const uniqueFiles = files\r\n                      .reduce((acc, cur) => {\r\n                        const isDuplicate = fieldsArray.find((f) => {\r\n                          return handlers.getFileKey(f.file) === handlers.getFileKey(cur);\r\n                        });\r\n                        if (isDuplicate) {\r\n                          hasDuplicates = true;\r\n                        }\r\n                        return isDuplicate ? acc : [...acc, cur];\r\n                      }, [])\r\n                      .map((f) => ({ file: f, name: f.name, type: null }));\r\n                    handlers.onFilesAdded([...fieldsArray, ...uniqueFiles], rejectedFiles, hasDuplicates);\r\n                    if (utils.generic.isValidArray(uniqueFiles, true)) {\r\n                      appendFieldArray(uniqueFiles);\r\n                    }\r\n                  }}\r\n                />\r\n              </Box>\r\n            </FormGrid>\r\n            <FormGrid item xs={12}>\r\n              {hasWarnings && (\r\n                <FormGrid item xs={12}>\r\n                  <Box mb={-3} display=\"flex\" justifyContent=\"center\" alignItems=\"center\" flexDirection=\"column\">\r\n                    {Object.entries(warnings)\r\n                      .filter(([type, obj]) => Boolean(obj.message))\r\n                      .map(([type, obj]) => {\r\n                        return (\r\n                          <Box key={type} mb={1}>\r\n                            <Warning icon border type={obj.type} text={obj.message} />\r\n                          </Box>\r\n                        );\r\n                      })}\r\n                  </Box>\r\n                </FormGrid>\r\n              )}\r\n\r\n              {utils.generic.isValidArray(fieldsArray, true) && (\r\n                <Box>\r\n                  <Typography className={classes.subTitle}>\r\n                    {utils.string.t('processingInstructions.manageDocuments.documentsAddedGxbForRiskRef', { riskRefId: riskRef.riskRefId })}\r\n                  </Typography>\r\n                  <Divider />\r\n                  <div className={classes.enableScroll}>\r\n                    <Table>\r\n                      <TableHead columns={cols} />\r\n                      <TableBody>\r\n                        {fieldsArray.map(({ file, name, type }, index) => {\r\n                          return (\r\n                            <TableRow key={handlers.getFileKey(file)}>\r\n                              <TableCell compact>\r\n                                <FormText\r\n                                  control={control}\r\n                                  type=\"text\"\r\n                                  name={`files.${index}.name`}\r\n                                  defaultValue={name}\r\n                                  muiComponentProps={{\r\n                                    size: 'small',\r\n                                    classes: { root: classes.filenameRoot },\r\n                                    InputProps: {\r\n                                      readOnly: true,\r\n                                      disabled: true,\r\n                                      classes: { root: classes.filenameBase, input: classes.filenameInput },\r\n                                    },\r\n                                  }}\r\n                                  errors={errors}\r\n                                />\r\n                                <FormHidden type=\"hidden\" control={control} name={`files.${index}.file`} defaultValue={file} />\r\n                              </TableCell>\r\n                              <TableCell menu>\r\n                                <Button\r\n                                  icon={HighlightOffIcon}\r\n                                  variant=\"text\"\r\n                                  danger\r\n                                  size=\"small\"\r\n                                  onClick={() => {\r\n                                    const updatedFilesArray = fieldsArray.filter((file, fileIndex) => {\r\n                                      return fileIndex !== index;\r\n                                    });\r\n                                    handlers.onFilesRemoved(updatedFilesArray);\r\n                                    removeFieldArray(index);\r\n                                  }}\r\n                                />\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          );\r\n                        })}\r\n                      </TableBody>\r\n                    </Table>\r\n                  </div>\r\n                </Box>\r\n              )}\r\n            </FormGrid>\r\n          </FormFields>\r\n          <FormActions type=\"dialog\">\r\n            {cancel && (\r\n              <Button\r\n                text={cancel.label}\r\n                variant=\"text\"\r\n                disabled={formState.isSubmitting}\r\n                onClick={() => {\r\n                  cancelModal();\r\n                }}\r\n              />\r\n            )}\r\n            {submit && (\r\n              <Button\r\n                text={submit.label}\r\n                type=\"submit\"\r\n                disabled={fieldsArray.length === 0 || formState.isSubmitting || hasTooManyFilesErrors}\r\n                color=\"primary\"\r\n              />\r\n            )}\r\n          </FormActions>\r\n        </FormContainer>\r\n      </Overflow>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}