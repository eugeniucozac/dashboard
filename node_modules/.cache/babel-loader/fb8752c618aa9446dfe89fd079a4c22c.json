{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport get from 'lodash/get';\nimport flatten from 'lodash/flatten';\nimport uniq from 'lodash/uniq'; // app\n\nimport config from 'config';\nimport * as utils from 'utils';\nimport { authLogout } from 'stores';\nvar departmentKeys = Object.keys(config.slipcase.mappings);\n\nvar getIds = function getIds(topics) {\n  var selectedSlipcaseTopics = topics.filter(function (topic) {\n    return !departmentKeys.includes(topic.value.toString());\n  }).map(function (topic) {\n    return topic.slipcaseId;\n  });\n  var derivedTopics = flatten(topics.map(function (department) {\n    return config.slipcase.mappings[department.value];\n  })).filter(function (topic) {\n    return !!topic;\n  });\n  return uniq([].concat(_toConsumableArray(selectedSlipcaseTopics), _toConsumableArray(derivedTopics)));\n};\n\nexport var getArticles = function getArticles(params) {\n  return function (dispatch, getState) {\n    dispatch(getArticlesRequest());\n    var state = getState(); // prettier-ignore\n\n    var endpoint = state.config.vars.endpoint;\n    var paramsLimit = params && params.size !== undefined ? params.size : get(state, 'articles.list.pageSize');\n    var paramsOffset = params && params.page !== undefined ? params.page : get(state, 'articles.list.page');\n    var paramsIncludeTopics = params && params.selectedTopics || get(state, 'articles.list.topics');\n    return utils.api.get({\n      endpoint: endpoint.slipcase,\n      path: 'api/v1/feed/',\n      headers: false,\n      params: _objectSpread({\n        apiKey: config.slipcase.apiKey,\n        output: 'json',\n        includePaywalled: 1,\n        limit: paramsLimit,\n        offset: paramsOffset * paramsLimit\n      }, paramsIncludeTopics.length && {\n        includeTopics: getIds(paramsIncludeTopics)\n      })\n    }).then(function (response) {\n      return utils.api.handleResponse(response);\n    }).then(function (data) {\n      dispatch(getArticlesSuccess({\n        items: data,\n        page: paramsOffset,\n        pageSize: paramsLimit\n      }));\n    }).catch(function (err) {\n      var errorParams = {\n        file: 'stores/articles.actions.get',\n        message: 'API fetch error (articles.get)'\n      };\n      utils.api.handleError(err, errorParams);\n      utils.api.handleUnauthorized(err, dispatch, authLogout);\n      dispatch(getArticlesFailure(err));\n      return err;\n    });\n  };\n};\nexport var getArticlesRequest = function getArticlesRequest() {\n  return {\n    type: 'ARTICLES_GET_REQUEST'\n  };\n};\nexport var getArticlesSuccess = function getArticlesSuccess(payload) {\n  return {\n    type: 'ARTICLES_GET_SUCCESS',\n    payload: payload\n  };\n};\nexport var getArticlesFailure = function getArticlesFailure(error) {\n  return {\n    type: 'ARTICLES_GET_FAILURE',\n    payload: error\n  };\n};","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/stores/articles/articles.actions.get.js"],"names":["get","flatten","uniq","config","utils","authLogout","departmentKeys","Object","keys","slipcase","mappings","getIds","topics","selectedSlipcaseTopics","filter","topic","includes","value","toString","map","slipcaseId","derivedTopics","department","getArticles","params","dispatch","getState","getArticlesRequest","state","endpoint","vars","paramsLimit","size","undefined","paramsOffset","page","paramsIncludeTopics","selectedTopics","api","path","headers","apiKey","output","includePaywalled","limit","offset","length","includeTopics","then","response","handleResponse","data","getArticlesSuccess","items","pageSize","catch","err","errorParams","file","message","handleError","handleUnauthorized","getArticlesFailure","type","payload","error"],"mappings":";;AAAA,OAAOA,GAAP,MAAgB,YAAhB;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,OAAOC,IAAP,MAAiB,aAAjB,C,CAEA;;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,UAAT,QAA2B,QAA3B;AAEA,IAAMC,cAAc,GAAGC,MAAM,CAACC,IAAP,CAAYL,MAAM,CAACM,QAAP,CAAgBC,QAA5B,CAAvB;;AAEA,IAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,MAAD,EAAY;AACzB,MAAMC,sBAAsB,GAAGD,MAAM,CAClCE,MAD4B,CACrB,UAACC,KAAD;AAAA,WAAW,CAACT,cAAc,CAACU,QAAf,CAAwBD,KAAK,CAACE,KAAN,CAAYC,QAAZ,EAAxB,CAAZ;AAAA,GADqB,EAE5BC,GAF4B,CAExB,UAACJ,KAAD;AAAA,WAAWA,KAAK,CAACK,UAAjB;AAAA,GAFwB,CAA/B;AAGA,MAAMC,aAAa,GAAGpB,OAAO,CAACW,MAAM,CAACO,GAAP,CAAW,UAACG,UAAD;AAAA,WAAgBnB,MAAM,CAACM,QAAP,CAAgBC,QAAhB,CAAyBY,UAAU,CAACL,KAApC,CAAhB;AAAA,GAAX,CAAD,CAAP,CAAgFH,MAAhF,CAAuF,UAACC,KAAD;AAAA,WAAW,CAAC,CAACA,KAAb;AAAA,GAAvF,CAAtB;AACA,SAAOb,IAAI,8BAAKW,sBAAL,sBAAgCQ,aAAhC,GAAX;AACD,CAND;;AAQA,OAAO,IAAME,WAAW,GAAG,SAAdA,WAAc,CAACC,MAAD;AAAA,SAAY,UAACC,QAAD,EAAWC,QAAX,EAAwB;AAC7DD,IAAAA,QAAQ,CAACE,kBAAkB,EAAnB,CAAR;AAEA,QAAMC,KAAK,GAAGF,QAAQ,EAAtB,CAH6D,CAI7D;;AAJ6D,QAKnCG,QALmC,GAKpBD,KALoB,CAKrDzB,MALqD,CAK3C2B,IAL2C,CAKnCD,QALmC;AAM7D,QAAME,WAAW,GAAGP,MAAM,IAAIA,MAAM,CAACQ,IAAP,KAAgBC,SAA1B,GAAsCT,MAAM,CAACQ,IAA7C,GAAoDhC,GAAG,CAAC4B,KAAD,EAAQ,wBAAR,CAA3E;AACA,QAAMM,YAAY,GAAGV,MAAM,IAAIA,MAAM,CAACW,IAAP,KAAgBF,SAA1B,GAAsCT,MAAM,CAACW,IAA7C,GAAoDnC,GAAG,CAAC4B,KAAD,EAAQ,oBAAR,CAA5E;AACA,QAAMQ,mBAAmB,GAAIZ,MAAM,IAAIA,MAAM,CAACa,cAAlB,IAAqCrC,GAAG,CAAC4B,KAAD,EAAQ,sBAAR,CAApE;AAEA,WAAOxB,KAAK,CAACkC,GAAN,CACJtC,GADI,CACA;AACH6B,MAAAA,QAAQ,EAAEA,QAAQ,CAACpB,QADhB;AAEH8B,MAAAA,IAAI,EAAE,cAFH;AAGHC,MAAAA,OAAO,EAAE,KAHN;AAIHhB,MAAAA,MAAM;AACJiB,QAAAA,MAAM,EAAEtC,MAAM,CAACM,QAAP,CAAgBgC,MADpB;AAEJC,QAAAA,MAAM,EAAE,MAFJ;AAGJC,QAAAA,gBAAgB,EAAE,CAHd;AAIJC,QAAAA,KAAK,EAAEb,WAJH;AAKJc,QAAAA,MAAM,EAAEX,YAAY,GAAGH;AALnB,SAMAK,mBAAmB,CAACU,MAApB,IAA8B;AAAEC,QAAAA,aAAa,EAAEpC,MAAM,CAACyB,mBAAD;AAAvB,OAN9B;AAJH,KADA,EAcJY,IAdI,CAcC,UAACC,QAAD;AAAA,aAAc7C,KAAK,CAACkC,GAAN,CAAUY,cAAV,CAAyBD,QAAzB,CAAd;AAAA,KAdD,EAeJD,IAfI,CAeC,UAACG,IAAD,EAAU;AACd1B,MAAAA,QAAQ,CACN2B,kBAAkB,CAAC;AACjBC,QAAAA,KAAK,EAAEF,IADU;AAEjBhB,QAAAA,IAAI,EAAED,YAFW;AAGjBoB,QAAAA,QAAQ,EAAEvB;AAHO,OAAD,CADZ,CAAR;AAOD,KAvBI,EAwBJwB,KAxBI,CAwBE,UAACC,GAAD,EAAS;AACd,UAAMC,WAAW,GAAG;AAClBC,QAAAA,IAAI,EAAE,6BADY;AAElBC,QAAAA,OAAO,EAAE;AAFS,OAApB;AAKAvD,MAAAA,KAAK,CAACkC,GAAN,CAAUsB,WAAV,CAAsBJ,GAAtB,EAA2BC,WAA3B;AACArD,MAAAA,KAAK,CAACkC,GAAN,CAAUuB,kBAAV,CAA6BL,GAA7B,EAAkC/B,QAAlC,EAA4CpB,UAA5C;AACAoB,MAAAA,QAAQ,CAACqC,kBAAkB,CAACN,GAAD,CAAnB,CAAR;AACA,aAAOA,GAAP;AACD,KAlCI,CAAP;AAmCD,GA7C0B;AAAA,CAApB;AA+CP,OAAO,IAAM7B,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;AACtC,SAAO;AACLoC,IAAAA,IAAI,EAAE;AADD,GAAP;AAGD,CAJM;AAMP,OAAO,IAAMX,kBAAkB,GAAG,SAArBA,kBAAqB,CAACY,OAAD,EAAa;AAC7C,SAAO;AACLD,IAAAA,IAAI,EAAE,sBADD;AAELC,IAAAA,OAAO,EAAPA;AAFK,GAAP;AAID,CALM;AAOP,OAAO,IAAMF,kBAAkB,GAAG,SAArBA,kBAAqB,CAACG,KAAD,EAAW;AAC3C,SAAO;AACLF,IAAAA,IAAI,EAAE,sBADD;AAELC,IAAAA,OAAO,EAAEC;AAFJ,GAAP;AAID,CALM","sourcesContent":["import get from 'lodash/get';\r\nimport flatten from 'lodash/flatten';\r\nimport uniq from 'lodash/uniq';\r\n\r\n// app\r\nimport config from 'config';\r\nimport * as utils from 'utils';\r\nimport { authLogout } from 'stores';\r\n\r\nconst departmentKeys = Object.keys(config.slipcase.mappings);\r\n\r\nconst getIds = (topics) => {\r\n  const selectedSlipcaseTopics = topics\r\n    .filter((topic) => !departmentKeys.includes(topic.value.toString()))\r\n    .map((topic) => topic.slipcaseId);\r\n  const derivedTopics = flatten(topics.map((department) => config.slipcase.mappings[department.value])).filter((topic) => !!topic);\r\n  return uniq([...selectedSlipcaseTopics, ...derivedTopics]);\r\n};\r\n\r\nexport const getArticles = (params) => (dispatch, getState) => {\r\n  dispatch(getArticlesRequest());\r\n\r\n  const state = getState();\r\n  // prettier-ignore\r\n  const { config: { vars: { endpoint }}} = state;\r\n  const paramsLimit = params && params.size !== undefined ? params.size : get(state, 'articles.list.pageSize');\r\n  const paramsOffset = params && params.page !== undefined ? params.page : get(state, 'articles.list.page');\r\n  const paramsIncludeTopics = (params && params.selectedTopics) || get(state, 'articles.list.topics');\r\n\r\n  return utils.api\r\n    .get({\r\n      endpoint: endpoint.slipcase,\r\n      path: 'api/v1/feed/',\r\n      headers: false,\r\n      params: {\r\n        apiKey: config.slipcase.apiKey,\r\n        output: 'json',\r\n        includePaywalled: 1,\r\n        limit: paramsLimit,\r\n        offset: paramsOffset * paramsLimit,\r\n        ...(paramsIncludeTopics.length && { includeTopics: getIds(paramsIncludeTopics) }),\r\n      },\r\n    })\r\n    .then((response) => utils.api.handleResponse(response))\r\n    .then((data) => {\r\n      dispatch(\r\n        getArticlesSuccess({\r\n          items: data,\r\n          page: paramsOffset,\r\n          pageSize: paramsLimit,\r\n        })\r\n      );\r\n    })\r\n    .catch((err) => {\r\n      const errorParams = {\r\n        file: 'stores/articles.actions.get',\r\n        message: 'API fetch error (articles.get)',\r\n      };\r\n\r\n      utils.api.handleError(err, errorParams);\r\n      utils.api.handleUnauthorized(err, dispatch, authLogout);\r\n      dispatch(getArticlesFailure(err));\r\n      return err;\r\n    });\r\n};\r\n\r\nexport const getArticlesRequest = () => {\r\n  return {\r\n    type: 'ARTICLES_GET_REQUEST',\r\n  };\r\n};\r\n\r\nexport const getArticlesSuccess = (payload) => {\r\n  return {\r\n    type: 'ARTICLES_GET_SUCCESS',\r\n    payload,\r\n  };\r\n};\r\n\r\nexport const getArticlesFailure = (error) => {\r\n  return {\r\n    type: 'ARTICLES_GET_FAILURE',\r\n    payload: error,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}