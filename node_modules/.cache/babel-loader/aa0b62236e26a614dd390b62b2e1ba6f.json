{"ast":null,"code":"import _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\forms\\\\DmsUploadFiles\\\\DmsUploadFiles.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux'; // app\n\nimport { DmsUploadFilesView } from './DmsUploadFiles.view';\nimport { hideModal, getDmsMetaData, selectRefDataNewDocumentTypesByContextSource, selectRefDataNewDocumentTypeLookUpByContextSource, selectDmsMetaData, selectorDmsViewFiles, selectSettlementCurrency, removeLoader, postDmsDocuments, uploadClientSideDmsDocuments, selectDmsClientSideUploadFiles, selectUser } from 'stores';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nDmsUploadFiles.propTypes = {\n  files: PropTypes.array.isRequired,\n  context: PropTypes.string.isRequired,\n  referenceId: PropTypes.string.isRequired,\n  sourceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  documentTypeKey: PropTypes.oneOf(Object.values(constants.DMS_DOCUMENT_TYPE_SECTION_KEYS)),\n  postDmsDocumentsSuccess: PropTypes.func,\n  onClosingUploadModal: PropTypes.func,\n  isClientSideUpload: PropTypes.bool\n};\nDmsUploadFiles.defaultProps = {\n  documentTypeKey: constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy,\n  postDmsDocumentsSuccess: function postDmsDocumentsSuccess() {},\n  onClosingUploadModal: function onClosingUploadModal() {}\n};\nexport default function DmsUploadFiles(_ref) {\n  _s();\n\n  var files = _ref.files,\n      context = _ref.context,\n      referenceId = _ref.referenceId,\n      sourceId = _ref.sourceId,\n      documentTypeKey = _ref.documentTypeKey,\n      postDmsDocumentsSuccess = _ref.postDmsDocumentsSuccess,\n      onClosingUploadModal = _ref.onClosingUploadModal,\n      isClientSideUpload = _ref.isClientSideUpload;\n  var dispatch = useDispatch();\n  var filesLiteVersion = utils.dms.trimFileProperties(files);\n  var isDmsFromPi = utils.dmsFormatter.isDmsFromPi(documentTypeKey);\n  var showFolderFilter = !(isDmsFromPi || documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy); // redux\n\n  var selectCurrencies = useSelector(selectSettlementCurrency);\n  var documentMetaData = useSelector(selectDmsMetaData);\n  var previousUploadedFiles = useSelector(selectorDmsViewFiles);\n  var clientUploadedFiles = useSelector(selectDmsClientSideUploadFiles);\n  var xbInstanceId = sourceId ? sourceId : constants.DMS_CLAIM_SOURCE_ID;\n  var user = useSelector(selectUser);\n\n  var _utils$dmsFormatter$g = utils.dmsFormatter.getDocumentTypeFilterKeys(context, xbInstanceId, documentTypeKey),\n      dmsSectionKey = _utils$dmsFormatter$g.dmsSectionKey,\n      selectedSourceId = _utils$dmsFormatter$g.dmsSourceId,\n      documentTypeSource = _utils$dmsFormatter$g.dmsDocTypeSource;\n\n  var documentTypesBeforeFilter = useSelector(dmsSectionKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy ? selectRefDataNewDocumentTypeLookUpByContextSource(dmsSectionKey, selectedSourceId) : selectRefDataNewDocumentTypesByContextSource(dmsSectionKey, selectedSourceId, documentTypeSource));\n\n  var _ref2 = isDmsFromPi && utils.dmsFormatter.getDocumentTypeInfo(documentTypeKey, selectedSourceId),\n      documentTypeDescription = _ref2.documentTypeDescription,\n      sectionKey = _ref2.sectionKey,\n      dmsSourceID = _ref2.dmsSourceID;\n\n  var documentTypesAfterFilter = (context === constants.DMS_CONTEXT_POLICY || context === constants.DMS_CONTEXT_PROCESSING_INSTRUCTION) && isDmsFromPi ? documentTypesBeforeFilter === null || documentTypesBeforeFilter === void 0 ? void 0 : documentTypesBeforeFilter.filter(function (type) {\n    return type.documentTypeDescription === documentTypeDescription && type.sectionKey === sectionKey && type.sourceID === dmsSourceID;\n  }) : documentTypesBeforeFilter; // state\n\n  var _useState = useState(filesLiteVersion),\n      _useState2 = _slicedToArray(_useState, 2),\n      activeFiles = _useState2[0],\n      setActiveFiles = _useState2[1];\n\n  var _useState3 = useState(documentTypesAfterFilter),\n      _useState4 = _slicedToArray(_useState3, 2),\n      refinedDocTypes = _useState4[0],\n      setRefinedDocTypes = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isMetaDataLoaded = _useState6[0],\n      setIsMetaDataLoaded = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      showDocTypeRequired = _useState8[0],\n      setShowDocTypeRequired = _useState8[1];\n\n  var _useState9 = useState(true),\n      _useState10 = _slicedToArray(_useState9, 2),\n      canSubmit = _useState10[0],\n      setCanSubmit = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      filesSubmitted = _useState12[0],\n      setFilesSubmitted = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      isUploading = _useState14[0],\n      setIsUploading = _useState14[1];\n\n  var _useState15 = useState((filesLiteVersion === null || filesLiteVersion === void 0 ? void 0 : filesLiteVersion.map(function () {\n    return false;\n  })) || []),\n      _useState16 = _slicedToArray(_useState15, 2),\n      uploadStatus = _useState16[0],\n      setUploadStatus = _useState16[1];\n\n  var _useState17 = useState([]),\n      _useState18 = _slicedToArray(_useState17, 2),\n      postUploadMetaData = _useState18[0],\n      setPostUploadMetaData = _useState18[1];\n\n  var tableFormArrayRef = useRef(utils.dms.getFilesForm(activeFiles || []));\n  var duplicateFileIndexes = utils.dms.getDuplicateFileIndexes(activeFiles, previousUploadedFiles);\n  var folderTypes = utils.dms.getFolderTypes(documentTypesAfterFilter);\n  var currencies = utils.currency.listWithCodeAndCurrency(selectCurrencies);\n  var cols = [{\n    id: 'fileName',\n    label: utils.string.t('claims.lossInformation.dmsUploadDocument.cols.fileName')\n  }, {\n    id: 'documentType',\n    label: utils.string.t('claims.lossInformation.dmsUploadDocument.cols.documentType')\n  }, {\n    id: 'documentClassification',\n    label: utils.string.t('claims.lossInformation.dmsUploadDocument.cols.documentClassification')\n  }, {\n    id: 'removeDoc',\n    empty: true\n  }]; // handlers\n\n  var handleFolderTypeSelection = function handleFolderTypeSelection(event, value) {\n    setRefinedDocTypes(utils.dms.refinedDocTypeByFolderName(value, documentTypesAfterFilter));\n  };\n\n  var handleRemoveFiles = function handleRemoveFiles(removalIndex) {\n    var newList = _toConsumableArray(activeFiles);\n\n    newList.splice(removalIndex, 1);\n\n    var newForm = _toConsumableArray(tableFormArrayRef === null || tableFormArrayRef === void 0 ? void 0 : tableFormArrayRef.current);\n\n    newForm.splice(removalIndex, 1);\n    tableFormArrayRef.current = _toConsumableArray(newForm);\n    setActiveFiles(newList);\n    checkIfInvalidFiles(tableFormArrayRef === null || tableFormArrayRef === void 0 ? void 0 : tableFormArrayRef.current);\n  };\n\n  var handleTableForm = function handleTableForm(index, rowFormState) {\n    var _rowFormState$formDoc;\n\n    var newForm = _toConsumableArray(tableFormArrayRef === null || tableFormArrayRef === void 0 ? void 0 : tableFormArrayRef.current);\n\n    newForm[index] = {\n      formFileName: (rowFormState === null || rowFormState === void 0 ? void 0 : rowFormState.formFileName) || '',\n      formDocType: rowFormState === null || rowFormState === void 0 ? void 0 : rowFormState.formDocType,\n      formDocClassificationType: {\n        id: (rowFormState === null || rowFormState === void 0 ? void 0 : (_rowFormState$formDoc = rowFormState.formDocClassificationType) === null || _rowFormState$formDoc === void 0 ? void 0 : _rowFormState$formDoc.id) || 0\n      },\n      paymentFields: rowFormState === null || rowFormState === void 0 ? void 0 : rowFormState.paymentFields,\n      isDuplicateFileName: (rowFormState === null || rowFormState === void 0 ? void 0 : rowFormState.isDuplicateFileName) || false,\n      isInvalidFileName: (rowFormState === null || rowFormState === void 0 ? void 0 : rowFormState.isInvalidFileName) || false\n    };\n    tableFormArrayRef.current = _toConsumableArray(newForm);\n    checkIfInvalidFiles(tableFormArrayRef === null || tableFormArrayRef === void 0 ? void 0 : tableFormArrayRef.current);\n  };\n\n  var checkIfInvalidFiles = function checkIfInvalidFiles(fileFormArray) {\n    var invalidCondition = utils.generic.isValidArray(fileFormArray, true) && fileFormArray.every(function (fileForm) {\n      return !(fileForm === null || fileForm === void 0 ? void 0 : fileForm.isInvalidFileName);\n    });\n    if (!canSubmit && invalidCondition) setCanSubmit(true);\n    if (canSubmit && !invalidCondition) setCanSubmit(false);\n  };\n\n  var checkIfSubmittable = function checkIfSubmittable(fileFormArray) {\n    var submitCondition = utils.generic.isValidArray(fileFormArray, true) && fileFormArray.every(function (fileForm) {\n      var _fileForm$formDocType;\n\n      return (fileForm === null || fileForm === void 0 ? void 0 : (_fileForm$formDocType = fileForm.formDocType) === null || _fileForm$formDocType === void 0 ? void 0 : _fileForm$formDocType.id) && !(fileForm === null || fileForm === void 0 ? void 0 : fileForm.isInvalidFileName);\n    });\n    setCanSubmit(submitCondition);\n    return submitCondition;\n  };\n\n  var handleFilesSubmission = function handleFilesSubmission(e) {\n    e.preventDefault();\n    var filesFormData = tableFormArrayRef === null || tableFormArrayRef === void 0 ? void 0 : tableFormArrayRef.current;\n\n    if (checkIfSubmittable(filesFormData)) {\n      setIsUploading(true);\n      makeUploadCall(filesFormData);\n    } else {\n      setShowDocTypeRequired(true);\n    }\n  };\n\n  var makeUploadCall = function makeUploadCall(filesFormData) {\n    var submitData = utils.dms.constructUploadDocsRequest(context, filesLiteVersion, filesFormData, documentMetaData);\n    var submitFiles = utils.dms.getFullFileProperties(files, activeFiles);\n\n    if (isClientSideUpload) {\n      var documentList = _toConsumableArray(clientUploadedFiles === null || clientUploadedFiles === void 0 ? void 0 : clientUploadedFiles.documentList);\n\n      if (!utils.generic.isInvalidOrEmptyArray(submitData === null || submitData === void 0 ? void 0 : submitData.documentDto)) {\n        var _submitData$documentD;\n\n        var docList = submitData === null || submitData === void 0 ? void 0 : (_submitData$documentD = submitData.documentDto) === null || _submitData$documentD === void 0 ? void 0 : _submitData$documentD.map(function (item) {\n          var docDetails = {\n            documentName: item === null || item === void 0 ? void 0 : item.documentName,\n            docClassification: item === null || item === void 0 ? void 0 : item.docClassification,\n            documentTypeDescription: item === null || item === void 0 ? void 0 : item.documentTypeDescription,\n            documentTypeId: item === null || item === void 0 ? void 0 : item.documentTypeId,\n            fileLastModifiedDate: item === null || item === void 0 ? void 0 : item.fileLastModifiedDate,\n            srcApplication: constants.DMS_SHAREPATH_SOURCES.edge,\n            updatedDate: new Date(),\n            createdByName: user === null || user === void 0 ? void 0 : user.fullName\n          };\n          return docDetails;\n        });\n        documentList = [].concat(_toConsumableArray(docList), _toConsumableArray(documentList));\n      }\n\n      var fileDetails = {\n        context: context,\n        documentTypeKey: documentTypeKey,\n        submitData: submitData,\n        submitFiles: submitFiles\n      };\n\n      if (utils.generic.isValidObject(clientUploadedFiles === null || clientUploadedFiles === void 0 ? void 0 : clientUploadedFiles.fileDetails, 'submitData')) {\n        var _clientUploadedFiles$, _clientUploadedFiles$2;\n\n        var documentDtoList = _toConsumableArray(clientUploadedFiles === null || clientUploadedFiles === void 0 ? void 0 : (_clientUploadedFiles$ = clientUploadedFiles.fileDetails) === null || _clientUploadedFiles$ === void 0 ? void 0 : (_clientUploadedFiles$2 = _clientUploadedFiles$.submitData) === null || _clientUploadedFiles$2 === void 0 ? void 0 : _clientUploadedFiles$2.documentDto);\n\n        if (!utils.generic.isInvalidOrEmptyArray(documentDtoList)) {\n          var _fileDetails$submitDa, _fileDetails$submitDa2;\n\n          fileDetails === null || fileDetails === void 0 ? void 0 : (_fileDetails$submitDa = fileDetails.submitData) === null || _fileDetails$submitDa === void 0 ? void 0 : (_fileDetails$submitDa2 = _fileDetails$submitDa.documentDto) === null || _fileDetails$submitDa2 === void 0 ? void 0 : _fileDetails$submitDa2.push.apply(_fileDetails$submitDa2, _toConsumableArray(documentDtoList));\n        }\n      }\n\n      if (utils.generic.isValidObject(clientUploadedFiles === null || clientUploadedFiles === void 0 ? void 0 : clientUploadedFiles.fileDetails, 'submitFiles')) {\n        var _clientUploadedFiles$3;\n\n        var submitFilesList = _toConsumableArray(clientUploadedFiles === null || clientUploadedFiles === void 0 ? void 0 : (_clientUploadedFiles$3 = clientUploadedFiles.fileDetails) === null || _clientUploadedFiles$3 === void 0 ? void 0 : _clientUploadedFiles$3.submitFiles);\n\n        if (!utils.generic.isInvalidOrEmptyArray(submitFilesList)) {\n          var _fileDetails$submitFi;\n\n          fileDetails === null || fileDetails === void 0 ? void 0 : (_fileDetails$submitFi = fileDetails.submitFiles) === null || _fileDetails$submitFi === void 0 ? void 0 : _fileDetails$submitFi.push.apply(_fileDetails$submitFi, _toConsumableArray(submitFilesList));\n        }\n      }\n\n      var uploadedFileContext = {\n        fileDetails: fileDetails,\n        documentList: documentList\n      };\n      dispatch(uploadClientSideDmsDocuments(uploadedFileContext));\n      dispatch(hideModal('DMS_UPLOAD_FILES'));\n    } else {\n      dispatch(postDmsDocuments({\n        context: context,\n        documentTypeKey: documentTypeKey,\n        submitData: submitData,\n        submitFiles: submitFiles\n      })).then(function (data) {\n        var _data$status;\n\n        setIsUploading(false);\n        setFilesSubmitted(true);\n\n        if ((data === null || data === void 0 ? void 0 : (_data$status = data.status) === null || _data$status === void 0 ? void 0 : _data$status.toLowerCase()) === constants.API_RESPONSE_OK.toLowerCase()) {\n          var _data$data, _data$data2;\n\n          markUploadFailedFiles(data === null || data === void 0 ? void 0 : data.data);\n          postDmsDocumentsSuccess(data);\n          setPostUploadMetaData(utils.dms.getDocMetaDataAfterUpload(data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.documentDto));\n\n          if (utils.dms.checkIfAllUploaded(data === null || data === void 0 ? void 0 : (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.documentDto)) {\n            dispatch(hideModal('DMS_UPLOAD_FILES'));\n            onClosingUploadModal();\n          }\n        }\n      });\n    }\n  };\n\n  var markUploadFailedFiles = function markUploadFailedFiles(data) {\n    var _ref3;\n\n    var docDtoInfo = (data === null || data === void 0 ? void 0 : data.documentDto) || [];\n    var uploadFiles = docDtoInfo === null || docDtoInfo === void 0 ? void 0 : docDtoInfo.map(function (eachFile) {\n      return eachFile === null || eachFile === void 0 ? void 0 : eachFile.documentName;\n    });\n    var uploadStatus = docDtoInfo === null || docDtoInfo === void 0 ? void 0 : docDtoInfo.map(function (eachFile) {\n      return eachFile === null || eachFile === void 0 ? void 0 : eachFile.documentUploaded;\n    });\n    if (utils.dms.checkIfAllUploaded(docDtoInfo)) setCanSubmit(false);\n    var newList = (_ref3 = _toConsumableArray(activeFiles)) === null || _ref3 === void 0 ? void 0 : _ref3.filter(function (item, index) {\n      return !uploadStatus[index];\n    });\n\n    var currentForm = _toConsumableArray(tableFormArrayRef === null || tableFormArrayRef === void 0 ? void 0 : tableFormArrayRef.current);\n\n    var removalIndex = [];\n    var newForm = currentForm === null || currentForm === void 0 ? void 0 : currentForm.filter(function (item) {\n      var matchIndex = uploadFiles === null || uploadFiles === void 0 ? void 0 : uploadFiles.indexOf(item === null || item === void 0 ? void 0 : item.formFileName);\n      removalIndex.push(matchIndex);\n      return matchIndex > -1 && !uploadStatus[matchIndex];\n    });\n\n    if (utils.generic.isValidArray(removalIndex, true)) {\n      removalIndex.forEach(function (ind) {\n        uploadStatus.splice(ind, 1);\n      });\n    }\n\n    tableFormArrayRef.current = _toConsumableArray(newForm);\n    setActiveFiles(newList);\n    setUploadStatus(uploadStatus);\n  };\n\n  var handleRetrySingleFile = function handleRetrySingleFile(retryIndex) {\n    var submitData = utils.dms.constructUploadDocsRequest(context, [filesLiteVersion[retryIndex]], [tableFormArrayRef === null || tableFormArrayRef === void 0 ? void 0 : tableFormArrayRef.current[retryIndex]], documentMetaData);\n    var submitFiles = utils.dms.getFullFileProperties([files[retryIndex]], [filesLiteVersion[retryIndex]]);\n    setFilesSubmitted(false);\n    setIsUploading(true);\n    dispatch(postDmsDocuments({\n      context: context,\n      documentTypeKey: documentTypeKey,\n      submitData: submitData,\n      submitFiles: submitFiles\n    })).then(function (data) {\n      var _data$status2;\n\n      setIsUploading(false);\n      setFilesSubmitted(true);\n\n      if ((data === null || data === void 0 ? void 0 : (_data$status2 = data.status) === null || _data$status2 === void 0 ? void 0 : _data$status2.toLowerCase()) === constants.API_RESPONSE_OK.toLowerCase()) {\n        var _data$data3;\n\n        setFilesSubmitted(true);\n        markUploadFailedFiles(data === null || data === void 0 ? void 0 : data.data);\n\n        if (utils.dms.checkIfAllUploaded(data === null || data === void 0 ? void 0 : (_data$data3 = data.data) === null || _data$data3 === void 0 ? void 0 : _data$data3.documentDto)) {\n          dispatch(hideModal('DMS_UPLOAD_FILES'));\n          postDmsDocumentsSuccess(data);\n          onClosingUploadModal();\n        }\n      }\n    });\n  };\n\n  var handleCancel = function handleCancel() {\n    dispatch(hideModal('DMS_UPLOAD_FILES'));\n    onClosingUploadModal();\n  };\n\n  useEffect(function () {\n    dispatch(getDmsMetaData(context, xbInstanceId, referenceId)).then(function (data) {\n      setIsMetaDataLoaded((data === null || data === void 0 ? void 0 : data.status) === constants.API_RESPONSE_OK);\n    }).catch(function () {\n      return setIsMetaDataLoaded(false);\n    });\n    dispatch(removeLoader('DmsUploadFiles'));\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var resetDocTypeRequired = function resetDocTypeRequired() {\n    setShowDocTypeRequired(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(DmsUploadFilesView, {\n    context: context,\n    files: activeFiles,\n    duplicateFileIndexes: duplicateFileIndexes,\n    cols: cols,\n    currencies: currencies,\n    folderTypes: folderTypes,\n    documentTypes: refinedDocTypes,\n    isMetaDataLoaded: isMetaDataLoaded,\n    showDocTypeRequired: showDocTypeRequired,\n    canSubmit: canSubmit,\n    filesSubmitted: filesSubmitted,\n    isUploading: isUploading,\n    uploadStatus: uploadStatus,\n    isDmsFromPi: isDmsFromPi,\n    showFolderFilter: showFolderFilter,\n    postUploadMetaData: postUploadMetaData,\n    resetDocTypeRequired: resetDocTypeRequired,\n    handlers: {\n      handleFolderTypeSelection: handleFolderTypeSelection,\n      handleRemoveFiles: handleRemoveFiles,\n      handleTableForm: handleTableForm,\n      handleFilesSubmission: handleFilesSubmission,\n      handleRetrySingleFile: handleRetrySingleFile,\n      handleCancel: handleCancel\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 320,\n    columnNumber: 5\n  }, this);\n}\n\n_s(DmsUploadFiles, \"MtNwS0g6F4qN1VjwqNGUbRnjtJE=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = DmsUploadFiles;\n\nvar _c;\n\n$RefreshReg$(_c, \"DmsUploadFiles\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/forms/DmsUploadFiles/DmsUploadFiles.js"],"names":["React","useState","useEffect","useRef","PropTypes","useDispatch","useSelector","DmsUploadFilesView","hideModal","getDmsMetaData","selectRefDataNewDocumentTypesByContextSource","selectRefDataNewDocumentTypeLookUpByContextSource","selectDmsMetaData","selectorDmsViewFiles","selectSettlementCurrency","removeLoader","postDmsDocuments","uploadClientSideDmsDocuments","selectDmsClientSideUploadFiles","selectUser","constants","utils","DmsUploadFiles","propTypes","files","array","isRequired","context","string","referenceId","sourceId","oneOfType","number","documentTypeKey","oneOf","Object","values","DMS_DOCUMENT_TYPE_SECTION_KEYS","postDmsDocumentsSuccess","func","onClosingUploadModal","isClientSideUpload","bool","defaultProps","policy","dispatch","filesLiteVersion","dms","trimFileProperties","isDmsFromPi","dmsFormatter","showFolderFilter","selectCurrencies","documentMetaData","previousUploadedFiles","clientUploadedFiles","xbInstanceId","DMS_CLAIM_SOURCE_ID","user","getDocumentTypeFilterKeys","dmsSectionKey","selectedSourceId","dmsSourceId","documentTypeSource","dmsDocTypeSource","documentTypesBeforeFilter","getDocumentTypeInfo","documentTypeDescription","sectionKey","dmsSourceID","documentTypesAfterFilter","DMS_CONTEXT_POLICY","DMS_CONTEXT_PROCESSING_INSTRUCTION","filter","type","sourceID","activeFiles","setActiveFiles","refinedDocTypes","setRefinedDocTypes","isMetaDataLoaded","setIsMetaDataLoaded","showDocTypeRequired","setShowDocTypeRequired","canSubmit","setCanSubmit","filesSubmitted","setFilesSubmitted","isUploading","setIsUploading","map","uploadStatus","setUploadStatus","postUploadMetaData","setPostUploadMetaData","tableFormArrayRef","getFilesForm","duplicateFileIndexes","getDuplicateFileIndexes","folderTypes","getFolderTypes","currencies","currency","listWithCodeAndCurrency","cols","id","label","t","empty","handleFolderTypeSelection","event","value","refinedDocTypeByFolderName","handleRemoveFiles","removalIndex","newList","splice","newForm","current","checkIfInvalidFiles","handleTableForm","index","rowFormState","formFileName","formDocType","formDocClassificationType","paymentFields","isDuplicateFileName","isInvalidFileName","fileFormArray","invalidCondition","generic","isValidArray","every","fileForm","checkIfSubmittable","submitCondition","handleFilesSubmission","e","preventDefault","filesFormData","makeUploadCall","submitData","constructUploadDocsRequest","submitFiles","getFullFileProperties","documentList","isInvalidOrEmptyArray","documentDto","docList","item","docDetails","documentName","docClassification","documentTypeId","fileLastModifiedDate","srcApplication","DMS_SHAREPATH_SOURCES","edge","updatedDate","Date","createdByName","fullName","fileDetails","isValidObject","documentDtoList","push","submitFilesList","uploadedFileContext","then","data","status","toLowerCase","API_RESPONSE_OK","markUploadFailedFiles","getDocMetaDataAfterUpload","checkIfAllUploaded","docDtoInfo","uploadFiles","eachFile","documentUploaded","currentForm","matchIndex","indexOf","forEach","ind","handleRetrySingleFile","retryIndex","handleCancel","catch","resetDocTypeRequired"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\n// app\r\nimport { DmsUploadFilesView } from './DmsUploadFiles.view';\r\nimport {\r\n  hideModal,\r\n  getDmsMetaData,\r\n  selectRefDataNewDocumentTypesByContextSource,\r\n  selectRefDataNewDocumentTypeLookUpByContextSource,\r\n  selectDmsMetaData,\r\n  selectorDmsViewFiles,\r\n  selectSettlementCurrency,\r\n  removeLoader,\r\n  postDmsDocuments,\r\n  uploadClientSideDmsDocuments,\r\n  selectDmsClientSideUploadFiles,\r\n  selectUser,\r\n} from 'stores';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\n\r\nDmsUploadFiles.propTypes = {\r\n  files: PropTypes.array.isRequired,\r\n  context: PropTypes.string.isRequired,\r\n  referenceId: PropTypes.string.isRequired,\r\n  sourceId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n  documentTypeKey: PropTypes.oneOf(Object.values(constants.DMS_DOCUMENT_TYPE_SECTION_KEYS)),\r\n  postDmsDocumentsSuccess: PropTypes.func,\r\n  onClosingUploadModal: PropTypes.func,\r\n  isClientSideUpload: PropTypes.bool,\r\n};\r\n\r\nDmsUploadFiles.defaultProps = {\r\n  documentTypeKey: constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy,\r\n  postDmsDocumentsSuccess: () => {},\r\n  onClosingUploadModal: () => {},\r\n};\r\n\r\nexport default function DmsUploadFiles({\r\n  files,\r\n  context,\r\n  referenceId,\r\n  sourceId,\r\n  documentTypeKey,\r\n  postDmsDocumentsSuccess,\r\n  onClosingUploadModal,\r\n  isClientSideUpload,\r\n}) {\r\n  const dispatch = useDispatch();\r\n\r\n  const filesLiteVersion = utils.dms.trimFileProperties(files);\r\n  const isDmsFromPi = utils.dmsFormatter.isDmsFromPi(documentTypeKey);\r\n  const showFolderFilter = !(isDmsFromPi || documentTypeKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy);\r\n\r\n  // redux\r\n  const selectCurrencies = useSelector(selectSettlementCurrency);\r\n  const documentMetaData = useSelector(selectDmsMetaData);\r\n  const previousUploadedFiles = useSelector(selectorDmsViewFiles);\r\n  const clientUploadedFiles = useSelector(selectDmsClientSideUploadFiles);\r\n\r\n  const xbInstanceId = sourceId ? sourceId : constants.DMS_CLAIM_SOURCE_ID;\r\n\r\n  const user = useSelector(selectUser);\r\n\r\n  const {\r\n    dmsSectionKey,\r\n    dmsSourceId: selectedSourceId,\r\n    dmsDocTypeSource: documentTypeSource,\r\n  } = utils.dmsFormatter.getDocumentTypeFilterKeys(context, xbInstanceId, documentTypeKey);\r\n\r\n  const documentTypesBeforeFilter = useSelector(\r\n    dmsSectionKey === constants.DMS_DOCUMENT_TYPE_SECTION_KEYS.policy\r\n      ? selectRefDataNewDocumentTypeLookUpByContextSource(dmsSectionKey, selectedSourceId)\r\n      : selectRefDataNewDocumentTypesByContextSource(dmsSectionKey, selectedSourceId, documentTypeSource)\r\n  );\r\n\r\n  const { documentTypeDescription, sectionKey, dmsSourceID } =\r\n    isDmsFromPi && utils.dmsFormatter.getDocumentTypeInfo(documentTypeKey, selectedSourceId);\r\n\r\n  const documentTypesAfterFilter =\r\n    (context === constants.DMS_CONTEXT_POLICY || context === constants.DMS_CONTEXT_PROCESSING_INSTRUCTION) && isDmsFromPi\r\n      ? documentTypesBeforeFilter?.filter(\r\n          (type) =>\r\n            type.documentTypeDescription === documentTypeDescription && type.sectionKey === sectionKey && type.sourceID === dmsSourceID\r\n        )\r\n      : documentTypesBeforeFilter;\r\n\r\n  // state\r\n  const [activeFiles, setActiveFiles] = useState(filesLiteVersion);\r\n  const [refinedDocTypes, setRefinedDocTypes] = useState(documentTypesAfterFilter);\r\n  const [isMetaDataLoaded, setIsMetaDataLoaded] = useState(false);\r\n  const [showDocTypeRequired, setShowDocTypeRequired] = useState(false);\r\n  const [canSubmit, setCanSubmit] = useState(true);\r\n  const [filesSubmitted, setFilesSubmitted] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [uploadStatus, setUploadStatus] = useState(filesLiteVersion?.map(() => false) || []);\r\n  const [postUploadMetaData, setPostUploadMetaData] = useState([]);\r\n\r\n  const tableFormArrayRef = useRef(utils.dms.getFilesForm(activeFiles || []));\r\n  const duplicateFileIndexes = utils.dms.getDuplicateFileIndexes(activeFiles, previousUploadedFiles);\r\n  const folderTypes = utils.dms.getFolderTypes(documentTypesAfterFilter);\r\n  const currencies = utils.currency.listWithCodeAndCurrency(selectCurrencies);\r\n\r\n  const cols = [\r\n    {\r\n      id: 'fileName',\r\n      label: utils.string.t('claims.lossInformation.dmsUploadDocument.cols.fileName'),\r\n    },\r\n    {\r\n      id: 'documentType',\r\n      label: utils.string.t('claims.lossInformation.dmsUploadDocument.cols.documentType'),\r\n    },\r\n    {\r\n      id: 'documentClassification',\r\n      label: utils.string.t('claims.lossInformation.dmsUploadDocument.cols.documentClassification'),\r\n    },\r\n    {\r\n      id: 'removeDoc',\r\n      empty: true,\r\n    },\r\n  ];\r\n\r\n  // handlers\r\n  const handleFolderTypeSelection = (event, value) => {\r\n    setRefinedDocTypes(utils.dms.refinedDocTypeByFolderName(value, documentTypesAfterFilter));\r\n  };\r\n\r\n  const handleRemoveFiles = (removalIndex) => {\r\n    const newList = [...activeFiles];\r\n    newList.splice(removalIndex, 1);\r\n\r\n    const newForm = [...tableFormArrayRef?.current];\r\n    newForm.splice(removalIndex, 1);\r\n    tableFormArrayRef.current = [...newForm];\r\n\r\n    setActiveFiles(newList);\r\n    checkIfInvalidFiles(tableFormArrayRef?.current);\r\n  };\r\n\r\n  const handleTableForm = (index, rowFormState) => {\r\n    const newForm = [...tableFormArrayRef?.current];\r\n    newForm[index] = {\r\n      formFileName: rowFormState?.formFileName || '',\r\n      formDocType: rowFormState?.formDocType,\r\n      formDocClassificationType: { id: rowFormState?.formDocClassificationType?.id || 0 },\r\n      paymentFields: rowFormState?.paymentFields,\r\n      isDuplicateFileName: rowFormState?.isDuplicateFileName || false,\r\n      isInvalidFileName: rowFormState?.isInvalidFileName || false,\r\n    };\r\n    tableFormArrayRef.current = [...newForm];\r\n\r\n    checkIfInvalidFiles(tableFormArrayRef?.current);\r\n  };\r\n\r\n  const checkIfInvalidFiles = (fileFormArray) => {\r\n    const invalidCondition =\r\n      utils.generic.isValidArray(fileFormArray, true) && fileFormArray.every((fileForm) => !fileForm?.isInvalidFileName);\r\n    if (!canSubmit && invalidCondition) setCanSubmit(true);\r\n    if (canSubmit && !invalidCondition) setCanSubmit(false);\r\n  };\r\n\r\n  const checkIfSubmittable = (fileFormArray) => {\r\n    const submitCondition =\r\n      utils.generic.isValidArray(fileFormArray, true) &&\r\n      fileFormArray.every((fileForm) => {\r\n        return fileForm?.formDocType?.id && !fileForm?.isInvalidFileName;\r\n      });\r\n    setCanSubmit(submitCondition);\r\n    return submitCondition;\r\n  };\r\n\r\n  const handleFilesSubmission = (e) => {\r\n    e.preventDefault();\r\n    const filesFormData = tableFormArrayRef?.current;\r\n    if (checkIfSubmittable(filesFormData)) {\r\n      setIsUploading(true);\r\n      makeUploadCall(filesFormData);\r\n    } else {\r\n      setShowDocTypeRequired(true);\r\n    }\r\n  };\r\n\r\n  const makeUploadCall = (filesFormData) => {\r\n    const submitData = utils.dms.constructUploadDocsRequest(context, filesLiteVersion, filesFormData, documentMetaData);\r\n    const submitFiles = utils.dms.getFullFileProperties(files, activeFiles);\r\n\r\n    if (isClientSideUpload) {\r\n      let documentList = [...clientUploadedFiles?.documentList];\r\n      if (!utils.generic.isInvalidOrEmptyArray(submitData?.documentDto)) {\r\n        const docList = submitData?.documentDto?.map((item) => {\r\n          const docDetails = {\r\n            documentName: item?.documentName,\r\n            docClassification: item?.docClassification,\r\n            documentTypeDescription: item?.documentTypeDescription,\r\n            documentTypeId: item?.documentTypeId,\r\n            fileLastModifiedDate: item?.fileLastModifiedDate,\r\n            srcApplication: constants.DMS_SHAREPATH_SOURCES.edge,\r\n            updatedDate: new Date(),\r\n            createdByName: user?.fullName,\r\n          };\r\n          return docDetails;\r\n        });\r\n        documentList = [...docList, ...documentList];\r\n      }\r\n      const fileDetails = { context, documentTypeKey, submitData, submitFiles };\r\n      if (utils.generic.isValidObject(clientUploadedFiles?.fileDetails, 'submitData')) {\r\n        const documentDtoList = [...clientUploadedFiles?.fileDetails?.submitData?.documentDto];\r\n        if (!utils.generic.isInvalidOrEmptyArray(documentDtoList)) {\r\n          fileDetails?.submitData?.documentDto?.push(...documentDtoList);\r\n        }\r\n      }\r\n      if (utils.generic.isValidObject(clientUploadedFiles?.fileDetails, 'submitFiles')) {\r\n        const submitFilesList = [...clientUploadedFiles?.fileDetails?.submitFiles];\r\n        if (!utils.generic.isInvalidOrEmptyArray(submitFilesList)) {\r\n          fileDetails?.submitFiles?.push(...submitFilesList);\r\n        }\r\n      }\r\n      const uploadedFileContext = {\r\n        fileDetails,\r\n        documentList,\r\n      };\r\n      dispatch(uploadClientSideDmsDocuments(uploadedFileContext));\r\n      dispatch(hideModal('DMS_UPLOAD_FILES'));\r\n    } else {\r\n      dispatch(postDmsDocuments({ context, documentTypeKey, submitData, submitFiles })).then((data) => {\r\n        setIsUploading(false);\r\n        setFilesSubmitted(true);\r\n        if (data?.status?.toLowerCase() === constants.API_RESPONSE_OK.toLowerCase()) {\r\n          markUploadFailedFiles(data?.data);\r\n          postDmsDocumentsSuccess(data);\r\n          setPostUploadMetaData(utils.dms.getDocMetaDataAfterUpload(data?.data?.documentDto));\r\n          if (utils.dms.checkIfAllUploaded(data?.data?.documentDto)) {\r\n            dispatch(hideModal('DMS_UPLOAD_FILES'));\r\n            onClosingUploadModal();\r\n          }\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  const markUploadFailedFiles = (data) => {\r\n    const docDtoInfo = data?.documentDto || [];\r\n\r\n    const uploadFiles = docDtoInfo?.map((eachFile) => eachFile?.documentName);\r\n    const uploadStatus = docDtoInfo?.map((eachFile) => eachFile?.documentUploaded);\r\n\r\n    if (utils.dms.checkIfAllUploaded(docDtoInfo)) setCanSubmit(false);\r\n\r\n    const newList = [...activeFiles]?.filter((item, index) => !uploadStatus[index]);\r\n\r\n    const currentForm = [...tableFormArrayRef?.current];\r\n    let removalIndex = [];\r\n\r\n    const newForm = currentForm?.filter((item) => {\r\n      const matchIndex = uploadFiles?.indexOf(item?.formFileName);\r\n      removalIndex.push(matchIndex);\r\n      return matchIndex > -1 && !uploadStatus[matchIndex];\r\n    });\r\n\r\n    if (utils.generic.isValidArray(removalIndex, true)) {\r\n      removalIndex.forEach((ind) => {\r\n        uploadStatus.splice(ind, 1);\r\n      });\r\n    }\r\n\r\n    tableFormArrayRef.current = [...newForm];\r\n\r\n    setActiveFiles(newList);\r\n    setUploadStatus(uploadStatus);\r\n  };\r\n\r\n  const handleRetrySingleFile = (retryIndex) => {\r\n    const submitData = utils.dms.constructUploadDocsRequest(\r\n      context,\r\n      [filesLiteVersion[retryIndex]],\r\n      [tableFormArrayRef?.current[retryIndex]],\r\n      documentMetaData\r\n    );\r\n    const submitFiles = utils.dms.getFullFileProperties([files[retryIndex]], [filesLiteVersion[retryIndex]]);\r\n\r\n    setFilesSubmitted(false);\r\n    setIsUploading(true);\r\n\r\n    dispatch(postDmsDocuments({ context, documentTypeKey, submitData, submitFiles })).then((data) => {\r\n      setIsUploading(false);\r\n      setFilesSubmitted(true);\r\n      if (data?.status?.toLowerCase() === constants.API_RESPONSE_OK.toLowerCase()) {\r\n        setFilesSubmitted(true);\r\n        markUploadFailedFiles(data?.data);\r\n        if (utils.dms.checkIfAllUploaded(data?.data?.documentDto)) {\r\n          dispatch(hideModal('DMS_UPLOAD_FILES'));\r\n          postDmsDocumentsSuccess(data);\r\n          onClosingUploadModal();\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    dispatch(hideModal('DMS_UPLOAD_FILES'));\r\n    onClosingUploadModal();\r\n  };\r\n\r\n  useEffect(() => {\r\n    dispatch(getDmsMetaData(context, xbInstanceId, referenceId))\r\n      .then((data) => {\r\n        setIsMetaDataLoaded(data?.status === constants.API_RESPONSE_OK);\r\n      })\r\n      .catch(() => setIsMetaDataLoaded(false));\r\n    dispatch(removeLoader('DmsUploadFiles'));\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const resetDocTypeRequired = () => {\r\n    setShowDocTypeRequired(false);\r\n  };\r\n\r\n  return (\r\n    <DmsUploadFilesView\r\n      context={context}\r\n      files={activeFiles}\r\n      duplicateFileIndexes={duplicateFileIndexes}\r\n      cols={cols}\r\n      currencies={currencies}\r\n      folderTypes={folderTypes}\r\n      documentTypes={refinedDocTypes}\r\n      isMetaDataLoaded={isMetaDataLoaded}\r\n      showDocTypeRequired={showDocTypeRequired}\r\n      canSubmit={canSubmit}\r\n      filesSubmitted={filesSubmitted}\r\n      isUploading={isUploading}\r\n      uploadStatus={uploadStatus}\r\n      isDmsFromPi={isDmsFromPi}\r\n      showFolderFilter={showFolderFilter}\r\n      postUploadMetaData={postUploadMetaData}\r\n      resetDocTypeRequired={resetDocTypeRequired}\r\n      handlers={{\r\n        handleFolderTypeSelection,\r\n        handleRemoveFiles,\r\n        handleTableForm,\r\n        handleFilesSubmission,\r\n        handleRetrySingleFile,\r\n        handleCancel,\r\n      }}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}