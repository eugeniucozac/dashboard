{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ClientCharts\\\\ClientCharts.js\";\nimport React, { PureComponent, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { withRouter } from 'react-router';\nimport { firstBy } from 'thenby';\nimport kebabCase from 'lodash/kebabCase';\nimport toNumber from 'lodash/toNumber';\nimport flatten from 'lodash/flatten';\nimport isEmpty from 'lodash/isEmpty';\nimport uniqBy from 'lodash/uniqBy';\nimport range from 'lodash/range';\nimport pick from 'lodash/pick';\nimport xor from 'lodash/xor';\nimport get from 'lodash/get'; // app\n\nimport styles from './ClientCharts.styles';\nimport { updatePortfolioMapDepartment, resetPortfolioMap } from 'stores';\nimport { AvatarGroup, CardList, PageHeader, PopoverMenu, Sticky, Button, Translate, SectionHeader } from 'components';\nimport { ChartPremiumByAccount, ChartPremiumByMarket, ChartPremiumByYear, PortfolioMapHeader } from 'modules';\nimport { showModal } from 'stores';\nimport { withThemeListener } from 'hoc';\nimport * as utils from 'utils';\nimport config from 'config'; // mui\n\nimport { withStyles, withTheme, Typography } from '@material-ui/core';\nimport PeopleIcon from '@material-ui/icons/People';\nimport EventAvailableIcon from '@material-ui/icons/EventAvailable';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport MapIcon from '@material-ui/icons/Map'; // state\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user,\n    referenceDataCurrencies: state.referenceData.currencies,\n    referenceDataDepartments: state.referenceData.departments,\n    filteredDepartments: state.portfolioMap.tiv.filteredDepartments\n  };\n}; // dispatch\n\n\nvar mapDispatchToProps = {\n  showModal: showModal,\n  updatePortfolioMapDepartment: updatePortfolioMapDepartment,\n  resetPortfolioMap: resetPortfolioMap\n};\nexport var ClientCharts = /*#__PURE__*/function (_PureComponent) {\n  _inherits(ClientCharts, _PureComponent);\n\n  var _super = _createSuper(ClientCharts);\n\n  function ClientCharts(props) {\n    var _this;\n\n    _classCallCheck(this, ClientCharts);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"getUrlParamsOfficeIds\", function () {\n      var officeIds = get(_this.props, 'match.params.officeIds'); // abort\n\n      if (!officeIds) return [];\n      var offices = officeIds.split('-') || [];\n      return offices.map(function (o) {\n        return toNumber(o);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getDepartments\", function (placements, placementsYear) {\n      var selectedDepartments = _this.state.selectedDepartments;\n      var referenceDataDepartments = _this.props.referenceDataDepartments;\n      return placements.reduce(function (list, placement) {\n        var year = utils.placement.getYear(placement);\n        var isValid = year === placementsYear; // Only keep placements for defined year\n\n        if (!isValid) return list;\n        var deptId = placement.departmentId;\n        var deptName = utils.placement.getDepartmentName(placement, referenceDataDepartments);\n        var premiumByCurrency = utils.placement.getPremiumBySettlementCurrency(placement, true, true);\n        var isNew = !list.some(function (item) {\n          return item.id === deptId;\n        });\n        return isNew ? [].concat(_toConsumableArray(list), [{\n          id: deptId,\n          name: deptName,\n          premiumByCurrency: premiumByCurrency,\n          active: selectedDepartments.includes(deptId)\n        }]) : list.map(function (dept) {\n          if (dept.id === deptId) {\n            return _objectSpread(_objectSpread({}, dept), {}, {\n              premiumByCurrency: utils.placement.mergePremiumsByCurrency(dept.premiumByCurrency, premiumByCurrency)\n            });\n          }\n\n          return dept;\n        });\n      }, []).sort(firstBy('premiumByCurrency', -1));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getDepartmentsList\", function (placements, selectedYear) {\n      var filterEmpty = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      var departments = _this.getDepartments(placements, selectedYear).map(function (dept) {\n        return {\n          id: \"\".concat(dept.id, \"-\").concat(dept.name),\n          rawId: dept.id,\n          title: dept.name || '-',\n          children: _this.premiumsByCurrency(dept.premiumByCurrency),\n          active: dept.active,\n          onClick: _this.handleClickFilter('departments', dept.id)\n        };\n      });\n\n      return filterEmpty ? departments.filter(function (dep) {\n        return flatten(dep.children.props.children.filter(function (depVal) {\n          return utils.generic.isValidArray(depVal);\n        })).filter(function (dep) {\n          return !!dep;\n        }).length > 0;\n      }) : departments;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"premiumsByCurrency\", function (premiumByCurrency) {\n      var classes = _this.props.classes;\n      return /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: classes.premiumByCurrency,\n        children: [isEmpty(premiumByCurrency) && /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 40\n        }, _assertThisInitialized(_this)), Object.keys(premiumByCurrency).map(function (currency) {\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            children: utils.string.t('format.currency', {\n              value: {\n                number: premiumByCurrency[currency],\n                currency: currency,\n                \"default\": '-'\n              }\n            })\n          }, currency, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 11\n          }, _assertThisInitialized(_this));\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 7\n      }, _assertThisInitialized(_this));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getOffices\", function (placements) {\n      var offices = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var customSelectedDepartments = arguments.length > 2 ? arguments[2] : undefined;\n      var _this$state = _this.state,\n          selectedDepartments = _this$state.selectedDepartments,\n          selectedOffices = _this$state.selectedOffices;\n      var defaultOffices = offices.map(function (office) {\n        return _objectSpread(_objectSpread({}, pick(office, ['id', 'name', 'clients', 'cobrokers'])), {}, {\n          active: selectedOffices.includes(office.id),\n          placements: [],\n          premiumByCurrency: {}\n        });\n      });\n      return placements.reduce(function (list, placement) {\n        var year = utils.placement.getYear(placement);\n        var isValid = year === _this.state.selectedYear; // Only keep placements for defined year\n\n        if (!isValid) return list;\n        var premiumByCurrency = utils.placement.getPremiumBySettlementCurrency(placement, true, true);\n        var hasPremiums = Boolean(premiumByCurrency);\n        var isWithinDepartments = customSelectedDepartments ? customSelectedDepartments.includes(placement.departmentId) : selectedDepartments.includes(placement.departmentId);\n\n        if (hasPremiums && isWithinDepartments) {\n          placement.clients.forEach(function (client) {\n            offices.forEach(function (office) {\n              var officeId = office.id;\n              var isClientInOffice = office.clients.some(function (c) {\n                return c.id === client.id;\n              });\n\n              if (isClientInOffice) {\n                list = list.map(function (listObj) {\n                  if (listObj.id === officeId) {\n                    var isPlacementAlreadyIn = listObj.placements.includes(placement.id);\n\n                    if (!isPlacementAlreadyIn) {\n                      return _objectSpread(_objectSpread({}, listObj), {}, {\n                        premiumByCurrency: utils.placement.mergePremiumsByCurrency(listObj.premiumByCurrency, premiumByCurrency),\n                        placements: [].concat(_toConsumableArray(listObj.placements), [placement.id])\n                      });\n                    }\n                  }\n\n                  return listObj;\n                });\n              }\n            });\n          });\n        }\n\n        return list;\n      }, defaultOffices).filter(function (o) {\n        return Object.keys(o.premiumByCurrency).length > 0;\n      }).sort(firstBy('premiumByCurrency', -1).thenBy(utils.sort.array('lexical', 'name')));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getOfficesList\", function (offices) {\n      return offices.map(function (o) {\n        return {\n          id: \"\".concat(o.id, \"-\").concat(o.name),\n          title: o.name || '-',\n          children: _this.premiumsByCurrency(o.premiumByCurrency),\n          active: o.active,\n          onClick: _this.handleClickFilter('offices', o.id)\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getUsers\", function (offices) {\n      var users = offices.reduce(function (acc, office) {\n        if (!office.active || !office.cobrokers || !Array.isArray(office.cobrokers)) return acc;\n        return [].concat(_toConsumableArray(acc), _toConsumableArray(office.cobrokers));\n      }, []);\n      return uniqBy(users, 'id');\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"filterPlacements\", function (placements, offices) {\n      var _this$state2 = _this.state,\n          selectedDepartments = _this$state2.selectedDepartments,\n          selectedOffices = _this$state2.selectedOffices; // abort\n\n      if (utils.generic.isInvalidOrEmptyArray(placements) || utils.generic.isInvalidOrEmptyArray(offices)) return [];\n      var activeOffices = offices.filter(function (o) {\n        return selectedOffices.includes(o.id);\n      });\n      var activeOfficeClients = uniqBy(flatten(activeOffices.map(function (office) {\n        return office.clients;\n      })), 'id') || []; // only keep placement within the selected departments/offices\n\n      return placements.filter(function (placement) {\n        var placementClients = placement.clients || [];\n        var isWithinDepartments = selectedDepartments.includes(placement.departmentId);\n        var isWithinOffices = placementClients.some(function (p) {\n          return activeOfficeClients.some(function (c) {\n            return c.id === p.id;\n          });\n        });\n        return isWithinDepartments && isWithinOffices;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickFilter\", function (type, id) {\n      return function (event) {\n        var _this$props = _this.props,\n            updatePortfolioMapDepartment = _this$props.updatePortfolioMapDepartment,\n            filteredDepartments = _this$props.filteredDepartments;\n\n        switch (type) {\n          case 'departments':\n            var selectedDepartments = xor(_this.state.selectedDepartments, [id]);\n            var selectedCardDepartments = filteredDepartments.map(function (dep) {\n              return dep.rawId === id ? _objectSpread(_objectSpread({}, dep), {}, {\n                active: !dep.active\n              }) : dep;\n            });\n            updatePortfolioMapDepartment(selectedCardDepartments);\n\n            _this.setState({\n              selectedDepartments: selectedDepartments\n            });\n\n            break;\n\n          case 'offices':\n            _this.setState({\n              selectedOffices: xor(_this.state.selectedOffices, [id])\n            });\n\n            break;\n\n          default:\n            break;\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickChangeParent\", function (parent) {\n      return function (event) {\n        var type = _this.props.type;\n        var officeId = parent && parent.id;\n        var officeSlug = parent && parent.name ? \"/\".concat(kebabCase(parent.name)) : '';\n\n        _this.props.history.push(\"\".concat(config.routes[type].item, \"/\").concat(officeId).concat(officeSlug));\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickChangeYear\", function (year) {\n      return function (event) {\n        _this.setState({\n          selectedYear: year\n        });\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleViewPortfolio\", function () {\n      var _this$props2 = _this.props,\n          parent = _this$props2.parent,\n          showModal = _this$props2.showModal,\n          type = _this$props2.type;\n      var logo = utils.client.parent.getLogoFilePath(parent.selected);\n      showModal({\n        component: 'PORTFOLIO_MAP',\n        props: {\n          fullWidth: true,\n          fullScreen: true,\n          titleChildren: /*#__PURE__*/_jsxDEV(PortfolioMapHeader, {\n            logo: logo,\n            title: \"portfolio.title_\".concat(type)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 24\n          }, _assertThisInitialized(_this)),\n          disableAutoFocus: true,\n          componentProps: {\n            parent: parent\n          }\n        }\n      });\n    });\n\n    var currentYear = utils.app.getCurrentYear();\n    _this.state = {\n      years: range(currentYear, 2018),\n      // 2018 won't be included in the range, 2019 will therefore be the last\n      selectedYear: currentYear,\n      selectedDepartments: [],\n      selectedOffices: []\n    };\n    return _this;\n  }\n\n  _createClass(ClientCharts, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var resetPortfolioMap = this.props.resetPortfolioMap;\n      resetPortfolioMap();\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var selectedYear = this.state.selectedYear;\n      var _this$props3 = this.props,\n          user = _this$props3.user,\n          parent = _this$props3.parent,\n          history = _this$props3.history,\n          match = _this$props3.match,\n          updatePortfolioMapDepartment = _this$props3.updatePortfolioMapDepartment;\n      var userDeptId = utils.user.department.getDefault(user);\n      var departments = this.getDepartments(parent.placements, selectedYear);\n      var offices = this.getOffices(parent.placements, parent.offices, departments.map(function (d) {\n        return d.id;\n      }));\n      var urlParamsOfficeIds = this.getUrlParamsOfficeIds();\n      var params = match && get(match, 'params'); // departments\n\n      if (utils.generic.isValidArray(departments, true)) {\n        var defaultDept = departments.find(function (d) {\n          return d.id === userDeptId;\n        });\n        var newSelectedDepartments = defaultDept && defaultDept.id ? [defaultDept.id] : departments.map(function (d) {\n          return d.id;\n        });\n        var cardDepartments = this.getDepartmentsList(parent.placements, selectedYear, true);\n        var cardDepartmentsWithSelection = newSelectedDepartments.length ? cardDepartments.map(function (dep) {\n          return dep.rawId === newSelectedDepartments[0] ? _objectSpread(_objectSpread({}, dep), {}, {\n            active: true\n          }) : dep;\n        }) : cardDepartments;\n        updatePortfolioMapDepartment(cardDepartmentsWithSelection);\n        this.setState({\n          selectedDepartments: newSelectedDepartments\n        });\n      } // offices\n\n\n      if (utils.generic.isValidArray(offices, true)) {\n        var defaultOfficesFromUrlParams = offices.filter(function (o) {\n          return urlParamsOfficeIds.includes(o.id);\n        });\n        var newSelectedOffices = utils.generic.isValidArray(defaultOfficesFromUrlParams, true) ? defaultOfficesFromUrlParams.map(function (o) {\n          return o.id;\n        }) : offices.map(function (o) {\n          return o.id;\n        });\n        this.setState({\n          selectedOffices: newSelectedOffices\n        });\n      } // redirect to shorter URL if requested office doesn't exist\n\n\n      if (utils.generic.isValidArray(urlParamsOfficeIds, true) && !offices.some(function (o) {\n        return urlParamsOfficeIds.includes(o.id);\n      })) {\n        if (params && params.id && params.slug) {\n          history.replace(\"\".concat(config.routes.client.item, \"/\").concat(params.id, \"/\").concat(params.slug));\n        } else {\n          history.replace(\"\".concat(config.routes.client.item));\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state3 = this.state,\n          years = _this$state3.years,\n          selectedYear = _this$state3.selectedYear;\n      var _this$props4 = this.props,\n          type = _this$props4.type,\n          showByMarket = _this$props4.showByMarket,\n          showByYear = _this$props4.showByYear,\n          showOfficeSelection = _this$props4.showOfficeSelection,\n          pageIcon = _this$props4.pageIcon,\n          pageTitle = _this$props4.pageTitle,\n          parent = _this$props4.parent,\n          tabletUp = _this$props4.tabletUp,\n          theme = _this$props4.theme,\n          classes = _this$props4.classes; // abort\n\n      if (!parent.selected) return null;\n      var headerLogo = utils.client.parent.getLogoFilePath(parent.selected);\n      var parentName = parent.selected ? parent.selected.name : '';\n      var hasMultipleItems = parent.list.length > 1;\n      var stickyParent = tabletUp ? utils.app.getElement('#content') : null;\n      var stickyOffset = tabletUp ? 0 : theme.mixins.header.height;\n      var filteredOffices = this.getOffices(parent.placements, parent.offices);\n      var filteredPlacements = this.filterPlacements(parent.placements, filteredOffices);\n      var departmentsList = this.getDepartmentsList(parent.placements, selectedYear);\n      var officesList = this.getOfficesList(filteredOffices);\n      var usersList = this.getUsers(filteredOffices);\n\n      var Select = /*#__PURE__*/_jsxDEV(PopoverMenu, {\n        id: \"\".concat(type, \"-select\"),\n        text: parentName,\n        size: \"small\",\n        offset: true,\n        icon: ArrowDropDownIcon,\n        iconPosition: \"right\",\n        anchorOrigin: {\n          vertical: 'bottom',\n          horizontal: 'left'\n        },\n        items: parent.list.map(function (parent) {\n          return {\n            id: parent.id,\n            label: parent.name,\n            callback: _this2.handleClickChangeParent(parent)\n          };\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 7\n      }, this);\n\n      var yearSelect = /*#__PURE__*/_jsxDEV(PopoverMenu, {\n        id: \"year-select\",\n        text: selectedYear.toString() || '-',\n        size: \"small\",\n        offset: true,\n        icon: ArrowDropDownIcon,\n        iconPosition: \"right\",\n        anchorOrigin: {\n          vertical: 'bottom',\n          horizontal: 'left'\n        },\n        items: years.map(function (year) {\n          return {\n            id: year,\n            label: year.toString(),\n            callback: _this2.handleClickChangeYear(year)\n          };\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 7\n      }, this);\n\n      var usersContent = usersList && usersList.length > 0 && /*#__PURE__*/_jsxDEV(AvatarGroup, {\n        users: usersList,\n        max: 4,\n        nestedClasses: {\n          root: classes.avatars\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 7\n      }, this);\n\n      return /*#__PURE__*/_jsxDEV(Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(SectionHeader, {\n          title: pageTitle,\n          icon: pageIcon,\n          testid: \"\".concat(type, \"-chart-section-header\"),\n          nestedClasses: {\n            root: classes.header\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            icon: MapIcon,\n            size: \"medium\",\n            text: /*#__PURE__*/_jsxDEV(Translate, {\n              label: \"portfolio.title\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 437,\n              columnNumber: 19\n            }, this),\n            variant: \"contained\",\n            color: \"secondary\",\n            onClick: this.handleViewPortfolio,\n            \"data-testid\": \"view-portfolio\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(PageHeader, {\n          logo: headerLogo,\n          items: [{\n            icon: pageIcon,\n            title: utils.string.t(\"app.\".concat(type)),\n            content: hasMultipleItems ? Select : /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"textSecondary\",\n              className: classes.parentName,\n              children: parentName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 453,\n              columnNumber: 17\n            }, this)\n          }, {\n            icon: EventAvailableIcon,\n            title: utils.string.t('app.year'),\n            content: yearSelect\n          }, {\n            icon: PeopleIcon,\n            title: utils.string.t('app.users'),\n            content: usersContent\n          }]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 444,\n          columnNumber: 9\n        }, this), parent.placements && parent.placements.length > 0 && /*#__PURE__*/_jsxDEV(Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Sticky, {\n            top: stickyOffset,\n            parent: stickyParent,\n            nestedClasses: {\n              root: classes.sticky\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: classes.filterGroup,\n              children: [utils.generic.isValidArray(departmentsList, true) && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classes.filter,\n                children: /*#__PURE__*/_jsxDEV(CardList, {\n                  title: \"Departments\",\n                  data: departmentsList,\n                  nestedClasses: {\n                    card: classes.card\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 477,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 19\n              }, this), utils.generic.isValidArray(officesList, true) && showOfficeSelection && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classes.filter,\n                children: /*#__PURE__*/_jsxDEV(CardList, {\n                  title: \"Offices\",\n                  data: officesList,\n                  nestedClasses: {\n                    card: classes.card\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 482,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.content,\n            children: [/*#__PURE__*/_jsxDEV(ChartPremiumByAccount, {\n              placements: filteredPlacements,\n              year: selectedYear,\n              offices: filteredOffices\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 15\n            }, this), showByMarket && /*#__PURE__*/_jsxDEV(ChartPremiumByMarket, {\n              placements: filteredPlacements,\n              year: selectedYear,\n              offices: filteredOffices\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 32\n            }, this), showByYear && /*#__PURE__*/_jsxDEV(ChartPremiumByYear, {\n              placements: filteredPlacements\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 30\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return ClientCharts;\n}(PureComponent);\nClientCharts.displayName = \"ClientCharts\";\n\n_defineProperty(ClientCharts, \"propTypes\", {\n  type: PropTypes.oneOf(['client', 'market'])\n});\n\n_defineProperty(ClientCharts, \"defaultProps\", {\n  showByMarket: true,\n  showByYear: true,\n  showOfficeSelection: true\n});\n\nClientCharts.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [{\n    \"name\": \"getUrlParamsOfficeIds\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [],\n    \"returns\": null\n  }, {\n    \"name\": \"getDepartments\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"placements\",\n      \"type\": null\n    }, {\n      \"name\": \"placementsYear\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"getDepartmentsList\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"placements\",\n      \"type\": null\n    }, {\n      \"name\": \"selectedYear\",\n      \"type\": null\n    }, {\n      \"name\": \"filterEmpty\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"premiumsByCurrency\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"premiumByCurrency\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"getOffices\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"placements\",\n      \"type\": null\n    }, {\n      \"name\": \"offices\",\n      \"type\": null\n    }, {\n      \"name\": \"customSelectedDepartments\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"getOfficesList\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"offices\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"getUsers\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"offices\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"filterPlacements\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"placements\",\n      \"type\": null\n    }, {\n      \"name\": \"offices\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"handleClickFilter\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"type\",\n      \"type\": null\n    }, {\n      \"name\": \"id\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"handleClickChangeParent\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"parent\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"handleClickChangeYear\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"year\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"handleViewPortfolio\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [],\n    \"returns\": null\n  }],\n  \"displayName\": \"ClientCharts\",\n  \"props\": {\n    \"showByMarket\": {\n      \"defaultValue\": {\n        \"value\": \"true\",\n        \"computed\": false\n      },\n      \"required\": false\n    },\n    \"showByYear\": {\n      \"defaultValue\": {\n        \"value\": \"true\",\n        \"computed\": false\n      },\n      \"required\": false\n    },\n    \"showOfficeSelection\": {\n      \"defaultValue\": {\n        \"value\": \"true\",\n        \"computed\": false\n      },\n      \"required\": false\n    },\n    \"type\": {\n      \"type\": {\n        \"name\": \"enum\",\n        \"value\": [{\n          \"value\": \"'client'\",\n          \"computed\": false\n        }, {\n          \"value\": \"'market'\",\n          \"computed\": false\n        }]\n      },\n      \"required\": false,\n      \"description\": \"\"\n    }\n  }\n};\nexport default compose(withRouter, connect(mapStateToProps, mapDispatchToProps), withStyles(styles), withThemeListener, withTheme)(ClientCharts);\n\nif (typeof STORYBOOK_REACT_CLASSES !== \"undefined\") {\n  STORYBOOK_REACT_CLASSES[\"src\\\\modules\\\\ClientCharts\\\\ClientCharts.js\"] = {\n    name: \"ClientCharts\",\n    docgenInfo: ClientCharts.__docgenInfo,\n    path: \"src\\\\modules\\\\ClientCharts\\\\ClientCharts.js\"\n  };\n}","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ClientCharts/ClientCharts.js"],"names":["React","PureComponent","Fragment","PropTypes","connect","compose","withRouter","firstBy","kebabCase","toNumber","flatten","isEmpty","uniqBy","range","pick","xor","get","styles","updatePortfolioMapDepartment","resetPortfolioMap","AvatarGroup","CardList","PageHeader","PopoverMenu","Sticky","Button","Translate","SectionHeader","ChartPremiumByAccount","ChartPremiumByMarket","ChartPremiumByYear","PortfolioMapHeader","showModal","withThemeListener","utils","config","withStyles","withTheme","Typography","PeopleIcon","EventAvailableIcon","ArrowDropDownIcon","MapIcon","mapStateToProps","state","user","referenceDataCurrencies","referenceData","currencies","referenceDataDepartments","departments","filteredDepartments","portfolioMap","tiv","mapDispatchToProps","ClientCharts","props","officeIds","offices","split","map","o","placements","placementsYear","selectedDepartments","reduce","list","placement","year","getYear","isValid","deptId","departmentId","deptName","getDepartmentName","premiumByCurrency","getPremiumBySettlementCurrency","isNew","some","item","id","name","active","includes","dept","mergePremiumsByCurrency","sort","selectedYear","filterEmpty","getDepartments","rawId","title","children","premiumsByCurrency","onClick","handleClickFilter","filter","dep","depVal","generic","isValidArray","length","classes","Object","keys","currency","string","t","value","number","customSelectedDepartments","selectedOffices","defaultOffices","office","hasPremiums","Boolean","isWithinDepartments","clients","forEach","client","officeId","isClientInOffice","c","listObj","isPlacementAlreadyIn","thenBy","array","users","acc","cobrokers","Array","isArray","isInvalidOrEmptyArray","activeOffices","activeOfficeClients","placementClients","isWithinOffices","p","type","event","selectedCardDepartments","setState","parent","officeSlug","history","push","routes","logo","getLogoFilePath","selected","component","fullWidth","fullScreen","titleChildren","disableAutoFocus","componentProps","currentYear","app","getCurrentYear","years","match","userDeptId","department","getDefault","getOffices","d","urlParamsOfficeIds","getUrlParamsOfficeIds","params","defaultDept","find","newSelectedDepartments","cardDepartments","getDepartmentsList","cardDepartmentsWithSelection","defaultOfficesFromUrlParams","newSelectedOffices","slug","replace","showByMarket","showByYear","showOfficeSelection","pageIcon","pageTitle","tabletUp","theme","headerLogo","parentName","hasMultipleItems","stickyParent","getElement","stickyOffset","mixins","header","height","filteredOffices","filteredPlacements","filterPlacements","departmentsList","officesList","getOfficesList","usersList","getUsers","Select","vertical","horizontal","label","callback","handleClickChangeParent","yearSelect","toString","handleClickChangeYear","usersContent","root","avatars","handleViewPortfolio","icon","content","sticky","filterGroup","card","oneOf"],"mappings":"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","sourcesContent":["import React, { PureComponent, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from 'redux';\r\nimport { withRouter } from 'react-router';\r\nimport { firstBy } from 'thenby';\r\nimport kebabCase from 'lodash/kebabCase';\r\nimport toNumber from 'lodash/toNumber';\r\nimport flatten from 'lodash/flatten';\r\nimport isEmpty from 'lodash/isEmpty';\r\nimport uniqBy from 'lodash/uniqBy';\r\nimport range from 'lodash/range';\r\nimport pick from 'lodash/pick';\r\nimport xor from 'lodash/xor';\r\nimport get from 'lodash/get';\r\n\r\n// app\r\nimport styles from './ClientCharts.styles';\r\nimport { updatePortfolioMapDepartment, resetPortfolioMap } from 'stores';\r\nimport { AvatarGroup, CardList, PageHeader, PopoverMenu, Sticky, Button, Translate, SectionHeader } from 'components';\r\nimport { ChartPremiumByAccount, ChartPremiumByMarket, ChartPremiumByYear, PortfolioMapHeader } from 'modules';\r\nimport { showModal } from 'stores';\r\nimport { withThemeListener } from 'hoc';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\n// mui\r\nimport { withStyles, withTheme, Typography } from '@material-ui/core';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport EventAvailableIcon from '@material-ui/icons/EventAvailable';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport MapIcon from '@material-ui/icons/Map';\r\n\r\n// state\r\nconst mapStateToProps = (state) => ({\r\n  user: state.user,\r\n  referenceDataCurrencies: state.referenceData.currencies,\r\n  referenceDataDepartments: state.referenceData.departments,\r\n  filteredDepartments: state.portfolioMap.tiv.filteredDepartments,\r\n});\r\n\r\n// dispatch\r\nconst mapDispatchToProps = {\r\n  showModal,\r\n  updatePortfolioMapDepartment,\r\n  resetPortfolioMap,\r\n};\r\n\r\nexport class ClientCharts extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const currentYear = utils.app.getCurrentYear();\r\n\r\n    this.state = {\r\n      years: range(currentYear, 2018), // 2018 won't be included in the range, 2019 will therefore be the last\r\n      selectedYear: currentYear,\r\n      selectedDepartments: [],\r\n      selectedOffices: [],\r\n    };\r\n  }\r\n\r\n  static propTypes = {\r\n    type: PropTypes.oneOf(['client', 'market']),\r\n  };\r\n\r\n  static defaultProps = {\r\n    showByMarket: true,\r\n    showByYear: true,\r\n    showOfficeSelection: true,\r\n  };\r\n\r\n  getUrlParamsOfficeIds = () => {\r\n    const officeIds = get(this.props, 'match.params.officeIds');\r\n\r\n    // abort\r\n    if (!officeIds) return [];\r\n\r\n    const offices = officeIds.split('-') || [];\r\n\r\n    return offices.map((o) => toNumber(o));\r\n  };\r\n\r\n  getDepartments = (placements, placementsYear) => {\r\n    const { selectedDepartments } = this.state;\r\n    const { referenceDataDepartments } = this.props;\r\n\r\n    return placements\r\n      .reduce((list, placement) => {\r\n        const year = utils.placement.getYear(placement);\r\n        const isValid = year === placementsYear;\r\n\r\n        // Only keep placements for defined year\r\n        if (!isValid) return list;\r\n\r\n        const deptId = placement.departmentId;\r\n        const deptName = utils.placement.getDepartmentName(placement, referenceDataDepartments);\r\n        const premiumByCurrency = utils.placement.getPremiumBySettlementCurrency(placement, true, true);\r\n        const isNew = !list.some((item) => item.id === deptId);\r\n\r\n        return isNew\r\n          ? [\r\n              ...list,\r\n              {\r\n                id: deptId,\r\n                name: deptName,\r\n                premiumByCurrency,\r\n                active: selectedDepartments.includes(deptId),\r\n              },\r\n            ]\r\n          : list.map((dept) => {\r\n              if (dept.id === deptId) {\r\n                return {\r\n                  ...dept,\r\n                  premiumByCurrency: utils.placement.mergePremiumsByCurrency(dept.premiumByCurrency, premiumByCurrency),\r\n                };\r\n              }\r\n\r\n              return dept;\r\n            });\r\n      }, [])\r\n      .sort(firstBy('premiumByCurrency', -1));\r\n  };\r\n\r\n  getDepartmentsList = (placements, selectedYear, filterEmpty = false) => {\r\n    const departments = this.getDepartments(placements, selectedYear).map((dept) => {\r\n      return {\r\n        id: `${dept.id}-${dept.name}`,\r\n        rawId: dept.id,\r\n        title: dept.name || '-',\r\n        children: this.premiumsByCurrency(dept.premiumByCurrency),\r\n        active: dept.active,\r\n        onClick: this.handleClickFilter('departments', dept.id),\r\n      };\r\n    });\r\n    return filterEmpty\r\n      ? departments.filter(\r\n          (dep) =>\r\n            flatten(dep.children.props.children.filter((depVal) => utils.generic.isValidArray(depVal))).filter((dep) => !!dep).length > 0\r\n        )\r\n      : departments;\r\n  };\r\n\r\n  premiumsByCurrency = (premiumByCurrency) => {\r\n    const { classes } = this.props;\r\n    return (\r\n      <ul className={classes.premiumByCurrency}>\r\n        {isEmpty(premiumByCurrency) && <li>0</li>}\r\n        {Object.keys(premiumByCurrency).map((currency) => (\r\n          <li key={currency}>\r\n            {utils.string.t('format.currency', { value: { number: premiumByCurrency[currency], currency, default: '-' } })}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    );\r\n  };\r\n\r\n  getOffices = (placements, offices = [], customSelectedDepartments) => {\r\n    const { selectedDepartments, selectedOffices } = this.state;\r\n\r\n    const defaultOffices = offices.map((office) => {\r\n      return {\r\n        ...pick(office, ['id', 'name', 'clients', 'cobrokers']),\r\n        active: selectedOffices.includes(office.id),\r\n        placements: [],\r\n        premiumByCurrency: {},\r\n      };\r\n    });\r\n\r\n    return placements\r\n      .reduce((list, placement) => {\r\n        const year = utils.placement.getYear(placement);\r\n        const isValid = year === this.state.selectedYear;\r\n\r\n        // Only keep placements for defined year\r\n        if (!isValid) return list;\r\n\r\n        const premiumByCurrency = utils.placement.getPremiumBySettlementCurrency(placement, true, true);\r\n\r\n        const hasPremiums = Boolean(premiumByCurrency);\r\n        const isWithinDepartments = customSelectedDepartments\r\n          ? customSelectedDepartments.includes(placement.departmentId)\r\n          : selectedDepartments.includes(placement.departmentId);\r\n\r\n        if (hasPremiums && isWithinDepartments) {\r\n          placement.clients.forEach((client) => {\r\n            offices.forEach((office) => {\r\n              const officeId = office.id;\r\n              const isClientInOffice = office.clients.some((c) => c.id === client.id);\r\n              if (isClientInOffice) {\r\n                list = list.map((listObj) => {\r\n                  if (listObj.id === officeId) {\r\n                    const isPlacementAlreadyIn = listObj.placements.includes(placement.id);\r\n\r\n                    if (!isPlacementAlreadyIn) {\r\n                      return {\r\n                        ...listObj,\r\n                        premiumByCurrency: utils.placement.mergePremiumsByCurrency(listObj.premiumByCurrency, premiumByCurrency),\r\n                        placements: [...listObj.placements, placement.id],\r\n                      };\r\n                    }\r\n                  }\r\n\r\n                  return listObj;\r\n                });\r\n              }\r\n            });\r\n          });\r\n        }\r\n\r\n        return list;\r\n      }, defaultOffices)\r\n      .filter((o) => {\r\n        return Object.keys(o.premiumByCurrency).length > 0;\r\n      })\r\n      .sort(firstBy('premiumByCurrency', -1).thenBy(utils.sort.array('lexical', 'name')));\r\n  };\r\n\r\n  getOfficesList = (offices) => {\r\n    return offices.map((o) => {\r\n      return {\r\n        id: `${o.id}-${o.name}`,\r\n        title: o.name || '-',\r\n        children: this.premiumsByCurrency(o.premiumByCurrency),\r\n        active: o.active,\r\n        onClick: this.handleClickFilter('offices', o.id),\r\n      };\r\n    });\r\n  };\r\n\r\n  getUsers = (offices) => {\r\n    const users = offices.reduce((acc, office) => {\r\n      if (!office.active || !office.cobrokers || !Array.isArray(office.cobrokers)) return acc;\r\n\r\n      return [...acc, ...office.cobrokers];\r\n    }, []);\r\n\r\n    return uniqBy(users, 'id');\r\n  };\r\n\r\n  filterPlacements = (placements, offices) => {\r\n    const { selectedDepartments, selectedOffices } = this.state;\r\n\r\n    // abort\r\n    if (utils.generic.isInvalidOrEmptyArray(placements) || utils.generic.isInvalidOrEmptyArray(offices)) return [];\r\n\r\n    const activeOffices = offices.filter((o) => selectedOffices.includes(o.id));\r\n    const activeOfficeClients = uniqBy(flatten(activeOffices.map((office) => office.clients)), 'id') || [];\r\n\r\n    // only keep placement within the selected departments/offices\r\n    return placements.filter((placement) => {\r\n      const placementClients = placement.clients || [];\r\n      const isWithinDepartments = selectedDepartments.includes(placement.departmentId);\r\n      const isWithinOffices = placementClients.some((p) => activeOfficeClients.some((c) => c.id === p.id));\r\n\r\n      return isWithinDepartments && isWithinOffices;\r\n    });\r\n  };\r\n\r\n  handleClickFilter = (type, id) => (event) => {\r\n    const { updatePortfolioMapDepartment, filteredDepartments } = this.props;\r\n\r\n    switch (type) {\r\n      case 'departments':\r\n        const selectedDepartments = xor(this.state.selectedDepartments, [id]);\r\n        const selectedCardDepartments = filteredDepartments.map((dep) => (dep.rawId === id ? { ...dep, active: !dep.active } : dep));\r\n        updatePortfolioMapDepartment(selectedCardDepartments);\r\n        this.setState({ selectedDepartments });\r\n        break;\r\n      case 'offices':\r\n        this.setState({\r\n          selectedOffices: xor(this.state.selectedOffices, [id]),\r\n        });\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  handleClickChangeParent = (parent) => (event) => {\r\n    const { type } = this.props;\r\n    const officeId = parent && parent.id;\r\n    const officeSlug = parent && parent.name ? `/${kebabCase(parent.name)}` : '';\r\n\r\n    this.props.history.push(`${config.routes[type].item}/${officeId}${officeSlug}`);\r\n  };\r\n\r\n  handleClickChangeYear = (year) => (event) => {\r\n    this.setState({ selectedYear: year });\r\n  };\r\n\r\n  componentWillUnmount() {\r\n    const { resetPortfolioMap } = this.props;\r\n    resetPortfolioMap();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { selectedYear } = this.state;\r\n    const { user, parent, history, match, updatePortfolioMapDepartment } = this.props;\r\n\r\n    const userDeptId = utils.user.department.getDefault(user);\r\n    const departments = this.getDepartments(parent.placements, selectedYear);\r\n    const offices = this.getOffices(\r\n      parent.placements,\r\n      parent.offices,\r\n      departments.map((d) => d.id)\r\n    );\r\n    const urlParamsOfficeIds = this.getUrlParamsOfficeIds();\r\n    const params = match && get(match, 'params');\r\n\r\n    // departments\r\n    if (utils.generic.isValidArray(departments, true)) {\r\n      const defaultDept = departments.find((d) => d.id === userDeptId);\r\n      const newSelectedDepartments = defaultDept && defaultDept.id ? [defaultDept.id] : departments.map((d) => d.id);\r\n      const cardDepartments = this.getDepartmentsList(parent.placements, selectedYear, true);\r\n      const cardDepartmentsWithSelection = newSelectedDepartments.length\r\n        ? cardDepartments.map((dep) => (dep.rawId === newSelectedDepartments[0] ? { ...dep, active: true } : dep))\r\n        : cardDepartments;\r\n\r\n      updatePortfolioMapDepartment(cardDepartmentsWithSelection);\r\n\r\n      this.setState({ selectedDepartments: newSelectedDepartments });\r\n    }\r\n\r\n    // offices\r\n    if (utils.generic.isValidArray(offices, true)) {\r\n      const defaultOfficesFromUrlParams = offices.filter((o) => urlParamsOfficeIds.includes(o.id));\r\n      const newSelectedOffices = utils.generic.isValidArray(defaultOfficesFromUrlParams, true)\r\n        ? defaultOfficesFromUrlParams.map((o) => o.id)\r\n        : offices.map((o) => o.id);\r\n\r\n      this.setState({ selectedOffices: newSelectedOffices });\r\n    }\r\n\r\n    // redirect to shorter URL if requested office doesn't exist\r\n    if (utils.generic.isValidArray(urlParamsOfficeIds, true) && !offices.some((o) => urlParamsOfficeIds.includes(o.id))) {\r\n      if (params && params.id && params.slug) {\r\n        history.replace(`${config.routes.client.item}/${params.id}/${params.slug}`);\r\n      } else {\r\n        history.replace(`${config.routes.client.item}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleViewPortfolio = () => {\r\n    const { parent, showModal, type } = this.props;\r\n    const logo = utils.client.parent.getLogoFilePath(parent.selected);\r\n\r\n    showModal({\r\n      component: 'PORTFOLIO_MAP',\r\n      props: {\r\n        fullWidth: true,\r\n        fullScreen: true,\r\n        titleChildren: <PortfolioMapHeader logo={logo} title={`portfolio.title_${type}`} />,\r\n        disableAutoFocus: true,\r\n        componentProps: {\r\n          parent,\r\n        },\r\n      },\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { years, selectedYear } = this.state;\r\n    const { type, showByMarket, showByYear, showOfficeSelection, pageIcon, pageTitle, parent, tabletUp, theme, classes } = this.props;\r\n\r\n    // abort\r\n    if (!parent.selected) return null;\r\n\r\n    const headerLogo = utils.client.parent.getLogoFilePath(parent.selected);\r\n    const parentName = parent.selected ? parent.selected.name : '';\r\n    const hasMultipleItems = parent.list.length > 1;\r\n    const stickyParent = tabletUp ? utils.app.getElement('#content') : null;\r\n    const stickyOffset = tabletUp ? 0 : theme.mixins.header.height;\r\n\r\n    const filteredOffices = this.getOffices(parent.placements, parent.offices);\r\n    const filteredPlacements = this.filterPlacements(parent.placements, filteredOffices);\r\n\r\n    const departmentsList = this.getDepartmentsList(parent.placements, selectedYear);\r\n    const officesList = this.getOfficesList(filteredOffices);\r\n    const usersList = this.getUsers(filteredOffices);\r\n\r\n    const Select = (\r\n      <PopoverMenu\r\n        id={`${type}-select`}\r\n        text={parentName}\r\n        size=\"small\"\r\n        offset\r\n        icon={ArrowDropDownIcon}\r\n        iconPosition=\"right\"\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'left',\r\n        }}\r\n        items={parent.list.map((parent) => {\r\n          return {\r\n            id: parent.id,\r\n            label: parent.name,\r\n            callback: this.handleClickChangeParent(parent),\r\n          };\r\n        })}\r\n      />\r\n    );\r\n\r\n    const yearSelect = (\r\n      <PopoverMenu\r\n        id=\"year-select\"\r\n        text={selectedYear.toString() || '-'}\r\n        size=\"small\"\r\n        offset\r\n        icon={ArrowDropDownIcon}\r\n        iconPosition=\"right\"\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'left',\r\n        }}\r\n        items={years.map((year) => {\r\n          return {\r\n            id: year,\r\n            label: year.toString(),\r\n            callback: this.handleClickChangeYear(year),\r\n          };\r\n        })}\r\n      />\r\n    );\r\n\r\n    const usersContent = usersList && usersList.length > 0 && (\r\n      <AvatarGroup users={usersList} max={4} nestedClasses={{ root: classes.avatars }} />\r\n    );\r\n\r\n    return (\r\n      <Fragment>\r\n        <SectionHeader title={pageTitle} icon={pageIcon} testid={`${type}-chart-section-header`} nestedClasses={{ root: classes.header }}>\r\n          <Button\r\n            icon={MapIcon}\r\n            size=\"medium\"\r\n            text={<Translate label=\"portfolio.title\" />}\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            onClick={this.handleViewPortfolio}\r\n            data-testid=\"view-portfolio\"\r\n          />\r\n        </SectionHeader>\r\n        <PageHeader\r\n          logo={headerLogo}\r\n          items={[\r\n            {\r\n              icon: pageIcon,\r\n              title: utils.string.t(`app.${type}`),\r\n              content: hasMultipleItems ? (\r\n                Select\r\n              ) : (\r\n                <Typography variant=\"body2\" color=\"textSecondary\" className={classes.parentName}>\r\n                  {parentName}\r\n                </Typography>\r\n              ),\r\n            },\r\n            {\r\n              icon: EventAvailableIcon,\r\n              title: utils.string.t('app.year'),\r\n              content: yearSelect,\r\n            },\r\n            {\r\n              icon: PeopleIcon,\r\n              title: utils.string.t('app.users'),\r\n              content: usersContent,\r\n            },\r\n          ]}\r\n        />\r\n\r\n        {parent.placements && parent.placements.length > 0 && (\r\n          <Fragment>\r\n            <Sticky top={stickyOffset} parent={stickyParent} nestedClasses={{ root: classes.sticky }}>\r\n              <div className={classes.filterGroup}>\r\n                {utils.generic.isValidArray(departmentsList, true) && (\r\n                  <div className={classes.filter}>\r\n                    <CardList title=\"Departments\" data={departmentsList} nestedClasses={{ card: classes.card }} />\r\n                  </div>\r\n                )}\r\n                {utils.generic.isValidArray(officesList, true) && showOfficeSelection && (\r\n                  <div className={classes.filter}>\r\n                    <CardList title=\"Offices\" data={officesList} nestedClasses={{ card: classes.card }} />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </Sticky>\r\n\r\n            <div className={classes.content}>\r\n              <ChartPremiumByAccount placements={filteredPlacements} year={selectedYear} offices={filteredOffices} />\r\n              {showByMarket && <ChartPremiumByMarket placements={filteredPlacements} year={selectedYear} offices={filteredOffices} />}\r\n              {showByYear && <ChartPremiumByYear placements={filteredPlacements} />}\r\n            </div>\r\n          </Fragment>\r\n        )}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withRouter,\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles),\r\n  withThemeListener,\r\n  withTheme\r\n)(ClientCharts);\r\n"]},"metadata":{},"sourceType":"module"}