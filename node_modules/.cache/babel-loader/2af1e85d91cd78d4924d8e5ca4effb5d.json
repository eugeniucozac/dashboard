{"ast":null,"code":"import _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport flatten from 'lodash/flatten';\nimport get from 'lodash/get';\nimport upperCase from 'lodash/upperCase'; // app\n\nimport * as utils from 'utils';\nimport config from 'config';\nimport * as constants from 'consts';\nimport { processingInstructionsSchema } from 'schemas';\nexport var getData = function getData(_ref) {\n  var _processingInstructio, _processingInstructio2, _processingInstructio3;\n\n  var _ref$processingInstru = _ref.processingInstruction,\n      processingInstruction = _ref$processingInstru === void 0 ? {} : _ref$processingInstru,\n      departmentName = _ref.departmentName,\n      _ref$frontEndContactN = _ref.frontEndContactName,\n      frontEndContactName = _ref$frontEndContactN === void 0 ? '' : _ref$frontEndContactN,\n      _ref$authorizedSignat = _ref.authorizedSignatoryName,\n      authorizedSignatoryName = _ref$authorizedSignat === void 0 ? '' : _ref$authorizedSignat,\n      _ref$accountExecutive = _ref.accountExecutiveName,\n      accountExecutiveName = _ref$accountExecutive === void 0 ? '' : _ref$accountExecutive,\n      _ref$producingBrokerN = _ref.producingBrokerName,\n      producingBrokerName = _ref$producingBrokerN === void 0 ? '' : _ref$producingBrokerN,\n      refDataCurrencies = _ref.refDataCurrencies;\n  var labels = helpers.getLabels();\n  var leadRiskRefNumber = utils.generic.isValidArray(processingInstruction === null || processingInstruction === void 0 ? void 0 : processingInstruction.riskReferences, true) && (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio = processingInstruction.riskReferences) === null || _processingInstructio === void 0 ? void 0 : (_processingInstructio2 = _processingInstructio.find(function (r) {\n    return r.leadPolicy;\n  })) === null || _processingInstructio2 === void 0 ? void 0 : _processingInstructio2.riskRefId);\n  var leadRiskRefDetails = leadRiskRefNumber && (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio3 = processingInstruction.financialChecklistDetails) === null || _processingInstructio3 === void 0 ? void 0 : _processingInstructio3.find(function (a) {\n    return a.riskReference === leadRiskRefNumber;\n  })) || {};\n  if (!processingInstruction) return;\n  return {\n    labels: labels,\n    tableHeader: helpers.createHeader(),\n    summaryBody: helpers.createSummaryBody(processingInstruction, departmentName, frontEndContactName, accountExecutiveName, producingBrokerName),\n    checklistBody: flatten(['prePlacing', 'mrc', 'otherDetails'].map(function (sectionKey) {\n      return helpers.createChecklistBody(processingInstruction, sectionKey, false);\n    })),\n    instructionBody: helpers.createInstructionBody(processingInstruction, refDataCurrencies, leadRiskRefDetails),\n    specialBody: helpers.createSpecialBody(processingInstruction),\n    attachedDocumentBody: helpers.createAttachedDocumemtBody(processingInstruction),\n    approvalBody: helpers.createApprovalBody(processingInstruction, frontEndContactName, authorizedSignatoryName)\n  };\n};\nvar helpers = {\n  getSettlementCurrency: function getSettlementCurrency(id, refDataCurrencies) {\n    var _refDataCurrencies$fi;\n\n    return (_refDataCurrencies$fi = refDataCurrencies.find(function (ref) {\n      var _ref$currencyCodeID;\n\n      return (ref === null || ref === void 0 ? void 0 : (_ref$currencyCodeID = ref.currencyCodeID) === null || _ref$currencyCodeID === void 0 ? void 0 : _ref$currencyCodeID.toString()) === (id === null || id === void 0 ? void 0 : id.toString());\n    })) === null || _refDataCurrencies$fi === void 0 ? void 0 : _refDataCurrencies$fi.currencyCd;\n  },\n  getPaymentBasis: function getPaymentBasis(code) {\n    var _paymentBasisOptions$;\n\n    var paymentBasisOptions = [{\n      id: 1,\n      code: 'cash',\n      name: 'Cash'\n    }, {\n      id: 2,\n      code: 'quaterly',\n      name: 'Quaterly'\n    }, {\n      id: 3,\n      code: 'otherDeferred',\n      name: 'Other Deferred'\n    }];\n    return (_paymentBasisOptions$ = paymentBasisOptions.find(function (p) {\n      return p.code === code;\n    })) === null || _paymentBasisOptions$ === void 0 ? void 0 : _paymentBasisOptions$.name;\n  },\n  getPpwOrPpc: function getPpwOrPpc(code) {\n    var _ppwOrPpcOptions$find;\n\n    var ppwOrPpcOptions = [{\n      id: 1,\n      code: 'ppw',\n      name: 'PPW',\n      value: 1\n    }, {\n      id: 2,\n      code: 'ppc',\n      name: 'PPC',\n      value: 2\n    }, {\n      id: 3,\n      code: 'na',\n      name: 'N/A',\n      value: 3\n    }];\n    return (_ppwOrPpcOptions$find = ppwOrPpcOptions.find(function (p) {\n      return p.code === code;\n    })) === null || _ppwOrPpcOptions$find === void 0 ? void 0 : _ppwOrPpcOptions$find.name;\n  },\n  getMultiToggleLabel: function getMultiToggleLabel(value) {\n    if (!value) return;\n    var newValue = '';\n\n    if (value === constants.PI_TOGGLE_ID_YES) {\n      return newValue = utils.string.t('app.yes');\n    }\n\n    if (value === constants.PI_TOGGLE_ID_NO) {\n      return newValue = utils.string.t('app.no');\n    }\n\n    if (value === constants.PI_TOGGLE_ID_NA) {\n      return newValue = utils.string.t('app.na');\n    }\n\n    return newValue;\n  },\n  createHeader: function createHeader() {\n    return [['processingInstructionDetails', 'frontEndContact', 'authorisedSignatory'].map(function (headerKey) {\n      return helpers.getHeaderLabel(headerKey);\n    })];\n  },\n  createChecklistBody: function createChecklistBody(processingInstruction, sectionKey, subHeader) {\n    if (!processingInstruction) return [];\n    var rows = get(processingInstructionsSchema, \"content.\".concat(sectionKey));\n    if (!rows || !Array.isArray(rows)) return [];\n    var data = rows.map(function (row) {\n      var item = processingInstruction.checklist.find(function (item) {\n        return item.checkListDetails === row.rowKey;\n      }) || {};\n      var labelColumn = \"\".concat(helpers.getRowLabel(sectionKey, row.rowKey));\n      return [item.signedDate ? \"\".concat(labelColumn, \" (\").concat(utils.string.t('format.date', {\n        value: {\n          date: item.signedDate,\n          format: config.ui.format.date.text\n        }\n      }), \")\") : labelColumn, upperCase(helpers.renderAccountHandler(item.accountHandler, row, processingInstruction.checklist)).replace(/ /g, '/'), item.authorisedSignatory ? utils.string.t('app.authorised') : '-'];\n    });\n    return [[{\n      colSpan: 3,\n      content: subHeader ? helpers.getSectionSubHeader(sectionKey) : helpers.getSectionLabel(sectionKey)\n    }]].concat(_toConsumableArray(data));\n  },\n  createInstructionBody: function createInstructionBody(processingInstruction, refDataCurrencies, leadRiskRefDetails) {\n    var _processingInstructio4, _processingInstructio5, _processingInstructio6, _processingInstructio7, _processingInstructio8, _processingInstructio9, _processingInstructio10, _processingInstructio11, _processingInstructio12, _processingInstructio13, _processingInstructio14, _processingInstructio15, _processingInstructio16, _processingInstructio17, _processingInstructio18, _processingInstructio19, _processingInstructio20, _processingInstructio21, _processingInstructio22, _processingInstructio23, _processingInstructio24, _processingInstructio25, _processingInstructio26;\n\n    if (!processingInstruction) return [];\n    var premiumTaxCalSheetAttach = helpers.getMultiToggleLabel(processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio4 = processingInstruction.details) === null || _processingInstructio4 === void 0 ? void 0 : _processingInstructio4.premiumTaxCalculationSheetAttached);\n    var signedLinesCalAttach = helpers.getMultiToggleLabel(processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio5 = processingInstruction.details) === null || _processingInstructio5 === void 0 ? void 0 : _processingInstructio5.signedLinesCalculationSheetAttached);\n    var amount = utils.processingInstructions.getRetainedBrokerageValue(leadRiskRefDetails.grossPremiumAmount, leadRiskRefDetails.slipOrder, leadRiskRefDetails.retainedBrokerage);\n    var brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(leadRiskRefDetails.retainedBrokerageCurrencyCode || constants.CURRENCY_USD, amount);\n    var totalValue = leadRiskRefDetails.clientDiscount && leadRiskRefDetails.thirdPartyCommissionSharing && leadRiskRefDetails.pfInternalCommissionSharing && leadRiskRefDetails.retainedBrokerage ? utils.generic.getSumOfArray([leadRiskRefDetails.clientDiscount, leadRiskRefDetails.thirdPartyCommissionSharing, leadRiskRefDetails.pfInternalCommissionSharing, leadRiskRefDetails.retainedBrokerage], config.ui.format.percent.decimal) : null;\n    return [[utils.string.t('processingInstructions.pdf.instructionLabels.piPageSubHeader')], [utils.string.t('processingInstructions.pdf.instructionLabels.premiumAndTaxCalSheetAttach'), premiumTaxCalSheetAttach ? premiumTaxCalSheetAttach : utils.string.t('app.no'), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio6 = processingInstruction.details) === null || _processingInstructio6 === void 0 ? void 0 : _processingInstructio6.premiumTaxAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.signedLinesCalAttach'), signedLinesCalAttach ? signedLinesCalAttach : utils.string.t('app.no'), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio7 = processingInstruction.details) === null || _processingInstructio7 === void 0 ? void 0 : _processingInstructio7.signedLinesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.grossPremium'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.grossPremiumAmount, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio8 = processingInstruction.details) === null || _processingInstructio8 === void 0 ? void 0 : _processingInstructio8.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.slipOrder'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.slipOrder, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio9 = processingInstruction.details) === null || _processingInstructio9 === void 0 ? void 0 : _processingInstructio9.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.totalBrokerage'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.totalBrokerage, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio10 = processingInstruction.details) === null || _processingInstructio10 === void 0 ? void 0 : _processingInstructio10.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.clientDiscount'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.clientDiscount, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio11 = processingInstruction.details) === null || _processingInstructio11 === void 0 ? void 0 : _processingInstructio11.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyCommSharing'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.thirdPartyCommissionSharing, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio12 = processingInstruction.details) === null || _processingInstructio12 === void 0 ? void 0 : _processingInstructio12.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyName'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.thirdPartyName, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio13 = processingInstruction.details) === null || _processingInstructio13 === void 0 ? void 0 : _processingInstructio13.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalCommissionSharing'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.pfInternalCommissionSharing, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio14 = processingInstruction.details) === null || _processingInstructio14 === void 0 ? void 0 : _processingInstructio14.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalDeptName'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.pfInternalDepartment, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio15 = processingInstruction.details) === null || _processingInstructio15 === void 0 ? void 0 : _processingInstructio15.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerage'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.retainedBrokerage, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio16 = processingInstruction.details) === null || _processingInstructio16 === void 0 ? void 0 : _processingInstructio16.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerageAmount'), \"\".concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio17 = processingInstruction.details) === null || _processingInstructio17 === void 0 ? void 0 : _processingInstructio17.retainedBrokerageCurrencyCode) ? processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio18 = processingInstruction.details) === null || _processingInstructio18 === void 0 ? void 0 : _processingInstructio18.retainedBrokerageCurrencyCode : '', \" \").concat(amount), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio19 = processingInstruction.details) === null || _processingInstructio19 === void 0 ? void 0 : _processingInstructio19.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokergaeAmountInSelectedCurr'), \"GBP \".concat((brokerage === null || brokerage === void 0 ? void 0 : brokerage.value) ? brokerage === null || brokerage === void 0 ? void 0 : brokerage.value : '', \" @ \").concat(utils.string.t('format.number', {\n      value: {\n        number: brokerage === null || brokerage === void 0 ? void 0 : brokerage.rate,\n        format: {\n          trimMantissa: false\n        }\n      }\n    })), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio20 = processingInstruction.details) === null || _processingInstructio20 === void 0 ? void 0 : _processingInstructio20.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.total'), totalValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio21 = processingInstruction.details) === null || _processingInstructio21 === void 0 ? void 0 : _processingInstructio21.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.fees'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.fees, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio22 = processingInstruction.details) === null || _processingInstructio22 === void 0 ? void 0 : _processingInstructio22.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.otherDeductions'), leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.otherDeductions, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio23 = processingInstruction.details) === null || _processingInstructio23 === void 0 ? void 0 : _processingInstructio23.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.settlementCurrency'), helpers.getSettlementCurrency(leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.settlementCurrency, refDataCurrencies), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio24 = processingInstruction.details) === null || _processingInstructio24 === void 0 ? void 0 : _processingInstructio24.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.paymentBasis'), helpers.getPaymentBasis(leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.paymentBasis), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio25 = processingInstruction.details) === null || _processingInstructio25 === void 0 ? void 0 : _processingInstructio25.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [(leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.ppwOrPpcDate) ? \"\".concat(utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable'), \" (\").concat(utils.string.t('format.date', {\n      value: {\n        date: leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.ppwOrPpcDate,\n        format: config.ui.format.date.text\n      }\n    }), \")\") : utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable'), helpers.getPpwOrPpc(leadRiskRefDetails === null || leadRiskRefDetails === void 0 ? void 0 : leadRiskRefDetails.ppwOrPpc), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio26 = processingInstruction.details) === null || _processingInstructio26 === void 0 ? void 0 : _processingInstructio26.riskReferencesAuthorisedSignatory) ? utils.string.t('app.authorised') : '-']];\n  },\n  calculateTotal: function calculateTotal(lineItems) {\n    var sourceRowIds = ['totalClientDiscount', 'totalThirdParty', 'totalPfInternal', 'totalRetainedBrokerage'];\n    var values = lineItems.filter(function (item) {\n      return sourceRowIds.includes(item.itemKey);\n    }).map(function (item) {\n      return item.accountHandler;\n    });\n    return utils.generic.getSumOfArray(values, config.ui.format.percent.decimal);\n  },\n  calculateRetainedBrokerageAmount: function calculateRetainedBrokerageAmount(lineItems) {\n    var premiumCurrency = (lineItems.find(function (item) {\n      return item.itemKey === 'retainedBrokerageAmount';\n    }) || {}).premiumCurrency || '';\n    var grossPremium = lineItems.find(function (item) {\n      return item.itemKey === 'grossPremium';\n    });\n    var slipOrder = lineItems.find(function (item) {\n      return item.itemKey === 'slipOrder';\n    });\n    var totalRetainedBrokerage = lineItems.find(function (item) {\n      return item.itemKey === 'totalRetainedBrokerage';\n    });\n    if (!utils.generic.isValidObject(grossPremium) || !utils.generic.isValidObject(slipOrder) || !utils.generic.isValidObject(totalRetainedBrokerage)) return;\n    var brokerageAmount = utils.openingMemo.getRetainedBrokerageValue(grossPremium.accountHandler, slipOrder.accountHandler, totalRetainedBrokerage.accountHandler);\n    var convertedBrokerage = utils.openingMemo.getRetainedBrokerageConvertedValue(premiumCurrency, brokerageAmount);\n    var convertedBrokerageString = convertedBrokerage ? \" / GBP \".concat(convertedBrokerage.value, \" @ \").concat(utils.string.t('format.number', {\n      value: {\n        number: convertedBrokerage.rate,\n        format: {\n          trimMantissa: false\n        }\n      }\n    })) : '';\n    return \"\".concat(premiumCurrency, \" \").concat(brokerageAmount).concat(convertedBrokerageString);\n  },\n  renderAccountHandler: function renderAccountHandler(accountHandler, row, lineItems) {\n    var cell = row.cells.find(function (cell) {\n      return cell.name === 'accountHandler';\n    });\n    if (!cell) return;\n    if (row.rowKey === 'total') return helpers.calculateTotal(lineItems);\n    if (row.rowKey === 'retainedBrokerageAmount') return helpers.calculateRetainedBrokerageAmount(lineItems);\n    if (!cell.component || !cell.component.optionsKey) return accountHandler;\n    return utils.form.getSelectOption(cell.component.optionsKey, {}, accountHandler);\n  },\n  createSummaryBody: function createSummaryBody(processingInstruction, departmentName, frontEndContactName, accountExecutiveName, producingBrokerName) {\n    var _processingInstructio27, _processingInstructio28, _processingInstructio29, _processingInstructio30, _processingInstructio31, _processingInstructio32;\n\n    var processType = constants.PROCESS_TYPE_ID_CLOSING === (processingInstruction === null || processingInstruction === void 0 ? void 0 : processingInstruction.processTypeId) ? constants.PROCESS_TYPE_CLOSING : constants.PROCESS_TYPE_ID_FDO === (processingInstruction === null || processingInstruction === void 0 ? void 0 : processingInstruction.processTypeId) ? constants.PROCESS_TYPE_FDO : '';\n    var leadRef = processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio27 = processingInstruction.riskReferences) === null || _processingInstructio27 === void 0 ? void 0 : _processingInstructio27.find(function (r) {\n      return r.leadPolicy;\n    });\n    var allRiskRefs = processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio28 = processingInstruction.riskReferences) === null || _processingInstructio28 === void 0 ? void 0 : _processingInstructio28.map(function (r) {\n      return r.riskRefId;\n    });\n    return [[utils.string.t('processingInstructions.pdf.summaryLabels.processType'), upperCase(processType)], [utils.string.t('processingInstructions.pdf.summaryLabels.addedRiskRef'), allRiskRefs.join(', ')], [utils.string.t('processingInstructions.pdf.summaryLabels.leadRiskRef'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.riskRefId], [utils.string.t('processingInstructions.pdf.summaryLabels.gxbInstance'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.xbInstance], [utils.string.t('processingInstructions.pdf.summaryLabels.department'), departmentName], [utils.string.t('processingInstructions.pdf.summaryLabels.reInsuredOrCoverHolderName'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.assuredName], [utils.string.t('processingInstructions.pdf.summaryLabels.period'), \"From: \".concat(leadRef === null || leadRef === void 0 ? void 0 : leadRef.inceptionDate, \" To: \").concat(leadRef === null || leadRef === void 0 ? void 0 : leadRef.expiryDate)], [utils.string.t('processingInstructions.pdf.summaryLabels.invoicingClient'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.clientName], [utils.string.t('processingInstructions.pdf.summaryLabels.contactName'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio29 = processingInstruction.details) === null || _processingInstructio29 === void 0 ? void 0 : _processingInstructio29.contactName], [utils.string.t('processingInstructions.pdf.summaryLabels.clientEmail'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio30 = processingInstruction.details) === null || _processingInstructio30 === void 0 ? void 0 : _processingInstructio30.clientEmail], [utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceContactName'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio31 = processingInstruction.details) === null || _processingInstructio31 === void 0 ? void 0 : _processingInstructio31.eocInvoiceContactName], [utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceEmail'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio32 = processingInstruction.details) === null || _processingInstructio32 === void 0 ? void 0 : _processingInstructio32.eocInvoiceMail], [utils.string.t('processingInstructions.pdf.summaryLabels.producingBroker'), producingBrokerName], [utils.string.t('processingInstructions.pdf.summaryLabels.accountExecutive'), accountExecutiveName], [utils.string.t('processingInstructions.pdf.summaryLabels.frontEndContactName'), frontEndContactName], [{\n      colSpan: 2,\n      content: utils.string.t('processingInstructions.pdf.leadRiskReferenceLegend')\n    }]];\n  },\n  createApprovalBody: function createApprovalBody(processingInstruction, frontEndContactName, authorizedSignatoryName) {\n    return [[\"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.name'), \": \").concat(frontEndContactName), \"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.name'), \": \").concat(authorizedSignatoryName)], [\"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.approved'), \": \").concat(helpers.formatDate(new Date())), \"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.approved'), \": \").concat(helpers.formatDate(new Date()))]];\n  },\n  createAttachedDocumemtBody: function createAttachedDocumemtBody(processingInstruction) {\n    var _processingInstructio33, _leadRef$gxbDocuments;\n\n    var leadRef = processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio33 = processingInstruction.riskReferences) === null || _processingInstructio33 === void 0 ? void 0 : _processingInstructio33.find(function (r) {\n      return r.leadPolicy;\n    });\n    var gxbDocuments = leadRef === null || leadRef === void 0 ? void 0 : (_leadRef$gxbDocuments = leadRef.gxbDocuments) === null || _leadRef$gxbDocuments === void 0 ? void 0 : _leadRef$gxbDocuments.map(function (item, index) {\n      return [index + 1, item.name];\n    });\n    return [[\"\".concat(utils.string.t('processingInstructions.pdf.attachedDocumentSection.sno')), \"\".concat(utils.string.t('processingInstructions.pdf.attachedDocumentSection.header'))]].concat(_toConsumableArray(gxbDocuments));\n  },\n  createSpecialBody: function createSpecialBody(processingInstruction) {\n    var _processingInstructio34, _processingInstructio35, _processingInstructio36;\n\n    return [[\"\".concat(utils.string.t('processingInstructions.pdf.specialInstructions.highPriority'), \": \").concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio34 = processingInstruction.details) === null || _processingInstructio34 === void 0 ? void 0 : _processingInstructio34.highPriority) || '-'), \"\".concat(utils.string.t('processingInstructions.pdf.specialInstructions.frontEndSendDocuments'), \": \").concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio35 = processingInstruction.details) === null || _processingInstructio35 === void 0 ? void 0 : _processingInstructio35.frontEndSendDocs) || '-')], [{\n      colSpan: 2,\n      content: \"\".concat(utils.string.t('processingInstructions.pdf.specialInstructions.notes'), \": \").concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio36 = processingInstruction.details) === null || _processingInstructio36 === void 0 ? void 0 : _processingInstructio36.notes) || '-')\n    }]];\n  },\n  formatDate: function formatDate(date) {\n    return utils.string.t('format.date', {\n      value: {\n        date: date,\n        format: config.ui.format.date.text\n      }\n    });\n  },\n  getLabels: function getLabels() {\n    return {\n      na: utils.string.t('form.options.yesNoNa.na'),\n      approved: utils.string.t('app.approved'),\n      pdfHeader: utils.string.t('placement.openingMemo.pdf.header'),\n      instructionToProcessing: utils.string.t('placement.openingMemo.instructionToProcessing'),\n      specialInstructionsHeader: utils.string.t('placement.openingMemo.specialInstructions.header'),\n      attachedDocumentSectionHeader: utils.string.t('placement.openingMemo.attachedDocumentSection.header'),\n      accountHandler: utils.string.t('placement.openingMemo.approvers.accountHandler'),\n      authorisedSignatory: utils.string.t('placement.openingMemo.approvers.authorisedSignatory'),\n      placingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.placingBroker.label'),\n      originatorLabel: utils.string.t('placement.openingMemo.specialInstructions.originator.label'),\n      accountExecutiveLabel: utils.string.t('placement.openingMemo.specialInstructions.accountExecutive.label'),\n      producingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.producingBroker.label'),\n      frontEndContactLabel: utils.string.t('processingInstructions.authorisations.fields.frontEndContact')\n    };\n  },\n  getRowLabel: function getRowLabel(sectionKey, rowKey) {\n    return utils.string.t(\"processingInstructions.checklist.lineItems.\".concat(sectionKey, \".rows.\").concat(rowKey, \".label\"));\n  },\n  getYesNoNaLabel: function getYesNoNaLabel(accountHandler) {\n    return utils.string.t(\"form.options.yesNoNa.\".concat(utils.string.replaceLowerCase(accountHandler)));\n  },\n  getSectionLabel: function getSectionLabel(sectionKey) {\n    return utils.string.t(\"processingInstructions.checklist.lineItems.\".concat(sectionKey, \".label\"));\n  },\n  getSectionSubHeader: function getSectionSubHeader(sectionKey) {\n    return utils.string.t(\"processingInstructions.checklist.lineItems.\".concat(sectionKey, \".subHeader\"));\n  },\n  getHeaderLabel: function getHeaderLabel(headerKey) {\n    return utils.string.t(\"processingInstructions.pdf.pdfColHeaderLabels.\".concat(headerKey));\n  },\n  getOptionLabel: function getOptionLabel(rowKey, value) {\n    return utils.string.t(\"form.options.\".concat(rowKey, \".\").concat(value));\n  }\n};","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsPdf/ProcessingInstructions.pdf.helpers.js"],"names":["flatten","get","upperCase","utils","config","constants","processingInstructionsSchema","getData","processingInstruction","departmentName","frontEndContactName","authorizedSignatoryName","accountExecutiveName","producingBrokerName","refDataCurrencies","labels","helpers","getLabels","leadRiskRefNumber","generic","isValidArray","riskReferences","find","r","leadPolicy","riskRefId","leadRiskRefDetails","financialChecklistDetails","a","riskReference","tableHeader","createHeader","summaryBody","createSummaryBody","checklistBody","map","sectionKey","createChecklistBody","instructionBody","createInstructionBody","specialBody","createSpecialBody","attachedDocumentBody","createAttachedDocumemtBody","approvalBody","createApprovalBody","getSettlementCurrency","id","ref","currencyCodeID","toString","currencyCd","getPaymentBasis","code","paymentBasisOptions","name","p","getPpwOrPpc","ppwOrPpcOptions","value","getMultiToggleLabel","newValue","PI_TOGGLE_ID_YES","string","t","PI_TOGGLE_ID_NO","PI_TOGGLE_ID_NA","headerKey","getHeaderLabel","subHeader","rows","Array","isArray","data","row","item","checklist","checkListDetails","rowKey","labelColumn","getRowLabel","signedDate","date","format","ui","text","renderAccountHandler","accountHandler","replace","authorisedSignatory","colSpan","content","getSectionSubHeader","getSectionLabel","premiumTaxCalSheetAttach","details","premiumTaxCalculationSheetAttached","signedLinesCalAttach","signedLinesCalculationSheetAttached","amount","processingInstructions","getRetainedBrokerageValue","grossPremiumAmount","slipOrder","retainedBrokerage","brokerage","getRetainedBrokerageConvertedValue","retainedBrokerageCurrencyCode","CURRENCY_USD","totalValue","clientDiscount","thirdPartyCommissionSharing","pfInternalCommissionSharing","getSumOfArray","percent","decimal","premiumTaxAuthorisedSignatory","signedLinesAuthorisedSignatory","riskReferencesAuthorisedSignatory","totalBrokerage","thirdPartyName","pfInternalDepartment","number","rate","trimMantissa","fees","otherDeductions","settlementCurrency","paymentBasis","ppwOrPpcDate","ppwOrPpc","calculateTotal","lineItems","sourceRowIds","values","filter","includes","itemKey","calculateRetainedBrokerageAmount","premiumCurrency","grossPremium","totalRetainedBrokerage","isValidObject","brokerageAmount","openingMemo","convertedBrokerage","convertedBrokerageString","cell","cells","component","optionsKey","form","getSelectOption","processType","PROCESS_TYPE_ID_CLOSING","processTypeId","PROCESS_TYPE_CLOSING","PROCESS_TYPE_ID_FDO","PROCESS_TYPE_FDO","leadRef","allRiskRefs","join","xbInstance","assuredName","inceptionDate","expiryDate","clientName","contactName","clientEmail","eocInvoiceContactName","eocInvoiceMail","formatDate","Date","gxbDocuments","index","highPriority","frontEndSendDocs","notes","na","approved","pdfHeader","instructionToProcessing","specialInstructionsHeader","attachedDocumentSectionHeader","placingBrokerLabel","originatorLabel","accountExecutiveLabel","producingBrokerLabel","frontEndContactLabel","getYesNoNaLabel","replaceLowerCase","getOptionLabel"],"mappings":";AAAA,OAAOA,OAAP,MAAoB,gBAApB;AACA,OAAOC,GAAP,MAAgB,YAAhB;AACA,OAAOC,SAAP,MAAsB,kBAAtB,C,CAEA;;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAO,KAAKC,SAAZ,MAA2B,QAA3B;AACA,SAASC,4BAAT,QAA6C,SAA7C;AAEA,OAAO,IAAMC,OAAO,GAAG,SAAVA,OAAU,OAQjB;AAAA;;AAAA,mCAPJC,qBAOI;AAAA,MAPJA,qBAOI,sCAPoB,EAOpB;AAAA,MANJC,cAMI,QANJA,cAMI;AAAA,mCALJC,mBAKI;AAAA,MALJA,mBAKI,sCALkB,EAKlB;AAAA,mCAJJC,uBAII;AAAA,MAJJA,uBAII,sCAJsB,EAItB;AAAA,mCAHJC,oBAGI;AAAA,MAHJA,oBAGI,sCAHmB,EAGnB;AAAA,mCAFJC,mBAEI;AAAA,MAFJA,mBAEI,sCAFkB,EAElB;AAAA,MADJC,iBACI,QADJA,iBACI;AACJ,MAAMC,MAAM,GAAGC,OAAO,CAACC,SAAR,EAAf;AACA,MAAMC,iBAAiB,GACrBf,KAAK,CAACgB,OAAN,CAAcC,YAAd,CAA2BZ,qBAA3B,aAA2BA,qBAA3B,uBAA2BA,qBAAqB,CAAEa,cAAlD,EAAkE,IAAlE,MACAb,qBADA,aACAA,qBADA,gDACAA,qBAAqB,CAAEa,cADvB,oFACA,sBAAuCC,IAAvC,CAA4C,UAACC,CAAD;AAAA,WAAOA,CAAC,CAACC,UAAT;AAAA,GAA5C,CADA,2DACA,uBAAkEC,SADlE,CADF;AAGA,MAAMC,kBAAkB,GACrBR,iBAAiB,KAAIV,qBAAJ,aAAIA,qBAAJ,iDAAIA,qBAAqB,CAAEmB,yBAA3B,2DAAI,uBAAkDL,IAAlD,CAAuD,UAACM,CAAD;AAAA,WAAOA,CAAC,CAACC,aAAF,KAAoBX,iBAA3B;AAAA,GAAvD,CAAJ,CAAlB,IAA+H,EADjI;AAGA,MAAI,CAACV,qBAAL,EAA4B;AAC5B,SAAO;AACLO,IAAAA,MAAM,EAANA,MADK;AAELe,IAAAA,WAAW,EAAEd,OAAO,CAACe,YAAR,EAFR;AAGLC,IAAAA,WAAW,EAAEhB,OAAO,CAACiB,iBAAR,CACXzB,qBADW,EAEXC,cAFW,EAGXC,mBAHW,EAIXE,oBAJW,EAKXC,mBALW,CAHR;AAULqB,IAAAA,aAAa,EAAElC,OAAO,CACpB,CAAC,YAAD,EAAe,KAAf,EAAsB,cAAtB,EAAsCmC,GAAtC,CAA0C,UAACC,UAAD;AAAA,aAAgBpB,OAAO,CAACqB,mBAAR,CAA4B7B,qBAA5B,EAAmD4B,UAAnD,EAA+D,KAA/D,CAAhB;AAAA,KAA1C,CADoB,CAVjB;AAaLE,IAAAA,eAAe,EAAEtB,OAAO,CAACuB,qBAAR,CACf/B,qBADe,EAEfM,iBAFe,EAGfY,kBAHe,CAbZ;AAkBLc,IAAAA,WAAW,EAAExB,OAAO,CAACyB,iBAAR,CAA0BjC,qBAA1B,CAlBR;AAmBLkC,IAAAA,oBAAoB,EAAE1B,OAAO,CAAC2B,0BAAR,CAAmCnC,qBAAnC,CAnBjB;AAoBLoC,IAAAA,YAAY,EAAE5B,OAAO,CAAC6B,kBAAR,CAA2BrC,qBAA3B,EAAkDE,mBAAlD,EAAuEC,uBAAvE;AApBT,GAAP;AAsBD,CAvCM;AAyCP,IAAMK,OAAO,GAAG;AACd8B,EAAAA,qBAAqB,EAAE,+BAACC,EAAD,EAAKjC,iBAAL,EAA2B;AAAA;;AAChD,oCAAOA,iBAAiB,CAACQ,IAAlB,CAAuB,UAAC0B,GAAD;AAAA;;AAAA,aAAS,CAAAA,GAAG,SAAH,IAAAA,GAAG,WAAH,mCAAAA,GAAG,CAAEC,cAAL,4EAAqBC,QAArB,SAAoCH,EAApC,aAAoCA,EAApC,uBAAoCA,EAAE,CAAEG,QAAJ,EAApC,CAAT;AAAA,KAAvB,CAAP,0DAAO,sBAAqFC,UAA5F;AACD,GAHa;AAIdC,EAAAA,eAAe,EAAE,yBAACC,IAAD,EAAU;AAAA;;AACzB,QAAMC,mBAAmB,GAAG,CAC1B;AAAEP,MAAAA,EAAE,EAAE,CAAN;AAASM,MAAAA,IAAI,EAAE,MAAf;AAAuBE,MAAAA,IAAI,EAAE;AAA7B,KAD0B,EAE1B;AAAER,MAAAA,EAAE,EAAE,CAAN;AAASM,MAAAA,IAAI,EAAE,UAAf;AAA2BE,MAAAA,IAAI,EAAE;AAAjC,KAF0B,EAG1B;AAAER,MAAAA,EAAE,EAAE,CAAN;AAASM,MAAAA,IAAI,EAAE,eAAf;AAAgCE,MAAAA,IAAI,EAAE;AAAtC,KAH0B,CAA5B;AAKA,oCAAOD,mBAAmB,CAAChC,IAApB,CAAyB,UAACkC,CAAD;AAAA,aAAOA,CAAC,CAACH,IAAF,KAAWA,IAAlB;AAAA,KAAzB,CAAP,0DAAO,sBAAkDE,IAAzD;AACD,GAXa;AAYdE,EAAAA,WAAW,EAAE,qBAACJ,IAAD,EAAU;AAAA;;AACrB,QAAMK,eAAe,GAAG,CACtB;AAAEX,MAAAA,EAAE,EAAE,CAAN;AAASM,MAAAA,IAAI,EAAE,KAAf;AAAsBE,MAAAA,IAAI,EAAE,KAA5B;AAAmCI,MAAAA,KAAK,EAAE;AAA1C,KADsB,EAEtB;AAAEZ,MAAAA,EAAE,EAAE,CAAN;AAASM,MAAAA,IAAI,EAAE,KAAf;AAAsBE,MAAAA,IAAI,EAAE,KAA5B;AAAmCI,MAAAA,KAAK,EAAE;AAA1C,KAFsB,EAGtB;AAAEZ,MAAAA,EAAE,EAAE,CAAN;AAASM,MAAAA,IAAI,EAAE,IAAf;AAAqBE,MAAAA,IAAI,EAAE,KAA3B;AAAkCI,MAAAA,KAAK,EAAE;AAAzC,KAHsB,CAAxB;AAKA,oCAAOD,eAAe,CAACpC,IAAhB,CAAqB,UAACkC,CAAD;AAAA,aAAOA,CAAC,CAACH,IAAF,KAAWA,IAAlB;AAAA,KAArB,CAAP,0DAAO,sBAA8CE,IAArD;AACD,GAnBa;AAoBdK,EAAAA,mBAAmB,EAAE,6BAACD,KAAD,EAAW;AAC9B,QAAI,CAACA,KAAL,EAAY;AACZ,QAAIE,QAAQ,GAAG,EAAf;;AAEA,QAAIF,KAAK,KAAKtD,SAAS,CAACyD,gBAAxB,EAA0C;AACxC,aAAQD,QAAQ,GAAG1D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,SAAf,CAAnB;AACD;;AACD,QAAIL,KAAK,KAAKtD,SAAS,CAAC4D,eAAxB,EAAyC;AACvC,aAAQJ,QAAQ,GAAG1D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,QAAf,CAAnB;AACD;;AACD,QAAIL,KAAK,KAAKtD,SAAS,CAAC6D,eAAxB,EAAyC;AACvC,aAAQL,QAAQ,GAAG1D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,QAAf,CAAnB;AACD;;AACD,WAAOH,QAAP;AACD,GAlCa;AAmCd9B,EAAAA,YAAY,EAAE,wBAAM;AAClB,WAAO,CACL,CAAC,8BAAD,EAAiC,iBAAjC,EAAoD,qBAApD,EAA2EI,GAA3E,CAA+E,UAACgC,SAAD;AAAA,aAAenD,OAAO,CAACoD,cAAR,CAAuBD,SAAvB,CAAf;AAAA,KAA/E,CADK,CAAP;AAGD,GAvCa;AAwCd9B,EAAAA,mBAAmB,EAAE,6BAAC7B,qBAAD,EAAwB4B,UAAxB,EAAoCiC,SAApC,EAAkD;AACrE,QAAI,CAAC7D,qBAAL,EAA4B,OAAO,EAAP;AAC5B,QAAM8D,IAAI,GAAGrE,GAAG,CAACK,4BAAD,oBAA0C8B,UAA1C,EAAhB;AACA,QAAI,CAACkC,IAAD,IAAS,CAACC,KAAK,CAACC,OAAN,CAAcF,IAAd,CAAd,EAAmC,OAAO,EAAP;AACnC,QAAMG,IAAI,GAAGH,IAAI,CAACnC,GAAL,CAAS,UAACuC,GAAD,EAAS;AAC7B,UAAMC,IAAI,GAAGnE,qBAAqB,CAACoE,SAAtB,CAAgCtD,IAAhC,CAAqC,UAACqD,IAAD;AAAA,eAAUA,IAAI,CAACE,gBAAL,KAA0BH,GAAG,CAACI,MAAxC;AAAA,OAArC,KAAwF,EAArG;AACA,UAAMC,WAAW,aAAM/D,OAAO,CAACgE,WAAR,CAAoB5C,UAApB,EAAgCsC,GAAG,CAACI,MAApC,CAAN,CAAjB;AACA,aAAO,CACLH,IAAI,CAACM,UAAL,aACOF,WADP,eACuB5E,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,aAAf,EAA8B;AAAEL,QAAAA,KAAK,EAAE;AAAEuB,UAAAA,IAAI,EAAEP,IAAI,CAACM,UAAb;AAAyBE,UAAAA,MAAM,EAAE/E,MAAM,CAACgF,EAAP,CAAUD,MAAV,CAAiBD,IAAjB,CAAsBG;AAAvD;AAAT,OAA9B,CADvB,SAEIN,WAHC,EAIL7E,SAAS,CAACc,OAAO,CAACsE,oBAAR,CAA6BX,IAAI,CAACY,cAAlC,EAAkDb,GAAlD,EAAuDlE,qBAAqB,CAACoE,SAA7E,CAAD,CAAT,CAAmGY,OAAnG,CAA2G,IAA3G,EAAiH,GAAjH,CAJK,EAKLb,IAAI,CAACc,mBAAL,GAA2BtF,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAA3B,GAA8D,GALzD,CAAP;AAOD,KAVY,CAAb;AAWA,YAAQ,CAAC;AAAE0B,MAAAA,OAAO,EAAE,CAAX;AAAcC,MAAAA,OAAO,EAAEtB,SAAS,GAAGrD,OAAO,CAAC4E,mBAAR,CAA4BxD,UAA5B,CAAH,GAA6CpB,OAAO,CAAC6E,eAAR,CAAwBzD,UAAxB;AAA7E,KAAD,CAAR,4BAAiIqC,IAAjI;AACD,GAxDa;AAyDdlC,EAAAA,qBAAqB,EAAE,+BACrB/B,qBADqB,EAErBM,iBAFqB,EAGrBY,kBAHqB,EAIlB;AAAA;;AACH,QAAI,CAAClB,qBAAL,EAA4B,OAAO,EAAP;AAE5B,QAAMsF,wBAAwB,GAAG9E,OAAO,CAAC4C,mBAAR,CAA4BpD,qBAA5B,aAA4BA,qBAA5B,iDAA4BA,qBAAqB,CAAEuF,OAAnD,2DAA4B,uBAAgCC,kCAA5D,CAAjC;AAEA,QAAMC,oBAAoB,GAAGjF,OAAO,CAAC4C,mBAAR,CAA4BpD,qBAA5B,aAA4BA,qBAA5B,iDAA4BA,qBAAqB,CAAEuF,OAAnD,2DAA4B,uBAAgCG,mCAA5D,CAA7B;AACA,QAAMC,MAAM,GAAGhG,KAAK,CAACiG,sBAAN,CAA6BC,yBAA7B,CACb3E,kBAAkB,CAAC4E,kBADN,EAEb5E,kBAAkB,CAAC6E,SAFN,EAGb7E,kBAAkB,CAAC8E,iBAHN,CAAf;AAKA,QAAMC,SAAS,GAAGtG,KAAK,CAACiG,sBAAN,CAA6BM,kCAA7B,CAChBhF,kBAAkB,CAACiF,6BAAnB,IAAoDtG,SAAS,CAACuG,YAD9C,EAEhBT,MAFgB,CAAlB;AAIA,QAAMU,UAAU,GACdnF,kBAAkB,CAACoF,cAAnB,IAAqCpF,kBAAkB,CAACqF,2BAAxD,IAAuFrF,kBAAkB,CAACsF,2BAA1G,IAAyItF,kBAAkB,CAAC8E,iBAA5J,GACIrG,KAAK,CAACgB,OAAN,CAAc8F,aAAd,CACE,CAACvF,kBAAkB,CAACoF,cAApB,EAAoCpF,kBAAkB,CAACqF,2BAAvD,EAAoFrF,kBAAkB,CAACsF,2BAAvG,EAAoItF,kBAAkB,CAAC8E,iBAAvJ,CADF,EAEEpG,MAAM,CAACgF,EAAP,CAAUD,MAAV,CAAiB+B,OAAjB,CAAyBC,OAF3B,CADJ,GAKI,IANN;AAOA,WAAO,CACL,CAAChH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,8DAAf,CAAD,CADK,EAEL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,0EAAf,CADF,EAEE8B,wBAAwB,GAAGA,wBAAH,GAA8B3F,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,QAAf,CAFxD,EAGE,CAAAxD,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,sCAAAA,qBAAqB,CAAEuF,OAAvB,kFAAgCqB,6BAAhC,IAAgEjH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAAhE,GAAmG,GAHrG,CAFK,EAOL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,mEAAf,CADF,EAEEiC,oBAAoB,GAAGA,oBAAH,GAA0B9F,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,QAAf,CAFhD,EAGE,CAAAxD,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,sCAAAA,qBAAqB,CAAEuF,OAAvB,kFAAgCsB,8BAAhC,IAAiElH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAAjE,GAAoG,GAHtG,CAPK,EAYL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,2DAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAE4E,kBAFtB,EAGE,CAAA9F,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,sCAAAA,qBAAqB,CAAEuF,OAAvB,kFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CAZK,EAiBL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,wDAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAE6E,SAFtB,EAGE,CAAA/F,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,sCAAAA,qBAAqB,CAAEuF,OAAvB,kFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CAjBK,EAsBL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,6DAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAE6F,cAFtB,EAGE,CAAA/G,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CAtBK,EA2BL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,6DAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAEoF,cAFtB,EAGE,CAAAtG,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CA3BK,EAgCL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,oEAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAEqF,2BAFtB,EAGE,CAAAvG,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CAhCK,EAqCL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,6DAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAE8F,cAFtB,EAGE,CAAAhH,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CArCK,EA0CL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,0EAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAEsF,2BAFtB,EAGE,CAAAxG,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CA1CK,EA+CL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,iEAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAE+F,oBAFtB,EAGE,CAAAjH,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CA/CK,EAoDL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gEAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAE8E,iBAFtB,EAGE,CAAAhG,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CApDK,EAyDL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sEAAf,CADF,YAGI,CAAAxD,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCY,6BAAhC,IAAgEnG,qBAAhE,aAAgEA,qBAAhE,kDAAgEA,qBAAqB,CAAEuF,OAAvF,4DAAgE,wBAAgCY,6BAAhG,GAAgI,EAHpI,cAIMR,MAJN,GAKE,CAAA3F,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GALzG,CAzDK,EAgEL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,oFAAf,CADF,gBAGI,CAAAyC,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAE9C,KAAX,IAAmB8C,SAAnB,aAAmBA,SAAnB,uBAAmBA,SAAS,CAAE9C,KAA9B,GAAsC,EAH1C,gBAIQxD,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,eAAf,EAAgC;AACpCL,MAAAA,KAAK,EAAE;AAAE+D,QAAAA,MAAM,EAAEjB,SAAF,aAAEA,SAAF,uBAAEA,SAAS,CAAEkB,IAArB;AAA2BxC,QAAAA,MAAM,EAAE;AAAEyC,UAAAA,YAAY,EAAE;AAAhB;AAAnC;AAD6B,KAAhC,CAJR,GAOE,CAAApH,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAPzG,CAhEK,EAyEL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,oDAAf,CADF,EAEE6C,UAFF,EAGE,CAAArG,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CAzEK,EA8EL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,mDAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAEmG,IAFtB,EAGE,CAAArH,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CA9EK,EAmFL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,8DAAf,CADF,EAEEtC,kBAFF,aAEEA,kBAFF,uBAEEA,kBAAkB,CAAEoG,eAFtB,EAGE,CAAAtH,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CAnFK,EAwFL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,iEAAf,CADF,EAEEhD,OAAO,CAAC8B,qBAAR,CAA8BpB,kBAA9B,aAA8BA,kBAA9B,uBAA8BA,kBAAkB,CAAEqG,kBAAlD,EAAsEjH,iBAAtE,CAFF,EAGE,CAAAN,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CAxFK,EA6FL,CACE7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,2DAAf,CADF,EAEEhD,OAAO,CAACoC,eAAR,CAAwB1B,kBAAxB,aAAwBA,kBAAxB,uBAAwBA,kBAAkB,CAAEsG,YAA5C,CAFF,EAGE,CAAAxH,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAHzG,CA7FK,EAkGL,CACE,CAAAtC,kBAAkB,SAAlB,IAAAA,kBAAkB,WAAlB,YAAAA,kBAAkB,CAAEuG,YAApB,cACO9H,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,+DAAf,CADP,eAC2F7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,aAAf,EAA8B;AACnHL,MAAAA,KAAK,EAAE;AACLuB,QAAAA,IAAI,EAAExD,kBAAF,aAAEA,kBAAF,uBAAEA,kBAAkB,CAAEuG,YADrB;AAEL9C,QAAAA,MAAM,EAAE/E,MAAM,CAACgF,EAAP,CAAUD,MAAV,CAAiBD,IAAjB,CAAsBG;AAFzB;AAD4G,KAA9B,CAD3F,SAOIlF,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,+DAAf,CARN,EASEhD,OAAO,CAACyC,WAAR,CAAoB/B,kBAApB,aAAoBA,kBAApB,uBAAoBA,kBAAkB,CAAEwG,QAAxC,CATF,EAUE,CAAA1H,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCuB,iCAAhC,IAAoEnH,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gBAAf,CAApE,GAAuG,GAVzG,CAlGK,CAAP;AA+GD,GAlMa;AAmMdmE,EAAAA,cAAc,EAAE,wBAACC,SAAD,EAAe;AAC7B,QAAMC,YAAY,GAAG,CAAC,qBAAD,EAAwB,iBAAxB,EAA2C,iBAA3C,EAA8D,wBAA9D,CAArB;AACA,QAAMC,MAAM,GAAGF,SAAS,CAACG,MAAV,CAAiB,UAAC5D,IAAD;AAAA,aAAU0D,YAAY,CAACG,QAAb,CAAsB7D,IAAI,CAAC8D,OAA3B,CAAV;AAAA,KAAjB,EAAgEtG,GAAhE,CAAoE,UAACwC,IAAD;AAAA,aAAUA,IAAI,CAACY,cAAf;AAAA,KAApE,CAAf;AACA,WAAOpF,KAAK,CAACgB,OAAN,CAAc8F,aAAd,CAA4BqB,MAA5B,EAAoClI,MAAM,CAACgF,EAAP,CAAUD,MAAV,CAAiB+B,OAAjB,CAAyBC,OAA7D,CAAP;AACD,GAvMa;AAwMduB,EAAAA,gCAAgC,EAAE,0CAACN,SAAD,EAAe;AAC/C,QAAMO,eAAe,GAAG,CAACP,SAAS,CAAC9G,IAAV,CAAe,UAACqD,IAAD;AAAA,aAAUA,IAAI,CAAC8D,OAAL,KAAiB,yBAA3B;AAAA,KAAf,KAAwE,EAAzE,EAA6EE,eAA7E,IAAgG,EAAxH;AACA,QAAMC,YAAY,GAAGR,SAAS,CAAC9G,IAAV,CAAe,UAACqD,IAAD;AAAA,aAAUA,IAAI,CAAC8D,OAAL,KAAiB,cAA3B;AAAA,KAAf,CAArB;AACA,QAAMlC,SAAS,GAAG6B,SAAS,CAAC9G,IAAV,CAAe,UAACqD,IAAD;AAAA,aAAUA,IAAI,CAAC8D,OAAL,KAAiB,WAA3B;AAAA,KAAf,CAAlB;AACA,QAAMI,sBAAsB,GAAGT,SAAS,CAAC9G,IAAV,CAAe,UAACqD,IAAD;AAAA,aAAUA,IAAI,CAAC8D,OAAL,KAAiB,wBAA3B;AAAA,KAAf,CAA/B;AAEA,QACE,CAACtI,KAAK,CAACgB,OAAN,CAAc2H,aAAd,CAA4BF,YAA5B,CAAD,IACA,CAACzI,KAAK,CAACgB,OAAN,CAAc2H,aAAd,CAA4BvC,SAA5B,CADD,IAEA,CAACpG,KAAK,CAACgB,OAAN,CAAc2H,aAAd,CAA4BD,sBAA5B,CAHH,EAKE;AAEF,QAAME,eAAe,GAAG5I,KAAK,CAAC6I,WAAN,CAAkB3C,yBAAlB,CACtBuC,YAAY,CAACrD,cADS,EAEtBgB,SAAS,CAAChB,cAFY,EAGtBsD,sBAAsB,CAACtD,cAHD,CAAxB;AAKA,QAAM0D,kBAAkB,GAAG9I,KAAK,CAAC6I,WAAN,CAAkBtC,kCAAlB,CAAqDiC,eAArD,EAAsEI,eAAtE,CAA3B;AACA,QAAMG,wBAAwB,GAAGD,kBAAkB,oBACrCA,kBAAkB,CAACtF,KADkB,gBACPxD,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,eAAf,EAAgC;AACtEL,MAAAA,KAAK,EAAE;AAAE+D,QAAAA,MAAM,EAAEuB,kBAAkB,CAACtB,IAA7B;AAAmCxC,QAAAA,MAAM,EAAE;AAAEyC,UAAAA,YAAY,EAAE;AAAhB;AAA3C;AAD+D,KAAhC,CADO,IAI/C,EAJJ;AAMA,qBAAUe,eAAV,cAA6BI,eAA7B,SAA+CG,wBAA/C;AACD,GAlOa;AAmOd5D,EAAAA,oBAAoB,EAAE,8BAACC,cAAD,EAAiBb,GAAjB,EAAsB0D,SAAtB,EAAoC;AACxD,QAAMe,IAAI,GAAGzE,GAAG,CAAC0E,KAAJ,CAAU9H,IAAV,CAAe,UAAC6H,IAAD;AAAA,aAAUA,IAAI,CAAC5F,IAAL,KAAc,gBAAxB;AAAA,KAAf,CAAb;AACA,QAAI,CAAC4F,IAAL,EAAW;AACX,QAAIzE,GAAG,CAACI,MAAJ,KAAe,OAAnB,EAA4B,OAAO9D,OAAO,CAACmH,cAAR,CAAuBC,SAAvB,CAAP;AAC5B,QAAI1D,GAAG,CAACI,MAAJ,KAAe,yBAAnB,EAA8C,OAAO9D,OAAO,CAAC0H,gCAAR,CAAyCN,SAAzC,CAAP;AAC9C,QAAI,CAACe,IAAI,CAACE,SAAN,IAAmB,CAACF,IAAI,CAACE,SAAL,CAAeC,UAAvC,EAAmD,OAAO/D,cAAP;AACnD,WAAOpF,KAAK,CAACoJ,IAAN,CAAWC,eAAX,CAA2BL,IAAI,CAACE,SAAL,CAAeC,UAA1C,EAAsD,EAAtD,EAA0D/D,cAA1D,CAAP;AACD,GA1Oa;AA2OdtD,EAAAA,iBAAiB,EAAE,2BAACzB,qBAAD,EAAwBC,cAAxB,EAAwCC,mBAAxC,EAA6DE,oBAA7D,EAAmFC,mBAAnF,EAA2G;AAAA;;AAC5H,QAAM4I,WAAW,GACfpJ,SAAS,CAACqJ,uBAAV,MAAsClJ,qBAAtC,aAAsCA,qBAAtC,uBAAsCA,qBAAqB,CAAEmJ,aAA7D,IACItJ,SAAS,CAACuJ,oBADd,GAEIvJ,SAAS,CAACwJ,mBAAV,MAAkCrJ,qBAAlC,aAAkCA,qBAAlC,uBAAkCA,qBAAqB,CAAEmJ,aAAzD,IACAtJ,SAAS,CAACyJ,gBADV,GAEA,EALN;AAMA,QAAMC,OAAO,GAAGvJ,qBAAH,aAAGA,qBAAH,kDAAGA,qBAAqB,CAAEa,cAA1B,4DAAG,wBAAuCC,IAAvC,CAA4C,UAACC,CAAD;AAAA,aAAOA,CAAC,CAACC,UAAT;AAAA,KAA5C,CAAhB;AACA,QAAMwI,WAAW,GAAGxJ,qBAAH,aAAGA,qBAAH,kDAAGA,qBAAqB,CAAEa,cAA1B,4DAAG,wBAAuCc,GAAvC,CAA2C,UAACZ,CAAD;AAAA,aAAOA,CAAC,CAACE,SAAT;AAAA,KAA3C,CAApB;AACA,WAAO,CACL,CAACtB,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sDAAf,CAAD,EAAyE9D,SAAS,CAACuJ,WAAD,CAAlF,CADK,EAEL,CAACtJ,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,uDAAf,CAAD,EAA0EgG,WAAW,CAACC,IAAZ,CAAiB,IAAjB,CAA1E,CAFK,EAGL,CAAC9J,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sDAAf,CAAD,EAAyE+F,OAAzE,aAAyEA,OAAzE,uBAAyEA,OAAO,CAAEtI,SAAlF,CAHK,EAIL,CAACtB,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sDAAf,CAAD,EAAyE+F,OAAzE,aAAyEA,OAAzE,uBAAyEA,OAAO,CAAEG,UAAlF,CAJK,EAKL,CAAC/J,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,qDAAf,CAAD,EAAwEvD,cAAxE,CALK,EAML,CAACN,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,qEAAf,CAAD,EAAwF+F,OAAxF,aAAwFA,OAAxF,uBAAwFA,OAAO,CAAEI,WAAjG,CANK,EAOL,CAAChK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,iDAAf,CAAD,kBAA6E+F,OAA7E,aAA6EA,OAA7E,uBAA6EA,OAAO,CAAEK,aAAtF,kBAA2GL,OAA3G,aAA2GA,OAA3G,uBAA2GA,OAAO,CAAEM,UAApH,EAPK,EAQL,CAAClK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,0DAAf,CAAD,EAA6E+F,OAA7E,aAA6EA,OAA7E,uBAA6EA,OAAO,CAAEO,UAAtF,CARK,EASL,CAACnK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sDAAf,CAAD,EAAyExD,qBAAzE,aAAyEA,qBAAzE,kDAAyEA,qBAAqB,CAAEuF,OAAhG,4DAAyE,wBAAgCwE,WAAzG,CATK,EAUL,CAACpK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sDAAf,CAAD,EAAyExD,qBAAzE,aAAyEA,qBAAzE,kDAAyEA,qBAAqB,CAAEuF,OAAhG,4DAAyE,wBAAgCyE,WAAzG,CAVK,EAWL,CACErK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gEAAf,CADF,EAEExD,qBAFF,aAEEA,qBAFF,kDAEEA,qBAAqB,CAAEuF,OAFzB,4DAEE,wBAAgC0E,qBAFlC,CAXK,EAeL,CAACtK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,0DAAf,CAAD,EAA6ExD,qBAA7E,aAA6EA,qBAA7E,kDAA6EA,qBAAqB,CAAEuF,OAApG,4DAA6E,wBAAgC2E,cAA7G,CAfK,EAgBL,CAACvK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,0DAAf,CAAD,EAA6EnD,mBAA7E,CAhBK,EAiBL,CAACV,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,2DAAf,CAAD,EAA8EpD,oBAA9E,CAjBK,EAkBL,CAACT,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,8DAAf,CAAD,EAAiFtD,mBAAjF,CAlBK,EAmBL,CACE;AACEgF,MAAAA,OAAO,EAAE,CADX;AAEEC,MAAAA,OAAO,EAAExF,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,oDAAf;AAFX,KADF,CAnBK,CAAP;AA0BD,GA9Qa;AA+QdnB,EAAAA,kBAAkB,EAAE,4BAACrC,qBAAD,EAAwBE,mBAAxB,EAA6CC,uBAA7C,EAAyE;AAC3F,WAAO,CACL,WACKR,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,iDAAf,CADL,eAC2EtD,mBAD3E,aAEKP,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,iDAAf,CAFL,eAE2ErD,uBAF3E,EADK,EAKL,WACKR,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,qDAAf,CADL,eAC+EhD,OAAO,CAAC2J,UAAR,CAAmB,IAAIC,IAAJ,EAAnB,CAD/E,aAEKzK,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,qDAAf,CAFL,eAE+EhD,OAAO,CAAC2J,UAAR,CAAmB,IAAIC,IAAJ,EAAnB,CAF/E,EALK,CAAP;AAUD,GA1Ra;AA2RdjI,EAAAA,0BAA0B,EAAE,oCAACnC,qBAAD,EAA2B;AAAA;;AACrD,QAAMuJ,OAAO,GAAGvJ,qBAAH,aAAGA,qBAAH,kDAAGA,qBAAqB,CAAEa,cAA1B,4DAAG,wBAAuCC,IAAvC,CAA4C,UAACC,CAAD;AAAA,aAAOA,CAAC,CAACC,UAAT;AAAA,KAA5C,CAAhB;AACA,QAAMqJ,YAAY,GAAGd,OAAH,aAAGA,OAAH,gDAAGA,OAAO,CAAEc,YAAZ,0DAAG,sBAAuB1I,GAAvB,CAA2B,UAACwC,IAAD,EAAOmG,KAAP;AAAA,aAAiB,CAACA,KAAK,GAAG,CAAT,EAAYnG,IAAI,CAACpB,IAAjB,CAAjB;AAAA,KAA3B,CAArB;AACA,YACE,WACKpD,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,wDAAf,CADL,aAEK7D,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,2DAAf,CAFL,EADF,4BAKK6G,YALL;AAOD,GArSa;AAuSdpI,EAAAA,iBAAiB,EAAE,2BAACjC,qBAAD,EAA2B;AAAA;;AAC5C,WAAO,CACL,WACKL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,6DAAf,CADL,eAEI,CAAAxD,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCgF,YAAhC,KAAgD,GAFpD,aAIK5K,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sEAAf,CAJL,eAKI,CAAAxD,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCiF,gBAAhC,KAAoD,GALxD,EADK,EASL,CACE;AACEtF,MAAAA,OAAO,EAAE,CADX;AAEEC,MAAAA,OAAO,YAAKxF,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sDAAf,CAAL,eACL,CAAAxD,qBAAqB,SAArB,IAAAA,qBAAqB,WAArB,uCAAAA,qBAAqB,CAAEuF,OAAvB,oFAAgCkF,KAAhC,KAAyC,GADpC;AAFT,KADF,CATK,CAAP;AAkBD,GA1Ta;AA2TdN,EAAAA,UAAU,EAAE,oBAACzF,IAAD,EAAU;AACpB,WAAO/E,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,aAAf,EAA8B;AAAEL,MAAAA,KAAK,EAAE;AAAEuB,QAAAA,IAAI,EAAJA,IAAF;AAAQC,QAAAA,MAAM,EAAE/E,MAAM,CAACgF,EAAP,CAAUD,MAAV,CAAiBD,IAAjB,CAAsBG;AAAtC;AAAT,KAA9B,CAAP;AACD,GA7Ta;AA8TdpE,EAAAA,SAAS,EAAE;AAAA,WAAO;AAChBiK,MAAAA,EAAE,EAAE/K,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,yBAAf,CADY;AAEhBmH,MAAAA,QAAQ,EAAEhL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,cAAf,CAFM;AAGhBoH,MAAAA,SAAS,EAAEjL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,kCAAf,CAHK;AAIhBqH,MAAAA,uBAAuB,EAAElL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,+CAAf,CAJT;AAKhBsH,MAAAA,yBAAyB,EAAEnL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,kDAAf,CALX;AAMhBuH,MAAAA,6BAA6B,EAAEpL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,sDAAf,CANf;AAOhBuB,MAAAA,cAAc,EAAEpF,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,gDAAf,CAPA;AAQhByB,MAAAA,mBAAmB,EAAEtF,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,qDAAf,CARL;AAShBwH,MAAAA,kBAAkB,EAAErL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,+DAAf,CATJ;AAUhByH,MAAAA,eAAe,EAAEtL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,4DAAf,CAVD;AAWhB0H,MAAAA,qBAAqB,EAAEvL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,kEAAf,CAXP;AAYhB2H,MAAAA,oBAAoB,EAAExL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,iEAAf,CAZN;AAahB4H,MAAAA,oBAAoB,EAAEzL,KAAK,CAAC4D,MAAN,CAAaC,CAAb,CAAe,8DAAf;AAbN,KAAP;AAAA,GA9TG;AA6UdgB,EAAAA,WAAW,EAAE,qBAAC5C,UAAD,EAAa0C,MAAb;AAAA,WAAwB3E,KAAK,CAAC4D,MAAN,CAAaC,CAAb,sDAA6D5B,UAA7D,mBAAgF0C,MAAhF,YAAxB;AAAA,GA7UC;AA8Ud+G,EAAAA,eAAe,EAAE,yBAACtG,cAAD;AAAA,WAAoBpF,KAAK,CAAC4D,MAAN,CAAaC,CAAb,gCAAuC7D,KAAK,CAAC4D,MAAN,CAAa+H,gBAAb,CAA8BvG,cAA9B,CAAvC,EAApB;AAAA,GA9UH;AA+UdM,EAAAA,eAAe,EAAE,yBAACzD,UAAD;AAAA,WAAgBjC,KAAK,CAAC4D,MAAN,CAAaC,CAAb,sDAA6D5B,UAA7D,YAAhB;AAAA,GA/UH;AAgVdwD,EAAAA,mBAAmB,EAAE,6BAACxD,UAAD;AAAA,WAAgBjC,KAAK,CAAC4D,MAAN,CAAaC,CAAb,sDAA6D5B,UAA7D,gBAAhB;AAAA,GAhVP;AAiVdgC,EAAAA,cAAc,EAAE,wBAACD,SAAD;AAAA,WAAehE,KAAK,CAAC4D,MAAN,CAAaC,CAAb,yDAAgEG,SAAhE,EAAf;AAAA,GAjVF;AAkVd4H,EAAAA,cAAc,EAAE,wBAACjH,MAAD,EAASnB,KAAT;AAAA,WAAmBxD,KAAK,CAAC4D,MAAN,CAAaC,CAAb,wBAA+Bc,MAA/B,cAAyCnB,KAAzC,EAAnB;AAAA;AAlVF,CAAhB","sourcesContent":["import flatten from 'lodash/flatten';\r\nimport get from 'lodash/get';\r\nimport upperCase from 'lodash/upperCase';\r\n\r\n// app\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport * as constants from 'consts';\r\nimport { processingInstructionsSchema } from 'schemas';\r\n\r\nexport const getData = ({\r\n  processingInstruction = {},\r\n  departmentName,\r\n  frontEndContactName = '',\r\n  authorizedSignatoryName = '',\r\n  accountExecutiveName = '',\r\n  producingBrokerName = '',\r\n  refDataCurrencies,\r\n}) => {\r\n  const labels = helpers.getLabels();\r\n  const leadRiskRefNumber =\r\n    utils.generic.isValidArray(processingInstruction?.riskReferences, true) &&\r\n    processingInstruction?.riskReferences?.find((r) => r.leadPolicy)?.riskRefId;\r\n  const leadRiskRefDetails =\r\n    (leadRiskRefNumber && processingInstruction?.financialChecklistDetails?.find((a) => a.riskReference === leadRiskRefNumber)) || {};\r\n\r\n  if (!processingInstruction) return;\r\n  return {\r\n    labels,\r\n    tableHeader: helpers.createHeader(),\r\n    summaryBody: helpers.createSummaryBody(\r\n      processingInstruction,\r\n      departmentName,\r\n      frontEndContactName,\r\n      accountExecutiveName,\r\n      producingBrokerName\r\n    ),\r\n    checklistBody: flatten(\r\n      ['prePlacing', 'mrc', 'otherDetails'].map((sectionKey) => helpers.createChecklistBody(processingInstruction, sectionKey, false))\r\n    ),\r\n    instructionBody: helpers.createInstructionBody(\r\n      processingInstruction,\r\n      refDataCurrencies,\r\n      leadRiskRefDetails\r\n    ),\r\n    specialBody: helpers.createSpecialBody(processingInstruction),\r\n    attachedDocumentBody: helpers.createAttachedDocumemtBody(processingInstruction),\r\n    approvalBody: helpers.createApprovalBody(processingInstruction, frontEndContactName, authorizedSignatoryName),\r\n  };\r\n};\r\n\r\nconst helpers = {\r\n  getSettlementCurrency: (id, refDataCurrencies) => {\r\n    return refDataCurrencies.find((ref) => ref?.currencyCodeID?.toString() === id?.toString())?.currencyCd;\r\n  },\r\n  getPaymentBasis: (code) => {\r\n    const paymentBasisOptions = [\r\n      { id: 1, code: 'cash', name: 'Cash' },\r\n      { id: 2, code: 'quaterly', name: 'Quaterly' },\r\n      { id: 3, code: 'otherDeferred', name: 'Other Deferred' },\r\n    ];\r\n    return paymentBasisOptions.find((p) => p.code === code)?.name;\r\n  },\r\n  getPpwOrPpc: (code) => {\r\n    const ppwOrPpcOptions = [\r\n      { id: 1, code: 'ppw', name: 'PPW', value: 1 },\r\n      { id: 2, code: 'ppc', name: 'PPC', value: 2 },\r\n      { id: 3, code: 'na', name: 'N/A', value: 3 },\r\n    ];\r\n    return ppwOrPpcOptions.find((p) => p.code === code)?.name;\r\n  },\r\n  getMultiToggleLabel: (value) => {\r\n    if (!value) return;\r\n    let newValue = '';\r\n\r\n    if (value === constants.PI_TOGGLE_ID_YES) {\r\n      return (newValue = utils.string.t('app.yes'));\r\n    }\r\n    if (value === constants.PI_TOGGLE_ID_NO) {\r\n      return (newValue = utils.string.t('app.no'));\r\n    }\r\n    if (value === constants.PI_TOGGLE_ID_NA) {\r\n      return (newValue = utils.string.t('app.na'));\r\n    }\r\n    return newValue;\r\n  },\r\n  createHeader: () => {\r\n    return [\r\n      ['processingInstructionDetails', 'frontEndContact', 'authorisedSignatory'].map((headerKey) => helpers.getHeaderLabel(headerKey)),\r\n    ];\r\n  },\r\n  createChecklistBody: (processingInstruction, sectionKey, subHeader) => {\r\n    if (!processingInstruction) return [];\r\n    const rows = get(processingInstructionsSchema, `content.${sectionKey}`);\r\n    if (!rows || !Array.isArray(rows)) return [];\r\n    const data = rows.map((row) => {\r\n      const item = processingInstruction.checklist.find((item) => item.checkListDetails === row.rowKey) || {};\r\n      const labelColumn = `${helpers.getRowLabel(sectionKey, row.rowKey)}`;\r\n      return [\r\n        item.signedDate\r\n          ? `${labelColumn} (${utils.string.t('format.date', { value: { date: item.signedDate, format: config.ui.format.date.text } })})`\r\n          : labelColumn,\r\n        upperCase(helpers.renderAccountHandler(item.accountHandler, row, processingInstruction.checklist)).replace(/ /g, '/'),\r\n        item.authorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ];\r\n    });\r\n    return [[{ colSpan: 3, content: subHeader ? helpers.getSectionSubHeader(sectionKey) : helpers.getSectionLabel(sectionKey) }], ...data];\r\n  },\r\n  createInstructionBody: (\r\n    processingInstruction,\r\n    refDataCurrencies,\r\n    leadRiskRefDetails\r\n  ) => {\r\n    if (!processingInstruction) return [];\r\n\r\n    const premiumTaxCalSheetAttach = helpers.getMultiToggleLabel(processingInstruction?.details?.premiumTaxCalculationSheetAttached);\r\n\r\n    const signedLinesCalAttach = helpers.getMultiToggleLabel(processingInstruction?.details?.signedLinesCalculationSheetAttached);\r\n    const amount = utils.processingInstructions.getRetainedBrokerageValue(\r\n      leadRiskRefDetails.grossPremiumAmount,\r\n      leadRiskRefDetails.slipOrder,\r\n      leadRiskRefDetails.retainedBrokerage\r\n    );\r\n    const brokerage = utils.processingInstructions.getRetainedBrokerageConvertedValue(\r\n      leadRiskRefDetails.retainedBrokerageCurrencyCode || constants.CURRENCY_USD,\r\n      amount\r\n    );\r\n    const totalValue =\r\n      leadRiskRefDetails.clientDiscount && leadRiskRefDetails.thirdPartyCommissionSharing && leadRiskRefDetails.pfInternalCommissionSharing && leadRiskRefDetails.retainedBrokerage\r\n        ? utils.generic.getSumOfArray(\r\n            [leadRiskRefDetails.clientDiscount, leadRiskRefDetails.thirdPartyCommissionSharing, leadRiskRefDetails.pfInternalCommissionSharing, leadRiskRefDetails.retainedBrokerage],\r\n            config.ui.format.percent.decimal\r\n          )\r\n        : null;\r\n    return [\r\n      [utils.string.t('processingInstructions.pdf.instructionLabels.piPageSubHeader')],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.premiumAndTaxCalSheetAttach'),\r\n        premiumTaxCalSheetAttach ? premiumTaxCalSheetAttach : utils.string.t('app.no'),\r\n        processingInstruction?.details?.premiumTaxAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.signedLinesCalAttach'),\r\n        signedLinesCalAttach ? signedLinesCalAttach : utils.string.t('app.no'),\r\n        processingInstruction?.details?.signedLinesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.grossPremium'),\r\n        leadRiskRefDetails?.grossPremiumAmount,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.slipOrder'),\r\n        leadRiskRefDetails?.slipOrder,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.totalBrokerage'),\r\n        leadRiskRefDetails?.totalBrokerage,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.clientDiscount'),\r\n        leadRiskRefDetails?.clientDiscount,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyCommSharing'),\r\n        leadRiskRefDetails?.thirdPartyCommissionSharing,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyName'),\r\n        leadRiskRefDetails?.thirdPartyName,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalCommissionSharing'),\r\n        leadRiskRefDetails?.pfInternalCommissionSharing,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalDeptName'),\r\n        leadRiskRefDetails?.pfInternalDepartment,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerage'),\r\n        leadRiskRefDetails?.retainedBrokerage,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerageAmount'),\r\n        `${\r\n          processingInstruction?.details?.retainedBrokerageCurrencyCode ? processingInstruction?.details?.retainedBrokerageCurrencyCode : ''\r\n        } ${amount}`,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokergaeAmountInSelectedCurr'),\r\n        `GBP ${\r\n          brokerage?.value ? brokerage?.value : ''\r\n        } @ ${utils.string.t('format.number', {\r\n          value: { number: brokerage?.rate, format: { trimMantissa: false } },\r\n        })}`,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.total'),\r\n        totalValue,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.fees'),\r\n        leadRiskRefDetails?.fees,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.otherDeductions'),\r\n        leadRiskRefDetails?.otherDeductions,\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.settlementCurrency'),\r\n        helpers.getSettlementCurrency(leadRiskRefDetails?.settlementCurrency, refDataCurrencies),\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.paymentBasis'),\r\n        helpers.getPaymentBasis(leadRiskRefDetails?.paymentBasis),\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n      [\r\n        leadRiskRefDetails?.ppwOrPpcDate\r\n          ? `${utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable')} (${utils.string.t('format.date', {\r\n              value: {\r\n                date: leadRiskRefDetails?.ppwOrPpcDate,\r\n                format: config.ui.format.date.text,\r\n              },\r\n            })})`\r\n          : utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable'),\r\n        helpers.getPpwOrPpc(leadRiskRefDetails?.ppwOrPpc),\r\n        processingInstruction?.details?.riskReferencesAuthorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ],\r\n    ];\r\n  },\r\n  calculateTotal: (lineItems) => {\r\n    const sourceRowIds = ['totalClientDiscount', 'totalThirdParty', 'totalPfInternal', 'totalRetainedBrokerage'];\r\n    const values = lineItems.filter((item) => sourceRowIds.includes(item.itemKey)).map((item) => item.accountHandler);\r\n    return utils.generic.getSumOfArray(values, config.ui.format.percent.decimal);\r\n  },\r\n  calculateRetainedBrokerageAmount: (lineItems) => {\r\n    const premiumCurrency = (lineItems.find((item) => item.itemKey === 'retainedBrokerageAmount') || {}).premiumCurrency || '';\r\n    const grossPremium = lineItems.find((item) => item.itemKey === 'grossPremium');\r\n    const slipOrder = lineItems.find((item) => item.itemKey === 'slipOrder');\r\n    const totalRetainedBrokerage = lineItems.find((item) => item.itemKey === 'totalRetainedBrokerage');\r\n\r\n    if (\r\n      !utils.generic.isValidObject(grossPremium) ||\r\n      !utils.generic.isValidObject(slipOrder) ||\r\n      !utils.generic.isValidObject(totalRetainedBrokerage)\r\n    )\r\n      return;\r\n\r\n    const brokerageAmount = utils.openingMemo.getRetainedBrokerageValue(\r\n      grossPremium.accountHandler,\r\n      slipOrder.accountHandler,\r\n      totalRetainedBrokerage.accountHandler\r\n    );\r\n    const convertedBrokerage = utils.openingMemo.getRetainedBrokerageConvertedValue(premiumCurrency, brokerageAmount);\r\n    const convertedBrokerageString = convertedBrokerage\r\n      ? ` / GBP ${convertedBrokerage.value} @ ${utils.string.t('format.number', {\r\n          value: { number: convertedBrokerage.rate, format: { trimMantissa: false } },\r\n        })}`\r\n      : '';\r\n\r\n    return `${premiumCurrency} ${brokerageAmount}${convertedBrokerageString}`;\r\n  },\r\n  renderAccountHandler: (accountHandler, row, lineItems) => {\r\n    const cell = row.cells.find((cell) => cell.name === 'accountHandler');\r\n    if (!cell) return;\r\n    if (row.rowKey === 'total') return helpers.calculateTotal(lineItems);\r\n    if (row.rowKey === 'retainedBrokerageAmount') return helpers.calculateRetainedBrokerageAmount(lineItems);\r\n    if (!cell.component || !cell.component.optionsKey) return accountHandler;\r\n    return utils.form.getSelectOption(cell.component.optionsKey, {}, accountHandler);\r\n  },\r\n  createSummaryBody: (processingInstruction, departmentName, frontEndContactName, accountExecutiveName, producingBrokerName) => {\r\n    const processType =\r\n      constants.PROCESS_TYPE_ID_CLOSING === processingInstruction?.processTypeId\r\n        ? constants.PROCESS_TYPE_CLOSING\r\n        : constants.PROCESS_TYPE_ID_FDO === processingInstruction?.processTypeId\r\n        ? constants.PROCESS_TYPE_FDO\r\n        : '';\r\n    const leadRef = processingInstruction?.riskReferences?.find((r) => r.leadPolicy);\r\n    const allRiskRefs = processingInstruction?.riskReferences?.map((r) => r.riskRefId);\r\n    return [\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.processType'), upperCase(processType)],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.addedRiskRef'), allRiskRefs.join(', ')],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.leadRiskRef'), leadRef?.riskRefId],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.gxbInstance'), leadRef?.xbInstance],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.department'), departmentName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.reInsuredOrCoverHolderName'), leadRef?.assuredName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.period'), `From: ${leadRef?.inceptionDate} To: ${leadRef?.expiryDate}`],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.invoicingClient'), leadRef?.clientName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.contactName'), processingInstruction?.details?.contactName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.clientEmail'), processingInstruction?.details?.clientEmail],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceContactName'),\r\n        processingInstruction?.details?.eocInvoiceContactName,\r\n      ],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceEmail'), processingInstruction?.details?.eocInvoiceMail],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.producingBroker'), producingBrokerName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.accountExecutive'), accountExecutiveName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.frontEndContactName'), frontEndContactName],\r\n      [\r\n        {\r\n          colSpan: 2,\r\n          content: utils.string.t('processingInstructions.pdf.leadRiskReferenceLegend'),\r\n        },\r\n      ],\r\n    ];\r\n  },\r\n  createApprovalBody: (processingInstruction, frontEndContactName, authorizedSignatoryName) => {\r\n    return [\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.name')}: ${frontEndContactName}`,\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.name')}: ${authorizedSignatoryName}`,\r\n      ],\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.approved')}: ${helpers.formatDate(new Date())}`,\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.approved')}: ${helpers.formatDate(new Date())}`,\r\n      ],\r\n    ];\r\n  },\r\n  createAttachedDocumemtBody: (processingInstruction) => {\r\n    const leadRef = processingInstruction?.riskReferences?.find((r) => r.leadPolicy);\r\n    const gxbDocuments = leadRef?.gxbDocuments?.map((item, index) => [index + 1, item.name]);\r\n    return [\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.attachedDocumentSection.sno')}`,\r\n        `${utils.string.t('processingInstructions.pdf.attachedDocumentSection.header')}`,\r\n      ],\r\n      ...gxbDocuments,\r\n    ];\r\n  },\r\n\r\n  createSpecialBody: (processingInstruction) => {\r\n    return [\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.specialInstructions.highPriority')}: ${\r\n          processingInstruction?.details?.highPriority || '-'\r\n        }`,\r\n        `${utils.string.t('processingInstructions.pdf.specialInstructions.frontEndSendDocuments')}: ${\r\n          processingInstruction?.details?.frontEndSendDocs || '-'\r\n        }`,\r\n      ],\r\n      [\r\n        {\r\n          colSpan: 2,\r\n          content: `${utils.string.t('processingInstructions.pdf.specialInstructions.notes')}: ${\r\n            processingInstruction?.details?.notes || '-'\r\n          }`,\r\n        },\r\n      ],\r\n    ];\r\n  },\r\n  formatDate: (date) => {\r\n    return utils.string.t('format.date', { value: { date, format: config.ui.format.date.text } });\r\n  },\r\n  getLabels: () => ({\r\n    na: utils.string.t('form.options.yesNoNa.na'),\r\n    approved: utils.string.t('app.approved'),\r\n    pdfHeader: utils.string.t('placement.openingMemo.pdf.header'),\r\n    instructionToProcessing: utils.string.t('placement.openingMemo.instructionToProcessing'),\r\n    specialInstructionsHeader: utils.string.t('placement.openingMemo.specialInstructions.header'),\r\n    attachedDocumentSectionHeader: utils.string.t('placement.openingMemo.attachedDocumentSection.header'),\r\n    accountHandler: utils.string.t('placement.openingMemo.approvers.accountHandler'),\r\n    authorisedSignatory: utils.string.t('placement.openingMemo.approvers.authorisedSignatory'),\r\n    placingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.placingBroker.label'),\r\n    originatorLabel: utils.string.t('placement.openingMemo.specialInstructions.originator.label'),\r\n    accountExecutiveLabel: utils.string.t('placement.openingMemo.specialInstructions.accountExecutive.label'),\r\n    producingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.producingBroker.label'),\r\n    frontEndContactLabel: utils.string.t('processingInstructions.authorisations.fields.frontEndContact'),\r\n  }),\r\n  getRowLabel: (sectionKey, rowKey) => utils.string.t(`processingInstructions.checklist.lineItems.${sectionKey}.rows.${rowKey}.label`),\r\n  getYesNoNaLabel: (accountHandler) => utils.string.t(`form.options.yesNoNa.${utils.string.replaceLowerCase(accountHandler)}`),\r\n  getSectionLabel: (sectionKey) => utils.string.t(`processingInstructions.checklist.lineItems.${sectionKey}.label`),\r\n  getSectionSubHeader: (sectionKey) => utils.string.t(`processingInstructions.checklist.lineItems.${sectionKey}.subHeader`),\r\n  getHeaderLabel: (headerKey) => utils.string.t(`processingInstructions.pdf.pdfColHeaderLabels.${headerKey}`),\r\n  getOptionLabel: (rowKey, value) => utils.string.t(`form.options.${rowKey}.${value}`),\r\n};\r\n"]},"metadata":{},"sourceType":"module"}