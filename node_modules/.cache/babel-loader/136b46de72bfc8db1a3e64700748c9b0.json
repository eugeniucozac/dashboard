{"ast":null,"code":"import \"core-js/modules/es.array.map\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport flatten from 'lodash/flatten';\nimport get from 'lodash/get';\nimport upperCase from 'lodash/upperCase'; // app\n\nimport * as utils from 'utils';\nimport config from 'config';\nimport * as constants from 'consts';\nimport { processingInstructionsSchema } from 'schemas';\nexport var getData = function getData(_ref) {\n  var _ref$processingInstru = _ref.processingInstruction,\n      processingInstruction = _ref$processingInstru === void 0 ? {} : _ref$processingInstru,\n      departmentName = _ref.departmentName,\n      _ref$frontEndContactN = _ref.frontEndContactName,\n      frontEndContactName = _ref$frontEndContactN === void 0 ? '' : _ref$frontEndContactN,\n      _ref$authorizedSignat = _ref.authorizedSignatoryName,\n      authorizedSignatoryName = _ref$authorizedSignat === void 0 ? '' : _ref$authorizedSignat,\n      _ref$accountExecutive = _ref.accountExecutiveName,\n      accountExecutiveName = _ref$accountExecutive === void 0 ? '' : _ref$accountExecutive,\n      _ref$producingBrokerN = _ref.producingBrokerName,\n      producingBrokerName = _ref$producingBrokerN === void 0 ? '' : _ref$producingBrokerN,\n      retainedBrokerageAmountForPdf = _ref.retainedBrokerageAmountForPdf,\n      totalAmountForPdf = _ref.totalAmountForPdf,\n      refDataCurrencies = _ref.refDataCurrencies;\n  var labels = helpers.getLabels();\n  if (!processingInstruction) return;\n  return {\n    labels: labels,\n    tableHeader: helpers.createHeader(),\n    summaryBody: helpers.createSummaryBody(processingInstruction, departmentName, frontEndContactName, accountExecutiveName, producingBrokerName),\n    checklistBody: flatten(['prePlacing', 'mrc', 'otherDetails'].map(function (sectionKey) {\n      return helpers.createChecklistBody(processingInstruction, sectionKey, false);\n    })),\n    instructionBody: helpers.createInstructionBody(processingInstruction, retainedBrokerageAmountForPdf, totalAmountForPdf, refDataCurrencies),\n    specialBody: helpers.createSpecialBody(processingInstruction),\n    attachedDocumentBody: helpers.createAttachedDocumemtBody(processingInstruction),\n    approvalBody: helpers.createApprovalBody(processingInstruction, frontEndContactName, authorizedSignatoryName)\n  };\n};\nvar helpers = {\n  getSettlementCurrency: function getSettlementCurrency(id, refDataCurrencies) {\n    var _refDataCurrencies$fi;\n\n    return (_refDataCurrencies$fi = refDataCurrencies.find(function (ref) {\n      return ref.currencyCodeID === id;\n    })) === null || _refDataCurrencies$fi === void 0 ? void 0 : _refDataCurrencies$fi.currencyCd;\n  },\n  getPaymentBasis: function getPaymentBasis(id) {\n    var _paymentBasisOptions$;\n\n    var paymentBasisOptions = [{\n      id: 1,\n      code: 'cash',\n      name: 'Cash'\n    }, {\n      id: 2,\n      code: 'quaterly',\n      name: 'Quaterly'\n    }, {\n      id: 3,\n      code: 'otherDeferred',\n      name: 'Other Deferred'\n    }];\n    return (_paymentBasisOptions$ = paymentBasisOptions.find(function (p) {\n      return p.id === id;\n    })) === null || _paymentBasisOptions$ === void 0 ? void 0 : _paymentBasisOptions$.name;\n  },\n  getPpwOrPpc: function getPpwOrPpc(id) {\n    var _ppwOrPpcOptions$find;\n\n    var ppwOrPpcOptions = [{\n      id: 1,\n      code: 'ppw',\n      name: 'PPW',\n      value: 1\n    }, {\n      id: 2,\n      code: 'ppc',\n      name: 'PPC',\n      value: 2\n    }, {\n      id: 3,\n      code: 'na',\n      name: 'N/A',\n      value: 3\n    }];\n    return (_ppwOrPpcOptions$find = ppwOrPpcOptions.find(function (p) {\n      return p.id === id;\n    })) === null || _ppwOrPpcOptions$find === void 0 ? void 0 : _ppwOrPpcOptions$find.name;\n  },\n  getMultiToggleLabel: function getMultiToggleLabel(value) {\n    if (!value) return;\n    var newValue = '';\n\n    if (value === constants.PI_TOGGLE_ID_YES) {\n      return newValue = utils.string.t('app.yes');\n    }\n\n    if (value === constants.PI_TOGGLE_ID_NO) {\n      return newValue = utils.string.t('app.no');\n    }\n\n    if (value === constants.PI_TOGGLE_ID_NA) {\n      return newValue = utils.string.t('app.na');\n    }\n\n    return newValue;\n  },\n  createHeader: function createHeader() {\n    return [['processingInstructionDetails', 'frontEndContact', 'authorisedSignatory'].map(function (headerKey) {\n      return helpers.getHeaderLabel(headerKey);\n    })];\n  },\n  createChecklistBody: function createChecklistBody(processingInstruction, sectionKey, subHeader) {\n    if (!processingInstruction) return [];\n    var rows = get(processingInstructionsSchema, \"content.\".concat(sectionKey));\n    if (!rows || !Array.isArray(rows)) return [];\n    var data = rows.map(function (row) {\n      var item = processingInstruction.checklist.find(function (item) {\n        return item.checkListDetails === row.rowKey;\n      }) || {};\n      var labelColumn = \"\".concat(helpers.getRowLabel(sectionKey, row.rowKey));\n      return [item.signedDate ? \"\".concat(labelColumn, \" (\").concat(utils.string.t('format.date', {\n        value: {\n          date: item.signedDate,\n          format: config.ui.format.date.text\n        }\n      }), \")\") : labelColumn, upperCase(helpers.renderAccountHandler(item.accountHandler, row, processingInstruction.checklist)).replace(/ /g, '/'), item.authorisedSignatory ? utils.string.t('app.authorised') : '-'];\n    });\n    return [[{\n      colSpan: 3,\n      content: subHeader ? helpers.getSectionSubHeader(sectionKey) : helpers.getSectionLabel(sectionKey)\n    }]].concat(_toConsumableArray(data));\n  },\n  createInstructionBody: function createInstructionBody(processingInstruction, retainedBrokerageAmountForPdf, totalAmountForPdf, refDataCurrencies) {\n    var _utils$processingInst, _utils$processingInst2, _processingInstructio, _processingInstructio2, _processingInstructio3, _processingInstructio4, _utils$processingInst3, _processingInstructio5, _processingInstructio6, _utils$processingInst4, _processingInstructio7, _processingInstructio8, _utils$processingInst5, _processingInstructio9, _processingInstructio10, _utils$processingInst6, _processingInstructio11, _processingInstructio12, _utils$processingInst7, _processingInstructio13, _processingInstructio14, _utils$processingInst8, _processingInstructio15, _processingInstructio16, _utils$processingInst9, _processingInstructio17, _processingInstructio18, _utils$processingInst10, _processingInstructio19, _processingInstructio20, _utils$processingInst11, _processingInstructio21, _processingInstructio22, _processingInstructio23, _processingInstructio24, _processingInstructio25, _processingInstructio26, _retainedBrokerageAmo, _retainedBrokerageAmo2, _retainedBrokerageAmo3, _processingInstructio27, _processingInstructio28, _processingInstructio29, _processingInstructio30, _utils$processingInst12, _processingInstructio31, _processingInstructio32, _utils$processingInst13, _processingInstructio33, _processingInstructio34, _utils$processingInst14, _processingInstructio35, _processingInstructio36, _utils$processingInst15, _processingInstructio37, _processingInstructio38, _utils$processingInst16, _utils$processingInst17, _utils$processingInst18, _processingInstructio39, _processingInstructio40;\n\n    if (!processingInstruction) return [];\n    var premiumTaxCalSheetAttach = helpers.getMultiToggleLabel((_utils$processingInst = utils.processingInstructions.getFinancialField(processingInstruction, 'premiumTaxCalculationSheetAttached')) === null || _utils$processingInst === void 0 ? void 0 : _utils$processingInst.numberValue);\n    var signedLinesCalAttach = helpers.getMultiToggleLabel((_utils$processingInst2 = utils.processingInstructions.getFinancialField(processingInstruction, 'signedLinesCalculationSheetAttached')) === null || _utils$processingInst2 === void 0 ? void 0 : _utils$processingInst2.numberValue);\n    return [[utils.string.t('processingInstructions.pdf.instructionLabels.piPageSubHeader')], [utils.string.t('processingInstructions.pdf.instructionLabels.premiumAndTaxCalSheetAttach'), premiumTaxCalSheetAttach ? premiumTaxCalSheetAttach : utils.string.t('app.no'), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio = processingInstruction.financialChecklist) === null || _processingInstructio === void 0 ? void 0 : (_processingInstructio2 = _processingInstructio.find(function (item) {\n      return item.name === constants.PREMIUM_TAX_CALCULATION_SHEET_ATTACHED;\n    })) === null || _processingInstructio2 === void 0 ? void 0 : _processingInstructio2.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.signedLinesCalAttach'), signedLinesCalAttach ? signedLinesCalAttach : utils.string.t('app.no'), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio3 = processingInstruction.financialChecklist) === null || _processingInstructio3 === void 0 ? void 0 : (_processingInstructio4 = _processingInstructio3.find(function (item) {\n      return item.name === constants.SIGNED_LINES_CALCULATION_SHEET_ATTACHED;\n    })) === null || _processingInstructio4 === void 0 ? void 0 : _processingInstructio4.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.grossPremium'), (_utils$processingInst3 = utils.processingInstructions.getFinancialField(processingInstruction, 'grossPremiumAmount')) === null || _utils$processingInst3 === void 0 ? void 0 : _utils$processingInst3.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio5 = processingInstruction.financialChecklist) === null || _processingInstructio5 === void 0 ? void 0 : (_processingInstructio6 = _processingInstructio5.find(function (item) {\n      return item.name === constants.GROSS_PREMIUM_AMOUNT;\n    })) === null || _processingInstructio6 === void 0 ? void 0 : _processingInstructio6.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.slipOrder'), (_utils$processingInst4 = utils.processingInstructions.getFinancialField(processingInstruction, 'slipOrder')) === null || _utils$processingInst4 === void 0 ? void 0 : _utils$processingInst4.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio7 = processingInstruction.financialChecklist) === null || _processingInstructio7 === void 0 ? void 0 : (_processingInstructio8 = _processingInstructio7.find(function (item) {\n      return item.name === constants.SLIP_ORDER;\n    })) === null || _processingInstructio8 === void 0 ? void 0 : _processingInstructio8.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.totalBrokerage'), (_utils$processingInst5 = utils.processingInstructions.getFinancialField(processingInstruction, 'totalBrokerage')) === null || _utils$processingInst5 === void 0 ? void 0 : _utils$processingInst5.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio9 = processingInstruction.financialChecklist) === null || _processingInstructio9 === void 0 ? void 0 : (_processingInstructio10 = _processingInstructio9.find(function (item) {\n      return item.name === constants.TOTAL_BROKERAGE;\n    })) === null || _processingInstructio10 === void 0 ? void 0 : _processingInstructio10.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.splitAsFollows'), '', '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.clientDiscount'), (_utils$processingInst6 = utils.processingInstructions.getFinancialField(processingInstruction, 'clientDiscount')) === null || _utils$processingInst6 === void 0 ? void 0 : _utils$processingInst6.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio11 = processingInstruction.financialChecklist) === null || _processingInstructio11 === void 0 ? void 0 : (_processingInstructio12 = _processingInstructio11.find(function (item) {\n      return item.name === constants.CLIENT_DISCOUNT;\n    })) === null || _processingInstructio12 === void 0 ? void 0 : _processingInstructio12.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyCommSharing'), (_utils$processingInst7 = utils.processingInstructions.getFinancialField(processingInstruction, constants.THIRD_PARTY)) === null || _utils$processingInst7 === void 0 ? void 0 : _utils$processingInst7.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio13 = processingInstruction.financialChecklist) === null || _processingInstructio13 === void 0 ? void 0 : (_processingInstructio14 = _processingInstructio13.find(function (item) {\n      return item.name === constants.THIRD_PARTY;\n    })) === null || _processingInstructio14 === void 0 ? void 0 : _processingInstructio14.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyName'), (_utils$processingInst8 = utils.processingInstructions.getFinancialField(processingInstruction, constants.THIRD_PARTY)) === null || _utils$processingInst8 === void 0 ? void 0 : _utils$processingInst8.stringValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio15 = processingInstruction.financialChecklist) === null || _processingInstructio15 === void 0 ? void 0 : (_processingInstructio16 = _processingInstructio15.find(function (item) {\n      return item.name === constants.THIRD_PARTY;\n    })) === null || _processingInstructio16 === void 0 ? void 0 : _processingInstructio16.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalCommissionSharing'), (_utils$processingInst9 = utils.processingInstructions.getFinancialField(processingInstruction, 'pfinternal')) === null || _utils$processingInst9 === void 0 ? void 0 : _utils$processingInst9.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio17 = processingInstruction.financialChecklist) === null || _processingInstructio17 === void 0 ? void 0 : (_processingInstructio18 = _processingInstructio17.find(function (item) {\n      return item.name === constants.PF_INTERNAL;\n    })) === null || _processingInstructio18 === void 0 ? void 0 : _processingInstructio18.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalDeptName'), (_utils$processingInst10 = utils.processingInstructions.getFinancialField(processingInstruction, constants.PF_INTERNAL)) === null || _utils$processingInst10 === void 0 ? void 0 : _utils$processingInst10.stringValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio19 = processingInstruction.financialChecklist) === null || _processingInstructio19 === void 0 ? void 0 : (_processingInstructio20 = _processingInstructio19.find(function (item) {\n      return item.name === constants.PF_INTERNAL;\n    })) === null || _processingInstructio20 === void 0 ? void 0 : _processingInstructio20.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerage'), (_utils$processingInst11 = utils.processingInstructions.getFinancialField(processingInstruction, 'retainedBrokerage')) === null || _utils$processingInst11 === void 0 ? void 0 : _utils$processingInst11.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio21 = processingInstruction.financialChecklist) === null || _processingInstructio21 === void 0 ? void 0 : (_processingInstructio22 = _processingInstructio21.find(function (item) {\n      return item.name === constants.RETAINED_BROKERAGE;\n    })) === null || _processingInstructio22 === void 0 ? void 0 : _processingInstructio22.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerageAmount'), \"\".concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio23 = processingInstruction.details) === null || _processingInstructio23 === void 0 ? void 0 : _processingInstructio23.retainedBrokerageCurrencyCode) ? processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio24 = processingInstruction.details) === null || _processingInstructio24 === void 0 ? void 0 : _processingInstructio24.retainedBrokerageCurrencyCode : '', \" \").concat(retainedBrokerageAmountForPdf === null || retainedBrokerageAmountForPdf === void 0 ? void 0 : retainedBrokerageAmountForPdf.retBrokerageAmt), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio25 = processingInstruction.financialChecklist) === null || _processingInstructio25 === void 0 ? void 0 : (_processingInstructio26 = _processingInstructio25.find(function (item) {\n      return item.name === constants.RETAINED_BROKERAGE;\n    })) === null || _processingInstructio26 === void 0 ? void 0 : _processingInstructio26.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokergaeAmountInSelectedCurr'), \"GBP \".concat((retainedBrokerageAmountForPdf === null || retainedBrokerageAmountForPdf === void 0 ? void 0 : (_retainedBrokerageAmo = retainedBrokerageAmountForPdf.convertedBrokerageAmt) === null || _retainedBrokerageAmo === void 0 ? void 0 : _retainedBrokerageAmo.value) ? retainedBrokerageAmountForPdf === null || retainedBrokerageAmountForPdf === void 0 ? void 0 : (_retainedBrokerageAmo2 = retainedBrokerageAmountForPdf.convertedBrokerageAmt) === null || _retainedBrokerageAmo2 === void 0 ? void 0 : _retainedBrokerageAmo2.value : '', \" @ \").concat(utils.string.t('format.number', {\n      value: {\n        number: retainedBrokerageAmountForPdf === null || retainedBrokerageAmountForPdf === void 0 ? void 0 : (_retainedBrokerageAmo3 = retainedBrokerageAmountForPdf.convertedBrokerageAmt) === null || _retainedBrokerageAmo3 === void 0 ? void 0 : _retainedBrokerageAmo3.rate,\n        format: {\n          trimMantissa: false\n        }\n      }\n    })), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio27 = processingInstruction.financialChecklist) === null || _processingInstructio27 === void 0 ? void 0 : (_processingInstructio28 = _processingInstructio27.find(function (item) {\n      return item.name === constants.RETAINED_BROKERAGE;\n    })) === null || _processingInstructio28 === void 0 ? void 0 : _processingInstructio28.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.total'), totalAmountForPdf, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio29 = processingInstruction.financialChecklist) === null || _processingInstructio29 === void 0 ? void 0 : (_processingInstructio30 = _processingInstructio29.find(function (item) {\n      return item.name === constants.TOTAL_BROKERAGE;\n    })) === null || _processingInstructio30 === void 0 ? void 0 : _processingInstructio30.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.fees'), (_utils$processingInst12 = utils.processingInstructions.getFinancialField(processingInstruction, 'fees')) === null || _utils$processingInst12 === void 0 ? void 0 : _utils$processingInst12.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio31 = processingInstruction.financialChecklist) === null || _processingInstructio31 === void 0 ? void 0 : (_processingInstructio32 = _processingInstructio31.find(function (item) {\n      return item.name === constants.FEES;\n    })) === null || _processingInstructio32 === void 0 ? void 0 : _processingInstructio32.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.otherDeductions'), (_utils$processingInst13 = utils.processingInstructions.getFinancialField(processingInstruction, 'otherDeductions')) === null || _utils$processingInst13 === void 0 ? void 0 : _utils$processingInst13.numberValue, (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio33 = processingInstruction.financialChecklist) === null || _processingInstructio33 === void 0 ? void 0 : (_processingInstructio34 = _processingInstructio33.find(function (item) {\n      return item.name === constants.OTHER_DEDUCTIONS;\n    })) === null || _processingInstructio34 === void 0 ? void 0 : _processingInstructio34.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.settlementCurrency'), helpers.getSettlementCurrency((_utils$processingInst14 = utils.processingInstructions.getFinancialField(processingInstruction, constants.SETTLEMENT_CURRENCY_CODE_ID)) === null || _utils$processingInst14 === void 0 ? void 0 : _utils$processingInst14.numberValue, refDataCurrencies), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio35 = processingInstruction.financialChecklist) === null || _processingInstructio35 === void 0 ? void 0 : (_processingInstructio36 = _processingInstructio35.find(function (item) {\n      return item.name === constants.SETTLEMENT_CURRENCY_CODE_ID;\n    })) === null || _processingInstructio36 === void 0 ? void 0 : _processingInstructio36.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [utils.string.t('processingInstructions.pdf.instructionLabels.paymentBasis'), helpers.getPaymentBasis((_utils$processingInst15 = utils.processingInstructions.getFinancialField(processingInstruction, 'paymentBasis')) === null || _utils$processingInst15 === void 0 ? void 0 : _utils$processingInst15.numberValue), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio37 = processingInstruction.financialChecklist) === null || _processingInstructio37 === void 0 ? void 0 : (_processingInstructio38 = _processingInstructio37.find(function (item) {\n      return item.name === constants.PAYMENT_BASIS;\n    })) === null || _processingInstructio38 === void 0 ? void 0 : _processingInstructio38.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-'], [((_utils$processingInst16 = utils.processingInstructions.getFinancialField(processingInstruction, 'ppwOrPpc')) === null || _utils$processingInst16 === void 0 ? void 0 : _utils$processingInst16.dateValue) ? \"\".concat(utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable'), \" (\").concat(utils.string.t('format.date', {\n      value: {\n        date: (_utils$processingInst17 = utils.processingInstructions.getFinancialField(processingInstruction, 'ppwOrPpc')) === null || _utils$processingInst17 === void 0 ? void 0 : _utils$processingInst17.dateValue,\n        format: config.ui.format.date.text\n      }\n    }), \")\") : utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable'), helpers.getPpwOrPpc((_utils$processingInst18 = utils.processingInstructions.getFinancialField(processingInstruction, 'ppwOrPpc')) === null || _utils$processingInst18 === void 0 ? void 0 : _utils$processingInst18.numberValue), (processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio39 = processingInstruction.financialChecklist) === null || _processingInstructio39 === void 0 ? void 0 : (_processingInstructio40 = _processingInstructio39.find(function (item) {\n      return item.name === constants.PPW_PPC;\n    })) === null || _processingInstructio40 === void 0 ? void 0 : _processingInstructio40.approvedByAuthorisedSignatory) ? utils.string.t('app.authorised') : '-']];\n  },\n  calculateTotal: function calculateTotal(lineItems) {\n    var sourceRowIds = ['totalClientDiscount', 'totalThirdParty', 'totalPfInternal', 'totalRetainedBrokerage'];\n    var values = lineItems.filter(function (item) {\n      return sourceRowIds.includes(item.itemKey);\n    }).map(function (item) {\n      return item.accountHandler;\n    });\n    return utils.generic.getSumOfArray(values, config.ui.format.percent.decimal);\n  },\n  calculateRetainedBrokerageAmount: function calculateRetainedBrokerageAmount(lineItems) {\n    var premiumCurrency = (lineItems.find(function (item) {\n      return item.itemKey === 'retainedBrokerageAmount';\n    }) || {}).premiumCurrency || '';\n    var grossPremium = lineItems.find(function (item) {\n      return item.itemKey === 'grossPremium';\n    });\n    var slipOrder = lineItems.find(function (item) {\n      return item.itemKey === 'slipOrder';\n    });\n    var totalRetainedBrokerage = lineItems.find(function (item) {\n      return item.itemKey === 'totalRetainedBrokerage';\n    });\n    if (!utils.generic.isValidObject(grossPremium) || !utils.generic.isValidObject(slipOrder) || !utils.generic.isValidObject(totalRetainedBrokerage)) return;\n    var brokerageAmount = utils.openingMemo.getRetainedBrokerageValue(grossPremium.accountHandler, slipOrder.accountHandler, totalRetainedBrokerage.accountHandler);\n    var convertedBrokerage = utils.openingMemo.getRetainedBrokerageConvertedValue(premiumCurrency, brokerageAmount);\n    var convertedBrokerageString = convertedBrokerage ? \" / GBP \".concat(convertedBrokerage.value, \" @ \").concat(utils.string.t('format.number', {\n      value: {\n        number: convertedBrokerage.rate,\n        format: {\n          trimMantissa: false\n        }\n      }\n    })) : '';\n    return \"\".concat(premiumCurrency, \" \").concat(brokerageAmount).concat(convertedBrokerageString);\n  },\n  renderAccountHandler: function renderAccountHandler(accountHandler, row, lineItems) {\n    var cell = row.cells.find(function (cell) {\n      return cell.name === 'accountHandler';\n    });\n    if (!cell) return;\n    if (row.rowKey === 'total') return helpers.calculateTotal(lineItems);\n    if (row.rowKey === 'retainedBrokerageAmount') return helpers.calculateRetainedBrokerageAmount(lineItems);\n    if (!cell.component || !cell.component.optionsKey) return accountHandler;\n    return utils.form.getSelectOption(cell.component.optionsKey, {}, accountHandler);\n  },\n  createSummaryBody: function createSummaryBody(processingInstruction, departmentName, frontEndContactName, accountExecutiveName, producingBrokerName) {\n    var _processingInstructio41, _processingInstructio42, _processingInstructio43, _processingInstructio44, _processingInstructio45, _processingInstructio46;\n\n    var processType = constants.PROCESS_TYPE_ID_CLOSING === (processingInstruction === null || processingInstruction === void 0 ? void 0 : processingInstruction.processTypeId) ? constants.PROCESS_TYPE_CLOSING : constants.PROCESS_TYPE_ID_FDO === (processingInstruction === null || processingInstruction === void 0 ? void 0 : processingInstruction.processTypeId) ? constants.PROCESS_TYPE_FDO : '';\n    var leadRef = processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio41 = processingInstruction.riskReferences) === null || _processingInstructio41 === void 0 ? void 0 : _processingInstructio41.find(function (r) {\n      return r.leadPolicy;\n    });\n    var allRiskRefs = processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio42 = processingInstruction.riskReferences) === null || _processingInstructio42 === void 0 ? void 0 : _processingInstructio42.map(function (r) {\n      return r.riskRefId;\n    });\n    return [[utils.string.t('processingInstructions.pdf.summaryLabels.processType'), upperCase(processType)], [utils.string.t('processingInstructions.pdf.summaryLabels.addedRiskRef'), allRiskRefs.join(', ')], [utils.string.t('processingInstructions.pdf.summaryLabels.leadRiskRef'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.riskRefId], [utils.string.t('processingInstructions.pdf.summaryLabels.gxbInstance'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.xbInstance], [utils.string.t('processingInstructions.pdf.summaryLabels.department'), departmentName], [utils.string.t('processingInstructions.pdf.summaryLabels.reInsuredOrCoverHolderName'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.assuredName], [utils.string.t('processingInstructions.pdf.summaryLabels.period'), \"From: \".concat(leadRef === null || leadRef === void 0 ? void 0 : leadRef.inceptionDate, \" To: \").concat(leadRef === null || leadRef === void 0 ? void 0 : leadRef.expiryDate)], [utils.string.t('processingInstructions.pdf.summaryLabels.invoicingClient'), leadRef === null || leadRef === void 0 ? void 0 : leadRef.clientName], [utils.string.t('processingInstructions.pdf.summaryLabels.contactName'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio43 = processingInstruction.details) === null || _processingInstructio43 === void 0 ? void 0 : _processingInstructio43.contactName], [utils.string.t('processingInstructions.pdf.summaryLabels.clientEmail'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio44 = processingInstruction.details) === null || _processingInstructio44 === void 0 ? void 0 : _processingInstructio44.clientEmail], [utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceContactName'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio45 = processingInstruction.details) === null || _processingInstructio45 === void 0 ? void 0 : _processingInstructio45.eocInvoiceContactName], [utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceEmail'), processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio46 = processingInstruction.details) === null || _processingInstructio46 === void 0 ? void 0 : _processingInstructio46.eocInvoiceMail], [utils.string.t('processingInstructions.pdf.summaryLabels.producingBroker'), producingBrokerName], [utils.string.t('processingInstructions.pdf.summaryLabels.accountExecutive'), accountExecutiveName], [utils.string.t('processingInstructions.pdf.summaryLabels.frontEndContactName'), frontEndContactName], [{\n      colSpan: 2,\n      content: utils.string.t('processingInstructions.pdf.leadRiskReferenceLegend')\n    }]];\n  },\n  createApprovalBody: function createApprovalBody(processingInstruction, frontEndContactName, authorizedSignatoryName) {\n    return [[\"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.name'), \": \").concat(frontEndContactName), \"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.name'), \": \").concat(authorizedSignatoryName)], [\"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.approved'), \": \").concat(helpers.formatDate(new Date())), \"\".concat(utils.string.t('processingInstructions.pdf.approvalSection.approved'), \": \").concat(helpers.formatDate(new Date()))]];\n  },\n  createAttachedDocumemtBody: function createAttachedDocumemtBody(processingInstruction) {\n    var _processingInstructio47, _leadRef$gxbDocuments;\n\n    var leadRef = processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio47 = processingInstruction.riskReferences) === null || _processingInstructio47 === void 0 ? void 0 : _processingInstructio47.find(function (r) {\n      return r.leadPolicy;\n    });\n    var gxbDocuments = leadRef === null || leadRef === void 0 ? void 0 : (_leadRef$gxbDocuments = leadRef.gxbDocuments) === null || _leadRef$gxbDocuments === void 0 ? void 0 : _leadRef$gxbDocuments.map(function (item, index) {\n      return [index + 1, item.name];\n    });\n    return [[\"\".concat(utils.string.t('processingInstructions.pdf.attachedDocumentSection.sno')), \"\".concat(utils.string.t('processingInstructions.pdf.attachedDocumentSection.header'))]].concat(_toConsumableArray(gxbDocuments));\n  },\n  createSpecialBody: function createSpecialBody(processingInstruction) {\n    var _processingInstructio48, _processingInstructio49, _processingInstructio50;\n\n    return [[\"\".concat(utils.string.t('processingInstructions.pdf.specialInstructions.highPriority'), \": \").concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio48 = processingInstruction.details) === null || _processingInstructio48 === void 0 ? void 0 : _processingInstructio48.highPriority) || '-'), \"\".concat(utils.string.t('processingInstructions.pdf.specialInstructions.frontEndSendDocuments'), \": \").concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio49 = processingInstruction.details) === null || _processingInstructio49 === void 0 ? void 0 : _processingInstructio49.frontEndSendDocs) || '-')], [{\n      colSpan: 2,\n      content: \"\".concat(utils.string.t('processingInstructions.pdf.specialInstructions.notes'), \": \").concat((processingInstruction === null || processingInstruction === void 0 ? void 0 : (_processingInstructio50 = processingInstruction.details) === null || _processingInstructio50 === void 0 ? void 0 : _processingInstructio50.notes) || '-')\n    }]];\n  },\n  formatDate: function formatDate(date) {\n    return utils.string.t('format.date', {\n      value: {\n        date: date,\n        format: config.ui.format.date.text\n      }\n    });\n  },\n  getLabels: function getLabels() {\n    return {\n      na: utils.string.t('form.options.yesNoNa.na'),\n      approved: utils.string.t('app.approved'),\n      pdfHeader: utils.string.t('placement.openingMemo.pdf.header'),\n      instructionToProcessing: utils.string.t('placement.openingMemo.instructionToProcessing'),\n      specialInstructionsHeader: utils.string.t('placement.openingMemo.specialInstructions.header'),\n      attachedDocumentSectionHeader: utils.string.t('placement.openingMemo.attachedDocumentSection.header'),\n      accountHandler: utils.string.t('placement.openingMemo.approvers.accountHandler'),\n      authorisedSignatory: utils.string.t('placement.openingMemo.approvers.authorisedSignatory'),\n      placingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.placingBroker.label'),\n      originatorLabel: utils.string.t('placement.openingMemo.specialInstructions.originator.label'),\n      accountExecutiveLabel: utils.string.t('placement.openingMemo.specialInstructions.accountExecutive.label'),\n      producingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.producingBroker.label'),\n      frontEndContactLabel: utils.string.t('processingInstructions.authorisations.fields.frontEndContact')\n    };\n  },\n  getRowLabel: function getRowLabel(sectionKey, rowKey) {\n    return utils.string.t(\"processingInstructions.checklist.lineItems.\".concat(sectionKey, \".rows.\").concat(rowKey, \".label\"));\n  },\n  getYesNoNaLabel: function getYesNoNaLabel(accountHandler) {\n    return utils.string.t(\"form.options.yesNoNa.\".concat(utils.string.replaceLowerCase(accountHandler)));\n  },\n  getSectionLabel: function getSectionLabel(sectionKey) {\n    return utils.string.t(\"processingInstructions.checklist.lineItems.\".concat(sectionKey, \".label\"));\n  },\n  getSectionSubHeader: function getSectionSubHeader(sectionKey) {\n    return utils.string.t(\"processingInstructions.checklist.lineItems.\".concat(sectionKey, \".subHeader\"));\n  },\n  getHeaderLabel: function getHeaderLabel(headerKey) {\n    return utils.string.t(\"processingInstructions.pdf.pdfColHeaderLabels.\".concat(headerKey));\n  },\n  getOptionLabel: function getOptionLabel(rowKey, value) {\n    return utils.string.t(\"form.options.\".concat(rowKey, \".\").concat(value));\n  }\n};","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsPdf/ProcessingInstructions.pdf.helpers.js"],"names":["flatten","get","upperCase","utils","config","constants","processingInstructionsSchema","getData","processingInstruction","departmentName","frontEndContactName","authorizedSignatoryName","accountExecutiveName","producingBrokerName","retainedBrokerageAmountForPdf","totalAmountForPdf","refDataCurrencies","labels","helpers","getLabels","tableHeader","createHeader","summaryBody","createSummaryBody","checklistBody","map","sectionKey","createChecklistBody","instructionBody","createInstructionBody","specialBody","createSpecialBody","attachedDocumentBody","createAttachedDocumemtBody","approvalBody","createApprovalBody","getSettlementCurrency","id","find","ref","currencyCodeID","currencyCd","getPaymentBasis","paymentBasisOptions","code","name","p","getPpwOrPpc","ppwOrPpcOptions","value","getMultiToggleLabel","newValue","PI_TOGGLE_ID_YES","string","t","PI_TOGGLE_ID_NO","PI_TOGGLE_ID_NA","headerKey","getHeaderLabel","subHeader","rows","Array","isArray","data","row","item","checklist","checkListDetails","rowKey","labelColumn","getRowLabel","signedDate","date","format","ui","text","renderAccountHandler","accountHandler","replace","authorisedSignatory","colSpan","content","getSectionSubHeader","getSectionLabel","premiumTaxCalSheetAttach","processingInstructions","getFinancialField","numberValue","signedLinesCalAttach","financialChecklist","PREMIUM_TAX_CALCULATION_SHEET_ATTACHED","approvedByAuthorisedSignatory","SIGNED_LINES_CALCULATION_SHEET_ATTACHED","GROSS_PREMIUM_AMOUNT","SLIP_ORDER","TOTAL_BROKERAGE","CLIENT_DISCOUNT","THIRD_PARTY","stringValue","PF_INTERNAL","RETAINED_BROKERAGE","details","retainedBrokerageCurrencyCode","retBrokerageAmt","convertedBrokerageAmt","number","rate","trimMantissa","FEES","OTHER_DEDUCTIONS","SETTLEMENT_CURRENCY_CODE_ID","PAYMENT_BASIS","dateValue","PPW_PPC","calculateTotal","lineItems","sourceRowIds","values","filter","includes","itemKey","generic","getSumOfArray","percent","decimal","calculateRetainedBrokerageAmount","premiumCurrency","grossPremium","slipOrder","totalRetainedBrokerage","isValidObject","brokerageAmount","openingMemo","getRetainedBrokerageValue","convertedBrokerage","getRetainedBrokerageConvertedValue","convertedBrokerageString","cell","cells","component","optionsKey","form","getSelectOption","processType","PROCESS_TYPE_ID_CLOSING","processTypeId","PROCESS_TYPE_CLOSING","PROCESS_TYPE_ID_FDO","PROCESS_TYPE_FDO","leadRef","riskReferences","r","leadPolicy","allRiskRefs","riskRefId","join","xbInstance","assuredName","inceptionDate","expiryDate","clientName","contactName","clientEmail","eocInvoiceContactName","eocInvoiceMail","formatDate","Date","gxbDocuments","index","highPriority","frontEndSendDocs","notes","na","approved","pdfHeader","instructionToProcessing","specialInstructionsHeader","attachedDocumentSectionHeader","placingBrokerLabel","originatorLabel","accountExecutiveLabel","producingBrokerLabel","frontEndContactLabel","getYesNoNaLabel","replaceLowerCase","getOptionLabel"],"mappings":"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","sourcesContent":["import flatten from 'lodash/flatten';\r\nimport get from 'lodash/get';\r\nimport upperCase from 'lodash/upperCase';\r\n\r\n// app\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport * as constants from 'consts';\r\nimport { processingInstructionsSchema } from 'schemas';\r\n\r\nexport const getData = ({\r\n  processingInstruction = {},\r\n  departmentName,\r\n  frontEndContactName = '',\r\n  authorizedSignatoryName = '',\r\n  accountExecutiveName = '',\r\n  producingBrokerName = '',\r\n  retainedBrokerageAmountForPdf,\r\n  totalAmountForPdf,\r\n  refDataCurrencies,\r\n}) => {\r\n  const labels = helpers.getLabels();\r\n  if (!processingInstruction) return;\r\n  return {\r\n    labels,\r\n    tableHeader: helpers.createHeader(),\r\n    summaryBody: helpers.createSummaryBody(\r\n      processingInstruction,\r\n      departmentName,\r\n      frontEndContactName,\r\n      accountExecutiveName,\r\n      producingBrokerName\r\n    ),\r\n    checklistBody: flatten(\r\n      ['prePlacing', 'mrc', 'otherDetails'].map((sectionKey) => helpers.createChecklistBody(processingInstruction, sectionKey, false))\r\n    ),\r\n    instructionBody: helpers.createInstructionBody(\r\n      processingInstruction,\r\n      retainedBrokerageAmountForPdf,\r\n      totalAmountForPdf,\r\n      refDataCurrencies\r\n    ),\r\n    specialBody: helpers.createSpecialBody(processingInstruction),\r\n    attachedDocumentBody: helpers.createAttachedDocumemtBody(processingInstruction),\r\n    approvalBody: helpers.createApprovalBody(processingInstruction, frontEndContactName, authorizedSignatoryName),\r\n  };\r\n};\r\n\r\nconst helpers = {\r\n  getSettlementCurrency: (id, refDataCurrencies) => {\r\n    return refDataCurrencies.find((ref) => ref.currencyCodeID === id)?.currencyCd;\r\n  },\r\n  getPaymentBasis: (id) => {\r\n    const paymentBasisOptions = [\r\n      { id: 1, code: 'cash', name: 'Cash' },\r\n      { id: 2, code: 'quaterly', name: 'Quaterly' },\r\n      { id: 3, code: 'otherDeferred', name: 'Other Deferred' },\r\n    ];\r\n    return paymentBasisOptions.find((p) => p.id === id)?.name;\r\n  },\r\n  getPpwOrPpc: (id) => {\r\n    const ppwOrPpcOptions = [\r\n      { id: 1, code: 'ppw', name: 'PPW', value: 1 },\r\n      { id: 2, code: 'ppc', name: 'PPC', value: 2 },\r\n      { id: 3, code: 'na', name: 'N/A', value: 3 },\r\n    ];\r\n    return ppwOrPpcOptions.find((p) => p.id === id)?.name;\r\n  },\r\n  getMultiToggleLabel: (value) => {\r\n    if (!value) return;\r\n    let newValue = '';\r\n\r\n    if (value === constants.PI_TOGGLE_ID_YES) {\r\n      return (newValue = utils.string.t('app.yes'));\r\n    }\r\n    if (value === constants.PI_TOGGLE_ID_NO) {\r\n      return (newValue = utils.string.t('app.no'));\r\n    }\r\n    if (value === constants.PI_TOGGLE_ID_NA) {\r\n      return (newValue = utils.string.t('app.na'));\r\n    }\r\n    return newValue;\r\n  },\r\n  createHeader: () => {\r\n    return [\r\n      ['processingInstructionDetails', 'frontEndContact', 'authorisedSignatory'].map((headerKey) => helpers.getHeaderLabel(headerKey)),\r\n    ];\r\n  },\r\n  createChecklistBody: (processingInstruction, sectionKey, subHeader) => {\r\n    if (!processingInstruction) return [];\r\n    const rows = get(processingInstructionsSchema, `content.${sectionKey}`);\r\n    if (!rows || !Array.isArray(rows)) return [];\r\n    const data = rows.map((row) => {\r\n      const item = processingInstruction.checklist.find((item) => item.checkListDetails === row.rowKey) || {};\r\n      const labelColumn = `${helpers.getRowLabel(sectionKey, row.rowKey)}`;\r\n      return [\r\n        item.signedDate\r\n          ? `${labelColumn} (${utils.string.t('format.date', { value: { date: item.signedDate, format: config.ui.format.date.text } })})`\r\n          : labelColumn,\r\n        upperCase(helpers.renderAccountHandler(item.accountHandler, row, processingInstruction.checklist)).replace(/ /g, '/'),\r\n        item.authorisedSignatory ? utils.string.t('app.authorised') : '-',\r\n      ];\r\n    });\r\n    return [[{ colSpan: 3, content: subHeader ? helpers.getSectionSubHeader(sectionKey) : helpers.getSectionLabel(sectionKey) }], ...data];\r\n  },\r\n  createInstructionBody: (processingInstruction, retainedBrokerageAmountForPdf, totalAmountForPdf, refDataCurrencies) => {\r\n    if (!processingInstruction) return [];\r\n\r\n    const premiumTaxCalSheetAttach = helpers.getMultiToggleLabel(\r\n      utils.processingInstructions.getFinancialField(processingInstruction, 'premiumTaxCalculationSheetAttached')?.numberValue\r\n    );\r\n\r\n    const signedLinesCalAttach = helpers.getMultiToggleLabel(\r\n      utils.processingInstructions.getFinancialField(processingInstruction, 'signedLinesCalculationSheetAttached')?.numberValue\r\n    );\r\n\r\n    return [\r\n      [utils.string.t('processingInstructions.pdf.instructionLabels.piPageSubHeader')],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.premiumAndTaxCalSheetAttach'),\r\n        premiumTaxCalSheetAttach ? premiumTaxCalSheetAttach : utils.string.t('app.no'),\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.PREMIUM_TAX_CALCULATION_SHEET_ATTACHED)\r\n          ?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.signedLinesCalAttach'),\r\n        signedLinesCalAttach ? signedLinesCalAttach : utils.string.t('app.no'),\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.SIGNED_LINES_CALCULATION_SHEET_ATTACHED)\r\n          ?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.grossPremium'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'grossPremiumAmount')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.GROSS_PREMIUM_AMOUNT)\r\n          ?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.slipOrder'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'slipOrder')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.SLIP_ORDER)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.totalBrokerage'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'totalBrokerage')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.TOTAL_BROKERAGE)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [utils.string.t('processingInstructions.pdf.instructionLabels.splitAsFollows'), '', '-'],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.clientDiscount'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'clientDiscount')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.CLIENT_DISCOUNT)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyCommSharing'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, constants.THIRD_PARTY)?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.THIRD_PARTY)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.thirdPartyName'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, constants.THIRD_PARTY)?.stringValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.THIRD_PARTY)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalCommissionSharing'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'pfinternal')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.PF_INTERNAL)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.pfInternalDeptName'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, constants.PF_INTERNAL)?.stringValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.PF_INTERNAL)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerage'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'retainedBrokerage')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.RETAINED_BROKERAGE)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokerageAmount'),\r\n        `${\r\n          processingInstruction?.details?.retainedBrokerageCurrencyCode ? processingInstruction?.details?.retainedBrokerageCurrencyCode : ''\r\n        } ${retainedBrokerageAmountForPdf?.retBrokerageAmt}`,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.RETAINED_BROKERAGE)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.retainedBrokergaeAmountInSelectedCurr'),\r\n        `GBP ${\r\n          retainedBrokerageAmountForPdf?.convertedBrokerageAmt?.value ? retainedBrokerageAmountForPdf?.convertedBrokerageAmt?.value : ''\r\n        } @ ${utils.string.t('format.number', {\r\n          value: { number: retainedBrokerageAmountForPdf?.convertedBrokerageAmt?.rate, format: { trimMantissa: false } },\r\n        })}`,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.RETAINED_BROKERAGE)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.total'),\r\n        totalAmountForPdf,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.TOTAL_BROKERAGE)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.fees'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'fees')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.FEES)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.otherDeductions'),\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'otherDeductions')?.numberValue,\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.OTHER_DEDUCTIONS)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.settlementCurrency'),\r\n        helpers.getSettlementCurrency(\r\n          utils.processingInstructions.getFinancialField(processingInstruction, constants.SETTLEMENT_CURRENCY_CODE_ID)?.numberValue,\r\n          refDataCurrencies\r\n        ),\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.SETTLEMENT_CURRENCY_CODE_ID)\r\n          ?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.instructionLabels.paymentBasis'),\r\n        helpers.getPaymentBasis(utils.processingInstructions.getFinancialField(processingInstruction, 'paymentBasis')?.numberValue),\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.PAYMENT_BASIS)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n      [\r\n        utils.processingInstructions.getFinancialField(processingInstruction, 'ppwOrPpc')?.dateValue\r\n          ? `${utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable')} (${utils.string.t('format.date', {\r\n              value: {\r\n                date: utils.processingInstructions.getFinancialField(processingInstruction, 'ppwOrPpc')?.dateValue,\r\n                format: config.ui.format.date.text,\r\n              },\r\n            })})`\r\n          : utils.string.t('processingInstructions.pdf.instructionLabels.ppwPpcApplicable'),\r\n        helpers.getPpwOrPpc(utils.processingInstructions.getFinancialField(processingInstruction, 'ppwOrPpc')?.numberValue),\r\n        processingInstruction?.financialChecklist?.find((item) => item.name === constants.PPW_PPC)?.approvedByAuthorisedSignatory\r\n          ? utils.string.t('app.authorised')\r\n          : '-',\r\n      ],\r\n    ];\r\n  },\r\n  calculateTotal: (lineItems) => {\r\n    const sourceRowIds = ['totalClientDiscount', 'totalThirdParty', 'totalPfInternal', 'totalRetainedBrokerage'];\r\n    const values = lineItems.filter((item) => sourceRowIds.includes(item.itemKey)).map((item) => item.accountHandler);\r\n    return utils.generic.getSumOfArray(values, config.ui.format.percent.decimal);\r\n  },\r\n  calculateRetainedBrokerageAmount: (lineItems) => {\r\n    const premiumCurrency = (lineItems.find((item) => item.itemKey === 'retainedBrokerageAmount') || {}).premiumCurrency || '';\r\n    const grossPremium = lineItems.find((item) => item.itemKey === 'grossPremium');\r\n    const slipOrder = lineItems.find((item) => item.itemKey === 'slipOrder');\r\n    const totalRetainedBrokerage = lineItems.find((item) => item.itemKey === 'totalRetainedBrokerage');\r\n\r\n    if (\r\n      !utils.generic.isValidObject(grossPremium) ||\r\n      !utils.generic.isValidObject(slipOrder) ||\r\n      !utils.generic.isValidObject(totalRetainedBrokerage)\r\n    )\r\n      return;\r\n\r\n    const brokerageAmount = utils.openingMemo.getRetainedBrokerageValue(\r\n      grossPremium.accountHandler,\r\n      slipOrder.accountHandler,\r\n      totalRetainedBrokerage.accountHandler\r\n    );\r\n    const convertedBrokerage = utils.openingMemo.getRetainedBrokerageConvertedValue(premiumCurrency, brokerageAmount);\r\n    const convertedBrokerageString = convertedBrokerage\r\n      ? ` / GBP ${convertedBrokerage.value} @ ${utils.string.t('format.number', {\r\n          value: { number: convertedBrokerage.rate, format: { trimMantissa: false } },\r\n        })}`\r\n      : '';\r\n\r\n    return `${premiumCurrency} ${brokerageAmount}${convertedBrokerageString}`;\r\n  },\r\n  renderAccountHandler: (accountHandler, row, lineItems) => {\r\n    const cell = row.cells.find((cell) => cell.name === 'accountHandler');\r\n    if (!cell) return;\r\n    if (row.rowKey === 'total') return helpers.calculateTotal(lineItems);\r\n    if (row.rowKey === 'retainedBrokerageAmount') return helpers.calculateRetainedBrokerageAmount(lineItems);\r\n    if (!cell.component || !cell.component.optionsKey) return accountHandler;\r\n    return utils.form.getSelectOption(cell.component.optionsKey, {}, accountHandler);\r\n  },\r\n  createSummaryBody: (processingInstruction, departmentName, frontEndContactName, accountExecutiveName, producingBrokerName) => {\r\n    const processType =\r\n      constants.PROCESS_TYPE_ID_CLOSING === processingInstruction?.processTypeId\r\n        ? constants.PROCESS_TYPE_CLOSING\r\n        : constants.PROCESS_TYPE_ID_FDO === processingInstruction?.processTypeId\r\n        ? constants.PROCESS_TYPE_FDO\r\n        : '';\r\n    const leadRef = processingInstruction?.riskReferences?.find((r) => r.leadPolicy);\r\n    const allRiskRefs = processingInstruction?.riskReferences?.map((r) => r.riskRefId);\r\n    return [\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.processType'), upperCase(processType)],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.addedRiskRef'), allRiskRefs.join(', ')],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.leadRiskRef'), leadRef?.riskRefId],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.gxbInstance'), leadRef?.xbInstance],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.department'), departmentName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.reInsuredOrCoverHolderName'), leadRef?.assuredName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.period'), `From: ${leadRef?.inceptionDate} To: ${leadRef?.expiryDate}`],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.invoicingClient'), leadRef?.clientName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.contactName'), processingInstruction?.details?.contactName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.clientEmail'), processingInstruction?.details?.clientEmail],\r\n      [\r\n        utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceContactName'),\r\n        processingInstruction?.details?.eocInvoiceContactName,\r\n      ],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.eocInvoiceEmail'), processingInstruction?.details?.eocInvoiceMail],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.producingBroker'), producingBrokerName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.accountExecutive'), accountExecutiveName],\r\n      [utils.string.t('processingInstructions.pdf.summaryLabels.frontEndContactName'), frontEndContactName],\r\n      [\r\n        {\r\n          colSpan: 2,\r\n          content: utils.string.t('processingInstructions.pdf.leadRiskReferenceLegend'),\r\n        },\r\n      ],\r\n    ];\r\n  },\r\n  createApprovalBody: (processingInstruction, frontEndContactName, authorizedSignatoryName) => {\r\n    return [\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.name')}: ${frontEndContactName}`,\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.name')}: ${authorizedSignatoryName}`,\r\n      ],\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.approved')}: ${helpers.formatDate(new Date())}`,\r\n        `${utils.string.t('processingInstructions.pdf.approvalSection.approved')}: ${helpers.formatDate(new Date())}`,\r\n      ],\r\n    ];\r\n  },\r\n  createAttachedDocumemtBody: (processingInstruction) => {\r\n    const leadRef = processingInstruction?.riskReferences?.find((r) => r.leadPolicy);\r\n    const gxbDocuments = leadRef?.gxbDocuments?.map((item, index) => [index + 1, item.name]);\r\n    return [\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.attachedDocumentSection.sno')}`,\r\n        `${utils.string.t('processingInstructions.pdf.attachedDocumentSection.header')}`,\r\n      ],\r\n      ...gxbDocuments,\r\n    ];\r\n  },\r\n\r\n  createSpecialBody: (processingInstruction) => {\r\n    return [\r\n      [\r\n        `${utils.string.t('processingInstructions.pdf.specialInstructions.highPriority')}: ${\r\n          processingInstruction?.details?.highPriority || '-'\r\n        }`,\r\n        `${utils.string.t('processingInstructions.pdf.specialInstructions.frontEndSendDocuments')}: ${\r\n          processingInstruction?.details?.frontEndSendDocs || '-'\r\n        }`,\r\n      ],\r\n      [\r\n        {\r\n          colSpan: 2,\r\n          content: `${utils.string.t('processingInstructions.pdf.specialInstructions.notes')}: ${\r\n            processingInstruction?.details?.notes || '-'\r\n          }`,\r\n        },\r\n      ],\r\n    ];\r\n  },\r\n  formatDate: (date) => {\r\n    return utils.string.t('format.date', { value: { date, format: config.ui.format.date.text } });\r\n  },\r\n  getLabels: () => ({\r\n    na: utils.string.t('form.options.yesNoNa.na'),\r\n    approved: utils.string.t('app.approved'),\r\n    pdfHeader: utils.string.t('placement.openingMemo.pdf.header'),\r\n    instructionToProcessing: utils.string.t('placement.openingMemo.instructionToProcessing'),\r\n    specialInstructionsHeader: utils.string.t('placement.openingMemo.specialInstructions.header'),\r\n    attachedDocumentSectionHeader: utils.string.t('placement.openingMemo.attachedDocumentSection.header'),\r\n    accountHandler: utils.string.t('placement.openingMemo.approvers.accountHandler'),\r\n    authorisedSignatory: utils.string.t('placement.openingMemo.approvers.authorisedSignatory'),\r\n    placingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.placingBroker.label'),\r\n    originatorLabel: utils.string.t('placement.openingMemo.specialInstructions.originator.label'),\r\n    accountExecutiveLabel: utils.string.t('placement.openingMemo.specialInstructions.accountExecutive.label'),\r\n    producingBrokerLabel: utils.string.t('placement.openingMemo.specialInstructions.producingBroker.label'),\r\n    frontEndContactLabel: utils.string.t('processingInstructions.authorisations.fields.frontEndContact'),\r\n  }),\r\n  getRowLabel: (sectionKey, rowKey) => utils.string.t(`processingInstructions.checklist.lineItems.${sectionKey}.rows.${rowKey}.label`),\r\n  getYesNoNaLabel: (accountHandler) => utils.string.t(`form.options.yesNoNa.${utils.string.replaceLowerCase(accountHandler)}`),\r\n  getSectionLabel: (sectionKey) => utils.string.t(`processingInstructions.checklist.lineItems.${sectionKey}.label`),\r\n  getSectionSubHeader: (sectionKey) => utils.string.t(`processingInstructions.checklist.lineItems.${sectionKey}.subHeader`),\r\n  getHeaderLabel: (headerKey) => utils.string.t(`processingInstructions.pdf.pdfColHeaderLabels.${headerKey}`),\r\n  getOptionLabel: (rowKey, value) => utils.string.t(`form.options.${rowKey}.${value}`),\r\n};\r\n"]},"metadata":{},"sourceType":"module"}