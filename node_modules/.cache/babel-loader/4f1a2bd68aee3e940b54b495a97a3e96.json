{"ast":null,"code":"import get from 'lodash/get'; // app\n\nimport * as utils from 'utils';\nimport { authLogout } from 'stores';\nexport var getLocationSummary = function getLocationSummary(_ref) {\n  var level = _ref.level,\n      placementIds = _ref.placementIds,\n      levelOverride = _ref.levelOverride;\n  return function (dispatch, getState) {\n    // prettier-ignore\n    var _getState = getState(),\n        auth = _getState.user.auth,\n        endpoint = _getState.config.vars.endpoint,\n        portfolioMap = _getState.portfolioMap;\n\n    var newLevel = levelOverride || level || get(portfolioMap, 'tiv.levelOverride') || get(portfolioMap, 'tiv.level');\n    var defaultError = {\n      file: 'stores/portfolioMap.actions.get'\n    };\n    dispatch(getLocationSummaryRequest({\n      level: level,\n      placementIds: placementIds,\n      levelOverride: levelOverride\n    }));\n\n    if (!placementIds || !utils.generic.isValidArray(placementIds, true) || !newLevel) {\n      dispatch(getLocationSummaryFailure(defaultError));\n      return;\n    }\n\n    var endpointParams = {\n      level: newLevel,\n      placementIds: placementIds\n    };\n    return utils.api.get({\n      token: auth.accessToken,\n      endpoint: endpoint.location,\n      path: \"api/summary\",\n      params: endpointParams\n    }).then(function (response) {\n      return utils.api.handleResponse(response);\n    }).then(function (json) {\n      return utils.api.handleData(json);\n    }).then(function (data) {\n      dispatch(getLocationSummarySuccess({\n        level: level || get(portfolioMap, 'tiv.level'),\n        levelOverride: levelOverride || get(portfolioMap, 'tiv.levelOverride'),\n        placementIds: placementIds,\n        data: data\n      }));\n    }).catch(function (err) {\n      var errorParams = {\n        file: 'stores/portfolioMap.actions.get',\n        message: 'API fetch error (portfolioMap.get)'\n      };\n      utils.api.handleError(err, errorParams);\n      utils.api.handleUnauthorized(err, dispatch, authLogout);\n      dispatch(getLocationSummaryFailure(err));\n      return err;\n    });\n  };\n};\nexport var getLocationSummaryRequest = function getLocationSummaryRequest(payload) {\n  return {\n    type: 'PORTFOLIO_MAP_GET_REQUEST',\n    payload: payload\n  };\n};\nexport var getLocationSummarySuccess = function getLocationSummarySuccess(payload) {\n  return {\n    type: 'PORTFOLIO_MAP_GET_SUCCESS',\n    payload: payload\n  };\n};\nexport var getLocationSummaryFailure = function getLocationSummaryFailure(error) {\n  return {\n    type: 'PORTFOLIO_MAP_GET_FAILURE',\n    payload: error\n  };\n};","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/stores/portfolioMap/portfolioMap.actions.get.js"],"names":["get","utils","authLogout","getLocationSummary","level","placementIds","levelOverride","dispatch","getState","auth","user","endpoint","config","vars","portfolioMap","newLevel","defaultError","file","getLocationSummaryRequest","generic","isValidArray","getLocationSummaryFailure","endpointParams","api","token","accessToken","location","path","params","then","response","handleResponse","json","handleData","data","getLocationSummarySuccess","catch","err","errorParams","message","handleError","handleUnauthorized","payload","type","error"],"mappings":"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","sourcesContent":["import get from 'lodash/get';\r\n\r\n// app\r\nimport * as utils from 'utils';\r\nimport { authLogout } from 'stores';\r\n\r\nexport const getLocationSummary =\r\n  ({ level, placementIds, levelOverride }) =>\r\n  (dispatch, getState) => {\r\n    // prettier-ignore\r\n    const { user: { auth }, config: { vars: { endpoint }}, portfolioMap } = getState();\r\n\r\n    const newLevel = levelOverride || level || get(portfolioMap, 'tiv.levelOverride') || get(portfolioMap, 'tiv.level');\r\n\r\n    const defaultError = {\r\n      file: 'stores/portfolioMap.actions.get',\r\n    };\r\n\r\n    dispatch(getLocationSummaryRequest({ level, placementIds, levelOverride }));\r\n\r\n    if (!placementIds || !utils.generic.isValidArray(placementIds, true) || !newLevel) {\r\n      dispatch(getLocationSummaryFailure(defaultError));\r\n      return;\r\n    }\r\n\r\n    const endpointParams = {\r\n      level: newLevel,\r\n      placementIds,\r\n    };\r\n\r\n    return utils.api\r\n      .get({\r\n        token: auth.accessToken,\r\n        endpoint: endpoint.location,\r\n        path: `api/summary`,\r\n        params: endpointParams,\r\n      })\r\n      .then((response) => utils.api.handleResponse(response))\r\n      .then((json) => utils.api.handleData(json))\r\n      .then((data) => {\r\n        dispatch(\r\n          getLocationSummarySuccess({\r\n            level: level || get(portfolioMap, 'tiv.level'),\r\n            levelOverride: levelOverride || get(portfolioMap, 'tiv.levelOverride'),\r\n            placementIds,\r\n            data,\r\n          })\r\n        );\r\n      })\r\n      .catch((err) => {\r\n        const errorParams = {\r\n          file: 'stores/portfolioMap.actions.get',\r\n          message: 'API fetch error (portfolioMap.get)',\r\n        };\r\n\r\n        utils.api.handleError(err, errorParams);\r\n        utils.api.handleUnauthorized(err, dispatch, authLogout);\r\n        dispatch(getLocationSummaryFailure(err));\r\n        return err;\r\n      });\r\n  };\r\n\r\nexport const getLocationSummaryRequest = (payload) => {\r\n  return {\r\n    type: 'PORTFOLIO_MAP_GET_REQUEST',\r\n    payload,\r\n  };\r\n};\r\n\r\nexport const getLocationSummarySuccess = (payload) => {\r\n  return {\r\n    type: 'PORTFOLIO_MAP_GET_SUCCESS',\r\n    payload,\r\n  };\r\n};\r\n\r\nexport const getLocationSummaryFailure = (error) => {\r\n  return {\r\n    type: 'PORTFOLIO_MAP_GET_FAILURE',\r\n    payload: error,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}