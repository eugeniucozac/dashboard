{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\PremiumProcessingCaseRFI\\\\PremiumProcessingCaseRFI.js\",\n    _s = $RefreshSig$();\n\nimport { React, useState, useRef, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory, useParams } from 'react-router';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames'; // app\n\nimport styles from './PremiumProcessingCaseRFI.styles';\nimport PremiumProcessingCaseRFIView from './PremiumProcessingCaseRFI.view';\nimport { getCaseRfiSubTabData, selectcaseRfiSubTabs, selectUser, selectCaseRfiDetails, hideModal, getCaseRFIDetails, selectUserEmail, selectUsersInRoles, getUsersForRole, selectRfiHistory } from 'stores';\nimport * as constants from 'consts';\nimport * as utils from 'utils';\nimport config from 'config'; // mui\n\nimport { makeStyles } from '@material-ui/core';\nimport FiberManualRecordIcon from '@material-ui/icons/FiberManualRecord';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nPremiumProcessingCaseRFI.propTypes = {\n  taskId: PropTypes.string.isRequired,\n  caseId: PropTypes.string.isRequired,\n  caseDetailsObject: PropTypes.object.isRequired,\n  isPageDirty: PropTypes.bool.isRequired,\n  handlers: PropTypes.shape({\n    setIsPageDirty: PropTypes.func.isRequired,\n    confirmNavigation: PropTypes.func.isRequired\n  })\n};\n\nfunction PremiumProcessingCaseRFI(_ref) {\n  _s();\n\n  var _params$subtab,\n      _this = this;\n\n  var taskId = _ref.taskId,\n      caseId = _ref.caseId,\n      caseDetailsObject = _ref.caseDetailsObject,\n      isPageDirty = _ref.isPageDirty,\n      handlers = _ref.handlers;\n  var classes = makeStyles(styles, {\n    name: 'PremiumProcessingCaseRFI'\n  })();\n  var dispatch = useDispatch();\n  var params = useParams();\n  var history = useHistory();\n  var isNewRfiUsersFetched = useRef(false);\n  var rfiSubTabs = useSelector(selectcaseRfiSubTabs);\n  var caseRfiDetails = useSelector(selectCaseRfiDetails);\n  var userEmail = useSelector(selectUserEmail);\n  var newRfiUsers = useSelector(selectUsersInRoles);\n  var user = useSelector(selectUser);\n  var caseRfiHistory = useSelector(selectRfiHistory);\n  var isWorklist = (caseDetailsObject === null || caseDetailsObject === void 0 ? void 0 : caseDetailsObject.taskView) === constants.WORKLIST;\n  var hasRfiTabPermission = utils.app.access.feature('premiumProcessing.RFITab', ['read'], user);\n  var newRfiTab = {\n    value: constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\n    label: utils.string.t('premiumProcessing.rfi.newRfi')\n  };\n  var paramsRfiTab = params === null || params === void 0 ? void 0 : (_params$subtab = params.subtab) === null || _params$subtab === void 0 ? void 0 : _params$subtab.toString();\n  var isValidTab = rfiSubTabs.map(function (tab) {\n    return tab.taskId;\n  }).includes(paramsRfiTab);\n\n  var _useState = useState({\n    id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\n    status: ''\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedTab = _useState2[0],\n      setSelectedTab = _useState2[1];\n\n  var subTabs = rfiSubTabs === null || rfiSubTabs === void 0 ? void 0 : rfiSubTabs.map(function (tab) {\n    var _classnames;\n\n    return {\n      value: tab.taskId,\n      label: utils.string.t('premiumProcessing.rfi.tabName', {\n        type: tab.rfiType,\n        id: tab.queryId\n      }),\n      subLabel: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(FiberManualRecordIcon, {\n          className: classnames((_classnames = {}, _defineProperty(_classnames, classes.status, true), _defineProperty(_classnames, classes.open, tab.status === constants.RFI_STATUS.OPEN), _defineProperty(_classnames, classes.responseReceived, tab.status === constants.RFI_STATUS.RESPONSE_RECEIVED), _defineProperty(_classnames, classes.resolved, tab.status === constants.RFI_STATUS.RESOLVED), _classnames))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, _this), tab.status]\n      }, void 0, true)\n    };\n  });\n  useEffect(function () {\n    dispatch(getCaseRfiSubTabData(caseId));\n  }, [dispatch, caseId, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    var _rfiSubTabs$find;\n\n    var selectedTabStatus = utils.generic.isValidArray(rfiSubTabs) ? ((_rfiSubTabs$find = rfiSubTabs.find(function (tab) {\n      var _tab$taskId;\n\n      return ((_tab$taskId = tab.taskId) === null || _tab$taskId === void 0 ? void 0 : _tab$taskId.toString()) === (paramsRfiTab === null || paramsRfiTab === void 0 ? void 0 : paramsRfiTab.toString());\n    })) === null || _rfiSubTabs$find === void 0 ? void 0 : _rfiSubTabs$find.status) || '' : '';\n    setSelectedTab({\n      id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\n      status: selectedTabStatus\n    });\n  }, [rfiSubTabs]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (paramsRfiTab && paramsRfiTab !== constants.PREMIUM_PROCESSING_TAB_NEW_RFI) {\n      dispatch(getCaseRFIDetails({\n        taskId: paramsRfiTab\n      })).then(function (res) {\n        if (res === null || res === void 0 ? void 0 : res.taskId) {\n          setSelectedTab({\n            id: res.taskId,\n            status: res.status\n          });\n        }\n      });\n    }\n  }, [paramsRfiTab, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (!isNewRfiUsersFetched.current) {\n      dispatch(getUsersForRole([constants.FRONT_END_CONTACT, constants.OPERATIONS_LEAD])).then(function (res) {\n        if (utils.generic.isValidArray(res, true)) {\n          isNewRfiUsersFetched.current = true;\n        }\n      });\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var switchTab = function switchTab(newTab) {\n    setSelectedTab({\n      id: newTab,\n      status: ''\n    });\n    handlers.setIsPageDirty(false);\n    history.replace(\"\".concat(config.routes.premiumProcessing.case, \"/\").concat(taskId, \"/\").concat(constants.PREMIUM_PROCESSING_TAB_RFI, \"/\").concat(newTab));\n    dispatch(hideModal('CONFIRM'));\n    return;\n  };\n\n  var stayOnTab = function stayOnTab() {\n    dispatch(hideModal('CONFIRM'));\n    return;\n  };\n\n  var selectTab = function selectTab(tabName) {\n    if (tabName === (selectedTab === null || selectedTab === void 0 ? void 0 : selectedTab.id)) return;\n\n    if (isPageDirty) {\n      handlers.confirmNavigation(function () {\n        return switchTab(tabName);\n      }, stayOnTab);\n      return;\n    } else {\n      switchTab(tabName);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(PremiumProcessingCaseRFIView, {\n    hasRfiTabPermission: hasRfiTabPermission,\n    caseDetails: caseDetailsObject,\n    rfiDetails: caseRfiDetails,\n    newRfiUsers: newRfiUsers,\n    subTabs: [newRfiTab].concat(_toConsumableArray(subTabs)),\n    selectedSubTab: selectedTab,\n    isCreatedByLoginUser: caseRfiDetails.createdByEmail === userEmail,\n    isPageDirty: isPageDirty,\n    isWorklist: isWorklist,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      selectTab: selectTab,\n      switchTab: switchTab,\n      stayOnTab: stayOnTab\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PremiumProcessingCaseRFI, \"y4m4PIPH6gb8GOBnfsOdFNra0io=\", false, function () {\n  return [useDispatch, useParams, useHistory, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PremiumProcessingCaseRFI;\nexport default PremiumProcessingCaseRFI;\n\nvar _c;\n\n$RefreshReg$(_c, \"PremiumProcessingCaseRFI\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/PremiumProcessingCaseRFI/PremiumProcessingCaseRFI.js"],"names":["React","useState","useRef","useEffect","useDispatch","useSelector","useHistory","useParams","PropTypes","classnames","styles","PremiumProcessingCaseRFIView","getCaseRfiSubTabData","selectcaseRfiSubTabs","selectUser","selectCaseRfiDetails","hideModal","getCaseRFIDetails","selectUserEmail","selectUsersInRoles","getUsersForRole","selectRfiHistory","constants","utils","config","makeStyles","FiberManualRecordIcon","PremiumProcessingCaseRFI","propTypes","taskId","string","isRequired","caseId","caseDetailsObject","object","isPageDirty","bool","handlers","shape","setIsPageDirty","func","confirmNavigation","classes","name","dispatch","params","history","isNewRfiUsersFetched","rfiSubTabs","caseRfiDetails","userEmail","newRfiUsers","user","caseRfiHistory","isWorklist","taskView","WORKLIST","hasRfiTabPermission","app","access","feature","newRfiTab","value","PREMIUM_PROCESSING_TAB_NEW_RFI","label","t","paramsRfiTab","subtab","toString","isValidTab","map","tab","includes","id","status","selectedTab","setSelectedTab","subTabs","type","rfiType","queryId","subLabel","open","RFI_STATUS","OPEN","responseReceived","RESPONSE_RECEIVED","resolved","RESOLVED","selectedTabStatus","generic","isValidArray","find","then","res","current","FRONT_END_CONTACT","OPERATIONS_LEAD","switchTab","newTab","replace","routes","premiumProcessing","case","PREMIUM_PROCESSING_TAB_RFI","stayOnTab","selectTab","tabName","createdByEmail"],"mappings":"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","sourcesContent":["import { React, useState, useRef, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport PropTypes from 'prop-types';\r\nimport classnames from 'classnames';\r\n\r\n// app\r\nimport styles from './PremiumProcessingCaseRFI.styles';\r\nimport PremiumProcessingCaseRFIView from './PremiumProcessingCaseRFI.view';\r\nimport {\r\n  getCaseRfiSubTabData,\r\n  selectcaseRfiSubTabs,\r\n  selectUser,\r\n  selectCaseRfiDetails,\r\n  hideModal,\r\n  getCaseRFIDetails,\r\n  selectUserEmail,\r\n  selectUsersInRoles,\r\n  getUsersForRole,\r\n  selectRfiHistory,\r\n} from 'stores';\r\nimport * as constants from 'consts';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\n\r\n// mui\r\nimport { makeStyles } from '@material-ui/core';\r\nimport FiberManualRecordIcon from '@material-ui/icons/FiberManualRecord';\r\n\r\nPremiumProcessingCaseRFI.propTypes = {\r\n  taskId: PropTypes.string.isRequired,\r\n  caseId: PropTypes.string.isRequired,\r\n  caseDetailsObject: PropTypes.object.isRequired,\r\n  isPageDirty: PropTypes.bool.isRequired,\r\n  handlers: PropTypes.shape({\r\n    setIsPageDirty: PropTypes.func.isRequired,\r\n    confirmNavigation: PropTypes.func.isRequired,\r\n  }),\r\n};\r\nfunction PremiumProcessingCaseRFI({ taskId, caseId, caseDetailsObject, isPageDirty, handlers }) {\r\n  const classes = makeStyles(styles, { name: 'PremiumProcessingCaseRFI' })();\r\n\r\n  const dispatch = useDispatch();\r\n  const params = useParams();\r\n  const history = useHistory();\r\n\r\n  const isNewRfiUsersFetched = useRef(false);\r\n  const rfiSubTabs = useSelector(selectcaseRfiSubTabs);\r\n  const caseRfiDetails = useSelector(selectCaseRfiDetails);\r\n  const userEmail = useSelector(selectUserEmail);\r\n  const newRfiUsers = useSelector(selectUsersInRoles);\r\n  const user = useSelector(selectUser);\r\n  const caseRfiHistory = useSelector(selectRfiHistory);\r\n  const isWorklist = caseDetailsObject?.taskView === constants.WORKLIST;\r\n  const hasRfiTabPermission = utils.app.access.feature('premiumProcessing.RFITab', ['read'], user);\r\n  const newRfiTab = {\r\n    value: constants.PREMIUM_PROCESSING_TAB_NEW_RFI,\r\n    label: utils.string.t('premiumProcessing.rfi.newRfi'),\r\n  };\r\n\r\n  const paramsRfiTab = params?.subtab?.toString();\r\n  const isValidTab = rfiSubTabs.map((tab) => tab.taskId).includes(paramsRfiTab);\r\n  const [selectedTab, setSelectedTab] = useState({ id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI, status: '' });\r\n  const subTabs = rfiSubTabs?.map((tab) => {\r\n    return {\r\n      value: tab.taskId,\r\n      label: utils.string.t('premiumProcessing.rfi.tabName', { type: tab.rfiType, id: tab.queryId }),\r\n      subLabel: (\r\n        <>\r\n          <FiberManualRecordIcon\r\n            className={classnames({\r\n              [classes.status]: true,\r\n              [classes.open]: tab.status === constants.RFI_STATUS.OPEN,\r\n              [classes.responseReceived]: tab.status === constants.RFI_STATUS.RESPONSE_RECEIVED,\r\n              [classes.resolved]: tab.status === constants.RFI_STATUS.RESOLVED,\r\n            })}\r\n          />\r\n          {tab.status}\r\n        </>\r\n      ),\r\n    };\r\n  });\r\n\r\n  useEffect(() => {\r\n    dispatch(getCaseRfiSubTabData(caseId));\r\n  }, [dispatch, caseId, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    const selectedTabStatus = utils.generic.isValidArray(rfiSubTabs)\r\n      ? rfiSubTabs.find((tab) => tab.taskId?.toString() === paramsRfiTab?.toString())?.status || ''\r\n      : '';\r\n\r\n    setSelectedTab({ id: isValidTab ? paramsRfiTab : constants.PREMIUM_PROCESSING_TAB_NEW_RFI, status: selectedTabStatus });\r\n  }, [rfiSubTabs]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (paramsRfiTab && paramsRfiTab !== constants.PREMIUM_PROCESSING_TAB_NEW_RFI) {\r\n      dispatch(getCaseRFIDetails({ taskId: paramsRfiTab })).then((res) => {\r\n        if (res?.taskId) {\r\n          setSelectedTab({ id: res.taskId, status: res.status });\r\n        }\r\n      });\r\n    }\r\n  }, [paramsRfiTab, caseRfiHistory]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (!isNewRfiUsersFetched.current) {\r\n      dispatch(getUsersForRole([constants.FRONT_END_CONTACT, constants.OPERATIONS_LEAD])).then((res) => {\r\n        if (utils.generic.isValidArray(res, true)) {\r\n          isNewRfiUsersFetched.current = true;\r\n        }\r\n      });\r\n    }\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const switchTab = (newTab) => {\r\n    setSelectedTab({ id: newTab, status: '' });\r\n    handlers.setIsPageDirty(false);\r\n    history.replace(`${config.routes.premiumProcessing.case}/${taskId}/${constants.PREMIUM_PROCESSING_TAB_RFI}/${newTab}`);\r\n    dispatch(hideModal('CONFIRM'));\r\n    return;\r\n  };\r\n\r\n  const stayOnTab = () => {\r\n    dispatch(hideModal('CONFIRM'));\r\n    return;\r\n  };\r\n\r\n  const selectTab = (tabName) => {\r\n    if (tabName === selectedTab?.id) return;\r\n    if (isPageDirty) {\r\n      handlers.confirmNavigation(() => switchTab(tabName), stayOnTab);\r\n      return;\r\n    } else {\r\n      switchTab(tabName);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <PremiumProcessingCaseRFIView\r\n      hasRfiTabPermission={hasRfiTabPermission}\r\n      caseDetails={caseDetailsObject}\r\n      rfiDetails={caseRfiDetails}\r\n      newRfiUsers={newRfiUsers}\r\n      subTabs={[newRfiTab, ...subTabs]}\r\n      selectedSubTab={selectedTab}\r\n      isCreatedByLoginUser={caseRfiDetails.createdByEmail === userEmail}\r\n      isPageDirty={isPageDirty}\r\n      isWorklist={isWorklist}\r\n      handlers={{ ...handlers, selectTab, switchTab, stayOnTab }}\r\n    />\r\n  );\r\n}\r\nexport default PremiumProcessingCaseRFI;\r\n"]},"metadata":{},"sourceType":"module"}