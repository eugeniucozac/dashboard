{"ast":null,"code":"import _regeneratorRuntime from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\DepartmentAccountsCalendarList\\\\DepartmentAccountsCalendarList.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useSelector } from 'react-redux';\nimport get from 'lodash/get'; // app\n\nimport { Skeleton } from 'components';\nimport styles from './DepartmentAccountsCalendarList.styles';\nimport { DepartmentAccountsCalendarListView } from './DepartmentAccountsCalendarList.view';\nimport { selectPlacementId, selectRefDataStatusesPlacement, selectUser } from 'stores';\nimport * as utils from 'utils'; // mui\n\nimport { makeStyles } from '@material-ui/core';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nDepartmentAccountsCalendarList.propTypes = {\n  rows: PropTypes.array.isRequired,\n  sort: PropTypes.object.isRequired,\n  pagination: PropTypes.object.isRequired,\n  handlers: PropTypes.object.isRequired\n};\nexport default function DepartmentAccountsCalendarList(_ref) {\n  _s();\n\n  var cols = _ref.cols,\n      handlers = _ref.handlers,\n      deptId = _ref.deptId,\n      monthDetails = _ref.monthDetails;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      items = _useState2[0],\n      setItems = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      firstItem = _useState4[0],\n      setFirstItem = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isLoading = _useState6[0],\n      setIsLoading = _useState6[1];\n\n  var placementSelectedId = useSelector(selectPlacementId);\n  var refDataStatusesPlacement = useSelector(selectRefDataStatusesPlacement);\n  var today = utils.date.today();\n  var classes = makeStyles(styles, {\n    name: 'DepartmentAccountsCalendarTable'\n  })({\n    wide: false\n  });\n  var user = useSelector(selectUser);\n  var endpoint = useSelector(function (state) {\n    return get(state, 'config.vars.endpoint');\n  });\n  var auth = user.auth;\n  useEffect(function () {\n    var isSubscribed = true;\n\n    var fetchTable = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var endpointParams, response, json, data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                endpointParams = {\n                  month: monthDetails.month,\n                  year: monthDetails.year\n                };\n                _context.next = 4;\n                return utils.api.get({\n                  token: auth.accessToken,\n                  endpoint: endpoint.edge,\n                  path: \"api/placement/department/\".concat(deptId, \"/calendar\"),\n                  params: endpointParams\n                });\n\n              case 4:\n                response = _context.sent;\n                _context.next = 7;\n                return utils.api.handleResponse(response);\n\n              case 7:\n                json = _context.sent;\n                _context.next = 10;\n                return utils.api.handleData(json);\n\n              case 10:\n                data = _context.sent;\n\n                if (isSubscribed) {\n                  setItems(utils.placement.parsePlacements(data));\n                  setIsLoading(false);\n                }\n\n                _context.next = 16;\n                break;\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](0);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 14]]);\n      }));\n\n      return function fetchTable() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    fetchTable();\n    return function () {\n      return isSubscribed = false;\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(function () {\n    if (today === monthDetails.date && items.length) {\n      var firstItemToday = items.findIndex(function (item) {\n        return item.inceptionDate >= today;\n      });\n      firstItemToday > 0 && setFirstItem(firstItemToday);\n    }\n  }, [today, monthDetails, items]);\n  return isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.monthBox,\n    \"data-testid\": \"department-accounts-list-loading\",\n    children: /*#__PURE__*/_jsxDEV(Skeleton, {\n      height: 40,\n      animation: \"wave\",\n      displayNumber: 5\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(DepartmentAccountsCalendarListView, {\n    isLoading: isLoading,\n    items: items,\n    firstItem: firstItem,\n    cols: cols,\n    placementId: placementSelectedId,\n    placementStatuses: refDataStatusesPlacement,\n    handleClickRow: handlers.handleClickRow,\n    handleDoubleClickRow: handlers.handleDoubleClickRow\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n}\n\n_s(DepartmentAccountsCalendarList, \"9TwKfL5Spc2YV4Y9IwCbZMCxUq8=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = DepartmentAccountsCalendarList;\n\nvar _c;\n\n$RefreshReg$(_c, \"DepartmentAccountsCalendarList\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/DepartmentAccountsCalendarList/DepartmentAccountsCalendarList.js"],"names":["React","useState","useEffect","PropTypes","useSelector","get","Skeleton","styles","DepartmentAccountsCalendarListView","selectPlacementId","selectRefDataStatusesPlacement","selectUser","utils","makeStyles","DepartmentAccountsCalendarList","propTypes","rows","array","isRequired","sort","object","pagination","handlers","cols","deptId","monthDetails","items","setItems","firstItem","setFirstItem","isLoading","setIsLoading","placementSelectedId","refDataStatusesPlacement","today","date","classes","name","wide","user","endpoint","state","auth","isSubscribed","fetchTable","endpointParams","month","year","api","token","accessToken","edge","path","params","response","handleResponse","json","handleData","data","placement","parsePlacements","length","firstItemToday","findIndex","item","inceptionDate","monthBox","handleClickRow","handleDoubleClickRow"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useSelector } from 'react-redux';\r\nimport get from 'lodash/get';\r\n\r\n// app\r\nimport { Skeleton } from 'components';\r\nimport styles from './DepartmentAccountsCalendarList.styles';\r\nimport { DepartmentAccountsCalendarListView } from './DepartmentAccountsCalendarList.view';\r\nimport { selectPlacementId, selectRefDataStatusesPlacement, selectUser } from 'stores';\r\nimport * as utils from 'utils';\r\n\r\n// mui\r\nimport { makeStyles } from '@material-ui/core';\r\n\r\nDepartmentAccountsCalendarList.propTypes = {\r\n  rows: PropTypes.array.isRequired,\r\n  sort: PropTypes.object.isRequired,\r\n  pagination: PropTypes.object.isRequired,\r\n  handlers: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default function DepartmentAccountsCalendarList({ cols, handlers, deptId, monthDetails }) {\r\n  const [items, setItems] = useState([]);\r\n  const [firstItem, setFirstItem] = useState(0);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const placementSelectedId = useSelector(selectPlacementId);\r\n  const refDataStatusesPlacement = useSelector(selectRefDataStatusesPlacement);\r\n  const today = utils.date.today();\r\n\r\n  const classes = makeStyles(styles, { name: 'DepartmentAccountsCalendarTable' })({ wide: false });\r\n\r\n  const user = useSelector(selectUser);\r\n  const endpoint = useSelector((state) => get(state, 'config.vars.endpoint'));\r\n  const { auth } = user;\r\n\r\n  useEffect(() => {\r\n    let isSubscribed = true;\r\n\r\n    const fetchTable = async () => {\r\n      try {\r\n        const endpointParams = {\r\n          month: monthDetails.month,\r\n          year: monthDetails.year,\r\n        };\r\n\r\n        const response = await utils.api.get({\r\n          token: auth.accessToken,\r\n          endpoint: endpoint.edge,\r\n          path: `api/placement/department/${deptId}/calendar`,\r\n          params: endpointParams,\r\n        });\r\n        const json = await utils.api.handleResponse(response);\r\n        const data = await utils.api.handleData(json);\r\n\r\n        if (isSubscribed) {\r\n          setItems(utils.placement.parsePlacements(data));\r\n          setIsLoading(false);\r\n        }\r\n      } catch (err) {}\r\n    };\r\n\r\n    fetchTable();\r\n\r\n    return () => (isSubscribed = false);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (today === monthDetails.date && items.length) {\r\n      const firstItemToday = items.findIndex((item) => item.inceptionDate >= today);\r\n\r\n      firstItemToday > 0 && setFirstItem(firstItemToday);\r\n    }\r\n  }, [today, monthDetails, items]);\r\n\r\n  return isLoading ? (\r\n    <div className={classes.monthBox} data-testid=\"department-accounts-list-loading\">\r\n      <Skeleton height={40} animation=\"wave\" displayNumber={5} />\r\n    </div>\r\n  ) : (\r\n    <DepartmentAccountsCalendarListView\r\n      isLoading={isLoading}\r\n      items={items}\r\n      firstItem={firstItem}\r\n      cols={cols}\r\n      placementId={placementSelectedId}\r\n      placementStatuses={refDataStatusesPlacement}\r\n      handleClickRow={handlers.handleClickRow}\r\n      handleDoubleClickRow={handlers.handleDoubleClickRow}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}