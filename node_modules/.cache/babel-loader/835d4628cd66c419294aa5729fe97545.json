{"ast":null,"code":"import _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\EnterAdHockDetails\\\\EnterAdHockDetails.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport * as Yup from 'yup';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport { useForm } from 'react-hook-form';\nimport { useDispatch, useSelector } from 'react-redux';\nimport EnterAdHockDetailsView from './EnterAdHockDetails.view';\nimport * as utils from 'utils';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport { selectPriorities, selectClaimsAssignedToUsers, postSaveAdHocTask, selectUser, selectAdhocTaskData, postEditAdHocTask } from 'stores';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nEnterAdHockDetails.propTypes = {\n  handleNext: PropTypes.func.isRequired,\n  handleSkipUpload: PropTypes.func.isRequired,\n  handleCancel: PropTypes.func.isRequired,\n  claim: PropTypes.object.isRequired,\n  handleFormStatus: PropTypes.func.isRequired,\n  reminderList: PropTypes.array.isRequired\n};\nEnterAdHockDetails.defaultProps = {\n  handleNext: function handleNext() {},\n  handleSkipUpload: function handleSkipUpload() {},\n  handleCancel: function handleCancel() {},\n  claim: {},\n  handleFormStatus: function handleFormStatus() {},\n  reminderList: []\n};\nexport default function EnterAdHockDetails(_ref) {\n  _s();\n\n  var _loginUserInfo$organi, _loginUserInfo$organi2, _priorities$find, _team$find;\n\n  var handleNext = _ref.handleNext,\n      handleSkipUpload = _ref.handleSkipUpload,\n      handleCancel = _ref.handleCancel,\n      claim = _ref.claim,\n      handleFormStatus = _ref.handleFormStatus,\n      reminderList = _ref.reminderList;\n  var dispatch = useDispatch();\n  var priorities = useSelector(selectPriorities);\n  var selectAssignees = useSelector(selectClaimsAssignedToUsers);\n  var loginUserInfo = useSelector(selectUser);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      users = _useState2[0],\n      setfilterUser = _useState2[1];\n\n  var taskDetails = useSelector(selectAdhocTaskData);\n  var defaultOrganization = {\n    organisationName: loginUserInfo === null || loginUserInfo === void 0 ? void 0 : (_loginUserInfo$organi = loginUserInfo.organisation) === null || _loginUserInfo$organi === void 0 ? void 0 : _loginUserInfo$organi.name,\n    organisationId: loginUserInfo === null || loginUserInfo === void 0 ? void 0 : (_loginUserInfo$organi2 = loginUserInfo.organisation) === null || _loginUserInfo$organi2 === void 0 ? void 0 : _loginUserInfo$organi2.id\n  };\n  var team = [{\n    organisationName: 'Mphasis',\n    organisationId: 1\n  }, {\n    organisationName: 'Ardonagh',\n    organisationId: 2\n  }];\n  var defaultPriority = {\n    id: '2',\n    name: null,\n    description: 'Medium'\n  };\n  var fields = [{\n    id: 'taskName',\n    name: 'taskName',\n    type: 'text',\n    label: utils.string.t('claims.processing.taskDetailsLabels.taskName'),\n    value: (taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.name) || '',\n    validation: Yup.string().required(utils.string.t('validation.required'))\n  }, {\n    name: 'priority',\n    id: 'priority',\n    type: 'select',\n    label: utils.string.t('claims.processing.taskDetailsLabels.priority'),\n    options: utils.generic.isValidArray(priorities, true) ? priorities : [],\n    optionKey: 'id',\n    optionLabel: 'description',\n    validation: Yup.string().required(utils.string.t('validation.required')),\n    defaultValue: Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.priority) ? priorities === null || priorities === void 0 ? void 0 : (_priorities$find = priorities.find(function (_ref2) {\n      var id = _ref2.id;\n      return id === (taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.priority);\n    })) === null || _priorities$find === void 0 ? void 0 : _priorities$find.id : defaultPriority === null || defaultPriority === void 0 ? void 0 : defaultPriority.id\n  }, {\n    id: 'team',\n    name: 'team',\n    type: 'select',\n    label: utils.string.t('claims.processing.taskDetailsLabels.team'),\n    options: utils.generic.isValidArray(team, true) ? team : [],\n    defaultValue: Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.sendToTeam) ? team === null || team === void 0 ? void 0 : (_team$find = team.find(function (_ref3) {\n      var _taskDetails$sendToTe;\n\n      var organisationName = _ref3.organisationName;\n      return (organisationName === null || organisationName === void 0 ? void 0 : organisationName.toLowerCase()) === (taskDetails === null || taskDetails === void 0 ? void 0 : (_taskDetails$sendToTe = taskDetails.sendToTeam) === null || _taskDetails$sendToTe === void 0 ? void 0 : _taskDetails$sendToTe.toLowerCase());\n    })) === null || _team$find === void 0 ? void 0 : _team$find.organisationId : defaultOrganization === null || defaultOrganization === void 0 ? void 0 : defaultOrganization.organisationId,\n    optionKey: 'organisationId',\n    optionLabel: 'organisationName',\n    validation: Yup.string().required(utils.string.t('validation.required'))\n  }, {\n    id: 'assignTo',\n    name: 'assignTo',\n    type: 'autocompletemui',\n    label: utils.string.t('claims.processing.taskDetailsLabels.assignedTo'),\n    options: utils.generic.isValidArray(users, true) ? users : [],\n    optionKey: 'email',\n    optionLabel: 'fullName',\n    validation: Yup.object().required(utils.string.t('validation.required')).nullable(),\n    defaultValue: null\n  }, {\n    id: 'taskDescription',\n    name: 'taskDescription',\n    label: \"\".concat(utils.string.t('claims.processing.taskDetailsLabels.description')),\n    type: 'textarea',\n    value: (taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.description) || '',\n    muiComponentProps: {\n      multiline: true,\n      rows: 5,\n      rowsMax: 5\n    },\n    validation: Yup.string().required(utils.string.t('validation.required'))\n  }, {\n    id: 'targetDueDate',\n    type: 'datepicker',\n    name: 'targetDueDate',\n    label: utils.string.t('claims.processing.taskDetailsLabels.targetDueDate'),\n    icon: 'TodayIcon',\n    value: Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.dueDate) ? taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.dueDate : null,\n    muiComponentProps: {\n      fullWidth: true\n    },\n    validation: Yup.date().required(utils.string.t('validation.required')).nullable().test('from', utils.string.t('claims.processing.validation.targetLessThanCreatedDate'), function (value) {\n      var createdDate = new moment();\n      return value && createdDate ? moment(value).isSameOrAfter(createdDate, 'day') : true;\n    })\n  }, {\n    id: 'reminder',\n    name: 'reminder',\n    type: 'autocompletemui',\n    label: utils.string.t('claims.processing.taskDetailsLabels.reminder'),\n    options: (reminderList === null || reminderList === void 0 ? void 0 : reminderList.length) ? reminderList : [],\n    optionKey: 'id',\n    optionLabel: 'name',\n    validation: Yup.object().nullable(),\n    defaultValue: Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.reminder) ? reminderList === null || reminderList === void 0 ? void 0 : reminderList.find(function (_ref4) {\n      var id = _ref4.id;\n      return id === (taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.reminder);\n    }) : null\n  }];\n  var defaultValues = utils.form.getInitialValues(fields);\n  var validationSchema = utils.form.getValidationSchema(fields);\n\n  var _useForm = useForm(_objectSpread({\n    defaultValues: defaultValues\n  }, validationSchema && {\n    resolver: yupResolver(validationSchema)\n  })),\n      errors = _useForm.errors,\n      control = _useForm.control,\n      handleSubmit = _useForm.handleSubmit,\n      formState = _useForm.formState,\n      watch = _useForm.watch,\n      setValue = _useForm.setValue;\n\n  var formIsDirty = formState.isDirty;\n  var watchTeam = watch('team');\n  var assignedTo = watch('assignTo');\n  useEffect(function () {\n    var filteredUser = [];\n\n    if (Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.sendToTeam)) {\n      var _selectAssignees$item, _filteredUser;\n\n      filteredUser = selectAssignees === null || selectAssignees === void 0 ? void 0 : (_selectAssignees$item = selectAssignees.items) === null || _selectAssignees$item === void 0 ? void 0 : _selectAssignees$item.filter(function (profile) {\n        var _profile$organisation, _taskDetails$sendToTe2;\n\n        return (profile === null || profile === void 0 ? void 0 : (_profile$organisation = profile.organisationName) === null || _profile$organisation === void 0 ? void 0 : _profile$organisation.toLowerCase()) === (taskDetails === null || taskDetails === void 0 ? void 0 : (_taskDetails$sendToTe2 = taskDetails.sendToTeam) === null || _taskDetails$sendToTe2 === void 0 ? void 0 : _taskDetails$sendToTe2.toLowerCase());\n      });\n      setfilterUser(filteredUser);\n\n      var _assignedTo = (_filteredUser = filteredUser) === null || _filteredUser === void 0 ? void 0 : _filteredUser.find(function (_ref5) {\n        var _taskDetails$sendToUs;\n\n        var email = _ref5.email;\n        return (email === null || email === void 0 ? void 0 : email.toLowerCase()) === (taskDetails === null || taskDetails === void 0 ? void 0 : (_taskDetails$sendToUs = taskDetails.sendToUser) === null || _taskDetails$sendToUs === void 0 ? void 0 : _taskDetails$sendToUs.toLowerCase());\n      });\n\n      setValue('assignTo', _assignedTo);\n    } else if (Boolean(watchTeam)) {\n      var _selectAssignees$item2;\n\n      filteredUser = selectAssignees === null || selectAssignees === void 0 ? void 0 : (_selectAssignees$item2 = selectAssignees.items) === null || _selectAssignees$item2 === void 0 ? void 0 : _selectAssignees$item2.filter(function (profile) {\n        return (profile === null || profile === void 0 ? void 0 : profile.organisationId) === watchTeam;\n      });\n      setfilterUser(filteredUser);\n    } else if (watchTeam === null) {\n      setfilterUser(selectAssignees === null || selectAssignees === void 0 ? void 0 : selectAssignees.items);\n    } else {\n      var _selectAssignees$item3;\n\n      filteredUser = selectAssignees === null || selectAssignees === void 0 ? void 0 : (_selectAssignees$item3 = selectAssignees.items) === null || _selectAssignees$item3 === void 0 ? void 0 : _selectAssignees$item3.filter(function (profile) {\n        var _loginUserInfo$organi3;\n\n        return (profile === null || profile === void 0 ? void 0 : profile.organisationId) === (loginUserInfo === null || loginUserInfo === void 0 ? void 0 : (_loginUserInfo$organi3 = loginUserInfo.organisation) === null || _loginUserInfo$organi3 === void 0 ? void 0 : _loginUserInfo$organi3.id);\n      });\n      setfilterUser(filteredUser);\n    }\n\n    if (Boolean(assignedTo)) {\n      var _filteredUser2;\n\n      var isValidSelection = !((_filteredUser2 = filteredUser) === null || _filteredUser2 === void 0 ? void 0 : _filteredUser2.some(function (_ref6) {\n        var _assignedTo$email;\n\n        var email = _ref6.email;\n        return (assignedTo === null || assignedTo === void 0 ? void 0 : (_assignedTo$email = assignedTo.email) === null || _assignedTo$email === void 0 ? void 0 : _assignedTo$email.toLowerCase()) === (email === null || email === void 0 ? void 0 : email.toLowerCase());\n      }));\n      isValidSelection && setValue('assignTo', null);\n    }\n  }, [selectAssignees, watchTeam]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(function () {\n    if (formIsDirty) {\n      handleFormStatus();\n    }\n  }, [formIsDirty]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var createAdHocTask = function createAdHocTask(values) {\n    var _values$assignTo, _values$reminder, _loginUserInfo$organi4, _values$assignTo2, _values$assignTo3;\n\n    var targetDueDate = utils.string.t('format.date', {\n      value: {\n        date: watch('targetDueDate'),\n        format: 'YYYY-MM-DDT00:00:00.000'\n      }\n    }) + 'Z';\n    var adHocData = {\n      assignedTo: values === null || values === void 0 ? void 0 : (_values$assignTo = values.assignTo) === null || _values$assignTo === void 0 ? void 0 : _values$assignTo.email,\n      bpmProcessId: Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.id) ? taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.processInstanceId : claim === null || claim === void 0 ? void 0 : claim.processID,\n      claimRef: claim === null || claim === void 0 ? void 0 : claim.claimReference,\n      description: values === null || values === void 0 ? void 0 : values.taskDescription,\n      priority: Number(values === null || values === void 0 ? void 0 : values.priority),\n      reminder: values === null || values === void 0 ? void 0 : (_values$reminder = values.reminder) === null || _values$reminder === void 0 ? void 0 : _values$reminder.id,\n      requestedByTeam: loginUserInfo === null || loginUserInfo === void 0 ? void 0 : (_loginUserInfo$organi4 = loginUserInfo.organisation) === null || _loginUserInfo$organi4 === void 0 ? void 0 : _loginUserInfo$organi4.name,\n      sendToTeam: values === null || values === void 0 ? void 0 : (_values$assignTo2 = values.assignTo) === null || _values$assignTo2 === void 0 ? void 0 : _values$assignTo2.organisationName,\n      sendToUser: values === null || values === void 0 ? void 0 : (_values$assignTo3 = values.assignTo) === null || _values$assignTo3 === void 0 ? void 0 : _values$assignTo3.email,\n      status: claim === null || claim === void 0 ? void 0 : claim.status,\n      targetDueDate: targetDueDate,\n      taskName: values === null || values === void 0 ? void 0 : values.taskName\n    };\n\n    if (formIsDirty) {\n      if (Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.id)) {\n        dispatch(postEditAdHocTask(adHocData, taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.id)).then(function (response) {\n          if ((response === null || response === void 0 ? void 0 : response.status) === 'OK') {\n            handleNext();\n          }\n        });\n      } else {\n        dispatch(postSaveAdHocTask(adHocData)).then(function (response) {\n          if ((response === null || response === void 0 ? void 0 : response.status) === 'OK') {\n            handleNext();\n          }\n        });\n      }\n    } else {\n      handleNext();\n    }\n  };\n\n  var skipUploadDocs = function skipUploadDocs(values) {\n    var _values$assignTo4, _values$reminder2, _loginUserInfo$organi5, _values$assignTo5, _values$assignTo6;\n\n    var targetDueDate = utils.string.t('format.date', {\n      value: {\n        date: watch('targetDueDate'),\n        format: 'YYYY-MM-DDT00:00:00.000'\n      }\n    }) + 'Z';\n    var adHocData = {\n      assignedTo: values === null || values === void 0 ? void 0 : (_values$assignTo4 = values.assignTo) === null || _values$assignTo4 === void 0 ? void 0 : _values$assignTo4.email,\n      bpmProcessId: Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.id) ? taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.processInstanceId : claim === null || claim === void 0 ? void 0 : claim.processID,\n      claimRef: claim === null || claim === void 0 ? void 0 : claim.claimReference,\n      description: values === null || values === void 0 ? void 0 : values.taskDescription,\n      priority: Number(values === null || values === void 0 ? void 0 : values.priority),\n      reminder: values === null || values === void 0 ? void 0 : (_values$reminder2 = values.reminder) === null || _values$reminder2 === void 0 ? void 0 : _values$reminder2.id,\n      requestedByTeam: loginUserInfo === null || loginUserInfo === void 0 ? void 0 : (_loginUserInfo$organi5 = loginUserInfo.organisation) === null || _loginUserInfo$organi5 === void 0 ? void 0 : _loginUserInfo$organi5.name,\n      sendToTeam: values === null || values === void 0 ? void 0 : (_values$assignTo5 = values.assignTo) === null || _values$assignTo5 === void 0 ? void 0 : _values$assignTo5.organisationName,\n      sendToUser: values === null || values === void 0 ? void 0 : (_values$assignTo6 = values.assignTo) === null || _values$assignTo6 === void 0 ? void 0 : _values$assignTo6.email,\n      status: claim === null || claim === void 0 ? void 0 : claim.status,\n      targetDueDate: targetDueDate,\n      taskName: values === null || values === void 0 ? void 0 : values.taskName\n    };\n\n    if (formIsDirty) {\n      if (Boolean(taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.id)) {\n        dispatch(postEditAdHocTask(adHocData, taskDetails === null || taskDetails === void 0 ? void 0 : taskDetails.id)).then(function (response) {\n          if ((response === null || response === void 0 ? void 0 : response.status) === 'OK') {\n            handleSkipUpload();\n          }\n        });\n      } else {\n        dispatch(postSaveAdHocTask(adHocData)).then(function (response) {\n          if ((response === null || response === void 0 ? void 0 : response.status) === 'OK') {\n            handleSkipUpload();\n          }\n        });\n      }\n    } else {\n      handleSkipUpload();\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(EnterAdHockDetailsView, {\n    fields: fields,\n    handleCancel: handleCancel,\n    errors: errors,\n    control: control,\n    claim: claim,\n    handleSubmit: handleSubmit,\n    createAdHocTask: createAdHocTask,\n    skipUploadDocs: skipUploadDocs\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 270,\n    columnNumber: 5\n  }, this);\n}\n\n_s(EnterAdHockDetails, \"nOGRGk7ULdscGALLE2NGcheEo5Y=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useForm];\n});\n\n_c = EnterAdHockDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"EnterAdHockDetails\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/EnterAdHockDetails/EnterAdHockDetails.js"],"names":["React","useEffect","useState","Yup","moment","PropTypes","useForm","useDispatch","useSelector","EnterAdHockDetailsView","utils","yupResolver","selectPriorities","selectClaimsAssignedToUsers","postSaveAdHocTask","selectUser","selectAdhocTaskData","postEditAdHocTask","EnterAdHockDetails","propTypes","handleNext","func","isRequired","handleSkipUpload","handleCancel","claim","object","handleFormStatus","reminderList","array","defaultProps","dispatch","priorities","selectAssignees","loginUserInfo","users","setfilterUser","taskDetails","defaultOrganization","organisationName","organisation","name","organisationId","id","team","defaultPriority","description","fields","type","label","string","t","value","validation","required","options","generic","isValidArray","optionKey","optionLabel","defaultValue","Boolean","priority","find","sendToTeam","toLowerCase","nullable","muiComponentProps","multiline","rows","rowsMax","icon","dueDate","fullWidth","date","test","createdDate","isSameOrAfter","length","reminder","defaultValues","form","getInitialValues","validationSchema","getValidationSchema","resolver","errors","control","handleSubmit","formState","watch","setValue","formIsDirty","isDirty","watchTeam","assignedTo","filteredUser","items","filter","profile","email","sendToUser","isValidSelection","some","createAdHocTask","values","targetDueDate","format","adHocData","assignTo","bpmProcessId","processInstanceId","processID","claimRef","claimReference","taskDescription","Number","requestedByTeam","status","taskName","then","response","skipUploadDocs"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport * as Yup from 'yup';\r\nimport moment from 'moment';\r\nimport PropTypes from 'prop-types';\r\nimport { useForm } from 'react-hook-form';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport EnterAdHockDetailsView from './EnterAdHockDetails.view';\r\n\r\nimport * as utils from 'utils';\r\n\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport {\r\n  selectPriorities,\r\n  selectClaimsAssignedToUsers,\r\n  postSaveAdHocTask,\r\n  selectUser,\r\n  selectAdhocTaskData,\r\n  postEditAdHocTask,\r\n} from 'stores';\r\n\r\nEnterAdHockDetails.propTypes = {\r\n  handleNext: PropTypes.func.isRequired,\r\n  handleSkipUpload: PropTypes.func.isRequired,\r\n  handleCancel: PropTypes.func.isRequired,\r\n  claim: PropTypes.object.isRequired,\r\n  handleFormStatus: PropTypes.func.isRequired,\r\n  reminderList: PropTypes.array.isRequired,\r\n};\r\nEnterAdHockDetails.defaultProps = {\r\n  handleNext: () => {},\r\n  handleSkipUpload: () => {},\r\n  handleCancel: () => {},\r\n  claim: {},\r\n  handleFormStatus: () => {},\r\n  reminderList: [],\r\n};\r\n\r\nexport default function EnterAdHockDetails({ handleNext, handleSkipUpload, handleCancel, claim, handleFormStatus, reminderList }) {\r\n  const dispatch = useDispatch();\r\n  const priorities = useSelector(selectPriorities);\r\n  const selectAssignees = useSelector(selectClaimsAssignedToUsers);\r\n  const loginUserInfo = useSelector(selectUser);\r\n  const [users, setfilterUser] = useState([]);\r\n  const taskDetails = useSelector(selectAdhocTaskData);\r\n\r\n  const defaultOrganization = {\r\n    organisationName: loginUserInfo?.organisation?.name,\r\n    organisationId: loginUserInfo?.organisation?.id,\r\n  };\r\n\r\n  const team = [\r\n    {\r\n      organisationName: 'Mphasis',\r\n      organisationId: 1,\r\n    },\r\n    {\r\n      organisationName: 'Ardonagh',\r\n      organisationId: 2,\r\n    },\r\n  ];\r\n\r\n  const defaultPriority = {\r\n    id: '2',\r\n    name: null,\r\n    description: 'Medium',\r\n  };\r\n  const fields = [\r\n    {\r\n      id: 'taskName',\r\n      name: 'taskName',\r\n      type: 'text',\r\n      label: utils.string.t('claims.processing.taskDetailsLabels.taskName'),\r\n      value: taskDetails?.name || '',\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n    },\r\n    {\r\n      name: 'priority',\r\n      id: 'priority',\r\n      type: 'select',\r\n      label: utils.string.t('claims.processing.taskDetailsLabels.priority'),\r\n      options: utils.generic.isValidArray(priorities, true) ? priorities : [],\r\n      optionKey: 'id',\r\n      optionLabel: 'description',\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n      defaultValue: Boolean(taskDetails?.priority) ? priorities?.find(({ id }) => id === taskDetails?.priority)?.id : defaultPriority?.id,\r\n    },\r\n    {\r\n      id: 'team',\r\n      name: 'team',\r\n      type: 'select',\r\n      label: utils.string.t('claims.processing.taskDetailsLabels.team'),\r\n      options: utils.generic.isValidArray(team, true) ? team : [],\r\n      defaultValue: Boolean(taskDetails?.sendToTeam)\r\n        ? team?.find(({ organisationName }) => organisationName?.toLowerCase() === taskDetails?.sendToTeam?.toLowerCase())?.organisationId\r\n        : defaultOrganization?.organisationId,\r\n      optionKey: 'organisationId',\r\n      optionLabel: 'organisationName',\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n    },\r\n    {\r\n      id: 'assignTo',\r\n      name: 'assignTo',\r\n      type: 'autocompletemui',\r\n      label: utils.string.t('claims.processing.taskDetailsLabels.assignedTo'),\r\n      options: utils.generic.isValidArray(users, true) ? users : [],\r\n      optionKey: 'email',\r\n      optionLabel: 'fullName',\r\n      validation: Yup.object().required(utils.string.t('validation.required')).nullable(),\r\n      defaultValue: null,\r\n    },\r\n    {\r\n      id: 'taskDescription',\r\n      name: 'taskDescription',\r\n      label: `${utils.string.t('claims.processing.taskDetailsLabels.description')}`,\r\n      type: 'textarea',\r\n      value: taskDetails?.description || '',\r\n      muiComponentProps: {\r\n        multiline: true,\r\n        rows: 5,\r\n        rowsMax: 5,\r\n      },\r\n      validation: Yup.string().required(utils.string.t('validation.required')),\r\n    },\r\n    {\r\n      id: 'targetDueDate',\r\n      type: 'datepicker',\r\n      name: 'targetDueDate',\r\n      label: utils.string.t('claims.processing.taskDetailsLabels.targetDueDate'),\r\n      icon: 'TodayIcon',\r\n      value: Boolean(taskDetails?.dueDate) ? taskDetails?.dueDate : null,\r\n      muiComponentProps: {\r\n        fullWidth: true,\r\n      },\r\n      validation: Yup.date()\r\n        .required(utils.string.t('validation.required'))\r\n        .nullable()\r\n        .test('from', utils.string.t('claims.processing.validation.targetLessThanCreatedDate'), function (value) {\r\n          const createdDate = new moment();\r\n          return value && createdDate ? moment(value).isSameOrAfter(createdDate, 'day') : true;\r\n        }),\r\n    },\r\n    {\r\n      id: 'reminder',\r\n      name: 'reminder',\r\n      type: 'autocompletemui',\r\n      label: utils.string.t('claims.processing.taskDetailsLabels.reminder'),\r\n      options: reminderList?.length ? reminderList : [],\r\n      optionKey: 'id',\r\n      optionLabel: 'name',\r\n      validation: Yup.object().nullable(),\r\n      defaultValue: Boolean(taskDetails?.reminder) ? reminderList?.find(({ id }) => id === taskDetails?.reminder) : null,\r\n    },\r\n  ];\r\n\r\n  const defaultValues = utils.form.getInitialValues(fields);\r\n  const validationSchema = utils.form.getValidationSchema(fields);\r\n\r\n  const { errors, control, handleSubmit, formState, watch, setValue } = useForm({\r\n    defaultValues,\r\n    ...(validationSchema && { resolver: yupResolver(validationSchema) }),\r\n  });\r\n  const formIsDirty = formState.isDirty;\r\n  const watchTeam = watch('team');\r\n  const assignedTo = watch('assignTo');\r\n\r\n  useEffect(() => {\r\n    let filteredUser = [];\r\n    if (Boolean(taskDetails?.sendToTeam)) {\r\n      filteredUser = selectAssignees?.items?.filter(\r\n        (profile) => profile?.organisationName?.toLowerCase() === taskDetails?.sendToTeam?.toLowerCase()\r\n      );\r\n      setfilterUser(filteredUser);\r\n      const assignedTo = filteredUser?.find(({ email }) => email?.toLowerCase() === taskDetails?.sendToUser?.toLowerCase());\r\n      setValue('assignTo', assignedTo);\r\n    } else if (Boolean(watchTeam)) {\r\n      filteredUser = selectAssignees?.items?.filter((profile) => profile?.organisationId === watchTeam);\r\n      setfilterUser(filteredUser);\r\n    } else if (watchTeam === null) {\r\n      setfilterUser(selectAssignees?.items);\r\n    } else {\r\n      filteredUser = selectAssignees?.items?.filter((profile) => profile?.organisationId === loginUserInfo?.organisation?.id);\r\n      setfilterUser(filteredUser);\r\n    }\r\n    if (Boolean(assignedTo)) {\r\n      const isValidSelection = !filteredUser?.some(({ email }) => assignedTo?.email?.toLowerCase() === email?.toLowerCase());\r\n      isValidSelection && setValue('assignTo', null);\r\n    }\r\n  }, [selectAssignees, watchTeam]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (formIsDirty) {\r\n      handleFormStatus();\r\n    }\r\n  }, [formIsDirty]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const createAdHocTask = (values) => {\r\n    const targetDueDate =\r\n      utils.string.t('format.date', { value: { date: watch('targetDueDate'), format: 'YYYY-MM-DDT00:00:00.000' } }) + 'Z';\r\n    const adHocData = {\r\n      assignedTo: values?.assignTo?.email,\r\n      bpmProcessId: Boolean(taskDetails?.id) ? taskDetails?.processInstanceId : claim?.processID,\r\n      claimRef: claim?.claimReference,\r\n      description: values?.taskDescription,\r\n      priority: Number(values?.priority),\r\n      reminder: values?.reminder?.id,\r\n      requestedByTeam: loginUserInfo?.organisation?.name,\r\n      sendToTeam: values?.assignTo?.organisationName,\r\n      sendToUser: values?.assignTo?.email,\r\n      status: claim?.status,\r\n      targetDueDate: targetDueDate,\r\n      taskName: values?.taskName,\r\n    };\r\n    if (formIsDirty) {\r\n      if (Boolean(taskDetails?.id)) {\r\n        dispatch(postEditAdHocTask(adHocData, taskDetails?.id)).then((response) => {\r\n          if (response?.status === 'OK') {\r\n            handleNext();\r\n          }\r\n        });\r\n      } else {\r\n        dispatch(postSaveAdHocTask(adHocData)).then((response) => {\r\n          if (response?.status === 'OK') {\r\n            handleNext();\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      handleNext();\r\n    }\r\n  };\r\n\r\n  const skipUploadDocs = (values) => {\r\n    const targetDueDate =\r\n      utils.string.t('format.date', { value: { date: watch('targetDueDate'), format: 'YYYY-MM-DDT00:00:00.000' } }) + 'Z';\r\n    const adHocData = {\r\n      assignedTo: values?.assignTo?.email,\r\n      bpmProcessId: Boolean(taskDetails?.id) ? taskDetails?.processInstanceId : claim?.processID,\r\n      claimRef: claim?.claimReference,\r\n      description: values?.taskDescription,\r\n      priority: Number(values?.priority),\r\n      reminder: values?.reminder?.id,\r\n      requestedByTeam: loginUserInfo?.organisation?.name,\r\n      sendToTeam: values?.assignTo?.organisationName,\r\n      sendToUser: values?.assignTo?.email,\r\n      status: claim?.status,\r\n      targetDueDate: targetDueDate,\r\n      taskName: values?.taskName,\r\n    };\r\n    if (formIsDirty) {\r\n      if (Boolean(taskDetails?.id)) {\r\n        dispatch(postEditAdHocTask(adHocData, taskDetails?.id)).then((response) => {\r\n          if (response?.status === 'OK') {\r\n            handleSkipUpload();\r\n          }\r\n        });\r\n      } else {\r\n        dispatch(postSaveAdHocTask(adHocData)).then((response) => {\r\n          if (response?.status === 'OK') {\r\n            handleSkipUpload();\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      handleSkipUpload();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <EnterAdHockDetailsView\r\n      fields={fields}\r\n      handleCancel={handleCancel}\r\n      errors={errors}\r\n      control={control}\r\n      claim={claim}\r\n      handleSubmit={handleSubmit}\r\n      createAdHocTask={createAdHocTask}\r\n      skipUploadDocs={skipUploadDocs}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}