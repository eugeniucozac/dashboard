{"ast":null,"code":"import \"core-js/modules/es.array.includes\";\nimport _objectSpread from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"E:/MPHASIS/claims-page/Mphasis-Edge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"E:\\\\MPHASIS\\\\claims-page\\\\Mphasis-Edge\\\\src\\\\modules\\\\ProcessingInstructionsChecklist\\\\ProcessingInstructionsChecklist.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useHistory, useParams } from 'react-router';\nimport get from 'lodash/get'; // app\n\nimport ProcessingInstructionsChecklistView from './ProcessingInstructionsChecklist.view';\nimport { processingInstructionsSchema } from 'schemas';\nimport { enqueueNotification, checkListUpdate, showModal, selectUser, selectPiProducingBrokers, selectPiAccountExecutives, selectPiFacilityTypes, selectAccountExecutivesForRiskReference, selectProducingBrokerNamesForRiskReference, updateReferenceDocumentCountLoading, getRiskReferenceDocumentsCount } from 'stores';\nimport * as utils from 'utils';\nimport config from 'config';\nimport * as constants from 'consts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nProcessingInstructionsChecklist.propTypes = {\n  instruction: PropTypes.object.isRequired,\n  handlers: PropTypes.shape({\n    back: PropTypes.func.isRequired,\n    next: PropTypes.func.isRequired\n  }).isRequired\n};\nexport default function ProcessingInstructionsChecklist(_ref) {\n  _s();\n\n  var _instruction$riskRefe,\n      _instruction$details7,\n      _instruction$details8,\n      _instruction$details9,\n      _instruction$details10,\n      _this = this;\n\n  var instruction = _ref.instruction,\n      handlers = _ref.handlers,\n      childRef = _ref.childRef;\n  var dispatch = useDispatch();\n  var history = useHistory();\n\n  var _useParams = useParams(),\n      id = _useParams.id,\n      step = _useParams.step,\n      tab = _useParams.tab;\n\n  var piProducingBrokers = useSelector(selectProducingBrokerNamesForRiskReference);\n  var piAccountExecutives = useSelector(selectAccountExecutivesForRiskReference);\n  var documents = useSelector(function (state) {\n    return get(state, 'processingInstructions.documents');\n  }) || {};\n  var producingBrokersFromRoles = useSelector(selectPiProducingBrokers);\n  var accountExecutivesFromRoles = useSelector(selectPiAccountExecutives);\n  var producingBrokers = utils.generic.isValidArray(piProducingBrokers, true) ? piProducingBrokers : producingBrokersFromRoles;\n  var accountExecutives = utils.generic.isValidArray(piAccountExecutives, true) ? piAccountExecutives : accountExecutivesFromRoles;\n  var facilityTypes = useSelector(selectPiFacilityTypes);\n  var user = useSelector(selectUser);\n  var columns = [{\n    id: 'detail',\n    label: utils.string.t('processingInstructions.checklist.cols.detail')\n  }, {\n    id: 'frontEndContact',\n    label: utils.string.t('processingInstructions.checklist.cols.frontEndContact'),\n    align: 'center'\n  }, {\n    id: 'authorisedSignatory',\n    label: utils.string.t('processingInstructions.checklist.cols.authorisedSignatory'),\n    align: 'center'\n  }];\n  var tabs = [{\n    value: 'general',\n    label: utils.string.t('processingInstructions.checklist.tabs.general.title')\n  }, {\n    value: 'pre-placing',\n    label: utils.string.t('processingInstructions.checklist.tabs.prePlacing.title')\n  }, {\n    value: 'mrc',\n    label: utils.string.t('processingInstructions.checklist.tabs.mrc.title')\n  }, {\n    value: 'other-details',\n    label: utils.string.t('processingInstructions.checklist.tabs.otherDetails.title')\n  }, {\n    value: 'risk-references',\n    label: utils.string.t('processingInstructions.checklist.tabs.riskRefs.title')\n  }];\n  var isValidTab = tabs.map(function (item) {\n    return item.value;\n  }).includes(tab);\n\n  var _useState = useState(isValidTab ? tab : 'general'),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedTab = _useState2[0],\n      setSelectedTab = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      defaultValues = _useState4[0],\n      setDefaultValues = _useState4[1];\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      schemaData = _useState6[0],\n      setSchemaData = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      resetKey = _useState8[0],\n      setResetKey = _useState8[1];\n\n  var leadRef = instruction === null || instruction === void 0 ? void 0 : (_instruction$riskRefe = instruction.riskReferences) === null || _instruction$riskRefe === void 0 ? void 0 : _instruction$riskRefe.find(function (r) {\n    return r.leadPolicy;\n  });\n  var leadRefProducingBrokerName = leadRef === null || leadRef === void 0 ? void 0 : leadRef.producingBrokerName;\n  var leadRefAccountExecutiveName = leadRef === null || leadRef === void 0 ? void 0 : leadRef.accountExecutive;\n  var isFdo = utils.processingInstructions.isFdo(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isDraft = utils.processingInstructions.status.isDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var isReopened = utils.processingInstructions.status.isReopened(instruction === null || instruction === void 0 ? void 0 : instruction.statusId);\n  var userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\n  var userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\n  var isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\n  var isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\n  var isReadOnly = !isEditable;\n  var isEndorsement = utils.processingInstructions.isEndorsement(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isFeeAndAmendment = utils.processingInstructions.isFeeAndAmendment(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var isBordereau = utils.processingInstructions.isBordereau(instruction === null || instruction === void 0 ? void 0 : instruction.processTypeId);\n  var faBorderProcessType = isBordereau || isFeeAndAmendment;\n\n  var getFacilityTypeId = function getFacilityTypeId() {\n    var _instruction$details;\n\n    var facilityTypeId = instruction === null || instruction === void 0 ? void 0 : (_instruction$details = instruction.details) === null || _instruction$details === void 0 ? void 0 : _instruction$details.facilityTypeId;\n\n    if (!facilityTypeId && utils.generic.isValidArray(facilityTypes, true)) {\n      var item = facilityTypes.find(function (type) {\n        var _instruction$details2;\n\n        return type.facilityTypeID === (instruction === null || instruction === void 0 ? void 0 : (_instruction$details2 = instruction.details) === null || _instruction$details2 === void 0 ? void 0 : _instruction$details2.facilityTypeId);\n      });\n      facilityTypeId = item === null || item === void 0 ? void 0 : item.facilityTypeID;\n    }\n\n    return facilityTypeId || '';\n  };\n\n  var getRiskReferenceDocumentCount = function getRiskReferenceDocumentCount() {\n    if (utils.generic.isValidArray(documents === null || documents === void 0 ? void 0 : documents.riskReferences, true)) {\n      var _documents$riskRefere;\n\n      dispatch(updateReferenceDocumentCountLoading(true));\n      var referenceList = documents === null || documents === void 0 ? void 0 : (_documents$riskRefere = documents.riskReferences) === null || _documents$riskRefere === void 0 ? void 0 : _documents$riskRefere.map(function (refData) {\n        return {\n          endorsementId: refData.endorsementId,\n          endorsementNumber: refData.endorsementNumber,\n          riskRefId: refData.riskRefId,\n          xbInstanceId: refData.xbInstanceId,\n          xbPolicyId: refData.xbPolicyId\n        };\n      });\n      var documentTypeValue = isEndorsement ? constants.PI_ENDORSEMENT_TYPE_DOCUMENT.documentTypeDescription : faBorderProcessType ? constants.PI_FABORDER_TYPE_DOCUMENT.documentTypeDescription : constants.PI_CLOSING_FDO_TYPE_DOCUMENT.documentTypeDescription;\n      dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue));\n    }\n  };\n\n  useEffect(function () {\n    getRiskReferenceDocumentCount();\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var getProducingBrokerId = function getProducingBrokerId() {\n    var _instruction$details3;\n\n    var producingBrokerId = instruction === null || instruction === void 0 ? void 0 : (_instruction$details3 = instruction.details) === null || _instruction$details3 === void 0 ? void 0 : _instruction$details3.producingBrokerId;\n    var item;\n\n    if (utils.generic.isValidArray(piProducingBrokers, true)) {\n      if (producingBrokerId) {\n        var _item;\n\n        item = piProducingBrokers.find(function (type) {\n          return type.id === producingBrokerId;\n        });\n        producingBrokerId = (_item = item) === null || _item === void 0 ? void 0 : _item.id;\n      } else if (leadRefProducingBrokerName) {\n        var leadProducingBroker = piProducingBrokers === null || piProducingBrokers === void 0 ? void 0 : piProducingBrokers.find(function (type) {\n          var _type$value;\n\n          return (type === null || type === void 0 ? void 0 : (_type$value = type.value) === null || _type$value === void 0 ? void 0 : _type$value.toLowerCase()) === (leadRefProducingBrokerName === null || leadRefProducingBrokerName === void 0 ? void 0 : leadRefProducingBrokerName.toLowerCase());\n        });\n        producingBrokerId = leadProducingBroker === null || leadProducingBroker === void 0 ? void 0 : leadProducingBroker.id;\n      }\n    } else if (!producingBrokerId && utils.generic.isValidArray(producingBrokers, true)) {\n      var _item2;\n\n      item = producingBrokers.find(function (type) {\n        var _instruction$details4;\n\n        return type.id === (instruction === null || instruction === void 0 ? void 0 : (_instruction$details4 = instruction.details) === null || _instruction$details4 === void 0 ? void 0 : _instruction$details4.producingBrokerId);\n      });\n      producingBrokerId = (_item2 = item) === null || _item2 === void 0 ? void 0 : _item2.id;\n    }\n\n    return producingBrokerId || '';\n  };\n\n  var getSelectedProducingBrokerName = function getSelectedProducingBrokerName(producingBrokerId) {\n    var _piProducingBrokers$f;\n\n    var selectedProducingBrokerName = piProducingBrokers === null || piProducingBrokers === void 0 ? void 0 : (_piProducingBrokers$f = piProducingBrokers.find(function (producingBroker) {\n      return (producingBroker === null || producingBroker === void 0 ? void 0 : producingBroker.id) === producingBrokerId;\n    })) === null || _piProducingBrokers$f === void 0 ? void 0 : _piProducingBrokers$f.value;\n    return selectedProducingBrokerName;\n  };\n\n  var getAccountExecutiveId = function getAccountExecutiveId() {\n    var _instruction$details5;\n\n    var accountExecutiveId = instruction === null || instruction === void 0 ? void 0 : (_instruction$details5 = instruction.details) === null || _instruction$details5 === void 0 ? void 0 : _instruction$details5.accountExecutiveId;\n    var item;\n\n    if (utils.generic.isValidArray(piAccountExecutives, true)) {\n      if (accountExecutiveId) {\n        var _item3;\n\n        item = piAccountExecutives.find(function (type) {\n          return type.id === accountExecutiveId;\n        });\n        accountExecutiveId = (_item3 = item) === null || _item3 === void 0 ? void 0 : _item3.id;\n      } else if (leadRefAccountExecutiveName) {\n        var leadAccountExecutive = piAccountExecutives === null || piAccountExecutives === void 0 ? void 0 : piAccountExecutives.find(function (type) {\n          return type.value.toLowerCase() === (leadRefAccountExecutiveName === null || leadRefAccountExecutiveName === void 0 ? void 0 : leadRefAccountExecutiveName.toLowerCase());\n        });\n        accountExecutiveId = leadAccountExecutive === null || leadAccountExecutive === void 0 ? void 0 : leadAccountExecutive.id;\n      }\n    } else if (!accountExecutiveId && utils.generic.isValidArray(accountExecutives, true)) {\n      var _item4;\n\n      item = accountExecutives.find(function (type) {\n        var _instruction$details6;\n\n        return type.id === (instruction === null || instruction === void 0 ? void 0 : (_instruction$details6 = instruction.details) === null || _instruction$details6 === void 0 ? void 0 : _instruction$details6.accountExecutiveId);\n      });\n      accountExecutiveId = (_item4 = item) === null || _item4 === void 0 ? void 0 : _item4.id;\n    }\n\n    return accountExecutiveId || '';\n  };\n\n  var getSelectedAccountExecutiveName = function getSelectedAccountExecutiveName(accountExecutiveId) {\n    var _piAccountExecutives$;\n\n    var selectedAccountExecutiveName = piAccountExecutives === null || piAccountExecutives === void 0 ? void 0 : (_piAccountExecutives$ = piAccountExecutives.find(function (accountExec) {\n      return (accountExec === null || accountExec === void 0 ? void 0 : accountExec.id) === accountExecutiveId;\n    })) === null || _piAccountExecutives$ === void 0 ? void 0 : _piAccountExecutives$.value;\n    return selectedAccountExecutiveName;\n  };\n\n  var fields = [{\n    name: 'invoicingClient',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.invoicingClient'),\n    value: (leadRef === null || leadRef === void 0 ? void 0 : leadRef.clientName) || '',\n    muiComponentProps: {\n      InputProps: {\n        readOnly: true,\n        disabled: true\n      }\n    }\n  }, {\n    name: 'contactName',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.contactName'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details7 = instruction.details) === null || _instruction$details7 === void 0 ? void 0 : _instruction$details7.contactName) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'clientEmail',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.clientEmail'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details8 = instruction.details) === null || _instruction$details8 === void 0 ? void 0 : _instruction$details8.clientEmail) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'eocInvoiceContactName',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceContactName'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details9 = instruction.details) === null || _instruction$details9 === void 0 ? void 0 : _instruction$details9.eocInvoiceContactName) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'eocInvoiceMail',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceMail'),\n    value: (instruction === null || instruction === void 0 ? void 0 : (_instruction$details10 = instruction.details) === null || _instruction$details10 === void 0 ? void 0 : _instruction$details10.eocInvoiceMail) || '',\n    muiComponentProps: {\n      inputProps: {\n        maxLength: 50\n      },\n      InputProps: {\n        readOnly: isReadOnly,\n        disabled: isReadOnly\n      }\n    }\n  }, {\n    name: 'producingBroker',\n    group: 'general',\n    type: 'select',\n    label: utils.string.t('processingInstructions.checklist.fields.producingBroker'),\n    value: getProducingBrokerId(),\n    options: producingBrokers,\n    optionKey: 'id',\n    optionLabel: 'value',\n    muiComponentProps: {\n      disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(producingBrokers)\n    }\n  }, {\n    name: 'accountExecutive',\n    group: 'general',\n    type: 'select',\n    label: utils.string.t('processingInstructions.checklist.fields.accountExecutive'),\n    value: getAccountExecutiveId(),\n    options: accountExecutives,\n    optionKey: 'id',\n    optionLabel: 'value',\n    muiComponentProps: {\n      disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(accountExecutives)\n    }\n  }].concat(_toConsumableArray(isFdo ? [{\n    name: 'businessType',\n    group: 'general',\n    type: 'text',\n    label: utils.string.t('processingInstructions.checklist.fields.businessType'),\n    value: (leadRef === null || leadRef === void 0 ? void 0 : leadRef.businessType) || '',\n    muiComponentProps: {\n      InputProps: {\n        readOnly: true,\n        disabled: true\n      }\n    }\n  }, {\n    name: 'facilityType',\n    group: 'general',\n    type: 'select',\n    label: utils.string.t('processingInstructions.checklist.fields.facilityType'),\n    value: getFacilityTypeId(),\n    options: facilityTypes,\n    optionKey: 'facilityTypeID',\n    optionLabel: 'facilityTypeDetails',\n    disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(facilityTypes)\n  }] : []));\n  useEffect(function () {\n    var _childRef$current, _childRef$current$pro;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current = childRef.current) === null || _childRef$current === void 0 ? void 0 : (_childRef$current$pro = _childRef$current.props) === null || _childRef$current$pro === void 0 ? void 0 : _childRef$current$pro.resetFunc;\n    var schema = utils.schemas.parsePiChecklist(processingInstructionsSchema, instruction);\n\n    var updatedDefaultValues = _objectSpread({\n      checklist: utils.form.getNestedInitialValues(schema === null || schema === void 0 ? void 0 : schema.rows, 'columnName')\n    }, utils.form.getInitialValues(fields));\n\n    setSchemaData(schema);\n    setDefaultValues(updatedDefaultValues);\n\n    if (utils.generic.isFunction(reset)) {\n      reset(updatedDefaultValues, {\n        keepDirty: false\n      });\n    }\n  }, [instruction] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  var validateAllChecklistSelected = function validateAllChecklistSelected(valuesChecklist) {\n    return Object.values(valuesChecklist).every(function (c) {\n      return ['YES', 'NO', 'NA'].includes(c.accountHandler);\n    });\n  };\n\n  var validateChecklistDates = function validateChecklistDates(valuesChecklist) {\n    var _valuesChecklist$quot, _valuesChecklist$quot2, _valuesChecklist$duty, _valuesChecklist$duty2, _valuesChecklist$evid, _valuesChecklist$evid2;\n\n    if ((valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$quot = valuesChecklist.quotesPutUp) === null || _valuesChecklist$quot === void 0 ? void 0 : _valuesChecklist$quot.accountHandler) === 'YES' && (valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$quot2 = valuesChecklist.quotesPutUp) === null || _valuesChecklist$quot2 === void 0 ? void 0 : _valuesChecklist$quot2.signedDate) === null) {\n      return false;\n    }\n\n    if ((valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$duty = valuesChecklist.dutyOfDisclosure) === null || _valuesChecklist$duty === void 0 ? void 0 : _valuesChecklist$duty.accountHandler) === 'YES' && (valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$duty2 = valuesChecklist.dutyOfDisclosure) === null || _valuesChecklist$duty2 === void 0 ? void 0 : _valuesChecklist$duty2.signedDate) === null) {\n      return false;\n    }\n\n    if ((valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$evid = valuesChecklist.evidence) === null || _valuesChecklist$evid === void 0 ? void 0 : _valuesChecklist$evid.accountHandler) === 'YES' && (valuesChecklist === null || valuesChecklist === void 0 ? void 0 : (_valuesChecklist$evid2 = valuesChecklist.evidence) === null || _valuesChecklist$evid2 === void 0 ? void 0 : _valuesChecklist$evid2.signedDate) === null) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var checklistCompletedModal = function checklistCompletedModal() {\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        fullWidth: true,\n        title: utils.string.t('processingInstructions.checklist.warning.title'),\n        maxWidth: 'xs',\n        componentProps: {\n          confirmLabel: utils.string.t('app.yes'),\n          cancelLabel: utils.string.t('app.no'),\n          confirmMessage: /*#__PURE__*/_jsxDEV(\"span\", {\n            dangerouslySetInnerHTML: {\n              __html: \"\".concat(utils.string.t('processingInstructions.checklist.allChecklistSelected'))\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 15\n          }, _this),\n          buttonColors: {\n            confirm: 'secondary',\n            cancel: 'primary'\n          },\n          submitHandler: function submitHandler() {\n            handlers.next();\n          },\n          cancelHandler: function cancelHandler() {},\n          handleClose: function handleClose() {}\n        }\n      }\n    }));\n  };\n\n  var handleSave = function handleSave() {\n    var _childRef$current$pro2;\n\n    var formValues = (_childRef$current$pro2 = childRef.current.props) === null || _childRef$current$pro2 === void 0 ? void 0 : _childRef$current$pro2.values;\n    var isProducingBrokerSelected = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.producingBroker);\n    var isFacilityTypeSelected = Boolean(isFdo ? formValues === null || formValues === void 0 ? void 0 : formValues.facilityType : true);\n    var isChecklistDatesSelected = validateChecklistDates(formValues === null || formValues === void 0 ? void 0 : formValues.checklist);\n\n    var updatedInstruction = _objectSpread(_objectSpread({}, instruction), {}, {\n      details: _objectSpread(_objectSpread({}, instruction.details), {}, {\n        accountExecutive: getSelectedAccountExecutiveName(formValues.accountExecutive),\n        producingBrokerName: getSelectedProducingBrokerName(formValues.producingBroker)\n      })\n    });\n\n    if (isProducingBrokerSelected && isChecklistDatesSelected && isFacilityTypeSelected) {\n      dispatch(checkListUpdate(formValues, updatedInstruction));\n    } else if (!isProducingBrokerSelected) {\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noProducingBrokerValue', 'warning'));\n    } else if (!isFacilityTypeSelected) {\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noFacilityTypeValue', 'warning'));\n    } else if (!isChecklistDatesSelected) {\n      dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\n    }\n  };\n\n  var handleNext = function handleNext() {\n    var _childRef$current$pro3;\n\n    var formValues = (_childRef$current$pro3 = childRef.current.props) === null || _childRef$current$pro3 === void 0 ? void 0 : _childRef$current$pro3.values;\n    var isProducingBrokerSelected = Boolean(formValues === null || formValues === void 0 ? void 0 : formValues.producingBroker);\n    var isFacilityTypeSelected = Boolean(isFdo ? formValues === null || formValues === void 0 ? void 0 : formValues.facilityType : true);\n    var isChecklistCompleted = validateAllChecklistSelected(formValues === null || formValues === void 0 ? void 0 : formValues.checklist);\n\n    if (!isEditable || isChecklistCompleted || selectedTab === 'general' && isProducingBrokerSelected && isFacilityTypeSelected) {\n      handlers.next();\n    } else if (!isProducingBrokerSelected) {\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noProducingBrokerValue', 'warning'));\n    } else if (!isFacilityTypeSelected) {\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noFacilityTypeValue', 'warning'));\n    } else if (isEditable && !isChecklistCompleted) {\n      checklistCompletedModal(formValues, instruction);\n    }\n  };\n\n  var handleCancel = function handleCancel() {\n    var _childRef$current2, _childRef$current2$pr;\n\n    var reset = childRef === null || childRef === void 0 ? void 0 : (_childRef$current2 = childRef.current) === null || _childRef$current2 === void 0 ? void 0 : (_childRef$current2$pr = _childRef$current2.props) === null || _childRef$current2$pr === void 0 ? void 0 : _childRef$current2$pr.resetFunc;\n    setResetKey(new Date().getTime());\n\n    if (utils.generic.isFunction(reset)) {\n      reset(defaultValues, {\n        keepDirty: false\n      });\n    }\n  };\n\n  var showAlertNavigation = function showAlertNavigation(submitHandler, cancelHandler) {\n    dispatch(showModal({\n      component: 'CONFIRM',\n      props: {\n        title: 'navigation.page.title',\n        subtitle: 'navigation.page.subtitle',\n        fullWidth: true,\n        maxWidth: 'sm',\n        componentProps: {\n          cancelLabel: utils.string.t('navigation.page.cancel'),\n          confirmLabel: utils.string.t('navigation.page.confirm'),\n          submitHandler: submitHandler,\n          cancelHandler: cancelHandler\n        }\n      }\n    }));\n  };\n\n  var toggleTab = function toggleTab(isPageDirty) {\n    return function (tab) {\n      if (isPageDirty) {\n        showAlertNavigation(function () {\n          return switchTab(tab);\n        }, function () {});\n      } else {\n        switchTab(tab);\n      }\n    };\n  };\n\n  var switchTab = function switchTab(tab) {\n    var _childRef$current$pro4;\n\n    var formValues = (_childRef$current$pro4 = childRef.current.props) === null || _childRef$current$pro4 === void 0 ? void 0 : _childRef$current$pro4.values;\n\n    var _ref2 = (formValues === null || formValues === void 0 ? void 0 : formValues.checklist) || {},\n        quotesPutUp = _ref2.quotesPutUp,\n        dutyOfDisclosure = _ref2.dutyOfDisclosure,\n        evidence = _ref2.evidence;\n\n    if (tab !== 'pre-placing') {\n      if ((quotesPutUp === null || quotesPutUp === void 0 ? void 0 : quotesPutUp.accountHandler) === 'YES' && (quotesPutUp === null || quotesPutUp === void 0 ? void 0 : quotesPutUp.signedDate) === null) {\n        dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\n        return;\n      }\n\n      if ((dutyOfDisclosure === null || dutyOfDisclosure === void 0 ? void 0 : dutyOfDisclosure.accountHandler) === 'YES' && (dutyOfDisclosure === null || dutyOfDisclosure === void 0 ? void 0 : dutyOfDisclosure.signedDate) === null) {\n        dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\n        return;\n      }\n\n      if ((evidence === null || evidence === void 0 ? void 0 : evidence.accountHandler) === 'YES' && (evidence === null || evidence === void 0 ? void 0 : evidence.signedDate) === null) {\n        dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\n        return;\n      }\n    }\n\n    setSelectedTab(tab);\n    history.replace(\"\".concat(config.routes.processingInstructions.steps, \"/\").concat(id).concat(step ? \"/\".concat(step) : '').concat(tab ? \"/\".concat(tab) : ''));\n  }; // abort if data is not ready/available\n\n\n  if (!defaultValues || !instruction) return null;\n  return /*#__PURE__*/_jsxDEV(ProcessingInstructionsChecklistView, {\n    instruction: instruction,\n    leadRef: leadRef,\n    defaultValues: defaultValues,\n    columns: columns,\n    tabs: tabs,\n    selectedTab: selectedTab,\n    fields: fields,\n    schemaData: schemaData,\n    isFdo: isFdo,\n    isReadOnly: isReadOnly,\n    isEditable: isEditable,\n    isCheckboxesEditable: isCheckboxesEditable,\n    handlers: _objectSpread(_objectSpread({}, handlers), {}, {\n      cancel: handleCancel,\n      save: handleSave,\n      next: handleNext,\n      toggleTab: toggleTab\n    }),\n    resetKey: resetKey,\n    ref: childRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 495,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProcessingInstructionsChecklist, \"j/kETskizq9IRiQpOEm1su2sUd8=\", false, function () {\n  return [useDispatch, useHistory, useParams, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ProcessingInstructionsChecklist;\nProcessingInstructionsChecklist.displayName = \"ProcessingInstructionsChecklist\";\nProcessingInstructionsChecklist.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [],\n  \"displayName\": \"ProcessingInstructionsChecklist\",\n  \"props\": {\n    \"instruction\": {\n      \"type\": {\n        \"name\": \"object\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"handlers\": {\n      \"type\": {\n        \"name\": \"shape\",\n        \"value\": {\n          \"back\": {\n            \"name\": \"func\",\n            \"required\": true\n          },\n          \"next\": {\n            \"name\": \"func\",\n            \"required\": true\n          }\n        }\n      },\n      \"required\": true,\n      \"description\": \"\"\n    }\n  }\n};\n\nif (typeof STORYBOOK_REACT_CLASSES !== \"undefined\") {\n  STORYBOOK_REACT_CLASSES[\"src\\\\modules\\\\ProcessingInstructionsChecklist\\\\ProcessingInstructionsChecklist.js\"] = {\n    name: \"ProcessingInstructionsChecklist\",\n    docgenInfo: ProcessingInstructionsChecklist.__docgenInfo,\n    path: \"src\\\\modules\\\\ProcessingInstructionsChecklist\\\\ProcessingInstructionsChecklist.js\"\n  };\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"ProcessingInstructionsChecklist\");","map":{"version":3,"sources":["E:/MPHASIS/claims-page/Mphasis-Edge/src/modules/ProcessingInstructionsChecklist/ProcessingInstructionsChecklist.js"],"names":["React","useEffect","useState","PropTypes","useSelector","useDispatch","useHistory","useParams","get","ProcessingInstructionsChecklistView","processingInstructionsSchema","enqueueNotification","checkListUpdate","showModal","selectUser","selectPiProducingBrokers","selectPiAccountExecutives","selectPiFacilityTypes","selectAccountExecutivesForRiskReference","selectProducingBrokerNamesForRiskReference","updateReferenceDocumentCountLoading","getRiskReferenceDocumentsCount","utils","config","constants","ProcessingInstructionsChecklist","propTypes","instruction","object","isRequired","handlers","shape","back","func","next","childRef","dispatch","history","id","step","tab","piProducingBrokers","piAccountExecutives","documents","state","producingBrokersFromRoles","accountExecutivesFromRoles","producingBrokers","generic","isValidArray","accountExecutives","facilityTypes","user","columns","label","string","t","align","tabs","value","isValidTab","map","item","includes","selectedTab","setSelectedTab","defaultValues","setDefaultValues","schemaData","setSchemaData","resetKey","setResetKey","leadRef","riskReferences","find","r","leadPolicy","leadRefProducingBrokerName","producingBrokerName","leadRefAccountExecutiveName","accountExecutive","isFdo","processingInstructions","processTypeId","isDraft","status","statusId","isRejectedDraft","isSubmittedAuthorisedSignatory","isReopened","userHasWritePermission","app","access","feature","userHasApproverAccess","isCheckboxesEditable","isEditable","isReadOnly","isEndorsement","isFeeAndAmendment","isBordereau","faBorderProcessType","getFacilityTypeId","facilityTypeId","details","type","facilityTypeID","getRiskReferenceDocumentCount","referenceList","refData","endorsementId","endorsementNumber","riskRefId","xbInstanceId","xbPolicyId","documentTypeValue","PI_ENDORSEMENT_TYPE_DOCUMENT","documentTypeDescription","PI_FABORDER_TYPE_DOCUMENT","PI_CLOSING_FDO_TYPE_DOCUMENT","getProducingBrokerId","producingBrokerId","leadProducingBroker","toLowerCase","getSelectedProducingBrokerName","selectedProducingBrokerName","producingBroker","getAccountExecutiveId","accountExecutiveId","leadAccountExecutive","getSelectedAccountExecutiveName","selectedAccountExecutiveName","accountExec","fields","name","group","clientName","muiComponentProps","InputProps","readOnly","disabled","contactName","inputProps","maxLength","clientEmail","eocInvoiceContactName","eocInvoiceMail","options","optionKey","optionLabel","isInvalidOrEmptyArray","businessType","reset","current","props","resetFunc","schema","schemas","parsePiChecklist","updatedDefaultValues","checklist","form","getNestedInitialValues","rows","getInitialValues","isFunction","keepDirty","validateAllChecklistSelected","valuesChecklist","Object","values","every","c","accountHandler","validateChecklistDates","quotesPutUp","signedDate","dutyOfDisclosure","evidence","checklistCompletedModal","component","fullWidth","title","maxWidth","componentProps","confirmLabel","cancelLabel","confirmMessage","__html","buttonColors","confirm","cancel","submitHandler","cancelHandler","handleClose","handleSave","formValues","isProducingBrokerSelected","Boolean","isFacilityTypeSelected","facilityType","isChecklistDatesSelected","updatedInstruction","handleNext","isChecklistCompleted","handleCancel","Date","getTime","showAlertNavigation","subtitle","toggleTab","isPageDirty","switchTab","replace","routes","steps","save"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport get from 'lodash/get';\r\n\r\n// app\r\nimport ProcessingInstructionsChecklistView from './ProcessingInstructionsChecklist.view';\r\nimport { processingInstructionsSchema } from 'schemas';\r\nimport {\r\n  enqueueNotification,\r\n  checkListUpdate,\r\n  showModal,\r\n  selectUser,\r\n  selectPiProducingBrokers,\r\n  selectPiAccountExecutives,\r\n  selectPiFacilityTypes,\r\n  selectAccountExecutivesForRiskReference,\r\n  selectProducingBrokerNamesForRiskReference,\r\n  updateReferenceDocumentCountLoading,\r\n  getRiskReferenceDocumentsCount,\r\n} from 'stores';\r\nimport * as utils from 'utils';\r\nimport config from 'config';\r\nimport * as constants from 'consts';\r\n\r\nProcessingInstructionsChecklist.propTypes = {\r\n  instruction: PropTypes.object.isRequired,\r\n  handlers: PropTypes.shape({\r\n    back: PropTypes.func.isRequired,\r\n    next: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nexport default function ProcessingInstructionsChecklist({ instruction, handlers, childRef }) {\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const { id, step, tab } = useParams();\r\n  const piProducingBrokers = useSelector(selectProducingBrokerNamesForRiskReference);\r\n  const piAccountExecutives = useSelector(selectAccountExecutivesForRiskReference);\r\n\r\n  const documents = useSelector((state) => get(state, 'processingInstructions.documents')) || {};\r\n  const producingBrokersFromRoles = useSelector(selectPiProducingBrokers);\r\n  const accountExecutivesFromRoles = useSelector(selectPiAccountExecutives);\r\n  const producingBrokers = utils.generic.isValidArray(piProducingBrokers, true) ? piProducingBrokers : producingBrokersFromRoles;\r\n  const accountExecutives = utils.generic.isValidArray(piAccountExecutives, true) ? piAccountExecutives : accountExecutivesFromRoles;\r\n  const facilityTypes = useSelector(selectPiFacilityTypes);\r\n  const user = useSelector(selectUser);\r\n\r\n  const columns = [\r\n    { id: 'detail', label: utils.string.t('processingInstructions.checklist.cols.detail') },\r\n    { id: 'frontEndContact', label: utils.string.t('processingInstructions.checklist.cols.frontEndContact'), align: 'center' },\r\n    { id: 'authorisedSignatory', label: utils.string.t('processingInstructions.checklist.cols.authorisedSignatory'), align: 'center' },\r\n  ];\r\n\r\n  const tabs = [\r\n    { value: 'general', label: utils.string.t('processingInstructions.checklist.tabs.general.title') },\r\n    { value: 'pre-placing', label: utils.string.t('processingInstructions.checklist.tabs.prePlacing.title') },\r\n    { value: 'mrc', label: utils.string.t('processingInstructions.checklist.tabs.mrc.title') },\r\n    { value: 'other-details', label: utils.string.t('processingInstructions.checklist.tabs.otherDetails.title') },\r\n    { value: 'risk-references', label: utils.string.t('processingInstructions.checklist.tabs.riskRefs.title') },\r\n  ];\r\n\r\n  const isValidTab = tabs.map((item) => item.value).includes(tab);\r\n\r\n  const [selectedTab, setSelectedTab] = useState(isValidTab ? tab : 'general');\r\n  const [defaultValues, setDefaultValues] = useState();\r\n  const [schemaData, setSchemaData] = useState({});\r\n  const [resetKey, setResetKey] = useState();\r\n  const leadRef = instruction?.riskReferences?.find((r) => r.leadPolicy);\r\n\r\n  const leadRefProducingBrokerName = leadRef?.producingBrokerName;\r\n  const leadRefAccountExecutiveName = leadRef?.accountExecutive;\r\n  const isFdo = utils.processingInstructions.isFdo(instruction?.processTypeId);\r\n  const isDraft = utils.processingInstructions.status.isDraft(instruction?.statusId);\r\n  const isRejectedDraft = utils.processingInstructions.status.isRejectedDraft(instruction?.statusId);\r\n  const isSubmittedAuthorisedSignatory = utils.processingInstructions.status.isSubmittedAuthorisedSignatory(instruction?.statusId);\r\n  const isReopened = utils.processingInstructions.status.isReopened(instruction?.statusId);\r\n  const userHasWritePermission = utils.app.access.feature('processingInstructions.processingInstructions', ['create', 'update'], user);\r\n  const userHasApproverAccess = utils.app.access.feature('processingInstructions.approverChecklist', ['create', 'update'], user);\r\n  const isCheckboxesEditable = userHasApproverAccess && isSubmittedAuthorisedSignatory;\r\n  const isEditable = userHasWritePermission && (isDraft || isRejectedDraft || isReopened);\r\n  const isReadOnly = !isEditable;\r\n\r\n  const isEndorsement = utils.processingInstructions.isEndorsement(instruction?.processTypeId);\r\n  const isFeeAndAmendment = utils.processingInstructions.isFeeAndAmendment(instruction?.processTypeId);\r\n  const isBordereau = utils.processingInstructions.isBordereau(instruction?.processTypeId);\r\n  const faBorderProcessType = isBordereau || isFeeAndAmendment;\r\n  const getFacilityTypeId = () => {\r\n    let facilityTypeId = instruction?.details?.facilityTypeId;\r\n\r\n    if (!facilityTypeId && utils.generic.isValidArray(facilityTypes, true)) {\r\n      const item = facilityTypes.find((type) => type.facilityTypeID === instruction?.details?.facilityTypeId);\r\n      facilityTypeId = item?.facilityTypeID;\r\n    }\r\n\r\n    return facilityTypeId || '';\r\n  };\r\n\r\n  const getRiskReferenceDocumentCount = () => {\r\n    if (utils.generic.isValidArray(documents?.riskReferences, true)) {\r\n      dispatch(updateReferenceDocumentCountLoading(true));\r\n      const referenceList = documents?.riskReferences?.map((refData) => {\r\n        return {\r\n          endorsementId: refData.endorsementId,\r\n          endorsementNumber: refData.endorsementNumber,\r\n          riskRefId: refData.riskRefId,\r\n          xbInstanceId: refData.xbInstanceId,\r\n          xbPolicyId: refData.xbPolicyId,\r\n        };\r\n      });\r\n      const documentTypeValue = isEndorsement\r\n        ? constants.PI_ENDORSEMENT_TYPE_DOCUMENT.documentTypeDescription\r\n        : faBorderProcessType\r\n        ? constants.PI_FABORDER_TYPE_DOCUMENT.documentTypeDescription\r\n        : constants.PI_CLOSING_FDO_TYPE_DOCUMENT.documentTypeDescription;\r\n      dispatch(getRiskReferenceDocumentsCount(referenceList, documentTypeValue));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getRiskReferenceDocumentCount();\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const getProducingBrokerId = () => {\r\n    let producingBrokerId = instruction?.details?.producingBrokerId;\r\n    let item;\r\n\r\n    if (utils.generic.isValidArray(piProducingBrokers, true)) {\r\n      if (producingBrokerId) {\r\n        item = piProducingBrokers.find((type) => type.id === producingBrokerId);\r\n        producingBrokerId = item?.id;\r\n      } else if (leadRefProducingBrokerName) {\r\n        const leadProducingBroker = piProducingBrokers?.find(\r\n          (type) => type?.value?.toLowerCase() === leadRefProducingBrokerName?.toLowerCase()\r\n        );\r\n        producingBrokerId = leadProducingBroker?.id;\r\n      }\r\n    } else if (!producingBrokerId && utils.generic.isValidArray(producingBrokers, true)) {\r\n      item = producingBrokers.find((type) => type.id === instruction?.details?.producingBrokerId);\r\n      producingBrokerId = item?.id;\r\n    }\r\n\r\n    return producingBrokerId || '';\r\n  };\r\n\r\n  const getSelectedProducingBrokerName = (producingBrokerId) => {\r\n    const selectedProducingBrokerName = piProducingBrokers?.find((producingBroker) => producingBroker?.id === producingBrokerId)?.value;\r\n    return selectedProducingBrokerName;\r\n  };\r\n\r\n  const getAccountExecutiveId = () => {\r\n    let accountExecutiveId = instruction?.details?.accountExecutiveId;\r\n    let item;\r\n    if (utils.generic.isValidArray(piAccountExecutives, true)) {\r\n      if (accountExecutiveId) {\r\n        item = piAccountExecutives.find((type) => type.id === accountExecutiveId);\r\n        accountExecutiveId = item?.id;\r\n      } else if (leadRefAccountExecutiveName) {\r\n        const leadAccountExecutive = piAccountExecutives?.find(\r\n          (type) => type.value.toLowerCase() === leadRefAccountExecutiveName?.toLowerCase()\r\n        );\r\n        accountExecutiveId = leadAccountExecutive?.id;\r\n      }\r\n    } else if (!accountExecutiveId && utils.generic.isValidArray(accountExecutives, true)) {\r\n      item = accountExecutives.find((type) => type.id === instruction?.details?.accountExecutiveId);\r\n      accountExecutiveId = item?.id;\r\n    }\r\n\r\n    return accountExecutiveId || '';\r\n  };\r\n\r\n  const getSelectedAccountExecutiveName = (accountExecutiveId) => {\r\n    const selectedAccountExecutiveName = piAccountExecutives?.find((accountExec) => accountExec?.id === accountExecutiveId)?.value;\r\n    return selectedAccountExecutiveName;\r\n  };\r\n\r\n  const fields = [\r\n    {\r\n      name: 'invoicingClient',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.invoicingClient'),\r\n      value: leadRef?.clientName || '',\r\n      muiComponentProps: {\r\n        InputProps: {\r\n          readOnly: true,\r\n          disabled: true,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'contactName',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.contactName'),\r\n      value: instruction?.details?.contactName || '',\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'clientEmail',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.clientEmail'),\r\n      value: instruction?.details?.clientEmail || '',\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'eocInvoiceContactName',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceContactName'),\r\n      value: instruction?.details?.eocInvoiceContactName || '',\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'eocInvoiceMail',\r\n      group: 'general',\r\n      type: 'text',\r\n      label: utils.string.t('processingInstructions.checklist.fields.eocInvoiceMail'),\r\n      value: instruction?.details?.eocInvoiceMail || '',\r\n      muiComponentProps: {\r\n        inputProps: {\r\n          maxLength: 50,\r\n        },\r\n        InputProps: {\r\n          readOnly: isReadOnly,\r\n          disabled: isReadOnly,\r\n        },\r\n      },\r\n    },\r\n    {\r\n      name: 'producingBroker',\r\n      group: 'general',\r\n      type: 'select',\r\n      label: utils.string.t('processingInstructions.checklist.fields.producingBroker'),\r\n      value: getProducingBrokerId(),\r\n      options: producingBrokers,\r\n      optionKey: 'id',\r\n      optionLabel: 'value',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(producingBrokers),\r\n      },\r\n    },\r\n    {\r\n      name: 'accountExecutive',\r\n      group: 'general',\r\n      type: 'select',\r\n      label: utils.string.t('processingInstructions.checklist.fields.accountExecutive'),\r\n      value: getAccountExecutiveId(),\r\n      options: accountExecutives,\r\n      optionKey: 'id',\r\n      optionLabel: 'value',\r\n      muiComponentProps: {\r\n        disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(accountExecutives),\r\n      },\r\n    },\r\n    ...(isFdo\r\n      ? [\r\n          {\r\n            name: 'businessType',\r\n            group: 'general',\r\n            type: 'text',\r\n            label: utils.string.t('processingInstructions.checklist.fields.businessType'),\r\n            value: leadRef?.businessType || '',\r\n            muiComponentProps: {\r\n              InputProps: {\r\n                readOnly: true,\r\n                disabled: true,\r\n              },\r\n            },\r\n          },\r\n          {\r\n            name: 'facilityType',\r\n            group: 'general',\r\n            type: 'select',\r\n            label: utils.string.t('processingInstructions.checklist.fields.facilityType'),\r\n            value: getFacilityTypeId(),\r\n            options: facilityTypes,\r\n            optionKey: 'facilityTypeID',\r\n            optionLabel: 'facilityTypeDetails',\r\n            disabled: isReadOnly || utils.generic.isInvalidOrEmptyArray(facilityTypes),\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  useEffect(\r\n    () => {\r\n      const reset = childRef?.current?.props?.resetFunc;\r\n      const schema = utils.schemas.parsePiChecklist(processingInstructionsSchema, instruction);\r\n      const updatedDefaultValues = {\r\n        checklist: utils.form.getNestedInitialValues(schema?.rows, 'columnName'),\r\n        ...utils.form.getInitialValues(fields),\r\n      };\r\n\r\n      setSchemaData(schema);\r\n      setDefaultValues(updatedDefaultValues);\r\n\r\n      if (utils.generic.isFunction(reset)) {\r\n        reset(updatedDefaultValues, {\r\n          keepDirty: false,\r\n        });\r\n      }\r\n    },\r\n    [instruction] // eslint-disable-line react-hooks/exhaustive-deps\r\n  );\r\n\r\n  const validateAllChecklistSelected = (valuesChecklist) => {\r\n    return Object.values(valuesChecklist).every((c) => ['YES', 'NO', 'NA'].includes(c.accountHandler));\r\n  };\r\n\r\n  const validateChecklistDates = (valuesChecklist) => {\r\n    if (valuesChecklist?.quotesPutUp?.accountHandler === 'YES' && valuesChecklist?.quotesPutUp?.signedDate === null) {\r\n      return false;\r\n    }\r\n\r\n    if (valuesChecklist?.dutyOfDisclosure?.accountHandler === 'YES' && valuesChecklist?.dutyOfDisclosure?.signedDate === null) {\r\n      return false;\r\n    }\r\n\r\n    if (valuesChecklist?.evidence?.accountHandler === 'YES' && valuesChecklist?.evidence?.signedDate === null) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const checklistCompletedModal = () => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          fullWidth: true,\r\n          title: utils.string.t('processingInstructions.checklist.warning.title'),\r\n          maxWidth: 'xs',\r\n          componentProps: {\r\n            confirmLabel: utils.string.t('app.yes'),\r\n            cancelLabel: utils.string.t('app.no'),\r\n            confirmMessage: (\r\n              <span\r\n                dangerouslySetInnerHTML={{\r\n                  __html: `${utils.string.t('processingInstructions.checklist.allChecklistSelected')}`,\r\n                }}\r\n              />\r\n            ),\r\n            buttonColors: { confirm: 'secondary', cancel: 'primary' },\r\n            submitHandler: () => {\r\n              handlers.next();\r\n            },\r\n            cancelHandler: () => {},\r\n            handleClose: () => {},\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleSave = () => {\r\n    const formValues = childRef.current.props?.values;\r\n    const isProducingBrokerSelected = Boolean(formValues?.producingBroker);\r\n    const isFacilityTypeSelected = Boolean(isFdo ? formValues?.facilityType : true);\r\n    const isChecklistDatesSelected = validateChecklistDates(formValues?.checklist);\r\n\r\n    const updatedInstruction = {\r\n      ...instruction,\r\n      details: {\r\n        ...instruction.details,\r\n        accountExecutive: getSelectedAccountExecutiveName(formValues.accountExecutive),\r\n        producingBrokerName: getSelectedProducingBrokerName(formValues.producingBroker),\r\n      },\r\n    };\r\n    if (isProducingBrokerSelected && isChecklistDatesSelected && isFacilityTypeSelected) {\r\n      dispatch(checkListUpdate(formValues, updatedInstruction));\r\n    } else if (!isProducingBrokerSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noProducingBrokerValue', 'warning'));\r\n    } else if (!isFacilityTypeSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noFacilityTypeValue', 'warning'));\r\n    } else if (!isChecklistDatesSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\r\n    }\r\n  };\r\n\r\n  const handleNext = () => {\r\n    const formValues = childRef.current.props?.values;\r\n    const isProducingBrokerSelected = Boolean(formValues?.producingBroker);\r\n    const isFacilityTypeSelected = Boolean(isFdo ? formValues?.facilityType : true);\r\n    const isChecklistCompleted = validateAllChecklistSelected(formValues?.checklist);\r\n\r\n    if (!isEditable || isChecklistCompleted || (selectedTab === 'general' && isProducingBrokerSelected && isFacilityTypeSelected)) {\r\n      handlers.next();\r\n    } else if (!isProducingBrokerSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noProducingBrokerValue', 'warning'));\r\n    } else if (!isFacilityTypeSelected) {\r\n      dispatch(enqueueNotification('processingInstructions.addRiskReference.noFacilityTypeValue', 'warning'));\r\n    } else if (isEditable && !isChecklistCompleted) {\r\n      checklistCompletedModal(formValues, instruction);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    const reset = childRef?.current?.props?.resetFunc;\r\n\r\n    setResetKey(new Date().getTime());\r\n\r\n    if (utils.generic.isFunction(reset)) {\r\n      reset(defaultValues, { keepDirty: false });\r\n    }\r\n  };\r\n\r\n  const showAlertNavigation = (submitHandler, cancelHandler) => {\r\n    dispatch(\r\n      showModal({\r\n        component: 'CONFIRM',\r\n        props: {\r\n          title: 'navigation.page.title',\r\n          subtitle: 'navigation.page.subtitle',\r\n          fullWidth: true,\r\n          maxWidth: 'sm',\r\n          componentProps: {\r\n            cancelLabel: utils.string.t('navigation.page.cancel'),\r\n            confirmLabel: utils.string.t('navigation.page.confirm'),\r\n            submitHandler,\r\n            cancelHandler,\r\n          },\r\n        },\r\n      })\r\n    );\r\n  };\r\n\r\n  const toggleTab = (isPageDirty) => (tab) => {\r\n    if (isPageDirty) {\r\n      showAlertNavigation(\r\n        () => switchTab(tab),\r\n        () => {}\r\n      );\r\n    } else {\r\n      switchTab(tab);\r\n    }\r\n  };\r\n\r\n  const switchTab = (tab) => {\r\n    const formValues = childRef.current.props?.values;\r\n    const { quotesPutUp, dutyOfDisclosure, evidence } = formValues?.checklist || {};\r\n\r\n    if (tab !== 'pre-placing') {\r\n      if (quotesPutUp?.accountHandler === 'YES' && quotesPutUp?.signedDate === null) {\r\n        dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\r\n        return;\r\n      }\r\n\r\n      if (dutyOfDisclosure?.accountHandler === 'YES' && dutyOfDisclosure?.signedDate === null) {\r\n        dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\r\n        return;\r\n      }\r\n\r\n      if (evidence?.accountHandler === 'YES' && evidence?.signedDate === null) {\r\n        dispatch(enqueueNotification('processingInstructions.checklist.prePlacing.mandatoryDateSelection', 'warning'));\r\n        return;\r\n      }\r\n    }\r\n\r\n    setSelectedTab(tab);\r\n    history.replace(`${config.routes.processingInstructions.steps}/${id}${step ? `/${step}` : ''}${tab ? `/${tab}` : ''}`);\r\n  };\r\n\r\n  // abort if data is not ready/available\r\n  if (!defaultValues || !instruction) return null;\r\n\r\n  return (\r\n    <ProcessingInstructionsChecklistView\r\n      instruction={instruction}\r\n      leadRef={leadRef}\r\n      defaultValues={defaultValues}\r\n      columns={columns}\r\n      tabs={tabs}\r\n      selectedTab={selectedTab}\r\n      fields={fields}\r\n      schemaData={schemaData}\r\n      isFdo={isFdo}\r\n      isReadOnly={isReadOnly}\r\n      isEditable={isEditable}\r\n      isCheckboxesEditable={isCheckboxesEditable}\r\n      handlers={{\r\n        ...handlers,\r\n        cancel: handleCancel,\r\n        save: handleSave,\r\n        next: handleNext,\r\n        toggleTab,\r\n      }}\r\n      resetKey={resetKey}\r\n      ref={childRef}\r\n    />\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}